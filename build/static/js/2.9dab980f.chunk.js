/*! For license information please see 2.9dab980f.chunk.js.LICENSE.txt */
(this["webpackJsonpmy-todo-app"]=this["webpackJsonpmy-todo-app"]||[]).push([[2],[function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(44),a=n.n(r),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=a.a.createContext&&a.a.createContext(i),u=function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function s(e){return e&&e.map((function(e,t){return a.a.createElement(e.tag,u({key:t},e.attr),s(e.child))}))}function l(e){return function(t){return a.a.createElement(f,u({attr:u({},e.attr)},t),s(e.child))}}function f(e){var t=function(t){var n,r=e.attr,i=e.size,o=e.title,s=c(e,["attr","size","title"]),l=i||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),a.a.createElement("svg",u({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,s,{className:n,style:u(u({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),o&&a.a.createElement("title",null,o),e.children)};return void 0!==o?a.a.createElement(o.Consumer,null,(function(e){return t(e)})):t(i)}},function(e,t,n){"use strict";n.r(t),n.d(t,"AdadeltaOptimizer",(function(){return xt})),n.d(t,"AdagradOptimizer",(function(){return kt})),n.d(t,"AdamOptimizer",(function(){return _t})),n.d(t,"AdamaxOptimizer",(function(){return Ct})),n.d(t,"MomentumOptimizer",(function(){return Nt})),n.d(t,"Optimizer",(function(){return yt})),n.d(t,"RMSPropOptimizer",(function(){return Tt})),n.d(t,"SGDOptimizer",(function(){return At})),n.d(t,"Tensor",(function(){return le.a})),n.d(t,"TensorBuffer",(function(){return le.b})),n.d(t,"Variable",(function(){return le.c})),n.d(t,"Rank",(function(){return It.a})),n.d(t,"sumOutType",(function(){return It.b})),n.d(t,"upcastType",(function(){return It.c})),n.d(t,"abs",(function(){return Dt.b})),n.d(t,"acos",(function(){return Dt.c})),n.d(t,"acosh",(function(){return Dt.d})),n.d(t,"add",(function(){return Dt.e})),n.d(t,"addN",(function(){return Dt.f})),n.d(t,"all",(function(){return Dt.g})),n.d(t,"any",(function(){return Dt.h})),n.d(t,"argMax",(function(){return Dt.i})),n.d(t,"argMin",(function(){return Dt.j})),n.d(t,"asin",(function(){return Dt.k})),n.d(t,"asinh",(function(){return Dt.l})),n.d(t,"atan",(function(){return Dt.m})),n.d(t,"atan2",(function(){return Dt.n})),n.d(t,"atanh",(function(){return Dt.o})),n.d(t,"avgPool",(function(){return Dt.p})),n.d(t,"avgPool3d",(function(){return Dt.q})),n.d(t,"basicLSTMCell",(function(){return Dt.r})),n.d(t,"batchToSpaceND",(function(){return Dt.w})),n.d(t,"batchNorm",(function(){return Dt.s})),n.d(t,"batchNorm2d",(function(){return Dt.t})),n.d(t,"batchNorm3d",(function(){return Dt.u})),n.d(t,"batchNorm4d",(function(){return Dt.v})),n.d(t,"bincount",(function(){return Dt.x})),n.d(t,"broadcastTo",(function(){return Dt.z})),n.d(t,"buffer",(function(){return Dt.A})),n.d(t,"cast",(function(){return Dt.B})),n.d(t,"ceil",(function(){return Dt.C})),n.d(t,"clipByValue",(function(){return Dt.D})),n.d(t,"clone",(function(){return Dt.E})),n.d(t,"complex",(function(){return Dt.F})),n.d(t,"concat",(function(){return Dt.G})),n.d(t,"concat1d",(function(){return Dt.H})),n.d(t,"concat2d",(function(){return Dt.I})),n.d(t,"concat3d",(function(){return Dt.J})),n.d(t,"concat4d",(function(){return Dt.K})),n.d(t,"conv1d",(function(){return Dt.L})),n.d(t,"conv2d",(function(){return Dt.M})),n.d(t,"conv2dTranspose",(function(){return Dt.N})),n.d(t,"conv3d",(function(){return Dt.O})),n.d(t,"conv3dTranspose",(function(){return Dt.P})),n.d(t,"cos",(function(){return Dt.Q})),n.d(t,"cosh",(function(){return Dt.R})),n.d(t,"cumsum",(function(){return Dt.T})),n.d(t,"denseBincount",(function(){return Dt.U})),n.d(t,"depthToSpace",(function(){return Dt.V})),n.d(t,"depthwiseConv2d",(function(){return Dt.W})),n.d(t,"diag",(function(){return Dt.X})),n.d(t,"dilation2d",(function(){return Dt.Y})),n.d(t,"div",(function(){return Dt.Z})),n.d(t,"divNoNan",(function(){return Dt.ab})),n.d(t,"dot",(function(){return Dt.bb})),n.d(t,"einsum",(function(){return Dt.db})),n.d(t,"elu",(function(){return Dt.eb})),n.d(t,"equal",(function(){return Dt.gb})),n.d(t,"erf",(function(){return Dt.hb})),n.d(t,"exp",(function(){return Dt.ib})),n.d(t,"expandDims",(function(){return Dt.jb})),n.d(t,"expm1",(function(){return Dt.kb})),n.d(t,"eye",(function(){return Dt.lb})),n.d(t,"fill",(function(){return Dt.nb})),n.d(t,"floor",(function(){return Dt.ob})),n.d(t,"floorDiv",(function(){return Dt.pb})),n.d(t,"gather",(function(){return Dt.rb})),n.d(t,"greater",(function(){return Dt.tb})),n.d(t,"greaterEqual",(function(){return Dt.ub})),n.d(t,"imag",(function(){return Dt.wb})),n.d(t,"isFinite",(function(){return Dt.Ab})),n.d(t,"isInf",(function(){return Dt.Bb})),n.d(t,"isNaN",(function(){return Dt.Cb})),n.d(t,"leakyRelu",(function(){return Dt.Db})),n.d(t,"less",(function(){return Dt.Eb})),n.d(t,"lessEqual",(function(){return Dt.Fb})),n.d(t,"linspace",(function(){return Dt.Hb})),n.d(t,"localResponseNormalization",(function(){return Dt.Ib})),n.d(t,"log",(function(){return Dt.Jb})),n.d(t,"log1p",(function(){return Dt.Kb})),n.d(t,"logSigmoid",(function(){return Dt.Lb})),n.d(t,"logSoftmax",(function(){return Dt.Mb})),n.d(t,"logSumExp",(function(){return Dt.Nb})),n.d(t,"logicalAnd",(function(){return Dt.Ob})),n.d(t,"logicalNot",(function(){return Dt.Pb})),n.d(t,"logicalOr",(function(){return Dt.Qb})),n.d(t,"logicalXor",(function(){return Dt.Rb})),n.d(t,"matMul",(function(){return Dt.Tb})),n.d(t,"max",(function(){return Dt.Ub})),n.d(t,"maxPool",(function(){return Dt.Vb})),n.d(t,"maxPool3d",(function(){return Dt.Wb})),n.d(t,"maxPoolWithArgmax",(function(){return Dt.Xb})),n.d(t,"maximum",(function(){return Dt.Yb})),n.d(t,"mean",(function(){return Dt.Zb})),n.d(t,"meshgrid",(function(){return Dt.ac})),n.d(t,"min",(function(){return Dt.bc})),n.d(t,"minimum",(function(){return Dt.cc})),n.d(t,"mirrorPad",(function(){return Dt.dc})),n.d(t,"mod",(function(){return Dt.ec})),n.d(t,"moments",(function(){return Dt.fc})),n.d(t,"mul",(function(){return Dt.hc})),n.d(t,"multiRNNCell",(function(){return Dt.ic})),n.d(t,"multinomial",(function(){return Dt.jc})),n.d(t,"neg",(function(){return Dt.kc})),n.d(t,"notEqual",(function(){return Dt.mc})),n.d(t,"oneHot",(function(){return Dt.nc})),n.d(t,"ones",(function(){return Dt.oc})),n.d(t,"onesLike",(function(){return Dt.pc})),n.d(t,"outerProduct",(function(){return Dt.rc})),n.d(t,"pad",(function(){return Dt.sc})),n.d(t,"pad1d",(function(){return Dt.tc})),n.d(t,"pad2d",(function(){return Dt.uc})),n.d(t,"pad3d",(function(){return Dt.vc})),n.d(t,"pad4d",(function(){return Dt.wc})),n.d(t,"pool",(function(){return Dt.xc})),n.d(t,"pow",(function(){return Dt.yc})),n.d(t,"prelu",(function(){return Dt.zc})),n.d(t,"print",(function(){return Dt.Ac})),n.d(t,"prod",(function(){return Dt.Bc})),n.d(t,"rand",(function(){return Dt.Cc})),n.d(t,"randomGamma",(function(){return Dt.Dc})),n.d(t,"randomNormal",(function(){return Dt.Ec})),n.d(t,"randomUniform",(function(){return Dt.Fc})),n.d(t,"range",(function(){return Dt.Gc})),n.d(t,"real",(function(){return Dt.Hc})),n.d(t,"reciprocal",(function(){return Dt.Ic})),n.d(t,"relu",(function(){return Dt.Jc})),n.d(t,"relu6",(function(){return Dt.Kc})),n.d(t,"reshape",(function(){return Dt.Lc})),n.d(t,"reverse",(function(){return Dt.Mc})),n.d(t,"reverse1d",(function(){return Dt.Nc})),n.d(t,"reverse2d",(function(){return Dt.Oc})),n.d(t,"reverse3d",(function(){return Dt.Pc})),n.d(t,"reverse4d",(function(){return Dt.Qc})),n.d(t,"round",(function(){return Dt.Sc})),n.d(t,"rsqrt",(function(){return Dt.Tc})),n.d(t,"scalar",(function(){return Dt.Uc})),n.d(t,"selu",(function(){return Dt.Wc})),n.d(t,"separableConv2d",(function(){return Dt.Xc})),n.d(t,"setdiff1dAsync",(function(){return Dt.Yc})),n.d(t,"sigmoid",(function(){return Dt.Zc})),n.d(t,"sign",(function(){return Dt.ad})),n.d(t,"sin",(function(){return Dt.cd})),n.d(t,"sinh",(function(){return Dt.dd})),n.d(t,"slice",(function(){return Dt.ed})),n.d(t,"slice1d",(function(){return Dt.fd})),n.d(t,"slice2d",(function(){return Dt.gd})),n.d(t,"slice3d",(function(){return Dt.hd})),n.d(t,"slice4d",(function(){return Dt.id})),n.d(t,"softmax",(function(){return Dt.jd})),n.d(t,"softplus",(function(){return Dt.kd})),n.d(t,"spaceToBatchND",(function(){return Dt.ld})),n.d(t,"fft",(function(){return Dt.mb})),n.d(t,"ifft",(function(){return Dt.vb})),n.d(t,"irfft",(function(){return Dt.zb})),n.d(t,"rfft",(function(){return Dt.Rc})),n.d(t,"split",(function(){return Dt.pd})),n.d(t,"sqrt",(function(){return Dt.qd})),n.d(t,"square",(function(){return Dt.rd})),n.d(t,"squaredDifference",(function(){return Dt.sd})),n.d(t,"squeeze",(function(){return Dt.td})),n.d(t,"stack",(function(){return Dt.ud})),n.d(t,"step",(function(){return Dt.vd})),n.d(t,"stridedSlice",(function(){return Dt.wd})),n.d(t,"sub",(function(){return Dt.xd})),n.d(t,"sum",(function(){return Dt.yd})),n.d(t,"tan",(function(){return Dt.zd})),n.d(t,"tanh",(function(){return Dt.Ad})),n.d(t,"tensor",(function(){return Dt.Bd})),n.d(t,"tensor1d",(function(){return Dt.Cd})),n.d(t,"tensor2d",(function(){return Dt.Dd})),n.d(t,"tensor3d",(function(){return Dt.Ed})),n.d(t,"tensor4d",(function(){return Dt.Fd})),n.d(t,"tensor5d",(function(){return Dt.Gd})),n.d(t,"tensor6d",(function(){return Dt.Hd})),n.d(t,"tile",(function(){return Dt.Id})),n.d(t,"topk",(function(){return Dt.Jd})),n.d(t,"truncatedNormal",(function(){return Dt.Ld})),n.d(t,"unique",(function(){return Dt.Md})),n.d(t,"unsortedSegmentSum",(function(){return Dt.Nd})),n.d(t,"unstack",(function(){return Dt.Od})),n.d(t,"variable",(function(){return Dt.Pd})),n.d(t,"where",(function(){return Dt.Qd})),n.d(t,"whereAsync",(function(){return Dt.Rd})),n.d(t,"zeros",(function(){return Dt.Sd})),n.d(t,"zerosLike",(function(){return Dt.Td})),n.d(t,"booleanMaskAsync",(function(){return Dt.y})),n.d(t,"transpose",(function(){return Dt.Kd})),n.d(t,"norm",(function(){return Dt.lc})),n.d(t,"movingAverage",(function(){return Dt.gc})),n.d(t,"scatterND",(function(){return Dt.Vc})),n.d(t,"sparseToDense",(function(){return Dt.nd})),n.d(t,"gatherND",(function(){return Dt.sb})),n.d(t,"dropout",(function(){return Dt.cb})),n.d(t,"enclosingPowerOfTwo",(function(){return Dt.fb})),n.d(t,"cosineWindow",(function(){return Dt.S})),n.d(t,"inTopKAsync",(function(){return Dt.yb})),n.d(t,"op",(function(){return Dt.qc})),n.d(t,"OP_SCOPE_SUFFIX",(function(){return Dt.a})),n.d(t,"image",(function(){return Dt.xb})),n.d(t,"linalg",(function(){return Dt.Gb})),n.d(t,"losses",(function(){return Dt.Sb})),n.d(t,"spectral",(function(){return Dt.od})),n.d(t,"fused",(function(){return Dt.qb})),n.d(t,"signal",(function(){return Dt.bd})),n.d(t,"sparse",(function(){return Dt.md})),n.d(t,"Reduction",(function(){return Ft.a})),n.d(t,"train",(function(){return Rt})),n.d(t,"enableProdMode",(function(){return lt.g})),n.d(t,"enableDebugMode",(function(){return lt.f})),n.d(t,"disableDeprecationWarnings",(function(){return lt.c})),n.d(t,"deprecationWarn",(function(){return lt.b})),n.d(t,"disposeVariables",(function(){return lt.e})),n.d(t,"engine",(function(){return lt.h})),n.d(t,"memory",(function(){return lt.m})),n.d(t,"profile",(function(){return lt.n})),n.d(t,"tidy",(function(){return lt.t})),n.d(t,"dispose",(function(){return lt.d})),n.d(t,"keep",(function(){return lt.l})),n.d(t,"time",(function(){return lt.u})),n.d(t,"setBackend",(function(){return lt.r})),n.d(t,"ready",(function(){return lt.o})),n.d(t,"getBackend",(function(){return lt.k})),n.d(t,"removeBackend",(function(){return lt.q})),n.d(t,"findBackend",(function(){return lt.i})),n.d(t,"findBackendFactory",(function(){return lt.j})),n.d(t,"registerBackend",(function(){return lt.p})),n.d(t,"backend",(function(){return lt.a})),n.d(t,"setPlatform",(function(){return lt.s})),n.d(t,"getKernel",(function(){return Ve.c})),n.d(t,"getGradient",(function(){return Ve.b})),n.d(t,"getKernelsForBackend",(function(){return Ve.d})),n.d(t,"registerKernel",(function(){return Ve.f})),n.d(t,"registerGradient",(function(){return Ve.e})),n.d(t,"unregisterKernel",(function(){return Ve.h})),n.d(t,"unregisterGradient",(function(){return Ve.g})),n.d(t,"copyRegisteredKernels",(function(){return Ve.a})),n.d(t,"customGrad",(function(){return bt.a})),n.d(t,"grad",(function(){return bt.b})),n.d(t,"grads",(function(){return bt.c})),n.d(t,"valueAndGrad",(function(){return bt.d})),n.d(t,"valueAndGrads",(function(){return bt.e})),n.d(t,"variableGrads",(function(){return bt.f})),n.d(t,"Environment",(function(){return p.b})),n.d(t,"env",(function(){return p.c})),n.d(t,"ENV",(function(){return p.a})),n.d(t,"version_core",(function(){return ut})),n.d(t,"nextFrame",(function(){return zt.a})),n.d(t,"browser",(function(){return i})),n.d(t,"io",(function(){return r})),n.d(t,"math",(function(){return a})),n.d(t,"serialization",(function(){return u})),n.d(t,"test_util",(function(){return it})),n.d(t,"util",(function(){return ot})),n.d(t,"backend_util",(function(){return s})),n.d(t,"tensor_util",(function(){return at})),n.d(t,"slice_util",(function(){return et})),n.d(t,"gather_util",(function(){return o})),n.d(t,"scatter_util",(function(){return Ze})),n.d(t,"device_util",(function(){return Nn})),n.d(t,"kernel_impls",(function(){return l})),n.d(t,"KernelBackend",(function(){return Dn.b})),n.d(t,"DataStorage",(function(){return Dn.a})),n.d(t,"Abs",(function(){return Ue.a})),n.d(t,"Acos",(function(){return Ue.b})),n.d(t,"Acosh",(function(){return Ue.c})),n.d(t,"Add",(function(){return Ue.d})),n.d(t,"AddN",(function(){return Ue.e})),n.d(t,"All",(function(){return Ue.f})),n.d(t,"Any",(function(){return Ue.g})),n.d(t,"ArgMax",(function(){return Ue.h})),n.d(t,"ArgMin",(function(){return Ue.i})),n.d(t,"Asin",(function(){return Ue.j})),n.d(t,"Asinh",(function(){return Ue.k})),n.d(t,"Atan",(function(){return Ue.l})),n.d(t,"Atanh",(function(){return Ue.n})),n.d(t,"Atan2",(function(){return Ue.m})),n.d(t,"AvgPool",(function(){return Ue.o})),n.d(t,"AvgPoolGrad",(function(){return Ue.r})),n.d(t,"AvgPool3D",(function(){return Ue.p})),n.d(t,"AvgPool3DGrad",(function(){return Ue.q})),n.d(t,"BatchMatMul",(function(){return Ue.s})),n.d(t,"BatchToSpaceND",(function(){return Ue.t})),n.d(t,"Bincount",(function(){return Ue.u})),n.d(t,"BroadcastTo",(function(){return Ue.v})),n.d(t,"Cast",(function(){return Ue.w})),n.d(t,"Ceil",(function(){return Ue.x})),n.d(t,"ClipByValue",(function(){return Ue.y})),n.d(t,"Complex",(function(){return Ue.z})),n.d(t,"ComplexAbs",(function(){return Ue.A})),n.d(t,"Concat",(function(){return Ue.B})),n.d(t,"Conv2D",(function(){return Ue.C})),n.d(t,"Conv2DBackpropFilter",(function(){return Ue.D})),n.d(t,"Conv2DBackpropInput",(function(){return Ue.E})),n.d(t,"Conv3D",(function(){return Ue.F})),n.d(t,"Conv3DBackpropFilterV2",(function(){return Ue.G})),n.d(t,"Conv3DBackpropInputV2",(function(){return Ue.H})),n.d(t,"Cos",(function(){return Ue.I})),n.d(t,"Cosh",(function(){return Ue.J})),n.d(t,"Cumsum",(function(){return Ue.L})),n.d(t,"CropAndResize",(function(){return Ue.K})),n.d(t,"DenseBincount",(function(){return Ue.M})),n.d(t,"DepthToSpace",(function(){return Ue.N})),n.d(t,"DepthwiseConv2dNative",(function(){return Ue.O})),n.d(t,"DepthwiseConv2dNativeBackpropFilter",(function(){return Ue.P})),n.d(t,"DepthwiseConv2dNativeBackpropInput",(function(){return Ue.Q})),n.d(t,"Diag",(function(){return Ue.R})),n.d(t,"Dilation2D",(function(){return Ue.S})),n.d(t,"Dilation2DBackpropInput",(function(){return Ue.U})),n.d(t,"Dilation2DBackpropFilter",(function(){return Ue.T})),n.d(t,"RealDiv",(function(){return Ue.lc})),n.d(t,"Einsum",(function(){return Ue.V})),n.d(t,"Elu",(function(){return Ue.W})),n.d(t,"EluGrad",(function(){return Ue.X})),n.d(t,"Erf",(function(){return Ue.Z})),n.d(t,"Equal",(function(){return Ue.Y})),n.d(t,"Exp",(function(){return Ue.ab})),n.d(t,"ExpandDims",(function(){return Ue.bb})),n.d(t,"Expm1",(function(){return Ue.cb})),n.d(t,"FFT",(function(){return Ue.db})),n.d(t,"Fill",(function(){return Ue.eb})),n.d(t,"FlipLeftRight",(function(){return Ue.fb})),n.d(t,"Floor",(function(){return Ue.gb})),n.d(t,"FloorDiv",(function(){return Ue.hb})),n.d(t,"FusedBatchNorm",(function(){return Ue.jb})),n.d(t,"GatherV2",(function(){return Ue.nb})),n.d(t,"GatherNd",(function(){return Ue.mb})),n.d(t,"Greater",(function(){return Ue.ob})),n.d(t,"GreaterEqual",(function(){return Ue.pb})),n.d(t,"Identity",(function(){return Ue.rb})),n.d(t,"IFFT",(function(){return Ue.qb})),n.d(t,"Imag",(function(){return Ue.sb})),n.d(t,"IsFinite",(function(){return Ue.tb})),n.d(t,"IsInf",(function(){return Ue.ub})),n.d(t,"IsNan",(function(){return Ue.vb})),n.d(t,"LeakyRelu",(function(){return Ue.yb})),n.d(t,"Less",(function(){return Ue.zb})),n.d(t,"LessEqual",(function(){return Ue.Ab})),n.d(t,"LinSpace",(function(){return Ue.Bb})),n.d(t,"Log",(function(){return Ue.Cb})),n.d(t,"Log1p",(function(){return Ue.Db})),n.d(t,"LogicalAnd",(function(){return Ue.Fb})),n.d(t,"LogicalNot",(function(){return Ue.Gb})),n.d(t,"LogicalOr",(function(){return Ue.Hb})),n.d(t,"LogSoftmax",(function(){return Ue.Eb})),n.d(t,"LRN",(function(){return Ue.wb})),n.d(t,"LRNGrad",(function(){return Ue.xb})),n.d(t,"Max",(function(){return Ue.Ib})),n.d(t,"Maximum",(function(){return Ue.Ob})),n.d(t,"MaxPool",(function(){return Ue.Jb})),n.d(t,"MaxPoolGrad",(function(){return Ue.Mb})),n.d(t,"MaxPool3D",(function(){return Ue.Kb})),n.d(t,"MaxPool3DGrad",(function(){return Ue.Lb})),n.d(t,"MaxPoolWithArgmax",(function(){return Ue.Nb})),n.d(t,"Mean",(function(){return Ue.Pb})),n.d(t,"Min",(function(){return Ue.Qb})),n.d(t,"Minimum",(function(){return Ue.Rb})),n.d(t,"MirrorPad",(function(){return Ue.Sb})),n.d(t,"Mod",(function(){return Ue.Tb})),n.d(t,"Multinomial",(function(){return Ue.Ub})),n.d(t,"Multiply",(function(){return Ue.Vb})),n.d(t,"Neg",(function(){return Ue.Wb})),n.d(t,"NotEqual",(function(){return Ue.ac})),n.d(t,"NonMaxSuppressionV3",(function(){return Ue.Xb})),n.d(t,"NonMaxSuppressionV4",(function(){return Ue.Yb})),n.d(t,"NonMaxSuppressionV5",(function(){return Ue.Zb})),n.d(t,"OnesLike",(function(){return Ue.cc})),n.d(t,"OneHot",(function(){return Ue.bc})),n.d(t,"Pack",(function(){return Ue.dc})),n.d(t,"PadV2",(function(){return Ue.ec})),n.d(t,"Pool",(function(){return Ue.fc})),n.d(t,"Pow",(function(){return Ue.gc})),n.d(t,"Prelu",(function(){return Ue.hc})),n.d(t,"Prod",(function(){return Ue.ic})),n.d(t,"Range",(function(){return Ue.jc})),n.d(t,"Real",(function(){return Ue.kc})),n.d(t,"Reciprocal",(function(){return Ue.mc})),n.d(t,"Relu",(function(){return Ue.nc})),n.d(t,"Reshape",(function(){return Ue.pc})),n.d(t,"ResizeNearestNeighbor",(function(){return Ue.sc})),n.d(t,"ResizeNearestNeighborGrad",(function(){return Ue.tc})),n.d(t,"ResizeBilinear",(function(){return Ue.qc})),n.d(t,"ResizeBilinearGrad",(function(){return Ue.rc})),n.d(t,"Relu6",(function(){return Ue.oc})),n.d(t,"Reverse",(function(){return Ue.uc})),n.d(t,"Round",(function(){return Ue.wc})),n.d(t,"Rsqrt",(function(){return Ue.xc})),n.d(t,"ScatterNd",(function(){return Ue.yc})),n.d(t,"Select",(function(){return Ue.zc})),n.d(t,"Selu",(function(){return Ue.Ac})),n.d(t,"Slice",(function(){return Ue.Fc})),n.d(t,"Sin",(function(){return Ue.Dc})),n.d(t,"Sinh",(function(){return Ue.Ec})),n.d(t,"Sign",(function(){return Ue.Cc})),n.d(t,"Sigmoid",(function(){return Ue.Bc})),n.d(t,"Softplus",(function(){return Ue.Hc})),n.d(t,"Sqrt",(function(){return Ue.Mc})),n.d(t,"Sum",(function(){return Ue.Sc})),n.d(t,"SpaceToBatchND",(function(){return Ue.Ic})),n.d(t,"SplitV",(function(){return Ue.Lc})),n.d(t,"Softmax",(function(){return Ue.Gc})),n.d(t,"SparseReshape",(function(){return Ue.Jc})),n.d(t,"SparseToDense",(function(){return Ue.Kc})),n.d(t,"SquaredDifference",(function(){return Ue.Oc})),n.d(t,"Square",(function(){return Ue.Nc})),n.d(t,"StridedSlice",(function(){return Ue.Qc})),n.d(t,"Sub",(function(){return Ue.Rc})),n.d(t,"Tan",(function(){return Ue.Tc})),n.d(t,"Tanh",(function(){return Ue.Uc})),n.d(t,"Tile",(function(){return Ue.Vc})),n.d(t,"TopK",(function(){return Ue.Wc})),n.d(t,"Transform",(function(){return Ue.Xc})),n.d(t,"Transpose",(function(){return Ue.Yc})),n.d(t,"Unique",(function(){return Ue.Zc})),n.d(t,"Unpack",(function(){return Ue.ad})),n.d(t,"UnsortedSegmentSum",(function(){return Ue.bd})),n.d(t,"ZerosLike",(function(){return Ue.cd})),n.d(t,"Step",(function(){return Ue.Pc})),n.d(t,"FromPixels",(function(){return Ue.ib})),n.d(t,"RotateWithOffset",(function(){return Ue.vc})),n.d(t,"_FusedMatMul",(function(){return Ue.dd})),n.d(t,"FusedConv2D",(function(){return Ue.kb})),n.d(t,"FusedDepthwiseConv2D",(function(){return Ue.lb}));var r={};n.r(r),n.d(r,"copyModel",(function(){return te})),n.d(r,"listModels",(function(){return J})),n.d(r,"moveModel",(function(){return re})),n.d(r,"removeModel",(function(){return Z})),n.d(r,"browserFiles",(function(){return me})),n.d(r,"browserHTTPRequest",(function(){return Ne})),n.d(r,"concatenateArrayBuffers",(function(){return y.d})),n.d(r,"decodeWeights",(function(){return y.e})),n.d(r,"encodeWeights",(function(){return y.f})),n.d(r,"fromMemory",(function(){return De})),n.d(r,"getLoadHandlers",(function(){return j})),n.d(r,"getModelArtifactsInfoForJSON",(function(){return y.g})),n.d(r,"getSaveHandlers",(function(){return w})),n.d(r,"http",(function(){return Ae})),n.d(r,"isHTTPScheme",(function(){return Ee})),n.d(r,"loadWeights",(function(){return ke})),n.d(r,"registerLoadRouter",(function(){return k})),n.d(r,"registerSaveRouter",(function(){return O})),n.d(r,"weightsLoaderFactory",(function(){return je})),n.d(r,"withSaveHandler",(function(){return Fe}));var a={};n.r(a),n.d(a,"confusionMatrix",(function(){return We}));var i={};n.r(i),n.d(i,"fromPixelsAsync",(function(){return Ke})),n.d(i,"toPixels",(function(){return Ye})),n.d(i,"fromPixels",(function(){return Je}));var o={};n.r(o),n.d(o,"prepareAndValidate",(function(){return Qe}));var u={};n.r(u),n.d(u,"Serializable",(function(){return tt})),n.d(u,"SerializationMap",(function(){return nt})),n.d(u,"registerClass",(function(){return rt}));var c={};n.r(c),n.d(c,"segOpComputeOptimalWindowSize",(function(){return _n})),n.d(c,"computeOutShape",(function(){return Sn})),n.d(c,"collectGatherOpShapeInfo",(function(){return En}));var s={};n.r(s),n.d(s,"axesAreInnerMostDims",(function(){return Lt.b})),n.d(s,"combineLocations",(function(){return Lt.c})),n.d(s,"computeOutAndReduceShapes",(function(){return Lt.d})),n.d(s,"expandShapeToKeepDim",(function(){return Lt.e})),n.d(s,"assertAxesAreInnerMostDims",(function(){return Lt.a})),n.d(s,"getAxesPermutation",(function(){return Lt.f})),n.d(s,"getUndoAxesPermutation",(function(){return Lt.h})),n.d(s,"getInnerMostAxes",(function(){return Lt.g})),n.d(s,"getBroadcastDims",(function(){return Pt.b})),n.d(s,"getReductionAxes",(function(){return Pt.c})),n.d(s,"assertAndGetBroadcastShape",(function(){return Pt.a})),n.d(s,"assertParamsConsistent",(function(){return Bt})),n.d(s,"computeOutShape",(function(){return Wt})),n.d(s,"computeDilation2DInfo",(function(){return Ut.d})),n.d(s,"computePool2DInfo",(function(){return Ut.e})),n.d(s,"computePool3DInfo",(function(){return Ut.f})),n.d(s,"computeConv2DInfo",(function(){return Ut.a})),n.d(s,"computeConv3DInfo",(function(){return Ut.b})),n.d(s,"computeDefaultPad",(function(){return Ut.c})),n.d(s,"tupleValuesAreOne",(function(){return Ut.i})),n.d(s,"eitherStridesOrDilationsAreOne",(function(){return Ut.h})),n.d(s,"convertConv2DDataFormat",(function(){return Ut.g})),n.d(s,"getFusedDyActivation",(function(){return Vt.c})),n.d(s,"getFusedBiasGradient",(function(){return Vt.b})),n.d(s,"applyActivation",(function(){return Vt.a})),n.d(s,"shouldFuse",(function(){return Vt.d})),n.d(s,"PARALLELIZE_THRESHOLD",(function(){return qt})),n.d(s,"computeOptimalWindowSize",(function(){return Ht})),n.d(s,"slice_util",(function(){return et})),n.d(s,"upcastType",(function(){return It.c})),n.d(s,"getImageCenter",(function(){return Gt})),n.d(s,"getReshaped",(function(){return Kt})),n.d(s,"getPermuted",(function(){return Xt})),n.d(s,"getReshapedPermuted",(function(){return Yt})),n.d(s,"getSliceBeginCoords",(function(){return $t})),n.d(s,"getSliceSize",(function(){return Jt})),n.d(s,"prepareAndValidate",(function(){return Qe})),n.d(s,"validateUpdateShape",(function(){return Ze.validateUpdateShape})),n.d(s,"validateInput",(function(){return Ze.validateInput})),n.d(s,"calculateShapes",(function(){return Ze.calculateShapes})),n.d(s,"SELU_SCALEALPHA",(function(){return Qt.b})),n.d(s,"SELU_SCALE",(function(){return Qt.a})),n.d(s,"ERF_P",(function(){return Zt})),n.d(s,"ERF_A1",(function(){return en})),n.d(s,"ERF_A2",(function(){return tn})),n.d(s,"ERF_A3",(function(){return nn})),n.d(s,"ERF_A4",(function(){return rn})),n.d(s,"ERF_A5",(function(){return an})),n.d(s,"warn",(function(){return on})),n.d(s,"log",(function(){return un})),n.d(s,"mergeRealAndImagArrays",(function(){return cn})),n.d(s,"splitRealAndImagArrays",(function(){return sn})),n.d(s,"complexWithEvenIndex",(function(){return ln})),n.d(s,"complexWithOddIndex",(function(){return fn})),n.d(s,"getComplexWithIndex",(function(){return dn})),n.d(s,"assignToTypedArray",(function(){return hn})),n.d(s,"exponents",(function(){return pn})),n.d(s,"exponent",(function(){return vn})),n.d(s,"decodeEinsumEquation",(function(){return gn})),n.d(s,"getEinsumPermutation",(function(){return yn})),n.d(s,"checkEinsumDimSizes",(function(){return xn})),n.d(s,"getEinsumComputePath",(function(){return On})),n.d(s,"isIdentityPermutation",(function(){return kn})),n.d(s,"prepareSplitSize",(function(){return jn})),n.d(s,"segment_util",(function(){return c})),n.d(s,"fromUint8ToStringArray",(function(){return Cn})),n.d(s,"fromStringArrayToUint8",(function(){return An}));var l={};n.r(l),n.d(l,"nonMaxSuppressionV3Impl",(function(){return Tn.a})),n.d(l,"nonMaxSuppressionV4Impl",(function(){return Tn.b})),n.d(l,"nonMaxSuppressionV5Impl",(function(){return Tn.c})),n.d(l,"whereImpl",(function(){return In.a}));var f=n(12),d=(n(161),n(3)),h=n(10),p=n(34),v=n(9),m=n(4),b=n.n(m),g=n(17),y=n(52),x=function(){function e(){Object(d.a)(this,e),this.saveRouters=[],this.loadRouters=[]}return Object(h.a)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),O=function(e){return x.registerSaveRouter(e)},k=function(e){return x.registerLoadRouter(e)},w=function(e){return x.getSaveHandlers(e)},j=function(e,t){return x.getLoadHandlers(e,t)},_="tensorflowjs",S="models_store",E="model_info_store";function C(){if(!Object(p.c)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function A(e){var t=e.result;t.createObjectStore(S,{keyPath:"modelPath"}),t.createObjectStore(E,{keyPath:"modelPath"})}var N=function(){function e(t){if(Object(d.a)(this,e),this.indexedDB=C(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return Object(h.a)(e,[{key:"save",value:function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(_,1);a.onupgradeneeded=function(){return A(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(S,"readonly"),u=o.objectStore(S).get(n.modelPath);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(u.result.modelArtifacts)},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){return i.close()}}else{var c,s=Object(y.g)(t),l=i.transaction(E,"readwrite"),f=l.objectStore(E),d=f.put({modelPath:n.modelPath,modelArtifactsInfo:s});d.onsuccess=function(){var a=(c=i.transaction(S,"readwrite")).objectStore(S).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:s});a.onsuccess=function(){return e({modelArtifactsInfo:s})},a.onerror=function(e){var t=(f=l.objectStore(E)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},d.onerror=function(e){return i.close(),r(d.error)},l.oncomplete=function(){null==c?i.close():c.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();N.URL_SCHEME="indexeddb://";var T=function(e){return Object(p.c)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(N.URL_SCHEME)?(t=e.slice(N.URL_SCHEME.length),new N(t)):null;var t};x.registerSaveRouter(T),x.registerLoadRouter(T);var I=function(){function e(){Object(d.a)(this,e),this.indexedDB=C()}return Object(h.a)(e,[{key:"listModels",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(_,1);r.onupgradeneeded=function(){return A(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(E,"readonly"),i=a.objectStore(E).getAll();i.onsuccess=function(){var t,n={},r=Object(v.a)(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(N.URL_SCHEME)?r.slice(N.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(_,1);a.onupgradeneeded=function(){return A(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(E,"readwrite"),u=o.objectStore(E),c=u.get(t);c.onsuccess=function(){if(null==c.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=u.delete(t),o=function(){var a=(n=i.transaction(S,"readwrite")).objectStore(S).delete(t);a.onsuccess=function(){return e(c.result.modelArtifactsInfo)},a.onerror=function(e){return r(c.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(c.error)}},c.onerror=function(e){return i.close(),r(c.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),D=n(19),F="/",M="tensorflowjs_models",R="info",z="model_topology",L="weight_specs",P="weight_data",B="model_metadata";function W(e){return{info:[M,e,R].join(F),topology:[M,e,z].join(F),weightSpecs:[M,e,L].join(F),weightData:[M,e,P].join(F),modelMetadata:[M,e,B].join(F)}}function U(e){var t=e.split(F);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(F)}var V=function(){function e(t){if(Object(d.a)(this,e),!Object(p.c)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=W(this.modelPath)}return Object(h.a)(e,[{key:"save",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n,r,a,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Object(y.g)(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Object(y.a)(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy},null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),e.abrupt("return",{modelArtifactsInfo:a});case 20:throw e.prev=20,e.t0=e.catch(7),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 28:case"end":return e.stop()}}),e,this,[[7,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t,n,r,a,i,o,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer)),null!=(u=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=Object(y.b)(u),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();V.URL_SCHEME="localstorage://";var q=function(e){return Object(p.c)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(V.URL_SCHEME)?(t=e.slice(V.URL_SCHEME.length),new V(t)):null;var t};x.registerSaveRouter(q),x.registerLoadRouter(q);var H=function(){function e(){Object(d.a)(this,e),Object(D.b)(Object(p.c)().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Object(D.b)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return Object(h.a)(e,[{key:"listModels",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t,n,r,a,i,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=M+F,r=F+R,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=U(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(V.URL_SCHEME)?a.slice(V.URL_SCHEME.length):a,n=W(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),e.abrupt("return",r);case 10:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),G="://",K=function(){function e(){Object(d.a)(this,e),this.managers={}}return Object(h.a)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){Object(D.b)(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(G)&&(t=t.slice(0,t.indexOf(G))),Object(D.b)(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();Object(D.b)(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();function X(e){if(-1===e.indexOf(G))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(K.getSchemes().join(",")));return{scheme:e.split(G)[0],path:e.split(G)[1]}}function Y(e,t){return $.apply(this,arguments)}function $(){return($=Object(g.a)(b.a.mark((function e(t,n){var r,a,i,o,u,c,s,l,f,d,h=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.length>2&&void 0!==h[2]&&h[2],Object(D.b)(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),a=x.getLoadHandlers(t),Object(D.b)(a.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),Object(D.b)(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],o=x.getSaveHandlers(n),Object(D.b)(o.length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),Object(D.b)(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),u=o[0],c=X(t).scheme,s=X(t).path,l=c===X(t).scheme,e.next=15,i.load();case 15:if(f=e.sent,!r||!l){e.next=19;break}return e.next=19,K.getManager(c).removeModel(s);case 19:return e.next=21,u.save(f);case 21:if(d=e.sent,!r||l){e.next=25;break}return e.next=25,K.getManager(c).removeModel(s);case 25:return e.abrupt("return",d.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return Q.apply(this,arguments)}function Q(){return(Q=Object(g.a)(b.a.mark((function e(){var t,n,r,a,i,o,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=K.getSchemes(),n={},r=Object(v.a)(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,K.getManager(i).listModels();case 9:for(u in o=e.sent)n[i+G+u]=o[u];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function Z(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(g.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=X(t),r=K.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(g.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",Y(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t){return ae.apply(this,arguments)}function ae(){return(ae=Object(g.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",Y(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}();if(Object(p.c)().get("IS_BROWSER")){Object(p.c)().setPlatform("browser",new ie);try{K.registerManager(V.URL_SCHEME,new H)}catch(Fn){}try{K.registerManager(N.URL_SCHEME,new I)}catch(Fn){}}n(337);var oe=n(57),ue=n(24),ce=n(76),se=n(183),le=n(16);Object(f.b)();var fe={buffer:oe.a,cast:ue.a,clone:ce.a,print:se.a};Object(le.f)(fe);var de=n(13);function he(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var pe=function(){function e(t){if(Object(d.a)(this,e),!Object(p.c)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return Object(h.a)(e,[{key:"save",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n,r,a,i,o,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,e.next=18,he((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 18:if(null==t.weightData){e.next=24;break}return(u=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,u.href=n,e.next=24,he((function(){return u.dispatchEvent(new MouseEvent("click"))}));case 24:return e.abrupt("return",{modelArtifactsInfo:Object(y.g)(t)});case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();pe.URL_SCHEME="downloads://";var ve=function(){function e(t){if(Object(d.a)(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.files=t}return Object(h.a)(e,[{key:"load",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t,n,r=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.files[0],n=this.files.slice(1),e.abrupt("return",new Promise((function(e,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),u=o.modelTopology;if(null!=u){0===n.length&&e({modelTopology:u});var c=o.weightsManifest;if(null!=c){var s;try{s=r.checkManifestAndWeightFiles(c,n)}catch(Fn){return void a(Fn)}var l=[],f=[],d=[];c.forEach((function(e){e.paths.forEach((function(e){f.push(e),d.push(null)})),l.push.apply(l,Object(de.a)(e.weights))})),c.forEach((function(t){t.paths.forEach((function(t){var n=new FileReader;n.onload=function(n){var r=n.target.result,a=f.indexOf(t);if(d[a]=r,-1===d.indexOf(null)){var i={modelTopology:u,weightSpecs:l,weightData:Object(y.d)(d),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy};null!=o.signature&&(i.signature=o.signature),null!=o.userDefinedMetadata&&(i.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(i.modelInitializer=o.modelInitializer),e(i)}},n.onerror=function(e){return a("Failed to weights data from file of path '".concat(t,"'."))},n.readAsArrayBuffer(s[t])}))}))}else a(new Error("weightManifest field is missing from file ".concat(t.name)))}else a(new Error("modelTopology field is missing from file ".concat(t.name)))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},i.readAsText(t)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkManifestAndWeightFiles",value:function(e,t){var n,r=[],a=t.map((function(e){return Object(y.c)(e.name)})),i={},o=Object(v.a)(e);try{for(o.s();!(n=o.n()).done;){n.value.paths.forEach((function(e){var n=Object(y.c)(e);if(-1!==r.indexOf(n))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(n,"'"));if(r.push(n),-1===a.indexOf(n))throw new Error("Weight file with basename '".concat(n,"' is not provided."));i[e]=t[a.indexOf(n)]}))}}catch(Fn){o.e(Fn)}finally{o.f()}if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(t.length,")."));return i}}]),e}();function me(e){return new ve(e)}x.registerSaveRouter((function(e){return Object(p.c)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(pe.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new pe(e)}(e.slice(pe.URL_SCHEME.length)):null}));var be=n(8);function ge(e,t,n,r){!function(e){Object(D.b)(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){Object(D.b)(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),Object(D.b)(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),Object(D.b)(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}var ye=n(170);function xe(e,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(g.a)(b.a.mark((function e(t,n){var r,a,i,o,u,c,s,l,f;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?Object(p.c)().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,ge(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(u=e.t0,c=u.map((function(e){return e.arrayBuffer()})),s=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(c);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,ge(c,n.onProgress,s,l);case 26:e.t1=e.sent;case 27:return f=e.t1,e.abrupt("return",f);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){return we.apply(this,arguments)}function we(){return(we=Object(g.a)(b.a.mark((function e(t){var n,r,a,i,o=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=je((function(e){return xe(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e){return function(){var t=Object(g.a)(b.a.mark((function t(n){var r,a,i,o,u,c,s,l,f,d,h,p,v=arguments;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},u=null!=a?a.map((function(){return!1})):[],c=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,s=ye.a[r]*D.O(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:s})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),u[n]=!0)})):l(),c.push(e.name),n+=s}))})),u.every((function(e){return e}))){t.next=10;break}throw s=a.filter((function(e,t){return!u[t]})),new Error("Could not find weights in manifest with names: "+"".concat(s.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(c.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),f=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;f.push(t)}))})),t.next=15,e(f);case 15:return d=t.sent,h={},p=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=d[p+a].byteLength;for(var i=new ArrayBuffer(r),u=new Uint8Array(i),c=0,s=0;s<t;s++){var l=new Uint8Array(d[p+s]);u.set(l,c),c+=l.byteLength}o[e].forEach((function(e){var t=i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),n=Object(y.e)(t,[e.manifestEntry]);for(var r in n)h[r]=n[r]})),p+=t})),t.abrupt("return",h);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}var _e=function(){function e(t,n){if(Object(d.a)(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(Object(D.b)("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=Object(p.c)().platform.fetch,Object(D.b)(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&Object(D.b)(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return Object(h.a)(e,[{key:"save",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n,r,a,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=13,this.fetch(this.path,n);case 13:if(!(i=e.sent).ok){e.next=18;break}return e.abrupt("return",{modelArtifactsInfo:Object(y.g)(t),responses:[i]});case 18:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t,n,r,a,i,o,u,c,s,l,f,d,h,p,v,m;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,o=n.generatedBy,u=n.convertedBy,c=n.format,s=n.signature,l=n.userDefinedMetadata,null!=a||null!=i){e.next=25;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 25:if(null==i){e.next=32;break}return e.next=28,this.loadWeights(i);case 28:h=e.sent,p=Object(be.a)(h,2),f=p[0],d=p[1];case 32:return v={modelTopology:a,weightSpecs:f,weightData:d,generatedBy:o,convertedBy:u,format:c},null!=s&&(v.signature=s),null!=l&&(v.userDefinedMetadata=l),(m=n.modelInitializer)&&(v.modelInitializer=m),e.abrupt("return",v);case 38:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n,r,a,i,o,u,c,s,l,f,d,h,p,m,g,x,O,k,w;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=Se(n),a=Object(be.a)(r,2),i=a[0],o=a[1],u=this.weightPathPrefix||i,c=[],s=Object(v.a)(t);try{for(s.s();!(l=s.n()).done;)f=l.value,c.push.apply(c,Object(de.a)(f.weights))}catch(Fn){s.e(Fn)}finally{s.f()}d=[],h=[],p=Object(v.a)(t);try{for(p.s();!(m=p.n()).done;){g=m.value,x=Object(v.a)(g.paths);try{for(x.s();!(O=x.n()).done;)k=O.value,null!=this.weightUrlConverter?h.push(this.weightUrlConverter(k)):d.push(u+k+o)}catch(Fn){x.e(Fn)}finally{x.f()}}}catch(Fn){p.e(Fn)}finally{p.f()}if(!this.weightUrlConverter){e.next=19;break}return e.t0=d.push,e.t1=d,e.t2=de.a,e.next=16,Promise.all(h);case 16:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 19:return e.next=21,xe(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 21:return w=e.sent,e.abrupt("return",[c,Object(y.d)(w)]);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Se(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function Ee(e){return null!=e.match(_e.URL_SCHEME_REGEX)}_e.URL_SCHEME_REGEX=/^https?:\/\//;var Ce=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return Ee(e)})):Ee(e))?Ae(e,t):null};function Ae(e,t){return new _e(e,t)}function Ne(e,t){return Ae(e,t)}x.registerSaveRouter(Ce),x.registerLoadRouter(Ce);var Te=function(){function e(t){Object(d.a)(this,e),this.modelArtifacts=t}return Object(h.a)(e,[{key:"load",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modelArtifacts);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ie=function(){function e(t){Object(d.a)(this,e),this.saveHandler=t}return Object(h.a)(e,[{key:"save",value:function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveHandler(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function De(e,t,n,r){if(1===arguments.length){var a=null!=e.modelTopology||null!=e.weightSpecs;return a?new Te(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Te({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Te({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function Fe(e){return new Ie(e)}var Me=n(6),Re=n(36),ze=n(118),Le=n(11),Pe=n(61);var Be,We=Object(Le.b)({confusionMatrix_:function(e,t,n){var r=Object(Me.a)(e,"labels","confusionMatrix"),a=Object(Me.a)(t,"predictions","confusionMatrix");D.b(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),D.b(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(r.rank)})),D.b(1===a.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(a.rank)})),D.b(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(a.shape[0],". ")+"Labels and predictions should have the same number of elements."})),D.b(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var i=Object(ze.a)(Object(ue.a)(r,"int32"),n),o=Object(ze.a)(Object(ue.a)(a,"int32"),n),u=Object(Pe.a)(i),c=Object(Re.a)(u,o);return Object(ue.a)(c,"int32")}}),Ue=n(7),Ve=n(70),qe=n(211);function He(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,u=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));u=!0}if(a){var c=2;if(a&&e.readyState<c)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}var s=Object(Ve.c)(Ue.ib,f.a.backendName);if(null!=s){var l={pixels:e},d={numChannels:t};return f.a.runKernel(Ue.ib,l,d)}var h,p,v=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],m=Object(be.a)(v,2),b=m[0],g=m[1];if(o?h=e.getContext("2d").getImageData(0,0,b,g).data:r||n?h=e.data:(i||a||u)&&(null==Be&&(Be=document.createElement("canvas").getContext("2d")),Be.canvas.width=b,Be.canvas.height=g,Be.drawImage(e,0,0,b,g),h=Be.getImageData(0,0,b,g).data),4===t)p=new Int32Array(h);else{var y=b*g;p=new Int32Array(y*t);for(var x=0;x<y;x++)for(var O=0;O<t;++O)p[x*t+O]=h[4*x+O]}var k=[g,b,t];return Object(qe.a)(p,k,"int32")}function Ge(e){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}function Ke(e){return Xe.apply(this,arguments)}function Xe(){return(Xe=Object(g.a)(b.a.mark((function e(t){var n,r,a,i=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:3,r=null,!Object(p.c)().getBool("WRAP_TO_IMAGEBITMAP")||!Ge(t)){e.next=15;break}return e.prev=3,e.next=6,createImageBitmap(t,{premultiplyAlpha:"none"});case 6:a=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),a=null;case 12:r=null!=a&&a.width===t.width&&a.height===t.height?a:t,e.next=16;break;case 15:r=t;case 16:return e.abrupt("return",He(r,n));case 17:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function Ye(e,t){return $e.apply(this,arguments)}function $e(){return($e=Object(g.a)(b.a.mark((function e(t,n){var r,a,i,o,u,c,s,l,f,d,h,p,v,m,g,y,x;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(Me.a)(t,"img","toPixels"),t instanceof le.a||(a=r,r=Object(ue.a)(a,"int32"),a.dispose()),2===r.rank||3===r.rank){e.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(i=r.shape.slice(0,2),o=Object(be.a)(i,2),u=o[0],c=o[1],!((s=2===r.rank?1:r.shape[2])>4||2===s)){e.next=8;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(s));case 8:if("float32"===r.dtype||"int32"===r.dtype){e.next=10;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,".")+" Please use float32 or int32 tensors.");case 10:return e.next=12,r.data();case 12:l=e.sent,f="float32"===r.dtype?255:1,d=new Uint8ClampedArray(c*u*4),h=0;case 16:if(!(h<u*c)){e.next=41;break}p=[0,0,0,255],v=0;case 19:if(!(v<s)){e.next=33;break}if(m=l[h*s+v],"float32"!==r.dtype){e.next=26;break}if(!(m<0||m>1)){e.next=24;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(m,"."));case 24:e.next=29;break;case 26:if("int32"!==r.dtype){e.next=29;break}if(!(m<0||m>255)){e.next=29;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(m,"."));case 29:1===s?(p[0]=m*f,p[1]=m*f,p[2]=m*f):p[v]=m*f;case 30:v++,e.next=19;break;case 33:d[(g=4*h)+0]=Math.round(p[0]),d[g+1]=Math.round(p[1]),d[g+2]=Math.round(p[2]),d[g+3]=Math.round(p[3]);case 38:++h,e.next=16;break;case 41:return null!=n&&(n.width=c,n.height=u,y=n.getContext("2d"),x=new ImageData(d,c,u),y.putImageData(x,0,0)),r!==t&&r.dispose(),e.abrupt("return",d);case 44:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Je=Object(Le.b)({fromPixels_:He});function Qe(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===Object(D.O)(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,u=0;u<a.length-1;++u)o*=a[u];var c=e.shape,s=a.slice();s.pop();for(var l=1,f=i;f<n;++f)l*=c[f],s.push(c[f]);var d=[].concat(Object(de.a)(Object(D.j)(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[s,o,l,d]}var Ze=n(131),et=n(132),tt=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),nt=function(){function e(){Object(d.a)(this,e),this.classNameMap={}}return Object(h.a)(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function rt(e){Object(D.b)(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),Object(D.b)("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),Object(D.b)(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),nt.register(e)}var at=n(35),it=n(157),ot=n(22),ut="3.5.0",ct=n(14),st=n(15),lt=n(38),ft=n(26),dt=n(28),ht=n(20),pt=n(50),vt=n(37),mt=n(32),bt=n(47),gt=n(29),yt=function(e){Object(ct.a)(n,e);var t=Object(st.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return Object(lt.d)(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return Object(bt.f)(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&Object(lt.d)(this.iterations_)}},{key:"saveIterations",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:Object(gt.a)(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(tt);Object.defineProperty(yt,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var xt=function(e){Object(ct.a)(n,e);var t=Object(st.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(d.a)(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=f.a.backend.epsilon()),a}return Object(h.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=f.a.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:Object(lt.t)((function(){return Object(mt.a)(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:Object(lt.t)((function(){return Object(mt.a)(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,u=t.accumulatedUpdates[r].variable;Object(lt.t)((function(){var e=Object(ft.a)(Object(ht.a)(o,t.rho),Object(ht.a)(Object(vt.a)(i),1-t.rho)),n=Object(ht.a)(Object(dt.a)(Object(pt.a)(Object(ft.a)(u,t.epsilon)),Object(pt.a)(Object(ft.a)(o,t.epsilon))),i),r=Object(ft.a)(Object(ht.a)(u,t.rho),Object(ht.a)(Object(vt.a)(n),1-t.rho));o.assign(e),u.assign(r);var c=Object(ft.a)(Object(ht.a)(n,-t.learningRate),a);a.assign(c)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(Object(lt.d)(this.accumulatedGrads.map((function(e){return e.variable}))),Object(lt.d)(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Object(de.a)(this.accumulatedGrads),Object(de.a)(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(yt);xt.className="Adadelta",rt(xt);var Ot=n(134),kt=function(e){Object(ct.a)(n,e);var t=Object(st.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return Object(d.a)(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return Object(h.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=f.a.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:Object(lt.t)((function(){return Object(Ot.a)(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;Object(lt.t)((function(){var e=Object(ft.a)(o,Object(vt.a)(i));o.assign(e);var n=Object(ft.a)(Object(ht.a)(Object(dt.a)(i,Object(pt.a)(Object(ft.a)(e,f.a.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&Object(lt.d)(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(yt);kt.className="Adagrad",rt(kt);var wt=n(63),jt=n(27),_t=function(e){Object(ct.a)(n,e);var t=Object(st.a)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Object(d.a)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Object(lt.t)((function(){i.accBeta1=Object(gt.a)(r).variable(),i.accBeta2=Object(gt.a)(a).variable()})),null==o&&(i.epsilon=f.a.backend.epsilon()),i}return Object(h.a)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Object(lt.t)((function(){var r=Object(jt.a)(1,t.accBeta1),a=Object(jt.a)(1,t.accBeta2);n.forEach((function(n,i){var o=f.a.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Object(lt.t)((function(){return Object(mt.a)(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:Object(lt.t)((function(){return Object(mt.a)(o).variable(false)}))});var u=Array.isArray(e)?e[i].tensor:e[n];if(null!=u){var c=t.accumulatedFirstMoment[i].variable,s=t.accumulatedSecondMoment[i].variable,l=Object(ft.a)(Object(ht.a)(c,t.beta1),Object(ht.a)(u,1-t.beta1)),d=Object(ft.a)(Object(ht.a)(s,t.beta2),Object(ht.a)(Object(vt.a)(u),1-t.beta2)),h=Object(dt.a)(l,r),p=Object(dt.a)(d,a);c.assign(l),s.assign(d);var v=Object(ft.a)(Object(ht.a)(Object(dt.a)(h,Object(ft.a)(Object(pt.a)(p),t.epsilon)),-t.learningRate),o);o.assign(v)}})),t.accBeta1.assign(Object(ht.a)(t.accBeta1,t.beta1)),t.accBeta2.assign(Object(ht.a)(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Object(lt.d)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&Object(lt.d)(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Object(de.a)(this.accumulatedFirstMoment),Object(de.a)(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n,r=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,Object(lt.t)((function(){r.accBeta1.assign(Object(wt.a)(r.beta1,r.iterations_+1)),r.accBeta2.assign(Object(wt.a)(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(yt);_t.className="Adam",rt(_t);var St=n(54),Et=n(102),Ct=function(e){Object(ct.a)(n,e);var t=Object(st.a)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Object(d.a)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=u,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],Object(lt.t)((function(){i.iteration=Object(gt.a)(0).variable(),i.accBeta1=Object(gt.a)(r).variable()})),null==o&&(i.epsilon=f.a.backend.epsilon()),i}return Object(h.a)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Object(lt.t)((function(){var r=Object(jt.a)(1,t.accBeta1),a=Object(dt.a)(-t.learningRate,Object(ft.a)(Object(ht.a)(t.iteration,t.decay),1));n.forEach((function(n,i){var o=f.a.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Object(mt.a)(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:Object(mt.a)(o).variable(false)});var u=Array.isArray(e)?e[i].tensor:e[n];if(null!=u){var c=t.accumulatedFirstMoment[i].variable,s=t.accumulatedWeightedInfNorm[i].variable,l=Object(ft.a)(Object(ht.a)(c,t.beta1),Object(ht.a)(u,1-t.beta1)),d=Object(ht.a)(s,t.beta2),h=Object(St.a)(u),p=Object(Et.a)(d,h);c.assign(l),s.assign(p);var v=Object(ft.a)(Object(ht.a)(Object(dt.a)(a,r),Object(dt.a)(l,Object(ft.a)(p,t.epsilon))),o);o.assign(v)}})),t.iteration.assign(Object(ft.a)(t.iteration,1)),t.accBeta1.assign(Object(ht.a)(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Object(lt.d)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&Object(lt.d)(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(yt);Ct.className="Adamax",rt(Ct);var At=function(e){Object(ct.a)(n,e);var t=Object(st.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return Object(h.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=f.a.registeredVariables[n];Object(lt.t)((function(){var e=Object(ft.a)(Object(ht.a)(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Object(lt.l)(Object(gt.a)(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(yt);At.className="SGD",rt(At);var Nt=function(e){Object(ct.a)(n,e);var t=Object(st.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(d.a)(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Object(gt.a)(a.momentum),a}return Object(h.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=f.a.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:Object(lt.t)((function(){return Object(mt.a)(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Object(lt.t)((function(){var e,n=Object(ft.a)(Object(ht.a)(t.m,i),o);e=t.useNesterov?Object(ft.a)(Object(ht.a)(t.c,Object(ft.a)(o,Object(ht.a)(n,t.m))),a):Object(ft.a)(Object(ht.a)(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&Object(lt.d)(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(At);Nt.className="Momentum",rt(Nt);var Tt=function(e){Object(ct.a)(n,e);var t=Object(st.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(d.a)(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=u,null==o&&(r.epsilon=f.a.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return Object(h.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=f.a.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:Object(lt.t)((function(){return Object(mt.a)(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:Object(lt.t)((function(){return Object(mt.a)(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:Object(lt.t)((function(){return Object(mt.a)(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var u=t.accumulatedMeanSquares[r].variable,c=t.accumulatedMoments[r].variable;Object(lt.t)((function(){var e=Object(ft.a)(Object(ht.a)(u,t.decay),Object(ht.a)(Object(vt.a)(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=Object(ft.a)(Object(ht.a)(n,t.decay),Object(ht.a)(o,1-t.decay)),s=Object(dt.a)(Object(ht.a)(o,t.learningRate),Object(pt.a)(Object(jt.a)(e,Object(ft.a)(Object(vt.a)(i),t.epsilon)))),l=Object(ft.a)(Object(ht.a)(c,t.momentum),s);u.assign(e),n.assign(i),c.assign(l);var f=Object(jt.a)(a,l);a.assign(f)}else{var d=Object(ft.a)(Object(ht.a)(u,t.decay),Object(ht.a)(Object(vt.a)(o),1-t.decay)),h=Object(ft.a)(Object(ht.a)(c,t.momentum),Object(dt.a)(Object(ht.a)(o,t.learningRate),Object(pt.a)(Object(ft.a)(d,t.epsilon))));u.assign(d),c.assign(h);var p=Object(jt.a)(a,h);a.assign(p)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&Object(lt.d)(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Object(lt.d)(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&Object(lt.d)(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Object(de.a)(this.accumulatedMeanSquares),Object(de.a)(this.accumulatedMoments)),this.centered&&t.push.apply(t,Object(de.a)(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(yt);Tt.className="RMSProp",rt(Tt);var It=n(101),Dt=n(33),Ft=n(48),Mt=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"sgd",value:function(e){return new At(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Nt(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Tt(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new _t(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new xt(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new Ct(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new kt(e,t)}}]),e}(),Rt={sgd:Mt.sgd,momentum:Mt.momentum,adadelta:Mt.adadelta,adagrad:Mt.adagrad,rmsprop:Mt.rmsprop,adamax:Mt.adamax,adam:Mt.adam},zt=n(288),Lt=n(51),Pt=n(30);function Bt(e,t){var n=e[0].length;e.forEach((function(e,t){D.b(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),D.b(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)D.b(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function Wt(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}var Ut=n(42),Vt=n(55),qt=30;function Ht(e){return e<=qt?e:Object(D.G)(e,Math.floor(Math.sqrt(e)))}function Gt(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function Kt(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function Xt(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],u=1;u<e;++u)u>=2*t+1||u%2===1?o.push(u):i.push(u);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function Yt(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function $t(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Jt(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var Qt=n(168),Zt=.3275911,en=.254829592,tn=-.284496736,nn=1.421413741,rn=-1.453152027,an=1.061405429;function on(){var e;Object(p.c)().getBool("IS_TEST")||(e=console).warn.apply(e,arguments)}function un(){var e;Object(p.c)().getBool("IS_TEST")||(e=console).log.apply(e,arguments)}function cn(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function sn(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function ln(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function fn(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function dn(e,t){return{real:e[2*t],imag:e[2*t+1]}}function hn(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function pn(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function vn(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var mn="->",bn=/->/g;function gn(e,t){var n=((e=e.replace(/\s/g,"")).length-e.replace(bn,"").length)/mn.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(mn,'").'));var r=e.split(mn),a=Object(be.a)(r,2),i=a[0],o=a[1];Object(D.b)(-1===i.indexOf("..."),(function(){return'The ellipsis notation ("'.concat("...",'") is not supported yet.')}));var u=i.split(","),c=u.length;if(t!==c)throw new Error("Expected ".concat(c," input tensors, received ").concat(t));if(c>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var s=[],l=function(e){var t=o[e];if(!u.some((function(e){return-1!==e.indexOf(t)})))throw new Error("Output subscripts contain the label ".concat(t," ")+"not present in the input subscripts.");-1===s.indexOf(t)&&s.push(t)},f=0;f<o.length;++f)l(f);for(var d=0;d<i.length;++d){var h=i[d];-1===s.indexOf(h)&&","!==h&&s.push(h)}for(var p=new Array(u.length),v=0;v<c;++v){if(new Set(u[v].split("")).size!==u[v].length)throw new Error("Found duplicate axes in input component ".concat(u[v],". ")+"Support for duplicate axes in input is not implemented yet.");p[v]=[];for(var m=0;m<u[v].length;++m)p[v].push(s.indexOf(u[v][m]))}for(var b=s.length,g=[],y=o.length;y<b;++y)g.push(y);return{allDims:s,summedDims:g,idDims:p}}function yn(e,t){var n=new Array(e);n.fill(-1);for(var r=0;r<t.length;++r)n[t[r]]=r;for(var a=[],i=0;i<e;++i)-1===n[i]&&a.push(i);return{permutationIndices:n=n.filter((function(e){return-1!==e})),expandDims:a}}function xn(e,t,n){for(var r=new Array(e),a=function(e){for(var a=n[e].shape,i=function(n){void 0===r[t[e][n]]?r[t[e][n]]=a[n]:Object(D.b)(r[t[e][n]]===a[n],(function(){return"Expected dimension ".concat(r[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<t[e].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function On(e,t){var n,r=e,a=[];0===e.length&&r.push(-1),n=e.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],u=0;u<r.length;++u){var c,s=wn(t,r[u]),l=Object(v.a)(s);try{for(l.s();!(c=l.n()).done;){var f=c.value;-1===o.indexOf(f)&&(a[u].push(f),o.push(f))}}catch(Fn){l.e(Fn)}finally{l.f()}}return{path:r,steps:a}}function kn(e){return e.every((function(e,t){return e===t}))}function wn(e,t){for(var n=[],r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function jn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)Object(D.b)(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);Object(D.b)(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}Object(D.b)(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function _n(e,t){var n,r=!1;for(e<=qt?(n=e,r=!0):n=Object(D.G)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Object(D.G)(e,n+1);return n}function Sn(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function En(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var u=e.shape[n],c=[],s=1,l=1,f=1,d=0;d<r;++d)c.push(e.shape[d]),s*=e.shape[d];for(var h=r;h<n;h++)c.push(e.shape[h]),l*=e.shape[h];for(var p=r;p<a;p++)c.push(t.shape[p]);for(var v=n+1;v<i;v++)c.push(e.shape[v]),f*=e.shape[v];return{batchSize:s,sliceSize:f,outerSize:l,dimSize:u,outputShape:c}}function Cn(e){try{return e.map((function(e){return Object(ot.decodeString)(e)}))}catch(Fn){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(Fn))}}function An(e){return e.map((function(e){return Object(ot.encodeString)(e)}))}var Nn=n(182),Tn=n(87),In=n(215),Dn=n(165)},function(e,t,n){"use strict";function r(e,t,n){return e.fields=t||[],e.fname=n,e}function a(e){return null==e?null:e.fname}function i(e){return null==e?null:e.fields}function o(e){return 1===e.length?u(e[0]):c(e)}n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return a})),n.d(t,"i",(function(){return $})),n.d(t,"j",(function(){return ee})),n.d(t,"k",(function(){return J})),n.d(t,"l",(function(){return Z})),n.d(t,"m",(function(){return ae})),n.d(t,"n",(function(){return ie})),n.d(t,"o",(function(){return s})),n.d(t,"p",(function(){return oe})),n.d(t,"q",(function(){return ue})),n.d(t,"r",(function(){return ce})),n.d(t,"s",(function(){return b})),n.d(t,"t",(function(){return de})),n.d(t,"u",(function(){return f})),n.d(t,"v",(function(){return he})),n.d(t,"w",(function(){return le})),n.d(t,"x",(function(){return d})),n.d(t,"y",(function(){return h})),n.d(t,"z",(function(){return pe})),n.d(t,"A",(function(){return ve})),n.d(t,"B",(function(){return _})),n.d(t,"C",(function(){return me})),n.d(t,"D",(function(){return be})),n.d(t,"E",(function(){return Q})),n.d(t,"F",(function(){return ge})),n.d(t,"G",(function(){return ye})),n.d(t,"H",(function(){return S})),n.d(t,"I",(function(){return xe})),n.d(t,"J",(function(){return Oe})),n.d(t,"K",(function(){return ke})),n.d(t,"L",(function(){return we})),n.d(t,"M",(function(){return j})),n.d(t,"N",(function(){return je})),n.d(t,"O",(function(){return _e})),n.d(t,"P",(function(){return C})),n.d(t,"Q",(function(){return v})),n.d(t,"R",(function(){return Ee})),n.d(t,"S",(function(){return P})),n.d(t,"T",(function(){return B})),n.d(t,"U",(function(){return W})),n.d(t,"V",(function(){return U})),n.d(t,"W",(function(){return T})),n.d(t,"X",(function(){return X})),n.d(t,"Y",(function(){return Se})),n.d(t,"Z",(function(){return Ce})),n.d(t,"ab",(function(){return l})),n.d(t,"bb",(function(){return Ae})),n.d(t,"cb",(function(){return Ne})),n.d(t,"db",(function(){return Ie})),n.d(t,"eb",(function(){return I})),n.d(t,"fb",(function(){return Fe})),n.d(t,"gb",(function(){return De})),n.d(t,"hb",(function(){return Me})),n.d(t,"ib",(function(){return m})),n.d(t,"jb",(function(){return Y})),n.d(t,"kb",(function(){return Re})),n.d(t,"lb",(function(){return A})),n.d(t,"mb",(function(){return p})),n.d(t,"nb",(function(){return q})),n.d(t,"ob",(function(){return H})),n.d(t,"pb",(function(){return G})),n.d(t,"qb",(function(){return K}));var u=function(e){return function(t){return t[e]}},c=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function s(e){throw Error(e)}function l(e){var t,n,r,a=[],i=e.length,o=null,u=0,c="";function l(){a.push(c+e.substring(t,n)),c="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))c+=e.substring(t,n),c+=e.substring(++n,++n),t=n;else if(r===o)l(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&l(),u=t=n+1):"]"===r&&(u||s("Access path missing open bracket: "+e),u>0&&l(),u=0,t=n+1):n>t?l():t=n+1}return u&&s("Access path missing closing bracket: "+e),o&&s("Access path missing closing quote: "+e),n>t&&(n++,l()),a}function f(e,t,n){var a=l(e);return e=1===a.length?a[0]:e,r((n&&n.get||o)(a),[e],t||e)}var d=f("id"),h=r((function(e){return e}),[],"identity"),p=r((function(){return 0}),[],"zero"),v=r((function(){return 1}),[],"one"),m=r((function(){return!0}),[],"true"),b=r((function(){return!1}),[],"false");function g(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var y=0,x=1,O=2,k=3,w=4;function j(e,t){var n=e||y;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=x&&g(t||"error","ERROR",arguments),this},warn:function(){return n>=O&&g(t||"warn","WARN",arguments),this},info:function(){return n>=k&&g(t||"log","INFO",arguments),this},debug:function(){return n>=w&&g(t||"log","DEBUG",arguments),this}}}var _=Array.isArray;function S(e){return e===Object(e)}var E=function(e){return"__proto__"!==e};function C(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)if("signals"===n)e.signals=N(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;A(e,n,t[n],r)}return e}),{})}function A(e,t,n,r){var a,i;if(E(t))if(S(n)&&!_(n))for(a in i=S(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[a])?A(i,a,n[a]):E(a)&&(i[a]=n[a]);else e[t]=n}function N(e,t){if(null==e)return t;var n={},r=[];function a(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(a),e.forEach(a),r}function T(e){return e[e.length-1]}function I(e){return null==e||""===e?null:+e}var D=function(e){return function(t){return e*Math.exp(t)}},F=function(e){return function(t){return Math.log(e*t)}},M=function(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}},R=function(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}},z=function(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}};function L(e,t,n,r){var a=n(e[0]),i=n(T(e)),o=(i-a)*t;return[r(a-o),r(i-o)]}function P(e,t){return L(e,t,I,h)}function B(e,t){var n=Math.sign(e[0]);return L(e,t,F(n),D(n))}function W(e,t,n){return L(e,t,z(n),z(1/n))}function U(e,t,n){return L(e,t,M(n),R(n))}function V(e,t,n,r,a){var i=r(e[0]),o=r(T(e)),u=null!=t?r(t):(i+o)/2;return[a(u+(i-u)*n),a(u+(o-u)*n)]}function q(e,t,n){return V(e,t,n,I,h)}function H(e,t,n){var r=Math.sign(e[0]);return V(e,t,n,F(r),D(r))}function G(e,t,n,r){return V(e,t,n,z(r),z(1/r))}function K(e,t,n,r){return V(e,t,n,M(r),R(r))}function X(e){return 1+~~(new Date(e).getMonth()/3)}function Y(e){return 1+~~(new Date(e).getUTCMonth()/3)}function $(e){return null!=e?_(e)?e:[e]:[]}function J(e,t,n){var r,a=e[0],i=e[1];return i<a&&(r=i,i=a,a=r),(r=i-a)>=n-t?[t,n]:[a=Math.min(Math.max(a,t),n-r),a+r]}function Q(e){return"function"===typeof e}function Z(e,t,n){n=n||{},t=$(t)||[];var a=[],o=[],u={},c=n.comparator||te;return $(e).forEach((function(e,r){null!=e&&(a.push("descending"===t[r]?-1:1),o.push(e=Q(e)?e:f(e,null,n)),(i(e)||[]).forEach((function(e){return u[e]=1})))})),0===o.length?null:r(c(o,a),Object.keys(u))}var ee=function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0)},te=function(e,t){return 1===e.length?ne(e[0],t[0]):re(e,t,e.length)},ne=function(e,t){return function(n,r){return ee(e(n),e(r))*t}},re=function(e,t,n){return t.push(0),function(r,a){for(var i,o=0,u=-1;0===o&&++u<n;)i=e[u],o=ee(i(r),i(a));return o*t[u]}};function ae(e){return Q(e)?e:function(){return e}}function ie(e,t){var n;return function(r){n&&clearTimeout(n),n=setTimeout((function(){return t(r),n=null}),e)}}function oe(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}function ue(e,t){var n,r,a,i,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];o<n&&(null==r||r!==r);r=e[++o]);for(a=i=r;o<n;++o)null!=(r=e[o])&&(r<a&&(a=r),r>i&&(i=r))}else{for(r=t(e[o]);o<n&&(null==r||r!==r);r=t(e[++o]));for(a=i=r;o<n;++o)null!=(r=t(e[o]))&&(r<a&&(a=r),r>i&&(i=r))}return[a,i]}function ce(e,t){var n,r,a,i,o,u=e.length,c=-1;if(null==t){for(;++c<u;)if(null!=(r=e[c])&&r>=r){n=a=r;break}if(c===u)return[-1,-1];for(i=o=c;++c<u;)null!=(r=e[c])&&(n>r&&(n=r,i=c),a<r&&(a=r,o=c))}else{for(;++c<u;)if(null!=(r=t(e[c],c,e))&&r>=r){n=a=r;break}if(c===u)return[-1,-1];for(i=o=c;++c<u;)null!=(r=t(e[c],c,e))&&(n>r&&(n=r,i=c),a<r&&(a=r,o=c))}return[i,o]}var se=Object.prototype.hasOwnProperty;function le(e,t){return se.call(e,t)}var fe={};function de(e){var t,n={};function r(e){return le(n,e)&&n[e]!==fe}var a={size:0,empty:0,object:n,has:r,get:function(e){return r(e)?n[e]:void 0},set:function(e,t){return r(e)||(++a.size,n[e]===fe&&--a.empty),n[e]=t,this},delete:function(e){return r(e)&&(--a.size,++a.empty,n[e]=fe),this},clear:function(){a.size=a.empty=0,a.object=n={}},test:function(e){return arguments.length?(t=e,a):t},clean:function(){var e={},r=0;for(var i in n){var o=n[i];o===fe||t&&t(o)||(e[i]=o,++r)}a.size=r,a.empty=0,a.object=n=e}};return e&&Object.keys(e).forEach((function(t){a.set(t,e[t])})),a}function he(e,t,n,r,a,i){if(!n&&0!==n)return i;var o,u=+n,c=e[0],s=T(e);s<c&&(o=c,c=s,s=o),o=Math.abs(t-c);var l=Math.abs(s-t);return o<l&&o<=u?r:l<=u?a:i}function pe(e,t,n){var r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),oe(r,n)}function ve(e,t,n,r){var a,i=t[0],o=t[t.length-1];return i>o&&(a=i,i=o,o=a),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)}function me(e){return"boolean"===typeof e}function be(e){return"[object Date]"===Object.prototype.toString.call(e)}function ge(e){return e&&Q(e[Symbol.iterator])}function ye(e){return"number"===typeof e}function xe(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function Oe(e){return"string"===typeof e}function ke(e,t,n){e&&(e=t?$(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):$(e));var a,i=e&&e.length,u=n&&n.get||o,c=function(e){return u(t?[e]:l(e))};if(i)if(1===i){var s=c(e[0]);a=function(e){return""+s(e)}}else{var f=e.map(c);a=function(e){for(var t=""+f[0](e),n=0;++n<i;)t+="|"+f[n](e);return t}}else a=function(){return""};return r(a,e,"key")}function we(e,t){var n=e[0],r=T(e),a=+t;return a?1===a?r:n+a*(r-n):n}function je(e){var t,n,r;e=+e||1e4;var a=function(){t={},n={},r=0},i=function(a,i){return++r>e&&(n=t,t={},r=1),t[a]=i};return a(),{clear:a,has:function(e){return le(t,e)||le(n,e)},get:function(e){return le(t,e)?t[e]:le(n,e)?i(e,n[e]):void 0},set:function(e,n){return le(t,e)?t[e]=n:i(e,n)}}}function _e(e,t,n,r){var a=t.length,i=n.length;if(!i)return t;if(!a)return n;for(var o=r||new t.constructor(a+i),u=0,c=0,s=0;u<a&&c<i;++s)o[s]=e(t[u],n[c])>0?n[c++]:t[u++];for(;u<a;++u,++s)o[s]=t[u];for(;c<i;++c,++s)o[s]=n[c];return o}function Se(e,t){for(var n="";--t>=0;)n+=e;return n}function Ee(e,t,n,r){var a=n||" ",i=e+"",o=t-i.length;return o<=0?i:"left"===r?Se(a,o)+i:"center"===r?Se(a,~~(o/2))+i+Se(a,Math.ceil(o/2)):i+Se(a,o)}function Ce(e){return e&&T(e)-e[0]||0}function Ae(e){return _(e)?"["+e.map(Ae)+"]":S(e)||Oe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Ne(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e}var Te=function(e){return ye(e)||be(e)?e:Date.parse(e)};function Ie(e,t){return t=t||Te,null==e||""===e?null:t(e)}function De(e){return null==e||""===e?null:e+""}function Fe(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}function Me(e,t,n,r){var a=null!=r?r:"\u2026",i=e+"",o=i.length,u=Math.max(0,t-a.length);return o<=t?i:"left"===n?a+i.slice(o-u):"center"===n?i.slice(0,Math.ceil(u/2))+a+i.slice(o-~~(u/2)):i.slice(0,u)+a}function Re(e,t,n){if(e)if(t)for(var r=e.length,a=0;a<r;++a){var i=t(e[a]);i&&n(i,a,e)}else e.forEach(n)}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},function(e,t,n){e.exports=n(333)},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return d}));var r=n(8),a=n(1);function i(e,t,n,r,i){var u=t.inputParams[e];if(u&&void 0!==u.inputIndexStart){var c=u.inputIndexStart,s=0===u.inputIndexEnd?void 0:void 0===u.inputIndexEnd?c+1:u.inputIndexEnd;if("tensor"===u.type)return o(t.inputNames[u.inputIndexStart],n,r,i);if("tensors"===u.type)return t.inputNames.slice(c,s).map((function(e){return o(e,n,r,i)}));var l=o(t.inputNames.slice(c)[0],n,r,i),f=l.dataSync();return"number"===u.type?f[0]:a.util.toNestedArray(l.shape,f)}var d=t.attrParams[e];return d&&d.value}function o(e,t,n,a){var i=l(e),o=Object(r.a)(i,2),u=o[0],c=o[1];if(null!=a){var f=a.getHashTableHandleByName(u);if(null!=f)return f}var d=n.currentContextIds.find((function(e){return!!t[s(u,e)]}));return void 0!==d?t[s(u,d)][c]:void 0}function u(e,t,n){return t[s(e,n.currentContextId)]}function c(e,t){var n=l(e),a=Object(r.a)(n,2),i=a[0],o=a[1];return[s(i,t&&t.currentContextId),o]}function s(e,t){return t?"".concat(e,"-").concat(t):e}function l(e){var t=e.split(":");return 1===t.length?[e,0]:[t[0],Number(t[t.length-1])]}function f(e,t,n){var r=i("pad",e,t,n);if("explicit"===r){r=i("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],o=0;o<4;o++)a[o][0]=r[2*o],a[o][1]=r[2*o+1];return a}return r}function d(e){return e.kept?e:Object(a.clone)(e)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return d}));var r=n(12),a=n(34),i=n(16),o=n(19),u=n(22);function c(e,t){var n=e;if(Object(o.A)(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Object(o.A)(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&Object(a.c)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&s(e,r,[]),r}function s(e,t,n){if(n=n||[],Array.isArray(e)||Object(o.A)(e)){Object(o.b)(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),Object(o.b)(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)s(e[a],r,n.concat(a))}else Object(o.b)(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function l(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function f(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof i.a)return l(a,e.dtype,t,n),e;var s=Object(o.r)(e);if("string"!==s&&["bool","int32","float32"].indexOf(a)>=0&&(s=a),l(a,s,t,n),null==e||!Object(o.A)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var f=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(f,"'"))}var d=c(e,s);Object(o.A)(e)||Array.isArray(e)||(e=[e]);var h=!0,p="string"!==s?Object(u.toTypedArray)(e,s):Object(o.m)(e,[],h);return r.a.makeTensor(p,d,s)}function d(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,a){return f(e,"".concat(t,"[").concat(a,"]"),n,r)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return p})),n.d(t,"n",(function(){return v})),n.d(t,"m",(function(){return m})),n.d(t,"o",(function(){return b})),n.d(t,"r",(function(){return g})),n.d(t,"p",(function(){return y})),n.d(t,"q",(function(){return x})),n.d(t,"s",(function(){return O})),n.d(t,"t",(function(){return k})),n.d(t,"u",(function(){return w})),n.d(t,"v",(function(){return j})),n.d(t,"w",(function(){return _})),n.d(t,"x",(function(){return S})),n.d(t,"y",(function(){return E})),n.d(t,"z",(function(){return C})),n.d(t,"A",(function(){return A})),n.d(t,"B",(function(){return N})),n.d(t,"C",(function(){return T})),n.d(t,"D",(function(){return I})),n.d(t,"E",(function(){return D})),n.d(t,"F",(function(){return F})),n.d(t,"G",(function(){return M})),n.d(t,"H",(function(){return R})),n.d(t,"I",(function(){return z})),n.d(t,"J",(function(){return L})),n.d(t,"L",(function(){return P})),n.d(t,"K",(function(){return B})),n.d(t,"M",(function(){return W})),n.d(t,"N",(function(){return U})),n.d(t,"O",(function(){return V})),n.d(t,"P",(function(){return q})),n.d(t,"Q",(function(){return H})),n.d(t,"R",(function(){return G})),n.d(t,"S",(function(){return K})),n.d(t,"U",(function(){return X})),n.d(t,"T",(function(){return Y})),n.d(t,"lc",(function(){return $})),n.d(t,"V",(function(){return J})),n.d(t,"W",(function(){return Q})),n.d(t,"X",(function(){return Z})),n.d(t,"Z",(function(){return ee})),n.d(t,"Y",(function(){return te})),n.d(t,"ab",(function(){return ne})),n.d(t,"bb",(function(){return re})),n.d(t,"cb",(function(){return ae})),n.d(t,"db",(function(){return ie})),n.d(t,"eb",(function(){return oe})),n.d(t,"fb",(function(){return ue})),n.d(t,"gb",(function(){return ce})),n.d(t,"hb",(function(){return se})),n.d(t,"jb",(function(){return le})),n.d(t,"nb",(function(){return fe})),n.d(t,"mb",(function(){return de})),n.d(t,"ob",(function(){return he})),n.d(t,"pb",(function(){return pe})),n.d(t,"rb",(function(){return ve})),n.d(t,"qb",(function(){return me})),n.d(t,"sb",(function(){return be})),n.d(t,"tb",(function(){return ge})),n.d(t,"ub",(function(){return ye})),n.d(t,"vb",(function(){return xe})),n.d(t,"yb",(function(){return Oe})),n.d(t,"zb",(function(){return ke})),n.d(t,"Ab",(function(){return we})),n.d(t,"Bb",(function(){return je})),n.d(t,"Cb",(function(){return _e})),n.d(t,"Db",(function(){return Se})),n.d(t,"Fb",(function(){return Ee})),n.d(t,"Gb",(function(){return Ce})),n.d(t,"Hb",(function(){return Ae})),n.d(t,"Eb",(function(){return Ne})),n.d(t,"wb",(function(){return Te})),n.d(t,"xb",(function(){return Ie})),n.d(t,"Ib",(function(){return De})),n.d(t,"Ob",(function(){return Fe})),n.d(t,"Jb",(function(){return Me})),n.d(t,"Mb",(function(){return Re})),n.d(t,"Kb",(function(){return ze})),n.d(t,"Lb",(function(){return Le})),n.d(t,"Nb",(function(){return Pe})),n.d(t,"Pb",(function(){return Be})),n.d(t,"Qb",(function(){return We})),n.d(t,"Rb",(function(){return Ue})),n.d(t,"Sb",(function(){return Ve})),n.d(t,"Tb",(function(){return qe})),n.d(t,"Ub",(function(){return He})),n.d(t,"Vb",(function(){return Ge})),n.d(t,"Wb",(function(){return Ke})),n.d(t,"ac",(function(){return Xe})),n.d(t,"Xb",(function(){return Ye})),n.d(t,"Yb",(function(){return $e})),n.d(t,"Zb",(function(){return Je})),n.d(t,"cc",(function(){return Qe})),n.d(t,"bc",(function(){return Ze})),n.d(t,"dc",(function(){return et})),n.d(t,"ec",(function(){return tt})),n.d(t,"fc",(function(){return nt})),n.d(t,"gc",(function(){return rt})),n.d(t,"hc",(function(){return at})),n.d(t,"ic",(function(){return it})),n.d(t,"jc",(function(){return ot})),n.d(t,"kc",(function(){return ut})),n.d(t,"mc",(function(){return ct})),n.d(t,"nc",(function(){return st})),n.d(t,"pc",(function(){return lt})),n.d(t,"sc",(function(){return ft})),n.d(t,"tc",(function(){return dt})),n.d(t,"qc",(function(){return ht})),n.d(t,"rc",(function(){return pt})),n.d(t,"oc",(function(){return vt})),n.d(t,"uc",(function(){return mt})),n.d(t,"wc",(function(){return bt})),n.d(t,"xc",(function(){return gt})),n.d(t,"yc",(function(){return yt})),n.d(t,"zc",(function(){return xt})),n.d(t,"Ac",(function(){return Ot})),n.d(t,"Fc",(function(){return kt})),n.d(t,"Dc",(function(){return wt})),n.d(t,"Ec",(function(){return jt})),n.d(t,"Cc",(function(){return _t})),n.d(t,"Bc",(function(){return St})),n.d(t,"Hc",(function(){return Et})),n.d(t,"Mc",(function(){return Ct})),n.d(t,"Sc",(function(){return At})),n.d(t,"Ic",(function(){return Nt})),n.d(t,"Lc",(function(){return Tt})),n.d(t,"Gc",(function(){return It})),n.d(t,"Jc",(function(){return Dt})),n.d(t,"Kc",(function(){return Ft})),n.d(t,"Oc",(function(){return Mt})),n.d(t,"Nc",(function(){return Rt})),n.d(t,"Qc",(function(){return zt})),n.d(t,"Rc",(function(){return Lt})),n.d(t,"Tc",(function(){return Pt})),n.d(t,"Uc",(function(){return Bt})),n.d(t,"Vc",(function(){return Wt})),n.d(t,"Wc",(function(){return Ut})),n.d(t,"Xc",(function(){return Vt})),n.d(t,"Yc",(function(){return qt})),n.d(t,"Zc",(function(){return Ht})),n.d(t,"ad",(function(){return Gt})),n.d(t,"bd",(function(){return Kt})),n.d(t,"cd",(function(){return Xt})),n.d(t,"Pc",(function(){return Yt})),n.d(t,"ib",(function(){return $t})),n.d(t,"vc",(function(){return Jt})),n.d(t,"dd",(function(){return Qt})),n.d(t,"kb",(function(){return Zt})),n.d(t,"lb",(function(){return en}));var r="Abs",a="Acos",i="Acosh",o="Add",u="AddN",c="All",s="Any",l="ArgMax",f="ArgMin",d="Asin",h="Asinh",p="Atan",v="Atanh",m="Atan2",b="AvgPool",g="AvgPoolGrad",y="AvgPool3D",x="AvgPool3DGrad",O="BatchMatMul",k="BatchToSpaceND",w="Bincount",j="BroadcastTo",_="Cast",S="Ceil",E="ClipByValue",C="Complex",A="ComplexAbs",N="Concat",T="Conv2D",I="Conv2DBackpropFilter",D="Conv2DBackpropInput",F="Conv3D",M="Conv3DBackpropFilterV2",R="Conv3DBackpropInputV2",z="Cos",L="Cosh",P="Cumsum",B="CropAndResize",W="DenseBincount",U="DepthToSpace",V="DepthwiseConv2dNative",q="DepthwiseConv2dNativeBackpropFilter",H="DepthwiseConv2dNativeBackpropInput",G="Diag",K="Dilation2D",X="Dilation2DBackpropInput",Y="Dilation2DBackpropFilter",$="RealDiv",J="Einsum",Q="Elu",Z="EluGrad",ee="Erf",te="Equal",ne="Exp",re="ExpandDims",ae="Expm1",ie="FFT",oe="Fill",ue="FlipLeftRight",ce="Floor",se="FloorDiv",le="FusedBatchNorm",fe="GatherV2",de="GatherNd",he="Greater",pe="GreaterEqual",ve="Identity",me="IFFT",be="Imag",ge="IsFinite",ye="IsInf",xe="IsNan",Oe="LeakyRelu",ke="Less",we="LessEqual",je="LinSpace",_e="Log",Se="Log1p",Ee="LogicalAnd",Ce="LogicalNot",Ae="LogicalOr",Ne="LogSoftmax",Te="LRN",Ie="LRNGrad",De="Max",Fe="Maximum",Me="MaxPool",Re="MaxPoolGrad",ze="MaxPool3D",Le="MaxPool3DGrad",Pe="MaxPoolWithArgmax",Be="Mean",We="Min",Ue="Minimum",Ve="MirrorPad",qe="Mod",He="Multinomial",Ge="Multiply",Ke="Neg",Xe="NotEqual",Ye="NonMaxSuppressionV3",$e="NonMaxSuppressionV4",Je="NonMaxSuppressionV5",Qe="OnesLike",Ze="OneHot",et="Pack",tt="PadV2",nt="Pool",rt="Pow",at="Prelu",it="Prod",ot="Range",ut="Real",ct="Reciprocal",st="Relu",lt="Reshape",ft="ResizeNearestNeighbor",dt="ResizeNearestNeighborGrad",ht="ResizeBilinear",pt="ResizeBilinearGrad",vt="Relu6",mt="Reverse",bt="Round",gt="Rsqrt",yt="ScatterNd",xt="Select",Ot="Selu",kt="Slice",wt="Sin",jt="Sinh",_t="Sign",St="Sigmoid",Et="Softplus",Ct="Sqrt",At="Sum",Nt="SpaceToBatchND",Tt="SplitV",It="Softmax",Dt="SparseReshape",Ft="SparseToDense",Mt="SquaredDifference",Rt="Square",zt="StridedSlice",Lt="Sub",Pt="Tan",Bt="Tanh",Wt="Tile",Ut="TopK",Vt="Transform",qt="Transpose",Ht="Unique",Gt="Unpack",Kt="UnsortedSegmentSum",Xt="ZerosLike",Yt="Step",$t="FromPixels",Jt="RotateWithOffset",Qt="_FusedMatMul",Zt="FusedConv2D",en="FusedDepthwiseConv2D"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(217);var a=n(110),i=n(218);function o(e,t){return Object(r.a)(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(c){a=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}}(e,t)||Object(a.a)(e,t)||Object(i.a)()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(110);function a(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(r.a)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw o}}}}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(12),a=n(19),i="__op";function o(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],o=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=i;var u=function(){r.a.startScope(n);try{var e=o.apply(void 0,arguments);return Object(a.x)(e)&&console.error("Cannot return a Promise inside of tidy."),r.a.endScope(e),e}catch(t){throw r.a.endScope(null),t}};return Object.defineProperty(u,"name",{value:n,configurable:!0}),u}},function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return C}));var r=n(9),a=n(13),i=n(4),o=n.n(i),u=n(17),c=n(3),s=n(10),l=n(165),f=n(34),d=n(122),h=n(7),p=n(70),v=n(22),m=n(19),b=function(){function e(t,n){Object(c.a)(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new g)}return Object(s.a)(e,[{key:"profileKernel",value:function(e,t,n){var a,i,o=function(){a=n()},u=v.now();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();var c,s=Object(r.a)(a);try{for(s.s();!(c=s.n()).done;){c.value.dataSync()}}catch(h){s.e(h)}finally{s.f()}i=Promise.resolve({kernelMs:v.now()-u})}if(Object(f.c)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var l=function(t){var n=a[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},d=0;d<a.length;d++)l(d);return{kernelName:e,outputs:a,inputs:t,timeMs:i.then((function(e){return e.kernelMs})),extraInfo:i.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var g=function(){function e(){Object(c.a)(this,e)}return Object(s.a)(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?m.L("".concat(r,"ms"),9):r.error,u=m.L(e,25),c=t.rank,s=t.size,l=m.L(t.shape.toString(),14),f="";for(var d in a){var h=a[d];if(null!=h){var p=h.shape||t.shape,v=p.length;f+="".concat(d,": ").concat(v,"D ").concat(v>0?p:""," ")}}console.log("%c".concat(u,"\t%c").concat(o,"\t%c").concat(c,"D ").concat(l,"\t%c").concat(s,"\t%c").concat(f,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function y(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var u=e[o],c=u.inputs;for(var s in c){for(var l=c[s],f=!1,d=0;d<t.length;d++)if(r[l.id]){u.outputs.forEach((function(e){return r[e.id]=!0})),f=!0,a[u.id]=!0;break}if(f)break}}var h={};h[n.id]=!0;for(var p={},v=e.length-1;v>=0;v--)for(var m=e[v],b=m.inputs,g=0;g<m.outputs.length;g++)if(h[m.outputs[g].id]){for(var y in b)h[b[y].id]=!0,p[m.id]=!0;break}for(var x=[],O=0;O<e.length;O++){var k=e[O];if(a[k.id]&&p[k.id]){var w={};for(var j in k.inputs){var _=k.inputs[j];r[_.id]&&(w[j]=_)}var S=Object.assign({},k);S.inputs=w,S.outputs=k.outputs,x.push(S)}}return x}function x(e,t,n,r){for(var a=function(a){var i=t[a],o=[];if(i.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));var u=i.gradient(o),c=function(t){if(!(t in u))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(u),"."));var a=n((function(){return u[t]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var o=i.inputs[t];if(!m.a(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=a;else{var c=e[o.id];e[o.id]=r(c,a),c.dispose()}};for(var s in i.inputs)c(s)},i=t.length-1;i>=0;i--)a(i)}var O=n(16),k=n(35);function w(e){return null!=e.kernelName}var j=function(){function e(){Object(c.a)(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return Object(s.a)(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),_=function(){function e(t){Object(c.a)(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new j}return Object(s.a)(e,[{key:"ready",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new b(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;Object(p.d)(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;Object(p.d)(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof l.b||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=C.runKernel(h.rb,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return C.runKernel(h.w,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(!(null!=Object(p.c)(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),u=this.state.numBytes,c=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var s=w(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(w(e)){var l=e.kernelName,f=e.inputs,d=e.attrs;null==this.backendName&&this.backend;var h=Object(p.c)(l,this.backendName);m.b(null!=h,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=h.kernelFunc({inputs:f,attrs:d,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){if(null!=e.rank)return e;var t=e.dataId,n=e.shape,r=e.dtype;return a.makeTensorFromDataId(t,n,r)}));if(o){var u=a.getTensorsForGradient(l,f,n);i=a.saveTensorsForBackwardMode(u)}return n}}else{var v=e.forwardFunc,b=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return v(a.backend,b)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(s,e,t),t}}var g,y=e.inputs,x=e.attrs,O=w(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(g=a.profiler.profileKernel(s,y,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(g),t=g.outputs):t=n()})),o&&this.addTapeNode(s,y,t,O,i,x),this.state.profiling&&this.state.activeProfile.kernels.push({name:s,bytesAdded:this.state.numBytes-u,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-c,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(y).map((function(e){return null!=y[e]?y[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=Object(p.b)(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(m.b(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var u=n.filter((function(e,t){return o[t]}));return a.concat(u)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&m.z(e[0])&&(a=e.map((function(e){return v.encodeString(e)})));var i=r.write(a,t,n),o=new O.a(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var u=this.state.tensorInfo.get(i),c=Object(m.f)(a);this.state.numBytes+=c-u.bytes,u.bytes=c}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){n=n||"float32";var a=new O.a(t,n,e,this.nextTensorId());return this.trackTensor(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new O.c(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*m.g(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof O.c||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*m.g(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,i,u,c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,i=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,Object(a.a)(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-i,u=Object(r.a)(this.state.activeProfile.kernels),e.prev=12,u.s();case 14:if((c=u.n()).done){e.next=24;break}return s=c.value,e.next=18,s.kernelTimeMs;case 18:return s.kernelTimeMs=e.sent,e.next=21,s.extraInfo;case 21:s.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),u.e(e.t0);case 29:return e.prev=29,u.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},c=Object(p.b)(e);null!=c&&(r=c.gradFunc),null!=r&&(u.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=m.F(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(u)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=Object(k.getTensorsInContainer)(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var a=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(m.b(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var o=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",e)}));m.b(o instanceof O.a,(function(){return"The result y returned by f() must be a tensor."}));var u=y(this.state.activeTape,t,o);if(!i&&0===u.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[o.id]=null==n?S(o.shape):n,x(e,u,(function(e){return a.tidy(e)}),A);var i=t.map((function(t){return e[t.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(e){var t,n=Object(r.a)(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(a){n.e(a)}finally{n.f()}})),a.state.activeTape=null),{value:o,grads:i}}))}},{key:"customGrad",value:function(e){var t=this;return m.b(m.u(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;m.b(r.every((function(e){return e instanceof O.a})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));var u=function(t,n){return i=e.apply(void 0,[].concat(r,[n])),m.b(i.value instanceof O.a,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),m.b(m.u(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},c=function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];m.b(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),m.b(a.every((function(e){return e instanceof O.a})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o};return t.runKernelFunc({forwardFunc:u,backwardsFunc:c,inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(v.now)(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=Object(v.now)()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new j,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function S(e){var t=Object(m.D)(Object(m.O)(e),"float32");return C.makeTensor(t,e,"float32")}function E(){var e=Object(d.b)();if(null==e._tfengine){var t=new f.b(e);e._tfengine=new _(t)}return Object(f.d)(e._tfengine.ENV),Object(O.g)((function(){return e._tfengine})),e._tfengine}_.nextTensorId=0,_.nextVariableId=0;var C=E();function A(e,t){var n={a:e,b:t};return C.runKernel(h.d,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(169);var a=n(216),i=n(110);function o(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||Object(a.a)(e)||Object(i.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(155);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(r.a)(e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(23),a=n(219);function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(43);function u(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?Object(o.a)(e):t}function c(e){var t=Object(a.a)();return function(){var n,a=Object(r.a)(e);if(t){var i=Object(r.a)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return u(this,n)}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"g",(function(){return k})),n.d(t,"f",(function(){return w})),n.d(t,"e",(function(){return j})),n.d(t,"a",(function(){return _})),n.d(t,"d",(function(){return S})),n.d(t,"c",(function(){return E}));var r=n(14),a=n(15),i=n(4),o=n.n(i),u=n(17),c=n(3),s=n(10),l=n(122),f=n(13),d=n(19);function h(e,t,n,r){var a=Object(d.j)(t),i=function(e,t,n,r){var a=Object(d.O)(t),i=r[r.length-1],o=new Array(i).fill(0),u=t.length,c="complex64"===n?b(e):e;if(u>1)for(var s=0;s<a/i;s++)for(var l=s*i,f=0;f<i;f++)o[f]=Math.max(o[f],p(c[l+f],0,n).length);return o}(e,t,n,a),o=t.length,u=m(e,t,n,a,i),c=["Tensor"];return r&&(c.push("  dtype: ".concat(n)),c.push("  rank: ".concat(o)),c.push("  shape: [".concat(t,"]")),c.push("  values:")),c.push(u.map((function(e){return"    "+e})).join("\n")),c.join("\n")}function p(e,t,n){var r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):Object(d.z)(e)?"'".concat(e,"'"):"bool"===n?v(e):parseFloat(e.toFixed(7)).toString(),Object(d.L)(r,t)}function v(e){return 0===e?"false":"true"}function m(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,u=t[0],c=t.length;if(0===c){if("complex64"===n){var s=b(e);return[p(s[0],0,n)]}return"bool"===n?[v(e[0])]:[e[0].toString()]}if(1===c){if(u>20){var l=3*o,d=Array.from(e.slice(0,l)),h=Array.from(e.slice((u-3)*o,u*o));return"complex64"===n&&(d=b(d),h=b(h)),["["+d.map((function(e,t){return p(e,a[t],n)})).join(", ")+", ..., "+h.map((function(e,t){return p(e,a[u-3+t],n)})).join(", ")+"]"]}var g="complex64"===n?b(e):Array.from(e);return["["+g.map((function(e,t){return p(e,a[t],n)})).join(", ")+"]"]}var y=t.slice(1),x=r.slice(1),O=r[0]*o,k=[];if(u>20){for(var w=0;w<3;w++){var j=w*O,_=j+O;k.push.apply(k,Object(f.a)(m(e.slice(j,_),y,n,x,a,!1)))}k.push("...");for(var S=u-3;S<u;S++){var E=S*O,C=E+O;k.push.apply(k,Object(f.a)(m(e.slice(E,C),y,n,x,a,S===u-1)))}}else for(var A=0;A<u;A++){var N=A*O,T=N+O;k.push.apply(k,Object(f.a)(m(e.slice(N,T),y,n,x,a,A===u-1)))}var I=2===c?",":"";k[0]="["+k[0]+I;for(var D=1;D<k.length-1;D++)k[D]=" "+k[D]+I;for(var F=",\n",M=2;M<c;M++)F+="\n";return k[k.length-1]=" "+k[k.length-1]+"]"+(i?"":F),k}function b(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var g=n(22),y=function(){function e(t,n,r){var a=this;if(Object(c.a)(this,e),this.dtype=n,this.shape=t.slice(),this.size=d.O(t),null!=r){var i=r.length;d.b(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||d.n(n,this.size),this.strides=Object(d.j)(t)}return Object(s.a)(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),d.b(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var u="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(u)}r++}for(var c=t[t.length-1],s=0;s<t.length-1;++s)c+=this.strides[s]*t[s];return this.values[c]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return x().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),x=null,O=null;function k(e){x=e}function w(e){O=e}function j(e){e}var _=function(){function e(t,n,r,a){Object(c.a)(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=d.O(t),this.strides=Object(d.j)(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object(s.a)(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",O.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return O.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Object(d.T)(this.shape,t,"complex64"===this.dtype));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return Object(d.T)(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=x().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return g.decodeString(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataSync",value:function(){this.throwIfDisposed();var e=x().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return g.decodeString(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,x().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(x().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return O.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),O.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return h(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),O.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),x().makeVariable(this,e,t,n)}}]),e}();function S(){return Object(l.a)("Tensor",(function(){return _}))}Object.defineProperty(_,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),S();var E=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r,a,i){var o;return Object(c.a)(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return Object(s.a)(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!d.a(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));x().disposeTensor(this),this.dataId=e.dataId,x().incRef(this,null)}},{key:"dispose",value:function(){x().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(_);Object.defineProperty(E,Symbol.hasInstance,{value:function(e){return e instanceof _&&null!=e.assign&&e.assign instanceof Function}})},function(e,t,n){"use strict";function r(e,t,n,r,a,i,o){try{var u=e[i](o),c=u.value}catch(s){return void n(s)}u.done?t(c):Promise.resolve(c).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function u(e){r(o,a,i,u,c,"next",e)}function c(e){r(o,a,i,u,c,"throw",e)}u(void 0)}))}}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({reshape_:function(e,t){var n={x:Object(i.a)(e,"x","reshape","string_or_numeric")},o={shape:t};return r.a.runKernel(a.pc,n,o)}})},function(e,t,n){"use strict";function r(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function a(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(e.length)+"Second array length was ".concat(t.length));for(var n,r,a=e.length,i=0;a>0;)i=Math.random()*a|0,n=e[--a],r=t[a],e[a]=e[i],t[a]=t[i],e[i]=n,t[i]=r}function i(e,t,n){return Math.max(e,Math.min(t,n))}function o(e){return e%2===0?e:e+1}function u(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function c(e,t){var n=Math.random();return t*n+(1-n)*e}function s(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n}function l(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";l(m(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function d(e){l(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||T(e)&&!n)for(var r=0;r<e.length;++r)h(e[r],t,n);else t.push(e);return t}function p(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function v(e){return 0===e.length}function m(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function b(e){return e%1===0}function g(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function y(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function x(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return r(t),t}function O(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var u=t(i);null!=n&&i>=n?a():setTimeout(o,u)}}()}))}function w(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function j(e,t){var n=t.length;return l((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),l(e.every((function(e){return b(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function _(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:j(t,e).sort(),o=0,u=0;u<e.length;++u){if(null!=i){if(i[o]===u&&1!==e[u])throw new Error("Can't squeeze axis ".concat(u," since its dim '").concat(e[u],"' is not 1"));(null==i[o]||i[o]>u)&&1===e[u]&&(n.push(e[u]),r.push(u)),i[o]<=u&&o++}1!==e[u]&&(n.push(e[u]),r.push(u))}return{newShape:n,keptDims:r}}function S(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function E(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function C(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function A(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function N(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function T(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function I(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function D(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function F(e){return"string"===typeof e||e instanceof String}function M(e){return"boolean"===typeof e}function R(e){return"number"===typeof e}function z(e){return Array.isArray(e)?z(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":R(e)?"float32":F(e)?"string":M(e)?"bool":"float32"}function L(e){return!!(e&&e.constructor&&e.call&&e.apply)}function P(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function B(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function W(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===t.length)for(var i=t[0]*(r?2:1),o=0;o<i;o++)a[o]=n[e+o];else for(var u=t[0],c=t.slice(1),s=c.reduce((function(e,t){return e*t}))*(r?2:1),l=0;l<u;l++)a[l]=W(e+l*s,c,n,r);return a}function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];var r=e.reduce((function(e,t){return e*t}))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return W(0,e,t,n)}function V(e,t){for(var n=q(e,t),r=0;r<n.length;r++)n[r]=1;return n}function q(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function H(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return U(e,new Float32Array(n));if("int32"===t)return U(e,new Int32Array(n));if("bool"===t)return U(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function G(e){e.forEach((function(t){l(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function K(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function X(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Y(e){return e&&e.then&&"function"===typeof e.then}n.d(t,"M",(function(){return r})),n.d(t,"N",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"H",(function(){return o})),n.d(t,"R",(function(){return u})),n.d(t,"J",(function(){return c})),n.d(t,"l",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"m",(function(){return h})),n.d(t,"O",(function(){return p})),n.d(t,"y",(function(){return v})),n.d(t,"a",(function(){return m})),n.d(t,"v",(function(){return b})),n.d(t,"S",(function(){return g})),n.d(t,"P",(function(){return y})),n.d(t,"k",(function(){return x})),n.d(t,"L",(function(){return O})),n.d(t,"K",(function(){return k})),n.d(t,"s",(function(){return w})),n.d(t,"I",(function(){return j})),n.d(t,"Q",(function(){return _})),n.d(t,"o",(function(){return S})),n.d(t,"n",(function(){return E})),n.d(t,"h",(function(){return C})),n.d(t,"B",(function(){return A})),n.d(t,"p",(function(){return N})),n.d(t,"A",(function(){return T})),n.d(t,"g",(function(){return I})),n.d(t,"f",(function(){return D})),n.d(t,"z",(function(){return F})),n.d(t,"t",(function(){return M})),n.d(t,"w",(function(){return R})),n.d(t,"r",(function(){return z})),n.d(t,"u",(function(){return L})),n.d(t,"G",(function(){return P})),n.d(t,"j",(function(){return B})),n.d(t,"T",(function(){return U})),n.d(t,"D",(function(){return V})),n.d(t,"F",(function(){return q})),n.d(t,"E",(function(){return H})),n.d(t,"c",(function(){return G})),n.d(t,"C",(function(){return K})),n.d(t,"q",(function(){return X})),n.d(t,"x",(function(){return Y}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(11);var s=Object(c.b)({mul_:function(e,t){var n=Object(u.a)(e,"a","mul"),c=Object(u.a)(t,"b","mul"),s=Object(o.makeTypesMatch)(n,c),l=Object(r.a)(s,2),f={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.Vb,f)}})},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.r(t),n.d(t,"createScalarValue",(function(){return i})),n.d(t,"toTypedArray",(function(){return o})),n.d(t,"now",(function(){return u})),n.d(t,"fetch",(function(){return c})),n.d(t,"encodeString",(function(){return s})),n.d(t,"decodeString",(function(){return l}));var r=n(34),a=n(19);function i(e,t){return"string"===t?s(e):o([e],t)}function o(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=a.m(e)),Object(r.c)().getBool("DEBUG")&&a.h(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),i=0;i<n.length;++i)0!==Math.round(e[i])&&(n[i]=1);return n}throw new Error("Unknown data type ".concat(t))}function u(){return Object(r.c)().platform.now()}function c(e,t){return Object(r.c)().platform.fetch(e,t)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Object(r.c)().platform.encode(e,t)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Object(r.c)().platform.decode(e,t)}n.d(t,"shuffle",(function(){return a.M})),n.d(t,"shuffleCombo",(function(){return a.N})),n.d(t,"clamp",(function(){return a.i})),n.d(t,"nearestLargerEven",(function(){return a.H})),n.d(t,"sum",(function(){return a.R})),n.d(t,"randUniform",(function(){return a.J})),n.d(t,"distSquared",(function(){return a.l})),n.d(t,"assert",(function(){return a.b})),n.d(t,"assertShapesMatch",(function(){return a.e})),n.d(t,"assertNonNull",(function(){return a.d})),n.d(t,"flatten",(function(){return a.m})),n.d(t,"sizeFromShape",(function(){return a.O})),n.d(t,"isScalarShape",(function(){return a.y})),n.d(t,"arraysEqual",(function(){return a.a})),n.d(t,"isInt",(function(){return a.v})),n.d(t,"tanh",(function(){return a.S})),n.d(t,"sizeToSquarishShape",(function(){return a.P})),n.d(t,"createShuffledIndices",(function(){return a.k})),n.d(t,"rightPad",(function(){return a.L})),n.d(t,"repeatedTry",(function(){return a.K})),n.d(t,"inferFromImplicitShape",(function(){return a.s})),n.d(t,"parseAxisParam",(function(){return a.I})),n.d(t,"squeezeShape",(function(){return a.Q})),n.d(t,"getTypedArrayFromDType",(function(){return a.o})),n.d(t,"getArrayFromDType",(function(){return a.n})),n.d(t,"checkConversionForErrors",(function(){return a.h})),n.d(t,"isValidDtype",(function(){return a.B})),n.d(t,"hasEncodingLoss",(function(){return a.p})),n.d(t,"isTypedArray",(function(){return a.A})),n.d(t,"bytesPerElement",(function(){return a.g})),n.d(t,"bytesFromStringArray",(function(){return a.f})),n.d(t,"isString",(function(){return a.z})),n.d(t,"isBoolean",(function(){return a.t})),n.d(t,"isNumber",(function(){return a.w})),n.d(t,"inferDtype",(function(){return a.r})),n.d(t,"isFunction",(function(){return a.u})),n.d(t,"nearestDivisor",(function(){return a.G})),n.d(t,"computeStrides",(function(){return a.j})),n.d(t,"toNestedArray",(function(){return a.T})),n.d(t,"makeOnesTypedArray",(function(){return a.D})),n.d(t,"makeZerosTypedArray",(function(){return a.F})),n.d(t,"makeZerosNestedTypedArray",(function(){return a.E})),n.d(t,"assertNonNegativeIntegerDimensions",(function(){return a.c})),n.d(t,"locToIndex",(function(){return a.C})),n.d(t,"indexToLoc",(function(){return a.q})),n.d(t,"isPromise",(function(){return a.x}))},function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({cast_:function(e,t){var n=Object(i.a)(e,"x","cast");if(!o.B(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var u={x:n},c={dtype:t};return r.a.runKernel(a.w,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(23);function a(e,t,n){return(a="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Object(r.a)(e)););return e}(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(11);var s=Object(c.b)({add_:function(e,t){var n=Object(u.a)(e,"a","add"),c=Object(u.a)(t,"b","add"),s=Object(o.makeTypesMatch)(n,c),l=Object(r.a)(s,2),f={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.d,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(11);var s=Object(c.b)({sub_:function(e,t){var n=Object(u.a)(e,"a","sub"),c=Object(u.a)(t,"b","sub"),s=Object(o.makeTypesMatch)(n,c),l=Object(r.a)(s,2),f={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.Rc,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(133),s=n(11);var l=Object(s.b)({div_:function(e,t){var n=Object(u.a)(e,"a","div"),s=Object(u.a)(t,"b","div"),l=Object(o.makeTypesMatch)(n,s),f=Object(r.a)(l,2);if(n=f[0],s=f[1],"int32"===n.dtype&&"int32"===s.dtype)return Object(c.a)(n,s);var d={a:n,b:s};return a.a.runKernel(i.lc,d,{})}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19),a=n(60);function i(e,t){if((Object(r.A)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Object(r.A)(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Object(a.a)(e,[],[],t)}},function(e,t,n){"use strict";function r(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function a(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var u="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(u)}n.unshift(i)}}return n}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(24),u=n(11);var c=Object(u.b)({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=Object(i.a)(e,"x","sum");"bool"===u.dtype&&(u=Object(o.a)(u,"int32"));var c={x:u},s={axis:t,keepDims:n};return r.a.runKernel(a.Sc,c,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({zerosLike_:function(e){var t={x:Object(i.a)(e,"x","zerosLike")};return r.a.runKernel(a.cd,t)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return u.a})),n.d(t,"f",(function(){return c.a})),n.d(t,"g",(function(){return s.a})),n.d(t,"h",(function(){return l.a})),n.d(t,"i",(function(){return f.a})),n.d(t,"j",(function(){return d.a})),n.d(t,"k",(function(){return h.a})),n.d(t,"l",(function(){return p.a})),n.d(t,"m",(function(){return v.a})),n.d(t,"n",(function(){return m.a})),n.d(t,"o",(function(){return b.a})),n.d(t,"p",(function(){return g.a})),n.d(t,"q",(function(){return y.a})),n.d(t,"r",(function(){return C})),n.d(t,"w",(function(){return A.a})),n.d(t,"s",(function(){return N.a})),n.d(t,"t",(function(){return I})),n.d(t,"u",(function(){return D})),n.d(t,"v",(function(){return F})),n.d(t,"x",(function(){return M.a})),n.d(t,"z",(function(){return R.a})),n.d(t,"A",(function(){return z.a})),n.d(t,"B",(function(){return L.a})),n.d(t,"C",(function(){return P.a})),n.d(t,"D",(function(){return B.a})),n.d(t,"E",(function(){return W.a})),n.d(t,"F",(function(){return U.a})),n.d(t,"G",(function(){return O.a})),n.d(t,"H",(function(){return V})),n.d(t,"I",(function(){return q})),n.d(t,"J",(function(){return H})),n.d(t,"K",(function(){return G})),n.d(t,"L",(function(){return K.a})),n.d(t,"M",(function(){return X.a})),n.d(t,"N",(function(){return Y.a})),n.d(t,"O",(function(){return $.a})),n.d(t,"P",(function(){return Q})),n.d(t,"Q",(function(){return Z.a})),n.d(t,"R",(function(){return ee.a})),n.d(t,"T",(function(){return te.a})),n.d(t,"U",(function(){return ne.a})),n.d(t,"V",(function(){return re.a})),n.d(t,"W",(function(){return ae.a})),n.d(t,"X",(function(){return ue})),n.d(t,"Y",(function(){return ce.a})),n.d(t,"Z",(function(){return se.a})),n.d(t,"ab",(function(){return le.a})),n.d(t,"bb",(function(){return fe.a})),n.d(t,"db",(function(){return de.a})),n.d(t,"eb",(function(){return he.a})),n.d(t,"gb",(function(){return pe.a})),n.d(t,"hb",(function(){return ve.a})),n.d(t,"ib",(function(){return me.a})),n.d(t,"jb",(function(){return be.a})),n.d(t,"kb",(function(){return ge.a})),n.d(t,"lb",(function(){return Oe})),n.d(t,"nb",(function(){return ke.a})),n.d(t,"ob",(function(){return we.a})),n.d(t,"pb",(function(){return je.a})),n.d(t,"rb",(function(){return _e.a})),n.d(t,"tb",(function(){return Se.a})),n.d(t,"ub",(function(){return Ee.a})),n.d(t,"wb",(function(){return Ce.a})),n.d(t,"Ab",(function(){return Ae.a})),n.d(t,"Bb",(function(){return Ne.a})),n.d(t,"Cb",(function(){return Te.a})),n.d(t,"Db",(function(){return Ie.a})),n.d(t,"Eb",(function(){return De.a})),n.d(t,"Fb",(function(){return Fe.a})),n.d(t,"Hb",(function(){return Me.a})),n.d(t,"Ib",(function(){return Re.a})),n.d(t,"Jb",(function(){return ze.a})),n.d(t,"Kb",(function(){return Le.a})),n.d(t,"Lb",(function(){return Pe.a})),n.d(t,"Mb",(function(){return Be.a})),n.d(t,"Nb",(function(){return We.a})),n.d(t,"Ob",(function(){return Ue.a})),n.d(t,"Pb",(function(){return Ve.a})),n.d(t,"Qb",(function(){return qe.a})),n.d(t,"Rb",(function(){return He.a})),n.d(t,"Tb",(function(){return k.a})),n.d(t,"Ub",(function(){return Ge.a})),n.d(t,"Vb",(function(){return Ke.a})),n.d(t,"Wb",(function(){return Xe.a})),n.d(t,"Xb",(function(){return Ye.a})),n.d(t,"Yb",(function(){return $e.a})),n.d(t,"Zb",(function(){return Je.a})),n.d(t,"ac",(function(){return et})),n.d(t,"bc",(function(){return tt.a})),n.d(t,"cc",(function(){return nt.a})),n.d(t,"dc",(function(){return rt.a})),n.d(t,"ec",(function(){return at.a})),n.d(t,"fc",(function(){return ct})),n.d(t,"hc",(function(){return w.a})),n.d(t,"ic",(function(){return st})),n.d(t,"jc",(function(){return lt.a})),n.d(t,"kc",(function(){return ft.a})),n.d(t,"mc",(function(){return dt.a})),n.d(t,"nc",(function(){return ht.a})),n.d(t,"oc",(function(){return Qe.a})),n.d(t,"pc",(function(){return pt.a})),n.d(t,"rc",(function(){return vt})),n.d(t,"sc",(function(){return mt.a})),n.d(t,"tc",(function(){return bt})),n.d(t,"uc",(function(){return gt})),n.d(t,"vc",(function(){return yt})),n.d(t,"wc",(function(){return xt})),n.d(t,"xc",(function(){return Ot.a})),n.d(t,"yc",(function(){return kt.a})),n.d(t,"zc",(function(){return wt.a})),n.d(t,"Ac",(function(){return jt.a})),n.d(t,"Bc",(function(){return _t.a})),n.d(t,"Cc",(function(){return St})),n.d(t,"Dc",(function(){return Ct})),n.d(t,"Ec",(function(){return At})),n.d(t,"Fc",(function(){return Nt.a})),n.d(t,"Gc",(function(){return Tt.a})),n.d(t,"Hc",(function(){return It.a})),n.d(t,"Ic",(function(){return Dt.a})),n.d(t,"Jc",(function(){return Ft.a})),n.d(t,"Kc",(function(){return Mt.a})),n.d(t,"Lc",(function(){return ye.a})),n.d(t,"Mc",(function(){return Rt.a})),n.d(t,"Nc",(function(){return zt})),n.d(t,"Oc",(function(){return Lt})),n.d(t,"Pc",(function(){return Pt})),n.d(t,"Qc",(function(){return Bt})),n.d(t,"Sc",(function(){return Wt.a})),n.d(t,"Tc",(function(){return Ut.a})),n.d(t,"Uc",(function(){return Vt.a})),n.d(t,"Wc",(function(){return qt.a})),n.d(t,"Xc",(function(){return Ht.a})),n.d(t,"Yc",(function(){return Gt.a})),n.d(t,"Zc",(function(){return _.a})),n.d(t,"ad",(function(){return Kt.a})),n.d(t,"cd",(function(){return Xt.a})),n.d(t,"dd",(function(){return Yt.a})),n.d(t,"ed",(function(){return S.a})),n.d(t,"fd",(function(){return $t})),n.d(t,"gd",(function(){return Jt})),n.d(t,"hd",(function(){return Qt})),n.d(t,"id",(function(){return Zt})),n.d(t,"jd",(function(){return en.a})),n.d(t,"kd",(function(){return tn.a})),n.d(t,"ld",(function(){return nn.a})),n.d(t,"mb",(function(){return rn.a})),n.d(t,"vb",(function(){return an.a})),n.d(t,"zb",(function(){return on.a})),n.d(t,"Rc",(function(){return un.a})),n.d(t,"pd",(function(){return cn.a})),n.d(t,"qd",(function(){return sn.a})),n.d(t,"rd",(function(){return ot.a})),n.d(t,"sd",(function(){return ln.a})),n.d(t,"td",(function(){return fn.a})),n.d(t,"ud",(function(){return dn.a})),n.d(t,"vd",(function(){return hn.a})),n.d(t,"wd",(function(){return pn.a})),n.d(t,"xd",(function(){return ut.a})),n.d(t,"yd",(function(){return vn.a})),n.d(t,"zd",(function(){return mn.a})),n.d(t,"Ad",(function(){return E.a})),n.d(t,"Bd",(function(){return bn.a})),n.d(t,"Cd",(function(){return gn.a})),n.d(t,"Dd",(function(){return xn})),n.d(t,"Ed",(function(){return On.a})),n.d(t,"Fd",(function(){return kn})),n.d(t,"Gd",(function(){return wn})),n.d(t,"Hd",(function(){return jn})),n.d(t,"Id",(function(){return xe.a})),n.d(t,"Jd",(function(){return _n.a})),n.d(t,"Ld",(function(){return Sn.a})),n.d(t,"Md",(function(){return En.a})),n.d(t,"Nd",(function(){return Cn.a})),n.d(t,"Od",(function(){return An.a})),n.d(t,"Pd",(function(){return Nn})),n.d(t,"Qd",(function(){return Tn.a})),n.d(t,"Rd",(function(){return In.a})),n.d(t,"Sd",(function(){return Dn.a})),n.d(t,"Td",(function(){return Fn.a})),n.d(t,"y",(function(){return Pn})),n.d(t,"Kd",(function(){return Bn.a})),n.d(t,"lc",(function(){return Wn.a})),n.d(t,"gc",(function(){return Vn})),n.d(t,"Vc",(function(){return qn.a})),n.d(t,"nd",(function(){return Hn.a})),n.d(t,"sb",(function(){return Gn.a})),n.d(t,"cb",(function(){return Kn})),n.d(t,"fb",(function(){return Xn})),n.d(t,"S",(function(){return Yn})),n.d(t,"yb",(function(){return Jn})),n.d(t,"qc",(function(){return j.b})),n.d(t,"a",(function(){return j.a})),n.d(t,"xb",(function(){return Jr})),n.d(t,"Gb",(function(){return Qr})),n.d(t,"Sb",(function(){return Zr})),n.d(t,"od",(function(){return Yr})),n.d(t,"qb",(function(){return r})),n.d(t,"bd",(function(){return $r})),n.d(t,"md",(function(){return ea}));var r={};n.r(r),n.d(r,"conv2d",(function(){return ir})),n.d(r,"depthwiseConv2d",(function(){return cr})),n.d(r,"matMul",(function(){return sr}));var a=n(54),i=n(252),o=n(253),u=n(26),c=n(254),s=n(184),l=n(185),f=n(186),d=n(187),h=n(255),p=n(256),v=n(257),m=n(188),b=n(258),g=n(135),y=n(259),x=n(6),O=n(45),k=n(36),w=n(20),j=n(11),_=n(77),S=n(40),E=n(166);var C=Object(j.b)({basicLSTMCell_:function(e,t,n,r,a,i){var o=Object(x.a)(e,"forgetBias","basicLSTMCell"),c=Object(x.a)(t,"lstmKernel","basicLSTMCell"),s=Object(x.a)(n,"lstmBias","basicLSTMCell"),l=Object(x.a)(r,"data","basicLSTMCell"),f=Object(x.a)(a,"c","basicLSTMCell"),d=Object(x.a)(i,"h","basicLSTMCell"),h=Object(O.a)([l,d],1),p=Object(k.a)(h,c),v=Object(u.a)(p,s),m=v.shape[0],b=v.shape[1]/4,g=[m,b],y=Object(S.a)(v,[0,0],g),j=Object(S.a)(v,[0,b],g),C=Object(S.a)(v,[0,2*b],g),A=Object(S.a)(v,[0,3*b],g),N=Object(u.a)(Object(w.a)(Object(_.a)(y),Object(E.a)(j)),Object(w.a)(f,Object(_.a)(Object(u.a)(o,C))));return[N,Object(w.a)(Object(E.a)(N),Object(_.a)(A))]}}),A=n(103),N=n(92),T=n(19);var I=Object(j.b)({batchNorm2d_:function(e,t,n,r,a,i){var o,u,c=Object(x.a)(e,"x","batchNorm"),s=Object(x.a)(t,"mean","batchNorm"),l=Object(x.a)(n,"variance","batchNorm");return null!=a&&(o=Object(x.a)(a,"scale","batchNorm")),null!=r&&(u=Object(x.a)(r,"offset","batchNorm")),T.b(2===c.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(c.rank,".")})),T.b(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,".")})),T.b(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&T.b(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&T.b(2===u.rank||1===u.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")})),Object(N.a)(c,s,l,u,o,i)}});var D=Object(j.b)({batchNorm3d_:function(e,t,n,r,a,i){var o,u,c=Object(x.a)(e,"x","batchNorm"),s=Object(x.a)(t,"mean","batchNorm"),l=Object(x.a)(n,"variance","batchNorm");return null!=a&&(o=Object(x.a)(a,"scale","batchNorm")),null!=r&&(u=Object(x.a)(r,"offset","batchNorm")),T.b(3===c.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(c.rank,".")})),T.b(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,".")})),T.b(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&T.b(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&T.b(3===u.rank||1===u.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")})),Object(N.a)(c,s,l,u,o,i)}});var F=Object(j.b)({batchNorm4d_:function(e,t,n,r,a,i){var o,u,c=Object(x.a)(e,"x","batchNorm"),s=Object(x.a)(t,"mean","batchNorm"),l=Object(x.a)(n,"variance","batchNorm");return null!=a&&(o=Object(x.a)(a,"scale","batchNorm")),null!=r&&(u=Object(x.a)(r,"offset","batchNorm")),T.b(4===c.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(c.rank,".")})),T.b(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,".")})),T.b(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&T.b(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&T.b(4===u.rank||1===u.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")})),Object(N.a)(c,s,l,u,o,i)}}),M=n(260),R=n(112),z=n(57),L=n(24),P=n(261),B=n(262),W=n(76),U=n(67);var V=Object(j.b)({concat1d_:function(e){return Object(O.a)(e,0)}});var q=Object(j.b)({concat2d_:function(e,t){return Object(O.a)(e,t)}});var H=Object(j.b)({concat3d_:function(e,t){return Object(O.a)(e,t)}});var G=Object(j.b)({concat4d_:function(e,t){return Object(O.a)(e,t)}}),K=n(189),X=n(73),Y=n(190),$=n(263),J=n(220);var Q=Object(j.b)({conv3dTranspose_:function(e,t,n,r,a){var i=Object(x.a)(e,"x","conv3dTranspose"),o=Object(x.a)(t,"filter","conv3dTranspose");return Object(J.a)(n,i,o,r,a)}}),Z=n(136),ee=n(191),te=n(137),ne=n(264),re=n(192),ae=n(104),ie=n(12),oe=n(7);var ue=Object(j.b)({diag_:function(e){var t={x:Object(x.a)(e,"x","diag")};return ie.a.runKernel(oe.R,t)}}),ce=n(193),se=n(28),le=n(194),fe=n(195),de=n(265),he=n(138),pe=n(105),ve=n(266),me=n(53),be=n(71),ge=n(267),ye=n(18),xe=n(93);var Oe=Object(j.b)({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=Object(z.a)([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var u=Object(ye.a)(a.toTensor(),[e,t]);if(null==n)return u;if(1===n.length)return Object(xe.a)(Object(be.a)(u,0),[n[0],1,1]);if(2===n.length)return Object(xe.a)(Object(be.a)(Object(be.a)(u,0),0),[n[0],n[1],1,1]);if(3===n.length)return Object(xe.a)(Object(be.a)(Object(be.a)(Object(be.a)(u,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),ke=n(134),we=n(139),je=n(133),_e=n(106),Se=n(59),Ee=n(74),Ce=n(140),Ae=n(268),Ne=n(269),Te=n(270),Ie=n(141),De=n(142),Fe=n(75),Me=n(271),Re=n(196),ze=n(83),Le=n(197),Pe=n(272),Be=n(273),We=n(143),Ue=n(68),Ve=n(107),qe=n(144),He=n(199),Ge=n(78),Ke=n(145),Xe=n(274),Ye=n(275),$e=n(102),Je=n(96),Qe=n(64),Ze=n(16);function et(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.indexing,a=void 0===r?"xy":r;if("xy"!==a&&"ij"!==a)throw new TypeError("".concat(a," is not a valid third argument to meshgrid"));if(void 0===e)return[];var i=Object(x.a)(e,"x","meshgrid",e instanceof Ze.a?e.dtype:"float32");if(void 0===t)return[i];var o=Object(x.a)(t,"y","meshgrid",t instanceof Ze.a?t.dtype:"float32"),u=Object(T.O)(i.shape),c=Object(T.O)(o.shape);return"xy"===a?(i=Object(ye.a)(i,[1,-1]),o=Object(ye.a)(o,[-1,1]),[Object(k.a)(Object(Qe.a)([c,1],i.dtype),i),Object(k.a)(o,Object(Qe.a)([1,u],o.dtype))]):(i=Object(ye.a)(i,[-1,1]),o=Object(ye.a)(o,[1,-1]),[Object(k.a)(i,Object(Qe.a)([1,c],i.dtype)),Object(k.a)(Object(Qe.a)([u,1],o.dtype),o)])}var tt=n(117),nt=n(146),rt=n(200),at=n(201),it=n(51),ot=n(37),ut=n(27);var ct=Object(j.b)({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Object(x.a)(e,"x","moments");var r=Object(T.I)(t,e.shape),a=Object(Je.a)(e,r,n),i=a.shape;n||(i=Object(it.e)(a.shape,r));var o=Object(ot.a)(Object(ut.a)(Object(L.a)(e,"float32"),Object(ye.a)(a,i))),u=Object(Je.a)(o,r,n);return{mean:a,variance:u}}});var st=Object(j.b)({multiRNNCell_:function(e,t,n,r){for(var a=Object(x.a)(t,"data","multiRNNCell"),i=Object(x.b)(n,"c","multiRNNCell"),o=Object(x.b)(r,"h","multiRNNCell"),u=a,c=[],s=0;s<e.length;s++){var l=e[s](u,i[s],o[s]);c.push(l[0]),c.push(l[1]),u=l[1]}for(var f=[],d=[],h=0;h<c.length;h+=2)f.push(c[h]),d.push(c[h+1]);return[f,d]}}),lt=n(276),ft=n(41),dt=n(147),ht=n(118),pt=n(277);var vt=Object(j.b)({outerProduct_:function(e,t){var n=Object(x.a)(e,"v1","outerProduct"),r=Object(x.a)(t,"v2","outerProduct");T.b(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=Object(ye.a)(n,[-1,1]),i=Object(ye.a)(r,[1,-1]);return Object(k.a)(a,i)}}),mt=n(65);var bt=Object(j.b)({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(T.b)(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Object(mt.a)(e,[t],n)}});var gt=Object(j.b)({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(T.b)(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(mt.a)(e,t,n)}});var yt=Object(j.b)({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(T.b)(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(mt.a)(e,t,n)}});var xt=Object(j.b)({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(T.b)(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(mt.a)(e,t,n)}}),Ot=n(202),kt=n(63),wt=n(148),jt=n(183),_t=n(203);var St=Object(j.b)({rand_:function(e,t,n){var r=Object(T.O)(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return ie.a.makeTensor(a,e,n)}}),Et=n(113);var Ct=Object(j.b)({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var i=new Et.b(t,n,r,a),o=Object(z.a)(e,r),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}});var At=Object(j.b)({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new Et.a(t,n,r,!1,a),o=Object(z.a)(e,r),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}}),Nt=n(204),Tt=n(167),It=n(119),Dt=n(278),Ft=n(89),Mt=n(149),Rt=n(58);var zt=Object(j.b)({reverse1d_:function(e){var t=Object(x.a)(e,"x","reverse");return T.b(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),Object(Rt.a)(t,0)}});var Lt=Object(j.b)({reverse2d_:function(e,t){var n=Object(x.a)(e,"x","reverse");return T.b(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),Object(Rt.a)(n,t)}});var Pt=Object(j.b)({reverse3d_:function(e,t){var n=Object(x.a)(e,"x","reverse");return T.b(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),Object(Rt.a)(n,t)}});var Bt=Object(j.b)({reverse4d_:function(e,t){var n=Object(x.a)(e,"x","reverse");return T.b(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),Object(Rt.a)(n,t)}}),Wt=n(279),Ut=n(205),Vt=n(29),qt=n(206),Ht=n(207),Gt=n(280),Kt=n(281),Xt=n(208),Yt=n(209);var $t=Object(j.b)({slice1d_:function(e,t,n){var r=Object(x.a)(e,"x","slice1d");return T.b(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,[t],[n])}});var Jt=Object(j.b)({slice2d_:function(e,t,n){var r=Object(x.a)(e,"x","slice2d");return T.b(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,t,n)}});var Qt=Object(j.b)({slice3d_:function(e,t,n){var r=Object(x.a)(e,"x","slice3d");return T.b(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,t,n)}});var Zt=Object(j.b)({slice4d_:function(e,t,n){var r=Object(x.a)(e,"x","slice4d");return T.b(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,t,n)}}),en=n(282),tn=n(198),nn=n(108),rn=n(150),an=n(120),on=n(210),un=n(151),cn=n(84),sn=n(50),ln=n(152),fn=n(109),dn=n(69),hn=n(90),pn=n(283),vn=n(31),mn=n(284),bn=n(111),gn=n(85),yn=n(60);function xn(e,t,n){if(Object(T.d)(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Object(x.c)(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Object(yn.a)(e,t,r,n)}var On=n(211);function kn(e,t,n){if(Object(T.d)(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Object(x.c)(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Object(yn.a)(e,t,r,n)}function wn(e,t,n){if(Object(T.d)(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Object(x.c)(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Object(yn.a)(e,t,r,n)}function jn(e,t,n){if(Object(T.d)(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Object(x.c)(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Object(yn.a)(e,t,r,n)}var _n=n(212),Sn=n(285),En=n(213),Cn=n(153),An=n(91);function Nn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return ie.a.makeVariable(e,t,n,r)}var Tn=n(49),In=n(214),Dn=n(88),Fn=n(32),Mn=n(4),Rn=n.n(Mn),zn=n(17);function Ln(){return(Ln=Object(zn.a)(Rn.a.mark((function e(t,n,r){var a,i,o,u,c,s,l,f,d,h,p,v,m;return Rn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=Object(x.a)(t,"tensor","boolMask"),i=Object(x.a)(n,"mask","boolMask","bool"),o=null==r?0:r,u=i.rank,c=a.shape,T.b(u>0,(function(){return"mask cannot be scalar"})),T.e(c.slice(o,o+u),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),s=1,l=o;l<o+u;l++)s*=c[l];return f=c.slice(0,o).concat([s],c.slice(o+u)),d=Object(ye.a)(a,f),h=Object(ye.a)(i,[-1]),e.next=14,Object(In.a)(h);case 14:return p=e.sent,v=Object(fn.a)(p,[1]),m=Object(_e.a)(d,v,o),t!==a&&a.dispose(),n!==i&&i.dispose(),v.dispose(),d.dispose(),h.dispose(),p.dispose(),e.abrupt("return",m);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pn=function(e,t,n){return Ln.apply(this,arguments)},Bn=n(61),Wn=n(154),Un=n(35);var Vn=Object(j.b)({movingAverage_:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=Object(x.a)(e,"v","movingAverage"),o=Object(x.a)(t,"x","movingAverage"),c=Object(x.a)(n,"decay","movingAverage");Object(Un.assertTypesMatch)(i,o),T.b(T.a(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var s=Object(Vt.a)(1),l=Object(ut.a)(s,c),f=Object(w.a)(Object(ut.a)(o,i),l);if(a){T.b(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var d=Object(x.a)(r,"step","movingAverage");f=Object(se.a)(f,Object(ut.a)(s,Object(kt.a)(c,d)))}return Object(u.a)(i,f)}}),qn=n(286),Hn=n(299),Gn=n(287);var Kn=Object(j.b)({dropout_:function(e,t,n,r){var a=Object(x.a)(e,"x","dropout");if(T.b("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),T.b(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof Ze.a?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(T.a(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,c=Object(se.a)(Object(we.a)(Object(u.a)(Object(Nt.a)(i,0,1,"float32",r),o)),o);return Object(w.a)(a,c)}});function Xn(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Yn(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Object(gn.a)(a,"float32")}function $n(){return($n=Object(zn.a)(Rn.a.mark((function e(t,n){var r,a,i,o,u,c,s,l,f,d,h,p,v,m,b,g=arguments;return Rn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g.length>2&&void 0!==g[2]?g[2]:1,a=Object(x.a)(t,"predictions","inTopK"),i=Object(x.a)(n,"targets","inTopK"),Object(T.b)(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),Object(T.b)(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(i.rank)})),Object(T.e)(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],Object(T.b)(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),e.next=10,a.data();case 10:return u=e.sent,e.next=13,i.data();case 13:c=e.sent,s=u.length/o,l=o,f=Object(T.o)("bool",s),d=0;case 17:if(!(d<s)){e.next=35;break}for(h=d*l,p=u.subarray(h,h+l),v=[],m=0;m<p.length;m++)v.push({value:p[m],index:m});v.sort((function(e,t){return t.value-e.value})),f[d]=0,b=0;case 25:if(!(b<r)){e.next=32;break}if(v[b].index!==c[d]){e.next=29;break}return f[d]=1,e.abrupt("break",32);case 29:b++,e.next=25;break;case 32:d++,e.next=17;break;case 35:return t!==a&&a.dispose(),n!==i&&i.dispose(),e.abrupt("return",Object(bn.a)(f,i.shape,"bool"));case 38:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Jn=function(e,t){return $n.apply(this,arguments)},Qn=n(8),Zn=n(47),er=n(30),tr=n(159),nr=n(156),rr=n(42),ar=n(55);var ir=Object(j.b)({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,c=e.dilations,s=void 0===c?[1,1]:c,l=e.dimRoundingMode,f=e.bias,d=e.activation,h=void 0===d?"linear":d,p=e.preluActivationWeights,v=e.leakyreluAlpha;if(h=h||"linear",!1===Object(ar.d)(ie.a.state.gradientDepth,h)){var m=Object(X.a)(t,n,r,a,o,s,l);return null!=f&&(m=Object(u.a)(m,f)),Object(ar.a)(m,h,p,v)}var b=Object(x.a)(t,"x","conv2d"),g=Object(x.a)(n,"filter","conv2d"),y=b,O=!1;3===b.rank&&(O=!0,y=Object(ye.a)(b,[1,b.shape[0],b.shape[1],b.shape[2]])),T.b(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),T.b(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")})),null!=l&&T.b(T.v(a),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(a,".")})),T.b(y.shape[3]===g.shape[2],(function(){return"Error in conv2d: depth of input (".concat(y.shape[3],") must match ")+"input depth for filter ".concat(g.shape[2],".")})),T.b(rr.h(r,s),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(s,"'")})),T.b("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var k,w,j=rr.a(y.shape,g.shape,r,s,a,l);if(null!=f){k=Object(x.a)(f,"bias","fused conv2d");var _=Object(Un.makeTypesMatch)(k,b);k=Object(Qn.a)(_,1)[0],er.a(j.outShape,k.shape)}null!=p&&(w=Object(x.a)(p,"prelu weights","fused conv2d"));var S=function(e,t){var n=Object(Qn.a)(t,4),i=n[0],o=n[1],u=n[2],c=n[3],l=Object(ar.c)(e,u,h);T.b(rr.i(s),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(s,"'")}));var f=[Object(nr.a)(o.shape,l,i,r,a),Object(tr.a)(o,l,i.shape,r,a)];if(null!=c){var d=Object(ar.b)(c,l);f.push(d)}return f},E={x:y,filter:g,bias:k,preluActivationWeights:w},C={strides:r,pad:a,dataFormat:o,dilations:s,dimRoundingMode:l,activation:h,leakyreluAlpha:v};return null==f?Object(Zn.a)((function(e,t,n){var r=ie.a.runKernel(oe.kb,E,C);return n([t,e,r]),O&&(r=Object(ye.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}}))(y,g):Object(Zn.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.kb,E,C);return r([t,e,a,n]),O&&(a=Object(ye.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:S}}))(y,g,k)}}),or=n(224),ur=n(223);var cr=Object(j.b)({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,c=e.dilations,s=void 0===c?[1,1]:c,l=e.dimRoundingMode,f=e.bias,d=e.activation,h=void 0===d?"linear":d,p=e.preluActivationWeights,v=e.leakyreluAlpha;if(!1===Object(ar.d)(ie.a.state.gradientDepth,h)){var m=Object(ae.a)(t,n,r,a,o,s,l);return null!=f&&(m=Object(u.a)(m,f)),Object(ar.a)(m,h,p,v)}var b=Object(x.a)(t,"x","depthwiseConv2d"),g=Object(x.a)(n,"filter","depthwiseConv2d"),y=b,O=!1;3===b.rank&&(O=!0,y=Object(ye.a)(b,[1,b.shape[0],b.shape[1],b.shape[2]])),T.b(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(y.rank,".")})),T.b(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")})),T.b(y.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(y.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")})),null==s&&(s=[1,1]),T.b(rr.h(r,s),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(s,"'")})),null!=l&&T.b(T.v(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(l," but got pad ").concat(a,".")}));var k,w,j=rr.a(y.shape,g.shape,r,s,a,l,!0);if(null!=f){k=Object(x.a)(f,"bias","fused conv2d");var _=Object(Un.makeTypesMatch)(k,b),S=Object(Qn.a)(_,1);k=S[0],er.a(j.outShape,k.shape)}null!=p&&(w=Object(x.a)(p,"prelu weights","fused depthwiseConv2d"));var E=function(e,t){T.b(rr.i(s),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var n=Object(Qn.a)(t,4),i=n[0],o=n[1],u=n[2],c=n[3],f=Object(ar.c)(e,u,h),d=Object(ur.a)(o.shape,f,i,r,a,s,l),p=Object(or.a)(o,f,i.shape,r,a,s,l);return null!=c?[d,p,Object(ar.b)(k,f)]:[d,p]},C={x:y,filter:g,bias:k,preluActivationWeights:w},A={strides:r,pad:a,dataFormat:o,dilations:s,dimRoundingMode:l,activation:h,leakyreluAlpha:v};return null==f?Object(Zn.a)((function(e,t,n){var r=ie.a.runKernel(oe.lb,C,A);return n([t,e,r]),O&&(r=Object(ye.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:E}}))(y,g):Object(Zn.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.lb,C,A);return r([t,e,a,n]),O&&(a=Object(ye.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:E}}))(y,g,k)}});var sr=Object(j.b)({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,c=e.bias,s=e.activation,l=void 0===s?"linear":s,f=e.preluActivationWeights,d=e.leakyreluAlpha;if(!1===Object(ar.d)(ie.a.state.gradientDepth,l)){var h=Object(k.a)(t,n,a,o);return null!=c&&(h=Object(u.a)(h,c)),Object(ar.a)(h,l,f,d)}var p=Object(x.a)(t,"a","fused matMul"),v=Object(x.a)(n,"b","fused matMul"),m=Object(Un.makeTypesMatch)(p,v),b=Object(Qn.a)(m,2);p=b[0],v=b[1];var g=a?p.shape[p.rank-2]:p.shape[p.rank-1],y=o?v.shape[v.rank-1]:v.shape[v.rank-2],O=a?p.shape[p.rank-1]:p.shape[p.rank-2],w=o?v.shape[v.rank-2]:v.shape[v.rank-1],j=p.shape.slice(0,-2),_=v.shape.slice(0,-2),S=T.O(j),E=T.O(_);T.b(p.rank>=2&&v.rank>=2&&p.rank===v.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at "+"least 2, got ranks ".concat(p.rank," and ").concat(v.rank,".")})),T.b(T.a(j,_),(function(){return"Error in fused matMul: outer dimensions (".concat(j,") and (")+"".concat(_,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(v.shape," must match.")})),T.b(g===y,(function(){return"Error in fused matMul: inner shapes (".concat(g,") and (")+"".concat(y,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(v.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var C,A,N=p.shape.slice(0,-2).concat([O,w]),I=a?Object(ye.a)(p,[S,g,O]):Object(ye.a)(p,[S,O,g]),D=o?Object(ye.a)(v,[E,w,y]):Object(ye.a)(v,[E,y,w]);if(null!=c){C=Object(x.a)(c,"bias","fused matMul");var F=Object(Un.makeTypesMatch)(C,p);C=Object(Qn.a)(F,1)[0],er.a(N,C.shape)}null!=f&&(A=Object(x.a)(f,"prelu weights","fused matMul"));var M=function(e,t){var n,r,i=Object(Qn.a)(t,4),u=i[0],s=i[1],f=i[2],d=i[3],h=Object(ar.c)(Object(ye.a)(e,f.shape),f,l);return a||o?!a&&o?(n=Object(k.a)(h,s,!1,!1),r=Object(k.a)(h,u,!0,!1)):a&&!o?(n=Object(k.a)(s,h,!1,!0),r=Object(k.a)(u,h,!1,!1)):(n=Object(k.a)(s,h,!0,!0),r=Object(k.a)(h,u,!0,!0)):(n=Object(k.a)(h,s,!1,!0),r=Object(k.a)(u,h,!0,!1)),null!=c?[n,r,Object(ar.b)(d,h)]:[n,r]},R={a:I,b:D,bias:C,preluActivationWeights:A},z={transposeA:a,transposeB:o,activation:l,leakyreluAlpha:d};return null==c?Object(Zn.a)((function(e,t,n){var r=ie.a.runKernel(oe.dd,R,z);return n([e,t,r]),{value:Object(ye.a)(r,N),gradFunc:M}}))(I,D):Object(Zn.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.dd,R,z);return r([e,t,a,n]),{value:Object(ye.a)(a,N),gradFunc:M}}))(I,D,C)}});var lr=Object(j.b)({hammingWindow_:function(e){return Yn(e,.54,.46)}});var fr=Object(j.b)({hannWindow_:function(e){return Yn(e,.5,.5)}});var dr=Object(j.b)({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(Object(S.a)(e,i,t)),i+=n;if(r)for(;i<e.size;){var u=i+t-e.size,c=Object(O.a)([Object(S.a)(e,i,t-u),Object(ke.a)([u],a)]);o.push(c),i+=n}return 0===o.length?xn([],[0,t]):Object(ye.a)(Object(O.a)(o),[o.length,t])}});var hr=Object(j.b)({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:fr;null==r&&(r=Xn(t));var i=dr(e,t,n),o=Object(w.a)(i,a(t));return Object(un.a)(o,r)}});var pr=Object(j.b)({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Object(x.a)(e,"image","cropAndResize"),u=Object(x.a)(t,"boxes","cropAndResize","float32"),c=Object(x.a)(n,"boxInd","cropAndResize","int32"),s=u.shape[0];T.b(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),T.b(2===u.rank&&4===u.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(s,",4] ")+"but had shape ".concat(u.shape,".")})),T.b(1===c.rank&&c.shape[0]===s,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(s,"] ")+"but had shape ".concat(u.shape,".")})),T.b(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),T.b(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),T.b("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:u,boxInd:c},f={method:a,extrapolationValue:i,cropSize:r},d=ie.a.runKernel(oe.K,l,f);return d}});var vr=Object(j.b)({flipLeftRight_:function(e){var t=Object(x.a)(e,"image","flipLeftRight","float32");T.b(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return ie.a.runKernel(oe.fb,n,{})}});var mr=Object(j.b)({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=Object(x.a)(e,"image","rotateWithOffset","float32");T.b(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r},u=ie.a.runKernel(oe.vc,i,o);return u}});function br(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),T.b(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),T.b(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),T.b(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),T.b(1===t.rank,(function(){return"scores must be a 1D tensor"})),T.b(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),T.b(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var gr=Object(j.b)({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=Object(x.a)(e,"boxes","nonMaxSuppression"),o=Object(x.a)(t,"scores","nonMaxSuppression"),u=br(i,o,n,r,a),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold};return ie.a.runKernel(oe.Xb,{boxes:i,scores:o},c)}}),yr=n(87);function xr(){return(xr=Object(zn.a)(Rn.a.mark((function e(t,n,r){var a,i,o,u,c,s,l,f,d,h,p=arguments;return Rn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>3&&void 0!==p[3]?p[3]:.5,i=p.length>4&&void 0!==p[4]?p[4]:Number.NEGATIVE_INFINITY,o=Object(x.a)(t,"boxes","nonMaxSuppressionAsync"),u=Object(x.a)(n,"scores","nonMaxSuppressionAsync"),c=br(o,u,r,a,i),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,e.next=10,Promise.all([o.data(),u.data()]);case 10:return s=e.sent,l=s[0],f=s[1],d=Object(yr.a)(l,f,r,a,i),h=d.selectedIndices,o!==t&&o.dispose(),u!==n&&u.dispose(),e.abrupt("return",Object(gn.a)(h,"int32"));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Or=function(e,t,n){return xr.apply(this,arguments)};var kr=Object(j.b)({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Object(x.a)(e,"boxes","nonMaxSuppression"),u=Object(x.a)(t,"scores","nonMaxSuppression"),c=br(o,u,n,r,a,i),s={boxes:o,scores:u},l={maxOutputSize:n=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:a=c.scoreThreshold,softNmsSigma:i=c.softNmsSigma},f=ie.a.runKernel(oe.Zb,s,l);return{selectedIndices:f[0],selectedScores:f[1]}}});function wr(){return(wr=Object(zn.a)(Rn.a.mark((function e(t,n,r){var a,i,o,u,c,s,l,f,d,h,p,v,m=arguments;return Rn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=m.length>3&&void 0!==m[3]?m[3]:.5,i=m.length>4&&void 0!==m[4]?m[4]:Number.NEGATIVE_INFINITY,o=m.length>5&&void 0!==m[5]?m[5]:0,u=Object(x.a)(t,"boxes","nonMaxSuppressionAsync"),c=Object(x.a)(n,"scores","nonMaxSuppressionAsync"),s=br(u,c,r,a,i,o),r=s.maxOutputSize,a=s.iouThreshold,i=s.scoreThreshold,o=s.softNmsSigma,e.next=12,Promise.all([u.data(),c.data()]);case 12:return l=e.sent,f=l[0],d=l[1],h=Object(yr.c)(f,d,r,a,i,o),p=h.selectedIndices,v=h.selectedScores,u!==t&&u.dispose(),c!==n&&c.dispose(),e.abrupt("return",{selectedIndices:Object(gn.a)(p,"int32"),selectedScores:Object(gn.a)(v)});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var jr=function(e,t,n){return wr.apply(this,arguments)};var _r=Object(j.b)({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Object(x.a)(e,"boxes","nonMaxSuppression"),u=Object(x.a)(t,"scores","nonMaxSuppression"),c=br(o,u,n,r,a,null),s=c.maxOutputSize,l=c.iouThreshold,f=c.scoreThreshold,d={boxes:o,scores:u},h={maxOutputSize:s,iouThreshold:l,scoreThreshold:f,padToMaxOutputSize:i},p=ie.a.runKernel(oe.Yb,d,h);return{selectedIndices:p[0],validOutputs:p[1]}}});function Sr(){return(Sr=Object(zn.a)(Rn.a.mark((function e(t,n,r){var a,i,o,u,c,s,l,f,d,h,p,v,m,b,g,y,O=arguments;return Rn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=O.length>3&&void 0!==O[3]?O[3]:.5,i=O.length>4&&void 0!==O[4]?O[4]:Number.NEGATIVE_INFINITY,o=O.length>5&&void 0!==O[5]&&O[5],u=Object(x.a)(t,"boxes","nonMaxSuppressionAsync"),c=Object(x.a)(n,"scores","nonMaxSuppressionAsync"),s=br(u,c,r,a,i,null),l=s.maxOutputSize,f=s.iouThreshold,d=s.scoreThreshold,e.next=11,Promise.all([u.data(),c.data()]);case 11:return h=e.sent,p=Object(Qn.a)(h,2),v=p[0],m=p[1],b=Object(yr.b)(v,m,l,f,d,o),g=b.selectedIndices,y=b.validOutputs,u!==t&&u.dispose(),c!==n&&c.dispose(),e.abrupt("return",{selectedIndices:Object(gn.a)(g,"int32"),validOutputs:Object(Vt.a)(y,"int32")});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Er=function(e,t,n){return Sr.apply(this,arguments)},Cr=n(222),Ar=n(221);var Nr=Object(j.b)({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=Object(x.a)(e,"image","transform","float32"),u=Object(x.a)(t,"transforms","transform","float32");T.b(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),T.b(2===u.rank&&(u.shape[0]===o.shape[0]||1===u.shape[0])&&8===u.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),T.b(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var c={image:o,transforms:u},s={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return ie.a.runKernel(oe.Xc,c,s)}});var Tr=Object(j.b)({bandPart_:function(e,t,n){Object(T.b)(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),Object(T.b)(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=Object(x.a)(e,"a","bandPart");Object(T.b)(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=r.shape.slice(-2),o=Object(Qn.a)(i,2),u=o[0],c=o[1];if(!(t<=u))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(u,")."));if(!(n<=c))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(c,")."));t<0&&(t=u),n<0&&(n=c);var s=Object(ye.a)(Object(Tt.a)(0,u,1,"int32"),[-1,1]),l=Object(Tt.a)(0,c,1,"int32"),f=Object(ut.a)(s,l),d=Object(Ue.a)(Object(Fe.a)(f,Object(Vt.a)(+t,"int32")),Object(Ee.a)(f,Object(Vt.a)(-n,"int32"))),h=Object(Dn.a)([u,c],r.dtype);return Object(ye.a)(Object(dn.a)(Object(An.a)(Object(ye.a)(r,[-1,u,c])).map((function(e){return Object(Tn.a)(d,e,h)}))),a)}});var Ir=Object(j.b)({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,Object(T.b)(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){Object(T.b)(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=Object(cn.a)(e,e.shape[0],0).map((function(e){return Object(fn.a)(e,[0])}))),Object(T.b)(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(ie.a.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var i=Object(w.a)(Object(vn.a)(Object(w.a)(n[a],t)),n[a]);t=Object(ut.a)(t,i)}return Object(se.a)(t,Object(Wn.a)(t,"euclidean"))})))},i=0;i<e.length;++i)a(i);return t?Object(dn.a)(n,0):n}}),Dr=n(38);function Fr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ie.a.tidy((function(){Object(T.b)(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=Oe(n),i=Object(W.a)(e),o=xn([[1]],[1,1]),u=Object(W.a)(o),c=n>=r?r:n,s=function(e){var t=i,c=u,s=a,l=ie.a.tidy((function(){var t=Object(S.a)(i,[e,e],[n-e,1]),c=Object(Wn.a)(t),s=Object(S.a)(i,[e,e],[1,1]),l=Object(Tn.a)(Object(Se.a)(s,0),xn([[-1]]),xn([[1]])),f=Object(ut.a)(s,Object(w.a)(l,c)),d=Object(se.a)(t,f);u=1===d.shape[0]?Object(W.a)(o):Object(O.a)([o,Object(S.a)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);var h=Object(ft.a)(Object(se.a)(Object(k.a)(l,f),c)),p=Object(S.a)(i,[e,0],[n-e,r]),v=Object(w.a)(h,u),m=Object(Bn.a)(u);if(0===e)i=Object(ut.a)(p,Object(k.a)(v,Object(k.a)(m,p)));else{var b=Object(ut.a)(p,Object(k.a)(v,Object(k.a)(m,p)));i=Object(O.a)([Object(S.a)(i,[0,0],[e,r]),b],0)}var g=Object(Bn.a)(v),y=Object(S.a)(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=Object(ut.a)(y,Object(k.a)(Object(k.a)(y,u),g));else{var x=Object(ut.a)(y,Object(k.a)(Object(k.a)(y,u),g));a=Object(O.a)([Object(S.a)(a,[0,0],[n,e]),x],1)}return[u,i,a]})),f=Object(Qn.a)(l,3);u=f[0],i=f[1],a=f[2],Object(Dr.d)([t,c,s])},l=0;l<c;++l)s(l);return!t&&n>r&&(a=Object(S.a)(a,[0,0],[n,r]),i=Object(S.a)(i,[0,0],[r,r])),[a,i]}))}var Mr=Object(j.b)({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(T.b)(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return Fr(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Object(An.a)(Object(ye.a)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach((function(e){var n=Fr(e,t),r=Object(Qn.a)(n,2),o=r[0],u=r[1];a.push(o),i.push(u)}));var o=Object(ye.a)(Object(dn.a)(a,0),e.shape),u=Object(ye.a)(Object(dn.a)(i,0),e.shape);return[o,u]}}),Rr=n(48);var zr=Object(j.b)({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Rr.a.SUM_BY_NONZERO_WEIGHTS,r=Object(x.a)(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=Object(x.a)(t,"weights","computeWeightedLoss"));var i=null==a?r:Object(w.a)(r,a);if(n===Rr.a.NONE)return i;if(n===Rr.a.SUM)return Object(vn.a)(i);if(n===Rr.a.MEAN){if(null==a)return Object(Je.a)(i);var o=r.size/a.size,u=Object(se.a)(Object(vn.a)(i),Object(vn.a)(a));return o>1?Object(se.a)(u,Object(Vt.a)(o)):u}if(n===Rr.a.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Object(se.a)(Object(vn.a)(i),Object(Vt.a)(r.size));var c=Object(w.a)(a,Object(Qe.a)(r.shape)),s=Object(L.a)(Object(vn.a)(Object(dt.a)(c,Object(Vt.a)(0))),"float32");return Object(se.a)(Object(vn.a)(i),s)}throw Error("Unknown reduction: ".concat(n))}});var Lr=Object(j.b)({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Rr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(x.a)(e,"labels","absoluteDifference"),o=Object(x.a)(t,"predictions","absoluteDifference"),u=null;null!=n&&(u=Object(x.a)(n,"weights","absoluteDifference")),Object(T.e)(i.shape,o.shape,"Error in absoluteDifference: ");var c=Object(a.a)(Object(ut.a)(i,o));return zr(c,u,r)}});var Pr=Object(j.b)({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Rr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(x.a)(e,"labels","cosineDistance"),o=Object(x.a)(t,"predictions","cosineDistance"),u=null;null!=r&&(u=Object(x.a)(r,"weights","cosineDistance")),Object(T.e)(i.shape,o.shape,"Error in cosineDistance: ");var c=Object(Vt.a)(1),s=Object(ut.a)(c,Object(vn.a)(Object(w.a)(i,o),n,!0));return zr(s,u,a)}});var Br=Object(j.b)({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Rr.a.SUM_BY_NONZERO_WEIGHTS,a=Object(x.a)(e,"labels","hingeLoss"),i=Object(x.a)(t,"predictions","hingeLoss"),o=null;null!=n&&(o=Object(x.a)(n,"weights","hingeLoss")),Object(T.e)(a.shape,i.shape,"Error in hingeLoss: ");var u=Object(Vt.a)(1);a=Object(ut.a)(Object(w.a)(Object(Vt.a)(2),a),u);var c=Object(Ft.a)(Object(ut.a)(u,Object(w.a)(a,i)));return zr(c,o,r)}});var Wr=Object(j.b)({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Rr.a.SUM_BY_NONZERO_WEIGHTS,o=Object(x.a)(e,"labels","huberLoss"),c=Object(x.a)(t,"predictions","huberLoss"),s=null;null!=n&&(s=Object(x.a)(n,"weights","huberLoss")),Object(T.e)(o.shape,c.shape,"Error in huberLoss: ");var l=Object(Vt.a)(r),f=Object(a.a)(Object(ut.a)(c,o)),d=Object(nt.a)(f,l),h=Object(ut.a)(f,d),p=Object(u.a)(Object(w.a)(Object(Vt.a)(.5),Object(ot.a)(d)),Object(w.a)(l,h));return zr(p,s,i)}});var Ur=Object(j.b)({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Rr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(x.a)(e,"labels","logLoss"),o=Object(x.a)(t,"predictions","logLoss"),c=null;null!=n&&(c=Object(x.a)(n,"weights","logLoss")),Object(T.e)(i.shape,o.shape,"Error in logLoss: ");var s=Object(Vt.a)(1),l=Object(Vt.a)(r),f=Object(ft.a)(Object(w.a)(i,Object(ze.a)(Object(u.a)(o,l)))),d=Object(w.a)(Object(ut.a)(s,i),Object(ze.a)(Object(u.a)(Object(ut.a)(s,o),l))),h=Object(ut.a)(f,d);return zr(h,c,a)}});var Vr=Object(j.b)({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Rr.a.SUM_BY_NONZERO_WEIGHTS,a=Object(x.a)(e,"labels","meanSquaredError"),i=Object(x.a)(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=Object(x.a)(n,"weights","meanSquaredError")),Object(T.e)(a.shape,i.shape,"Error in meanSquaredError: ");var u=Object(ln.a)(a,i);return zr(u,o,r)}});function qr(e,t){var n=Object(x.a)(e,"labels","sigmoidCrossEntropyWithLogits"),r=Object(x.a)(t,"logits","sigmoidCrossEntropyWithLogits");Object(T.e)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=Object(Ft.a)(r),o=Object(w.a)(r,n),c=Object(Le.a)(Object(me.a)(Object(ft.a)(Object(a.a)(r))));return Object(u.a)(Object(ut.a)(i,o),c)}var Hr=Object(j.b)({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Rr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(x.a)(e,"multiClassLabels","sigmoidCrossEntropy"),o=Object(x.a)(t,"logits","sigmoidCrossEntropy"),c=null;if(null!=n&&(c=Object(x.a)(n,"weights","sigmoidCrossEntropy")),Object(T.e)(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var s=Object(Vt.a)(r),l=Object(Vt.a)(1),f=Object(Vt.a)(.5);i=Object(u.a)(Object(w.a)(i,Object(ut.a)(l,s)),Object(w.a)(f,s))}var d=qr(i,o);return zr(d,c,a)}});function Gr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=Object(Zn.a)((function(e,t,r){var a=Object(We.a)(t,[n],!0),i=Object(ut.a)(Object(L.a)(t,"float32"),a);r([e,i]);var o=Object(ft.a)(Object(w.a)(i,e));return{value:Object(vn.a)(o,[n]),gradFunc:function(e,t){var r=Object(Qn.a)(t,2),a=r[0],i=r[1],o=Object(it.e)(e.shape,[n]);return[Object(w.a)(Object(ye.a)(e,o),Object(ut.a)(Object(L.a)(a,"float32"),Object(me.a)(i))),Object(w.a)(Object(ye.a)(e,o),Object(ut.a)(Object(me.a)(i),Object(L.a)(a,"float32")))]}}}));return r(e,t)}var Kr=Object(j.b)({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Rr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(x.a)(e,"onehotLabels","softmaxCrossEntropy"),o=Object(x.a)(t,"logits","softmaxCrossEntropy"),c=null;if(null!=n&&(c=Object(x.a)(n,"weights","softmaxCrossEntropy")),Object(T.e)(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var s=Object(Vt.a)(r),l=Object(Vt.a)(1),f=Object(Vt.a)(i.shape[1]);i=Object(u.a)(Object(w.a)(i,Object(ut.a)(l,s)),Object(se.a)(s,f))}var d=Gr(i,o);return zr(d,c,a)}});var Xr=Object(j.b)({sparseReshape_:function(e,t,n){var r=Object(x.a)(e,"inputIndices","sparseReshape"),a=Object(x.a)(t,"inputShape","sparseReshape"),i=Object(x.a)(n,"newShape","sparseReshape");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));var o={inputIndices:r,inputShape:a,newShape:i},u=ie.a.runKernel(oe.Jc,o);return{outputIndices:u[0],outputShape:u[1]}}}),Yr={fft:rn.a,ifft:an.a,rfft:un.a,irfft:on.a},$r={hammingWindow:lr,hannWindow:fr,frame:dr,stft:hr},Jr={flipLeftRight:vr,resizeNearestNeighbor:Ar.a,resizeBilinear:Cr.a,rotateWithOffset:mr,cropAndResize:pr,nonMaxSuppression:gr,nonMaxSuppressionAsync:Or,nonMaxSuppressionWithScore:kr,nonMaxSuppressionWithScoreAsync:jr,nonMaxSuppressionPadded:_r,nonMaxSuppressionPaddedAsync:Er,transform:Nr},Qr={bandPart:Tr,gramSchmidt:Ir,qr:Mr},Zr={absoluteDifference:Lr,computeWeightedLoss:zr,cosineDistance:Pr,hingeLoss:Br,huberLoss:Wr,logLoss:Ur,meanSquaredError:Vr,sigmoidCrossEntropy:Hr,softmaxCrossEntropy:Kr},ea={sparseReshape:Xr}},function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return m}));var r=n(8),a=n(4),i=n.n(a),o=n(17),u=n(3),c=n(10),s=n(19),l="tfjsflags",f=function(){function e(t){Object(u.a)(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=d,this.populateURLFlags()}return Object(c.a)(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(Object(s.x)(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=this.getQueryParams(this.global.location.search);if(l in t)t.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),a=Object(r.a)(n,2),i=a[0],o=a[1];e.urlFlags[i]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(i,o)}))}}}]),e}();function d(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return h(t,r[0],r[1]),r.join("=")})),t}function h(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function p(){return v}var v=null;function m(e){v=e}},function(e,t,n){"use strict";n.r(t),n.d(t,"makeTypesMatch",(function(){return o})),n.d(t,"assertTypesMatch",(function(){return u})),n.d(t,"isTensorInList",(function(){return c})),n.d(t,"getTensorsInContainer",(function(){return s}));var r=n(16),a=n(101),i=n(19);function o(e,t){if(e.dtype===t.dtype)return[e,t];var n=Object(a.c)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function u(e,t){Object(i.b)(e.dtype===t.dtype,(function(){return"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match")}))}function c(e,t){return t.some((function(t){return t.id===e.id}))}function s(e){var t=[];return l(e,t,new Set),t}function l(e,t,n){if(null!=e)if(e instanceof r.a)t.push(e);else if(a=e,Array.isArray(a)||"object"===typeof a){var a,i=e;for(var o in i){var u=i[o];n.has(u)||(n.add(u),l(u,t,n))}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(11);var s=Object(c.b)({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=Object(u.a)(e,"a","matMul"),l=Object(u.a)(t,"b","matMul"),f=Object(o.makeTypesMatch)(s,l),d=Object(r.a)(f,2),h={a:s=d[0],b:l=d[1]},p={transposeA:n,transposeB:c};return a.a.runKernel(i.s,h,p)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12),a=n(6),i=n(11);var o=Object(i.b)({square_:function(e){var t=Object(a.a)(e,"x","square");return r.a.runKernel("Square",{x:t},{})}})},function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return d})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"t",(function(){return v})),n.d(t,"d",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"u",(function(){return g})),n.d(t,"r",(function(){return y})),n.d(t,"o",(function(){return x})),n.d(t,"k",(function(){return O})),n.d(t,"q",(function(){return k})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return j})),n.d(t,"p",(function(){return _})),n.d(t,"a",(function(){return S})),n.d(t,"s",(function(){return E}));var r=n(12),a=n(34),i=n(16),o=n(35);function u(){Object(a.c)().set("PROD",!0)}function c(){Object(a.c)().set("DEBUG",!0)}function s(){Object(a.c)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(e){Object(a.c)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function f(){r.a.disposeVariables()}function d(){return r.a}function h(){return r.a.memory()}function p(e){return r.a.profile(e)}function v(e,t){return r.a.tidy(e,t)}function m(e){Object(o.getTensorsInContainer)(e).forEach((function(e){return e.dispose()}))}function b(e){return r.a.keep(e)}function g(e){return r.a.time(e)}function y(e){return r.a.setBackend(e)}function x(){return r.a.ready()}function O(){return r.a.backendName}function k(e){r.a.removeBackend(e)}function w(e){return r.a.findBackend(e)}function j(e){return r.a.findBackendFactory(e)}function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.a.registerBackend(e,t,n)}function S(){return r.a.backend}function E(e,t){Object(a.c)().setPlatform(e,t)}Object(i.e)(l)},function(e,t,n){"use strict";e.exports=n(432)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({slice_:function(e,t,n){var o=Object(i.a)(e,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");var u={x:o},c={begin:t,size:n};return r.a.runKernel(a.Fc,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({neg_:function(e){var t={x:Object(i.a)(e,"x","neg")};return r.a.runKernel(a.Wb,t)}})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"i",(function(){return b})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return y}));var r=n(8),a=n(13);function i(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0,u=e[3],s=[].concat(Object(a.a)(t),[u]),l=y(i);return c(e,s,n,o,r,null,null,l)}function o(e,t,n,a,i,o){var u,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=f(t),d=Object(r.a)(l,2),h=d[0],p=d[1];if("channelsLast"===s)u=[h,p,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));u=[h,p,e[1],e[1]]}return c(e,u,n,a,i,o,!1,s)}function u(e,t,n,a,i,o){var u,c,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",f=d(t),h=Object(r.a)(f,3),p=h[0],v=h[1],m=h[2];if("NDHWC"===l)c="channelsLast",u=[p,v,m,e[4],e[4]];else{if("NCDHW"!==l)throw new Error("Unknown dataFormat ".concat(l));c="channelsFirst",u=[p,v,m,e[1],e[1]]}return s(e,u,n,a,i,!1,c,o)}function c(e,t,n,a,i,o){var u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",s=-1,l=-1,d=-1,v=-1;if("channelsLast"===c){var m=Object(r.a)(e,4);s=m[0],l=m[1],d=m[2],v=m[3]}else{if("channelsFirst"!==c)throw new Error("Unknown dataFormat ".concat(c));var b=Object(r.a)(e,4);s=b[0],v=b[1],l=b[2],d=b[3]}var g,y=Object(r.a)(t,4),x=y[0],O=y[1],k=y[3],w=f(n),j=Object(r.a)(w,2),_=j[0],S=j[1],E=f(a),C=Object(r.a)(E,2),A=C[0],N=C[1],T=h(x,A),I=h(O,N),D=p(i,l,d,_,S,T,I,o,c),F=D.padInfo,M=D.outHeight,R=D.outWidth,z=u?k*v:k;return"channelsFirst"===c?g=[s,z,M,R]:"channelsLast"===c&&(g=[s,M,R,z]),{batchSize:s,dataFormat:c,inHeight:l,inWidth:d,inChannels:v,outHeight:M,outWidth:R,outChannels:z,padInfo:F,strideHeight:_,strideWidth:S,filterHeight:x,filterWidth:O,effectiveFilterHeight:T,effectiveFilterWidth:I,dilationHeight:A,dilationWidth:N,inShape:e,outShape:g,filterShape:t}}function s(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",c=arguments.length>7?arguments[7]:void 0,s=-1,l=-1,f=-1,p=-1,m=-1;if("channelsLast"===u){var b=Object(r.a)(e,5);s=b[0],l=b[1],f=b[2],p=b[3],m=b[4]}else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));var g=Object(r.a)(e,5);s=g[0],m=g[1],l=g[2],f=g[3],p=g[4]}var y,x=Object(r.a)(t,5),O=x[0],k=x[1],w=x[2],j=x[4],_=d(n),S=Object(r.a)(_,3),E=S[0],C=S[1],A=S[2],N=d(a),T=Object(r.a)(N,3),I=T[0],D=T[1],F=T[2],M=h(O,I),R=h(k,D),z=h(w,F),L=v(i,l,f,p,E,C,A,M,R,z,c),P=L.padInfo,B=L.outDepth,W=L.outHeight,U=L.outWidth,V=o?j*m:j;return"channelsFirst"===u?y=[s,V,B,W,U]:"channelsLast"===u&&(y=[s,B,W,U,V]),{batchSize:s,dataFormat:u,inDepth:l,inHeight:f,inWidth:p,inChannels:m,outDepth:B,outHeight:W,outWidth:U,outChannels:V,padInfo:P,strideDepth:E,strideHeight:C,strideWidth:A,filterDepth:O,filterHeight:k,filterWidth:w,effectiveFilterDepth:M,effectiveFilterHeight:R,effectiveFilterWidth:z,dilationDepth:I,dilationHeight:D,dilationWidth:F,inShape:e,outShape:y,filterShape:t}}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=h(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function f(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function d(e){return"number"===typeof e?[e,e,e]:e}function h(e,t){return t<=1?e:e+(e-1)*(t-1)}function p(e,t,n,r,a,i,o,u,c){var s,f,d;if("number"===typeof e){s={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,a){null==r&&(r=l(e,t,n));var i=e[0],o=e[1];return[m((i-t+2*r)/n+1,a),m((o-t+2*r)/n+1,a)]}([t,n],i,r,e,u);f=h[0],d=h[1]}else if("same"===e){f=Math.ceil(t/r),d=Math.ceil(n/a);var p=Math.max(0,(f-1)*r+i-t),v=Math.max(0,(d-1)*a+o-n),b=Math.floor(p/2),g=p-b,y=Math.floor(v/2);s={top:b,bottom:g,left:y,right:v-y,type:"SAME"}}else if("valid"===e)s={top:0,bottom:0,left:0,right:0,type:"VALID"},f=Math.ceil((t-i+1)/r),d=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var x="channelsLast"===c?e[1][0]:e[2][0],O="channelsLast"===c?e[1][1]:e[2][1],k="channelsLast"===c?e[2][0]:e[3][0],w="channelsLast"===c?e[2][1]:e[3][1];s={top:x,bottom:O,left:k,right:w,type:0===x&&0===O&&0===k&&0===w?"VALID":"EXPLICIT"},f=m((t-i+x+O)/r+1,u),d=m((n-o+k+w)/a+1,u)}return{padInfo:s,outHeight:f,outWidth:d}}function v(e,t,n,r,a,i,o,u,c,s,f){var d,h,p,v;if("number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var b=function(e,t,n,r,a,i){null==a&&(a=l(e,t,r));var o=e[0],u=e[1],c=e[2];return[m((o-t+2*a)/r+1,i),m((u-t+2*a)/r+1,i),m((c-t+2*a)/r+1,i),n]}([t,n,r,1],u,1,a,e,f);h=b[0],p=b[1],v=b[2]}else if("same"===e){var g=((h=Math.ceil(t/a))-1)*a+u-t,y=((p=Math.ceil(n/i))-1)*i+c-n,x=((v=Math.ceil(r/o))-1)*o+s-r,O=Math.floor(g/2),k=g-O,w=Math.floor(y/2),j=y-w,_=Math.floor(x/2);d={top:w,bottom:j,left:_,right:x-_,front:O,back:k,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: ".concat(e));d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-u+1)/a),p=Math.ceil((n-c+1)/i),v=Math.ceil((r-s+1)/o)}return{padInfo:d,outDepth:h,outHeight:p,outWidth:v}}function m(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function b(e){var t=f(e),n=Object(r.a)(t,3),a=n[0],i=n[1],o=n[2];return 1===a&&1===i&&1===o}function g(e,t){return b(e)||b(t)}function y(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}},function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";e.exports=n(328)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(76),c=n(11);var s=Object(c.b)({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(o.b)(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Object(i.b)(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return Object(u.a)(n[0]);var c=n,s={axis:t};return r.a.runKernel(a.B,c,s)}})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n(13),a=n(12),i=n(16),o=n(6),u=n(19);function c(e){return u.b(u.u(e),(function(){return"The f passed in grad(f) must be a function"})),function(t,n){var r=Object(o.a)(t,"x","tf.grad","string_or_numeric"),i=null!=n?Object(o.a)(n,"dy","tf.grad"):null;return a.a.tidy((function(){var t=a.a.gradients((function(){return e(r)}),[r],i),n=t.value,o=t.grads;return null!=i&&u.e(n.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),p(o),o[0]}))}}function s(e){return u.b(u.u(e),(function(){return"The f passed in grads(f) must be a function"})),function(t,n){u.b(Array.isArray(t),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var i=Object(o.b)(t,"args","tf.grads","string_or_numeric"),c=null!=n?Object(o.a)(n,"dy","tf.grads"):null;return a.a.tidy((function(){var t=a.a.gradients((function(){return e.apply(void 0,Object(r.a)(i))}),i,c),n=t.value,o=t.grads;return null!=c&&u.e(n.shape,c.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p(o),o}))}}function l(e){return u.b(u.u(e),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(t,n){u.b(t instanceof i.a,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),u.b(null==n||n instanceof i.a,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=a.a.gradients((function(){return e(t)}),[t],n),o=r.grads,c=r.value;return p(o),{grad:o[0],value:c}}}function f(e){return u.b(u.u(e),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(t,n){u.b(Array.isArray(t)&&t.every((function(e){return e instanceof i.a})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),u.b(null==n||n instanceof i.a,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var o=a.a.gradients((function(){return e.apply(void 0,Object(r.a)(t))}),t,n);return null!=n&&u.e(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p(o.grads),o}}function d(e,t){u.b(u.u(e),(function(){return"The f passed in variableGrads(f) must be a function"})),u.b(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof i.c})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],a.a.registeredVariables)t.push(a.a.registeredVariables[r]);var o=n?t.filter((function(e){return!e.trainable})):null,c=t.length;t=t.filter((function(e){return e.trainable})),u.b(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(c," variables is ")+"trainable."}));var s=a.a.gradients(e,t,null,!0),l=s.value,f=s.grads;u.b(f.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),u.b(0===l.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(l.rank," tensor")}));var d={};return t.forEach((function(e,t){null!=f[t]&&(d[e.name]=f[t])})),null!=o&&o.forEach((function(e){return d[e.name]=null})),{value:l,grads:d}}function h(e){return a.a.customGrad(e)}function p(e){if(e.filter((function(e){return null==e})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(112),u=n(30),c=n(11);var s=Object(c.b)({where_:function(e,t,n){var c=Object(i.a)(t,"a","where"),s=Object(i.a)(n,"b","where"),l=Object(i.a)(e,"condition","where","bool"),f=Object(u.a)(Object(u.a)(l.shape,c.shape),s.shape),d={condition:Object(o.a)(l,f),t:Object(o.a)(c,f),e:Object(o.a)(s,f)};return r.a.runKernel(a.zc,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({sqrt_:function(e){var t={x:Object(i.a)(e,"x","sqrt")};return r.a.runKernel(a.Mc,t)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return f}));var r=n(19);function a(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function i(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,u=0;u<r;u++)-1===n.indexOf(u)?a.push(e[i++]):a.push(t[o++]);return a}function o(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((function(t){return e[t]}))]}function u(e,t){return i(e,t.map((function(e){return 1})),t)}function c(e,t,n){r.b(a(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function s(e,t){if(a(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function l(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function f(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}},function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return x})),n.d(t,"g",(function(){return O}));var r=n(4),a=n.n(r),i=n(9),o=n(17),u=n(67),c=n(111),s=n(19),l=n(170);function f(e,t){return d.apply(this,arguments)}function d(){return(d=Object(o.a)(a.a.mark((function e(t,n){var r,i,u,c,s,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],i=[],u=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),c=function(e){var c=u[e],s=Array.isArray(t)?t[e].tensor:t[c];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(c,"': ").concat(s.dtype));var l={name:c,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){var f=new Promise(function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,i,o,u,c,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,i=new Uint8Array(r),o=0,u=0;u<n.length;u++)c=n[u],l=new Uint8Array(new Uint32Array([c.length]).buffer),i.set(l,o),o+=4,i.set(c,o),o+=c.length;t(i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());i.push(f)}else i.push(s.data());null!=n&&(l.group=n),r.push(l)},s=0;s<u.length;++s)c(s);return e.next=7,Promise.all(i);case 7:return l=e.sent,e.abrupt("return",{data:p(l),specs:r});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t){var n,r,a={},o=0,f=Object(i.a)(t);try{for(f.s();!(r=f.n()).done;){var d=r.value,h=d.name,p=d.dtype,v=d.shape,m=Object(s.O)(v),b=void 0;if("quantization"in d){var g=d.quantization;if("uint8"===g.dtype||"uint16"===g.dtype){if(!("min"in g)||!("scale"in g))throw new Error("Weight ".concat(d.name," with quantization ").concat(g.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==g.dtype)throw new Error("Weight ".concat(d.name," has unknown ")+"quantization dtype ".concat(g.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==p)throw new Error("Weight ".concat(d.name," is quantized with ").concat(g.dtype," ")+"which only supports weights of type float32 not ".concat(p,"."))}var y=l.a[g.dtype],x=e.slice(o,o+m*y),O="uint8"===g.dtype?new Uint8Array(x):new Uint16Array(x);if("float32"===p)if("uint8"===g.dtype||"uint16"===g.dtype){b=new Float32Array(O.length);for(var w=0;w<O.length;w++){var j=O[w];b[w]=j*g.scale+g.min}}else{if("float16"!==g.dtype)throw new Error("Unsupported quantization type ".concat(g.dtype," ")+"for weight type float32.");void 0===n&&(n=k()),b=n(O)}else{if("int32"!==p)throw new Error("Unsupported dtype in weight '".concat(h,"': ").concat(p));if("uint8"!==g.dtype&&"uint16"!==g.dtype)throw new Error("Unsupported quantization type ".concat(g.dtype," ")+"for weight type int32.");b=new Int32Array(O.length);for(var _=0;_<O.length;_++){var S=O[_];b[_]=Math.round(S*g.scale+g.min)}}o+=m*y}else if("string"===p){var E=Object(s.O)(d.shape);b=[];for(var C=0;C<E;C++){var A=new Uint32Array(e.slice(o,o+4))[0];o+=4;var N=new Uint8Array(e.slice(o,o+A));b.push(N),o+=A}}else{var T=l.a[p],I=e.slice(o,o+m*T);if("float32"===p)b=new Float32Array(I);else if("int32"===p)b=new Int32Array(I);else if("bool"===p)b=new Uint8Array(I);else{if("complex64"!==p)throw new Error("Unsupported dtype in weight '".concat(h,"': ").concat(p));b=new Float32Array(I);for(var D=new Float32Array(b.length/2),F=new Float32Array(b.length/2),M=0;M<D.length;M++)D[M]=b[2*M],F[M]=b[2*M+1];var R=Object(c.a)(D,v,"float32"),z=Object(c.a)(F,v,"float32");a[h]=Object(u.a)(R,z),R.dispose(),z.dispose()}o+=m*T}"complex64"!==p&&(a[h]=Object(c.a)(b,v,p))}}catch(L){f.e(L)}finally{f.f()}return a}function p(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var v="undefined"!==typeof e&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function m(t){return v?e.byteLength(t):new Blob([t]).size}function b(t){if(v)return e.from(t).toString("base64");for(var n=new Uint8Array(t),r="",a=0,i=n.length;a<i;a++)r+=String.fromCharCode(n[a]);return btoa(r)}function g(t){if(v){var n=e.from(t,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}for(var r=atob(t),a=new Uint8Array(r.length),i=0;i<r.length;++i)a.set([r.charCodeAt(i)],i);return a.buffer}function y(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function x(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function O(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:m(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:m(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function k(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var u=r[o],c=e[n[u>>10]+(1023&u)]+t[u>>10];i[o]=c}return new Float32Array(a)}}}).call(this,n(162).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({exp_:function(e){var t={x:Object(i.a)(e,"x","exp")};return r.a.runKernel(a.ab,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({abs_:function(e){var t=Object(i.a)(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return r.a.runKernel(a.A,n)}var o={x:t};return r.a.runKernel(a.a,o)}})},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return b}));var r=n(30),a=n(138),i=n(141),o=n(20),u=n(148),c=n(89),s=n(149),l=n(18),f=n(77),d=n(90),h=n(31);function p(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Object(o.a)(e,Object(d.a)(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function v(e,t){var n=t,a=r.c(e.shape,t.shape);return a.length>0&&(n=Object(h.a)(n,a)),Object(l.a)(n,e.shape)}function m(e,t,n,r){if("linear"===t)return e;if("relu"===t)return Object(c.a)(e);if("elu"===t)return Object(a.a)(e);if("relu6"===t)return Object(s.a)(e);if("prelu"===t)return Object(u.a)(e,n);if("leakyrelu"===t)return Object(i.a)(e,r);if("sigmoid"===t)return Object(f.a)(e);throw new Error("Unknown fused activation ".concat(t,"."))}var b=function(e,t){return!(e>0)||"linear"===t}},function(e,t,n){"use strict";n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return x})),n.d(t,"d",(function(){return O})),n.d(t,"g",(function(){return k})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return M})),n.d(t,"c",(function(){return w}));var r=n(9),a=n(14),i=n(15),o=n(4),u=n.n(o),c=n(17),s=n(3),l=n(10),f=n(1),d=n(94),h=n(79);function p(e){return e instanceof f.Tensor?{value:e.clone(),recurse:!1}:Object(h.e)(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var v=n(25),m=n(23),b=function(){function e(t){if(Object(s.a)(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return Object(l.a)(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=Object(r.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;this.push(a)}}catch(i){n.e(i)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),g=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){return Object(s.a)(this,n),t.call(this,n.INITIAL_CAPACITY)}return Object(l.a)(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){Object(v.a)(Object(m.a)(n.prototype),"isFull",this).call(this)&&this.expand(),Object(v.a)(Object(m.a)(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){Object(v.a)(Object(m.a)(n.prototype),"isFull",this).call(this)&&this.expand(),Object(v.a)(Object(m.a)(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(b);function y(e){return new _(e)}function x(e){return new S(e)}function O(e,t){return new z(e,t)}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.FAIL;return new L(e,t)}g.INITIAL_CAPACITY=32;var w,j=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"toArray",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=Object(c.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new D(this,e)}},{key:"filter",value:function(e){return new T(this,e)}},{key:"map",value:function(e){return new I(this,e)}},{key:"mapAsync",value:function(e){return new F(this,e)}},{key:"serialMapAsync",value:function(e){return new F(this,e).serial()}},{key:"flatmap",value:function(e){return new R(this,e)}},{key:"forEachAsync",value:function(){var e=Object(c.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=Object(c.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new N(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.f,r=this.rowMajorBatch(e,t);return r.map((function(e){return Object(h.d)(e,n)}))}},{key:"concatenate",value:function(e,t){return new z(y([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new A(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new C(this,e)}},{key:"prefetch",value:function(e){return new P(this,e)}},{key:"shuffle",value:function(e,t){return new B(this,e,t)}},{key:"serial",value:function(){return new E(this)}}]),e}(),_=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this)).items=e,r.trav=0,r}return Object(l.a)(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:(n=t,Object(h.b)(n,p)),done:!1});case 5:case"end":return e.stop()}var n}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),S=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this)).nextFn=e,r}return Object(l.a)(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}(j),E=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),C=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:f.dispose(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),A=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),N=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),T=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:f.dispose(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),I=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t,n,a,i,o,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=f.tensor_util.getTensorsInContainer(t.value),a=this.transform(t.value),i=f.tensor_util.getTensorsInContainer(a),o=Object(r.a)(n);try{for(o.s();!(c=o.n()).done;)s=c.value,f.tensor_util.isTensorInList(s,i)||s.dispose()}catch(u){o.e(u)}finally{o.f()}return e.abrupt("return",{value:a,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),D=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}(j),F=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t,n,a,i,o,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=f.tensor_util.getTensorsInContainer(t.value),e.next=8,this.transform(t.value);case 8:a=e.sent,i=f.tensor_util.getTensorsInContainer(a),o=Object(r.a)(n);try{for(o.s();!(c=o.n()).done;)s=c.value,f.tensor_util.isTensorInList(s,i)||s.dispose()}catch(u){o.e(u)}finally{o.f()}return e.abrupt("return",{value:a,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),M=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).outputQueue=new g,e.lastRead=Promise.resolve({value:null,done:!1}),e}return Object(l.a)(n,[{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),R=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t,n,a,i,o,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=f.tensor_util.getTensorsInContainer(t.value),a=this.transform(t.value),i=f.tensor_util.getTensorsInContainer(a),this.outputQueue.pushAll(a),o=Object(r.a)(n);try{for(o.s();!(c=o.n()).done;)s=c.value,f.tensor_util.isTensorInList(s,i)||s.dispose()}catch(u){o.e(u)}finally{o.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(M),z=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=Object(c.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(j);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(w||(w={}));var L=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.FAIL;return Object(s.a)(this,n),(r=t.call(this)).iterators=e,r.mismatchMode=a,r.count=0,r.currentPromise=null,r}return Object(l.a)(n,[{key:"summary",value:function(){return"{".concat("TODO: fill in upstream of zip summaries","} -> Zip")}},{key:"nextState",value:function(){var e=Object(c.a)(u.a.mark((function e(t){var n,r,a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e){return e instanceof j?{value:e.next().then((function(e){return n++,e.done&&r++,e.value})),recurse:!1}:{value:null,recurse:!0}},e.next=3,t;case 3:return n=0,r=0,e.next=7,Object(h.c)(this.iterators,a);case 7:if(i=e.sent,n!==r){e.next=10;break}return e.abrupt("return",{value:null,done:!0});case 10:if(!(r>0)){e.next=16;break}e.t0=this.mismatchMode,e.next=e.t0===w.FAIL?14:e.t0===w.SHORTEST?15:(e.t0,w.LONGEST,16);break;case 14:throw new Error("Zipped streams should have the same length. "+"Mismatched at element ".concat(this.count,"."));case 15:return e.abrupt("return",{value:null,done:!0});case 16:return this.count++,e.abrupt("return",{value:i,done:!1});case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentPromise=this.nextState(this.currentPromise),e.abrupt("return",this.currentPromise);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j),P=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new b(r),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(j),B=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r,a){var i;return Object(s.a)(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=d.alea(a||f.util.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return Object(l.a)(n,[{key:"next",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=Object(c.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(P)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),a=n(19);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",a.c(e),new r.b(e,t,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({reverse_:function(e,t){var n={x:Object(i.a)(e,"x","reverse")},o={dims:t};return r.a.runKernel(a.uc,n,o)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(11);var l=Object(s.b)({greater_:function(e,t){var n=Object(u.a)(e,"a","greater"),s=Object(u.a)(t,"b","greater"),l=Object(o.makeTypesMatch)(n,s),f=Object(r.a)(l,2);n=f[0],s=f[1],Object(c.a)(n.shape,s.shape);var d={a:n,b:s};return a.a.runKernel(i.ob,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12),a=n(19),i=n(22);function o(e,t,n,o){if(null==o&&(o=Object(a.r)(e)),"complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(a.A)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Object(a.c)(t);var u=Object(a.O)(t),c=Object(a.O)(n);Object(a.b)(u===c,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(u," values but has ").concat(c)}));for(var s=0;s<n.length;++s){var l=n[s],f=s!==n.length-1||l!==Object(a.O)(t.slice(s));Object(a.b)(n[s]===t[s]||!f,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return Object(a.A)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==o?Object(i.toTypedArray)(e,o):Object(a.m)(e,[],!0),r.a.makeTensor(e,t,o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({transpose_:function(e,t){var n=Object(i.a)(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),o.b(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){o.b(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(t)}))})),n.rank<=1)return n.clone();var u={x:n},c={perm:t};return r.a.runKernel(a.Yc,u,c)}})},function(e,t,n){var r=n(98),a=n(99),i=n(174),o=n(173),u=o.MAX_LENGTH,c=o.MAX_SAFE_INTEGER,s=n(127),l=s.re,f=s.t,d=n(175),h=n(233).compareIdentifiers,p=function(){"use strict";function e(t,n){if(r(this,e),n=d(n),t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!==typeof t)throw new TypeError("Invalid Version: ".concat(t));if(t.length>u)throw new TypeError("version is longer than ".concat(u," characters"));i("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var a=t.trim().match(n.loose?l[f.LOOSE]:l[f.FULL]);if(!a)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>c||this.major<0)throw new TypeError("Invalid major version");if(this.minor>c||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>c||this.patch<0)throw new TypeError("Invalid patch version");a[4]?this.prerelease=a[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<c)return t}return e})):this.prerelease=[],this.build=a[5]?a[5].split("."):[],this.format()}return a(e,[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(t){if(i("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"===typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}},{key:"compareMain",value:function(t){return t instanceof e||(t=new e(t,this.options)),h(this.major,t.major)||h(this.minor,t.minor)||h(this.patch,t.patch)}},{key:"comparePre",value:function(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],a=t.prerelease[n];if(i("prerelease compare",n,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return h(r,a)}while(++n)}},{key:"compareBuild",value:function(t){t instanceof e||(t=new e(t,this.options));var n=0;do{var r=this.build[n],a=t.build[n];if(i("prerelease compare",n,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return h(r,a)}while(++n)}},{key:"inc",value:function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"===typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: ".concat(e))}return this.format(),this.raw=this.version,this}}]),e}();e.exports=p},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(11);var s=Object(c.b)({pow_:function(e,t){var n=Object(u.a)(e,"base","pow"),c=Object(u.a)(t,"exp","pow"),s=Object(o.makeTypesMatch)(n,c),l=Object(r.a)(s,2),f={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.gc,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(19),i=n(67),o=n(88);function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=u(e,"float32"),c=Object(o.a)(e,"float32");return Object(i.a)(n,c)}var s=Object(a.D)(Object(a.O)(e),t);return r.a.makeTensor(s,e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(i.a)(e,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var u={paddings:t,constantValue:n},c={x:o};return r.a.runKernel(a.ec,c,u)}})},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C})),n.d(t,"i",(function(){return N})),n.d(t,"c",(function(){return T})),n.d(t,"f",(function(){return I})),n.d(t,"e",(function(){return M})),n.d(t,"d",(function(){return R})),n.d(t,"k",(function(){return L})),n.d(t,"g",(function(){return P})),n.d(t,"h",(function(){return B})),n.d(t,"j",(function(){return W})),n.d(t,"b",(function(){return U}));var r=n(8),a=n(13),i=n(3),o=n(10),u=n(1),c=n(95),s=n(116),l=n(5),f=n(301),d=n(302),h=n(303),p=n(304),v=n(305),m=n(306),b=n(307),g=n(308),y=n(309),x=n(310),O=n(311),k=n(312),w=n(313),j=n(314),_=n(315),S=n(316),E=n(317),C=function(){function e(){var t;Object(i.a)(this,e);var n=[f,d,h,p,v,m,b,O,x,g,k,w,j,_,S,E,y],r=(t=[]).concat.apply(t,Object(a.a)(n.map((function(e){return e.json}))));this.opMappers=r.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return Object(o.a)(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.node,i=[],o=[],u=[],c=a.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")?i.push(e[n.name]):"Const"===n.op?o.push(e[n.name]):null!=n.input&&0!==n.input.length||u.push(e[n.name]),e}),{}),s=[],f=[],d={},h={};null!=n&&(d=this.mapSignatureEntries(n.inputs),h=this.mapSignatureEntries(n.outputs));var p=Object.keys(c);p.forEach((function(e){var t=c[e];t.inputNames.forEach((function(e){var n=Object(l.b)(e),a=Object(r.a)(n,1)[0];t.inputs.push(c[a]),c[a].children.push(t)}))})),0===Object.keys(h).length?p.forEach((function(e){var t=c[e];0===t.children.length&&f.push(t)})):Object.keys(h).forEach((function(e){var t=Object(l.b)(e),n=Object(r.a)(t,1)[0],a=c[n];null!=a&&(a.signatureKey=h[e],f.push(a))})),Object.keys(d).length>0?Object.keys(d).forEach((function(e){var t=Object(l.b)(e),n=Object(r.a)(t,1)[0],a=c[n];a&&(a.signatureKey=d[e],s.push(a))})):s=i;var v={};null!=e.library&&null!=e.library.function&&(v=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{}));var m={nodes:c,inputs:s,outputs:f,weights:o,placeholders:i,signature:n,functions:v};return u.length>0&&(m.initNodes=u),m}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=Object(s.a)(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=N(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=N(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=B(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=B(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=I(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=I(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=P(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=P(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=T(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=T(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=U(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=U(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=L(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=L(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=W(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=W(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=M(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=M(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=R(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=R(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=F(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=F(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,a=[],i={};null!=n&&(i=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&a.push(e[n.name]),e}),{}));var o=[],u=[];e.signature.inputArg.forEach((function(e){var t=Object(l.b)(e.name),n=Object(r.a)(t,1)[0],a={name:n,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:D(e.type),type:"dtype"}},children:[]};a.signatureKey=e.name,o.push(a),i[n]=a})),Object.keys(i).forEach((function(e){var t=i[e];t.inputNames.forEach((function(e){var n=Object(l.b)(e),a=Object(r.a)(n,1)[0];t.inputs.push(i[a]),i[a].children.push(t)}))}));var c=e.ret;e.signature.outputArg.forEach((function(e){var t=Object(l.b)(c[e.name]),n=Object(r.a)(t,2),a=n[0],o=n[1],s=i[a];null!=s&&(s.defaultOutput=o,u.push(s))}));var s=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:u,weights:a,placeholders:[],signature:s}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();function A(t,n){var r=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){var n=Object(u.env)().global;if("undefined"!==typeof n.atob)return n.atob(t);if("undefined"!==typeof e)return new e(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return n?r:r.toLowerCase()}function N(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?A(a.s,r):n}function T(e,t,n){var r=e[t];return r?r.b:n}function I(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function D(e){switch("string"===typeof e&&(e=c.a[e]),e){case c.a.DT_FLOAT:return"float32";case c.a.DT_INT32:case c.a.DT_INT64:case c.a.DT_INT8:case c.a.DT_UINT8:return"int32";case c.a.DT_BOOL:return"bool";case c.a.DT_DOUBLE:return"float32";case c.a.DT_STRING:return"string";default:return null}}function F(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function M(e,t,n){var r=e[t];return r&&r.type?D(r.type):n}function R(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return D(e)})):n}function z(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"===typeof e.size?e.size:parseInt(e.size,10)})):[]}function L(e,t,n){var r=e[t];return r&&r.shape?z(r.shape):n}function P(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"===typeof e?e:parseInt(e,10)})):n}function B(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return A(e,r)})):n}function W(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return z(e)})):n}function U(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}}).call(this,n(162).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({complex_:function(e,t){var n=Object(i.a)(e,"real","complex"),u=Object(i.a)(t,"imag","complex");o.e(n.shape,u.shape,"real and imag shapes, ".concat(n.shape," and ").concat(u.shape,", ")+"must match in call to tf.complex().");var c={real:n,imag:u};return r.a.runKernel(a.z,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(30),u=n(11);var c=Object(u.b)({logicalAnd_:function(e,t){var n=Object(i.a)(e,"a","logicalAnd","bool"),u=Object(i.a)(t,"b","logicalAnd","bool");Object(o.a)(n.shape,u.shape);var c={a:n,b:u};return r.a.runKernel(a.Fb,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.b)(e,"tensors","stack","string_or_numeric");o.b(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&o.b(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var u=n,c={axis:t};return r.a.runKernel(a.dc,u,c)}})},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return d})),n.d(t,"h",(function(){return h})),n.d(t,"g",(function(){return p})),n.d(t,"a",(function(){return v}));var r=n(8),a=n(34),i=n(122),o=Object(i.a)("kernelRegistry",(function(){return new Map})),u=Object(i.a)("gradRegistry",(function(){return new Map}));function c(e,t){var n=m(e,t);return o.get(n)}function s(e){return u.get(e)}function l(e){for(var t=o.entries(),n=[];;){var a=t.next(),i=a.done,u=a.value;if(i)break;var c=Object(r.a)(u,2),s=c[0],l=c[1],f=s.split("_");Object(r.a)(f,1)[0]===e&&n.push(l)}return n}function f(e){var t=e.kernelName,n=e.backendName,r=m(t,n);o.has(r)&&console.warn("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),o.set(r,e)}function d(e){var t=e.kernelName;u.has(t)&&Object(a.c)().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(t,"'")),u.set(t,e)}function h(e,t){var n=m(e,t);if(!o.has(n))throw new Error("The kernel '".concat(e,"' for backend ")+"'".concat(t,"' is not registered"));o.delete(n)}function p(e){if(!u.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));u.delete(e)}function v(e,t){l(e).forEach((function(e){f(Object.assign({},e,{backendName:t}))}))}function m(e,t){return"".concat(t,"_").concat(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","expandDims","string_or_numeric");o.b(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var u={input:n},c={dim:t};return r.a.runKernel(a.bb,u,c)}})},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(42),c=n(11),s=n(18);var l=Object(c.b)({conv2d_:function(e,t,n,c){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,h=Object(i.a)(e,"x","conv2d"),p=Object(i.a)(t,"filter","conv2d"),v=h,m=!1;3===h.rank&&(m=!0,v=Object(s.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.b(4===v.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(v.rank,".")})),o.b(4===p.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")})),null!=d&&o.b(o.v(c),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(c,".")}));var b="NHWC"===l?v.shape[3]:v.shape[1];o.b(b===p.shape[2],(function(){return"Error in conv2d: depth of input (".concat(b,") must match ")+"input depth for filter ".concat(p.shape[2],".")})),o.b(u.h(n,f),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(f,"'")}));var g={x:v,filter:p},y={strides:n,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d},x=r.a.runKernel(a.C,g,y);return m?Object(s.a)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(11);var l=Object(s.b)({greaterEqual_:function(e,t){var n=Object(u.a)(e,"a","greaterEqual"),s=Object(u.a)(t,"b","greaterEqual"),l=Object(o.makeTypesMatch)(n,s),f=Object(r.a)(l,2);n=f[0],s=f[1],Object(c.a)(n.shape,s.shape);var d={a:n,b:s};return a.a.runKernel(i.pb,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(11);var l=Object(s.b)({lessEqual_:function(e,t){var n=Object(u.a)(e,"a","lessEqual"),s=Object(u.a)(t,"b","lessEqual"),l=Object(o.makeTypesMatch)(n,s),f=Object(r.a)(l,2);n=f[0],s=f[1],Object(c.a)(n.shape,s.shape);var d={a:n,b:s};return a.a.runKernel(i.Ab,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({clone_:function(e){var t={x:Object(i.a)(e,"x","clone","string_or_numeric")};return r.a.runKernel(a.rb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({sigmoid_:function(e){var t={x:Object(i.a)(e,"x","sigmoid")};return r.a.runKernel(a.Bc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","max"),u={x:o},c={reductionIndices:t,keepDims:n};return r.a.runKernel(a.Ib,u,c)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return v}));var r=n(4),a=n.n(r),i=n(17),o=n(1);function u(e,t){return c(e,t)}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(p(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var u=e[o],s=c(u,t,n,r);i[o]=s}return r.delete(e),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;return l(e,t)}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(p(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=l(e.map((function(e){return e[r]})),t,n);i[r]=a};for(var u in r)o(u);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function f(e){return null===e?null:p(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function d(e,t){return h.apply(this,arguments)}function h(){return(h=Object(i.a)(a.a.mark((function e(t,n){var r,i,u,s,l,f,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Map,c(t,n,r),i=0,u=Array.from(r.keys());case 3:if(!(i<u.length)){e.next=14;break}if(s=u[i],l=r.get(s),!o.util.isPromise(l)){e.next=11;break}return e.next=9,l;case 9:f=e.sent,r.set(s,f);case 11:i++,e.next=3;break;case 14:return d=c(t,n,r),e.abrupt("return",d);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof o.Tensor))}function v(e){return null==e||(null===(t=e)||"object"!==typeof t&&"function"!==typeof t)||Array.isArray(e)||"object"===typeof e&&e instanceof o.Tensor||o.util.isTypedArray(e);var t}},function(e,t,n){var r=n(62);e.exports=function(e,t,n){return new r(e,n).compare(new r(t,n))}},function(e,t,n){var r=n(239),a=n(129),i=n(98),o=n(99),u=function(){"use strict";function e(t,n){var r=this;if(i(this,e),n=s(n),t instanceof e)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new e(t.raw,n);if(t instanceof l)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map((function(e){return r.parseRange(e.trim())})).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var o=this.set[0];if(this.set=this.set.filter((function(e){return!y(e[0])})),0===this.set.length)this.set=[o];else if(this.set.length>1){var u,c=a(this.set);try{for(c.s();!(u=c.n()).done;){var f=u.value;if(1===f.length&&x(f[0])){this.set=[f];break}}}catch(d){c.e(d)}finally{c.f()}}}this.format()}return o(e,[{key:"format",value:function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range}},{key:"toString",value:function(){return this.range}},{key:"parseRange",value:function(e){var t=this;e=e.trim();var n=Object.keys(this.options).join(","),i="parseRange:".concat(n,":").concat(e),o=c.get(i);if(o)return o;var u=this.options.loose,s=u?p[v.HYPHENRANGELOOSE]:p[v.HYPHENRANGE];e=e.replace(s,I(this.options.includePrerelease)),f("hyphen replace",e),e=e.replace(p[v.COMPARATORTRIM],m),f("comparator trim",e,p[v.COMPARATORTRIM]),e=(e=(e=e.replace(p[v.TILDETRIM],b)).replace(p[v.CARETTRIM],g)).split(/\s+/).join(" ");var d,h=u?p[v.COMPARATORLOOSE]:p[v.COMPARATOR],x=e.split(" ").map((function(e){return k(e,t.options)})).join(" ").split(/\s+/).map((function(e){return T(e,t.options)})).filter(this.options.loose?function(e){return!!e.match(h)}:function(){return!0}).map((function(e){return new l(e,t.options)})),O=(x.length,new Map),w=a(x);try{for(w.s();!(d=w.n()).done;){var j=d.value;if(y(j))return[j];O.set(j.value,j)}}catch(S){w.e(S)}finally{w.f()}O.size>1&&O.has("")&&O.delete("");var _=r(O.values());return c.set(i,_),_}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((function(e){return O(e,n)&&t.set.some((function(t){return O(t,n)&&e.every((function(e){return t.every((function(t){return e.intersects(t,n)}))}))}))}))}},{key:"test",value:function(e){if(!e)return!1;if("string"===typeof e)try{e=new d(e,this.options)}catch(n){return!1}for(var t=0;t<this.set.length;t++)if(D(this.set[t],e,this.options))return!0;return!1}}]),e}();e.exports=u;var c=new(n(369))({max:1e3}),s=n(175),l=n(177),f=n(174),d=n(62),h=n(127),p=h.re,v=h.t,m=h.comparatorTrimReplace,b=h.tildeTrimReplace,g=h.caretTrimReplace,y=function(e){return"<0.0.0-0"===e.value},x=function(e){return""===e.value},O=function(e,t){for(var n=!0,r=e.slice(),a=r.pop();n&&r.length;)n=r.every((function(e){return a.intersects(e,t)})),a=r.pop();return n},k=function(e,t){return f("comp",e,t),e=S(e,t),f("caret",e),e=j(e,t),f("tildes",e),e=C(e,t),f("xrange",e),e=N(e,t),f("stars",e),e},w=function(e){return!e||"x"===e.toLowerCase()||"*"===e},j=function(e,t){return e.trim().split(/\s+/).map((function(e){return _(e,t)})).join(" ")},_=function(e,t){var n=t.loose?p[v.TILDELOOSE]:p[v.TILDE];return e.replace(n,(function(t,n,r,a,i){var o;return f("tilde",e,t,n,r,a,i),w(n)?o="":w(r)?o=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):w(a)?o=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):i?(f("replaceTilde pr",i),o=">=".concat(n,".").concat(r,".").concat(a,"-").concat(i," <").concat(n,".").concat(+r+1,".0-0")):o=">=".concat(n,".").concat(r,".").concat(a," <").concat(n,".").concat(+r+1,".0-0"),f("tilde return",o),o}))},S=function(e,t){return e.trim().split(/\s+/).map((function(e){return E(e,t)})).join(" ")},E=function(e,t){f("caret",e,t);var n=t.loose?p[v.CARETLOOSE]:p[v.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(function(t,n,a,i,o){var u;return f("caret",e,t,n,a,i,o),w(n)?u="":w(a)?u=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):w(i)?u="0"===n?">=".concat(n,".").concat(a,".0").concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".0").concat(r," <").concat(+n+1,".0.0-0"):o?(f("replaceCaret pr",o),u="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(+n+1,".0.0-0")):(f("no pr"),u="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i," <").concat(+n+1,".0.0-0")),f("caret return",u),u}))},C=function(e,t){return f("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return A(e,t)})).join(" ")},A=function(e,t){e=e.trim();var n=t.loose?p[v.XRANGELOOSE]:p[v.XRANGE];return e.replace(n,(function(n,r,a,i,o,u){f("xRange",e,n,r,a,i,o,u);var c=w(a),s=c||w(i),l=s||w(o),d=l;return"="===r&&d&&(r=""),u=t.includePrerelease?"-0":"",c?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(s&&(i=0),o=0,">"===r?(r=">=",s?(a=+a+1,i=0,o=0):(i=+i+1,o=0)):"<="===r&&(r="<",s?a=+a+1:i=+i+1),"<"===r&&(u="-0"),n="".concat(r+a,".").concat(i,".").concat(o).concat(u)):s?n=">=".concat(a,".0.0").concat(u," <").concat(+a+1,".0.0-0"):l&&(n=">=".concat(a,".").concat(i,".0").concat(u," <").concat(a,".").concat(+i+1,".0-0")),f("xRange return",n),n}))},N=function(e,t){return f("replaceStars",e,t),e.trim().replace(p[v.STAR],"")},T=function(e,t){return f("replaceGTE0",e,t),e.trim().replace(p[t.includePrerelease?v.GTE0PRE:v.GTE0],"")},I=function(e){return function(t,n,r,a,i,o,u,c,s,l,f,d,h){return n=w(r)?"":w(a)?">=".concat(r,".0.0").concat(e?"-0":""):w(i)?">=".concat(r,".").concat(a,".0").concat(e?"-0":""):o?">=".concat(n):">=".concat(n).concat(e?"-0":""),c=w(s)?"":w(l)?"<".concat(+s+1,".0.0-0"):w(f)?"<".concat(s,".").concat(+l+1,".0-0"):d?"<=".concat(s,".").concat(l,".").concat(f,"-").concat(d):e?"<".concat(s,".").concat(l,".").concat(+f+1,"-0"):"<=".concat(c),"".concat(n," ").concat(c).trim()}},D=function(e,t,n){for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var a=0;a<e.length;a++)if(f(e[a].semver),e[a].semver!==l.ANY&&e[a].semver.prerelease.length>0){var i=e[a].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}},function(e,t,n){"use strict";var r=n(4),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(295),o=n(296);t.getDrawArea=function(e){if(e instanceof HTMLElement)return e;if(i.isSurface(e))return e.drawArea;if(i.isSurfaceInfo(e))return o.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")},t.shallowEquals=function(e,t){var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++){var i=n[a];if(e[i]!==t[i])return!1}return!0},t.nextFrame=function(){return a(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return requestAnimationFrame(e)}));case 2:case"end":return e.stop()}}),e)})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({log_:function(e){var t={x:Object(i.a)(e,"x","log")};return r.a.runKernel(a.Cb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(i.a)(e,"x","split"),u={x:o},c={numOrSizeSplits:t,axis:n};return r.a.runKernel(a.Lc,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6),a=n(19),i=n(60);function o(e,t){Object(a.d)(e);var n=Object(r.c)(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Object(i.a)(e,null,n,t)}},function(e,t,n){"use strict";n.r(t),n.d(t,"formatDefaultLocale",(function(){return b})),n.d(t,"format",(function(){return l})),n.d(t,"formatPrefix",(function(){return f})),n.d(t,"formatLocale",(function(){return m})),n.d(t,"formatSpecifier",(function(){return o})),n.d(t,"precisionFixed",(function(){return g})),n.d(t,"precisionPrefix",(function(){return y})),n.d(t,"precisionRound",(function(){return x}));var r=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},a=function(e){return(e=r(Math.abs(e)))?e[1]:NaN},i=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function o(e){return new u(e)}function u(e){if(!(t=i.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}o.prototype=u.prototype,u.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var c,s,l,f,d=function(e,t){var n=r(e,t);if(!n)return e+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")},h={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return d(100*e,t)},r:d,s:function(e,t){var n=r(e,t);if(!n)return e+"";var a=n[0],i=n[1],o=i-(c=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,u=a.length;return o===u?a:o>u?a+new Array(o-u+1).join("0"):o>0?a.slice(0,o)+"."+a.slice(o):"0."+new Array(1-o).join("0")+r(e,Math.max(0,t+o-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},p=function(e){return e},v=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],m=function(e){var t,n,r=e.grouping&&e.thousands?(t=e.grouping,n=e.thousands,function(e,r){for(var a=e.length,i=[],o=0,u=t[0],c=0;a>0&&u>0&&(c+u+1>r&&(u=Math.max(1,r-c)),i.push(e.substring(a-=u,a+u)),!((c+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}):p,i=e.currency,u=e.decimal,s=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(e.numerals):p,l=e.percent||"%";function f(e){var t=(e=o(e)).fill,n=e.align,a=e.sign,f=e.symbol,d=e.zero,p=e.width,m=e.comma,b=e.precision,g=e.trim,y=e.type;"n"===y?(m=!0,y="g"):h[y]||(null==b&&(b=12),g=!0,y="g"),(d||"0"===t&&"="===n)&&(d=!0,t="0",n="=");var x="$"===f?i[0]:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",O="$"===f?i[1]:/[%p]/.test(y)?l:"",k=h[y],w=/[defgprs%]/.test(y);function j(e){var i,o,l,f=x,h=O;if("c"===y)h=k(e)+h,e="";else{var j=(e=+e)<0;if(e=k(Math.abs(e),b),g&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(a>0){if(!+e[r])break e;a=0}}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),j&&0===+e&&(j=!1),f=(j?"("===a?a:"-":"-"===a||"("===a?"":a)+f,h=("s"===y?v[8+c/3]:"")+h+(j&&"("===a?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){h=(46===l?u+e.slice(i+1):e.slice(i))+h,e=e.slice(0,i);break}}m&&!d&&(e=r(e,1/0));var _=f.length+e.length+h.length,S=_<p?new Array(p-_+1).join(t):"";switch(m&&d&&(e=r(S+e,S.length?p-h.length:1/0),S=""),n){case"<":e=f+e+h+S;break;case"=":e=f+S+e+h;break;case"^":e=S.slice(0,_=S.length>>1)+f+e+h+S.slice(_);break;default:e=S+f+e+h}return s(e)}return b=null==b?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b)),j.toString=function(){return e+""},j}return{format:f,formatPrefix:function(e,t){var n=f(((e=o(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(a(t)/3))),i=Math.pow(10,-r),u=v[8+r/3];return function(e){return n(i*e)+u}}}};function b(e){return s=m(e),l=s.format,f=s.formatPrefix,s}b({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var g=function(e){return Math.max(0,-a(Math.abs(e)))},y=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(t)/3)))-a(Math.abs(e)))},x=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,a(t)-a(e))+1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c}));var r=n(13);function a(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var u=n(t,e[i=r+(a-r>>>1)]);u>0?r=i+1:(a=i,o=!u)}return o?r:-r-1}(e,t,n||i)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function i(e,t){return e>t?1:e<t?-1:0}function o(e,t,n,r,a){return s(e,t,n,r,a,0)}function u(e,t,n,r,a,i){return s(e,t,n,r,a,0,!1,i,!0)}function c(e,t,n,r,a,i){return s(e,t,n,r,a,i,!0)}function s(e,t,n,i,o,u){for(var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],h=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=[],v=0;v<t.length;v++)t[v]>o&&p.push({score:t[v],boxIndex:v,suppressBeginIndex:0});p.sort(d);for(var m=u>0?-.5/u:0,b=[],g=[];b.length<n&&p.length>0;){var y=p.pop(),x=y.score,O=y.boxIndex,k=y.suppressBeginIndex;if(x<o)break;for(var w=!1,j=b.length-1;j>=k;--j){var _=l(e,O,b[j]);if(_>=i){w=!0;break}if(y.score=y.score*f(i,m,_),y.score<=o)break}y.suppressBeginIndex=b.length,w||(y.score===x?(b.push(O),g.push(y.score)):y.score>o&&a(p,y,d))}var S=b.length,E=n-S;s&&E>0&&(b.push.apply(b,Object(r.a)(new Array(E).fill(0))),g.push.apply(g,Object(r.a)(new Array(E).fill(0))));var C={selectedIndices:b};return c&&(C.selectedScores=g),h&&(C.validOutputs=S),C}function l(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),u=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),s=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),h=(u-i)*(c-o),p=(f-s)*(d-l);if(h<=0||p<=0)return 0;var v=Math.max(i,s),m=Math.max(o,l),b=Math.min(u,f),g=Math.min(c,d),y=Math.max(b-v,0)*Math.max(g-m,0);return y/(h+p-y)}function f(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function d(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12),a=n(19),i=n(67);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=o(e,"float32"),u=o(e,"float32");return Object(i.a)(n,u)}var c=Object(a.F)(Object(a.O)(e),t);return r.a.makeTensor(c,e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({relu_:function(e){var t={x:Object(i.a)(e,"x","relu")};return r.a.runKernel(a.nc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","step"),o={x:n},u={alpha:t};return r.a.runKernel(a.Pc,o,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","unstack","string_or_numeric");o.b(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var u={value:n},c={axis:t};return r.a.runKernel(a.ad,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(18);var c=n(11);var s=Object(c.b)({batchNorm_:function(e,t,n,c,s,l){null==l&&(l=.001);var f,d,h=Object(i.a)(e,"x","batchNorm"),p=Object(i.a)(t,"mean","batchNorm"),v=Object(i.a)(n,"variance","batchNorm");null!=s&&(f=Object(i.a)(s,"scale","batchNorm")),null!=c&&(d=Object(i.a)(c,"offset","batchNorm")),o.b(p.rank===v.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),o.b(null==d||p.rank===d.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),o.b(null==f||p.rank===f.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var m={x:function(e){return 0===e.rank||1===e.rank?Object(u.a)(e,[1,1,1,e.size]):2===e.rank?Object(u.a)(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Object(u.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(h),scale:f,offset:d,mean:p,variance:v},b={varianceEpsilon:l},g=r.a.runKernel(a.jb,m,b);return Object(u.a)(g,h.shape)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({tile_:function(e,t){var n=Object(i.a)(e,"x","tile","string_or_numeric");o.b(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var u={x:n},c={reps:t};return r.a.runKernel(a.Vc,u,c)}})},function(e,t,n){var r=n(340),a=n(341),i=n(342),o=n(343),u=n(344),c=n(345),s=n(346);s.alea=r,s.xor128=a,s.xorwow=i,s.xorshift7=o,s.xor4096=u,s.tychei=c,e.exports=s},function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return r})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(r||(r={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","mean"),u={x:o},c={axis:t,keepDims:n};return r.a.runKernel(a.Pb,u,c)}})},function(e,t,n){"use strict";n.d(t,"d",(function(){return a.tensor2d})),n.d(t,"e",(function(){return a.train})),n.d(t,"b",(function(){return zo})),n.d(t,"c",(function(){return Ro})),n.d(t,"a",(function(){return r}));var r={};n.r(r),n.d(r,"inputLayer",(function(){return Kc})),n.d(r,"elu",(function(){return Xc})),n.d(r,"reLU",(function(){return Yc})),n.d(r,"leakyReLU",(function(){return $c})),n.d(r,"prelu",(function(){return Jc})),n.d(r,"softmax",(function(){return Qc})),n.d(r,"thresholdedReLU",(function(){return Zc})),n.d(r,"conv1d",(function(){return es})),n.d(r,"conv2d",(function(){return ts})),n.d(r,"conv2dTranspose",(function(){return ns})),n.d(r,"conv3d",(function(){return rs})),n.d(r,"conv3dTranspose",(function(){return as})),n.d(r,"separableConv2d",(function(){return is})),n.d(r,"cropping2D",(function(){return os})),n.d(r,"upSampling2d",(function(){return us})),n.d(r,"depthwiseConv2d",(function(){return cs})),n.d(r,"activation",(function(){return ss})),n.d(r,"dense",(function(){return ls})),n.d(r,"dropout",(function(){return fs})),n.d(r,"spatialDropout1d",(function(){return ds})),n.d(r,"flatten",(function(){return hs})),n.d(r,"repeatVector",(function(){return ps})),n.d(r,"reshape",(function(){return vs})),n.d(r,"permute",(function(){return ms})),n.d(r,"embedding",(function(){return bs})),n.d(r,"add",(function(){return gs})),n.d(r,"average",(function(){return ys})),n.d(r,"concatenate",(function(){return xs})),n.d(r,"maximum",(function(){return Os})),n.d(r,"minimum",(function(){return ks})),n.d(r,"multiply",(function(){return ws})),n.d(r,"dot",(function(){return js})),n.d(r,"batchNormalization",(function(){return _s})),n.d(r,"layerNormalization",(function(){return Ss})),n.d(r,"zeroPadding2d",(function(){return Es})),n.d(r,"averagePooling1d",(function(){return Cs})),n.d(r,"avgPool1d",(function(){return As})),n.d(r,"avgPooling1d",(function(){return Ns})),n.d(r,"averagePooling2d",(function(){return Ts})),n.d(r,"avgPool2d",(function(){return Is})),n.d(r,"avgPooling2d",(function(){return Ds})),n.d(r,"averagePooling3d",(function(){return Fs})),n.d(r,"avgPool3d",(function(){return Ms})),n.d(r,"avgPooling3d",(function(){return Rs})),n.d(r,"globalAveragePooling1d",(function(){return zs})),n.d(r,"globalAveragePooling2d",(function(){return Ls})),n.d(r,"globalMaxPooling1d",(function(){return Ps})),n.d(r,"globalMaxPooling2d",(function(){return Bs})),n.d(r,"maxPooling1d",(function(){return Ws})),n.d(r,"maxPooling2d",(function(){return Us})),n.d(r,"maxPooling3d",(function(){return Vs})),n.d(r,"gru",(function(){return qs})),n.d(r,"gruCell",(function(){return Hs})),n.d(r,"lstm",(function(){return Gs})),n.d(r,"lstmCell",(function(){return Ks})),n.d(r,"simpleRNN",(function(){return Xs})),n.d(r,"simpleRNNCell",(function(){return Ys})),n.d(r,"convLstm2d",(function(){return $s})),n.d(r,"convLstm2dCell",(function(){return Js})),n.d(r,"rnn",(function(){return Qs})),n.d(r,"stackedRNNCells",(function(){return Zs})),n.d(r,"bidirectional",(function(){return el})),n.d(r,"timeDistributed",(function(){return tl})),n.d(r,"globalMaxPool1d",(function(){return nl})),n.d(r,"globalMaxPool2d",(function(){return rl})),n.d(r,"maxPool1d",(function(){return al})),n.d(r,"maxPool2d",(function(){return il})),n.d(r,"Layer",(function(){return Wa})),n.d(r,"RNN",(function(){return Pu})),n.d(r,"RNNCell",(function(){return Bu})),n.d(r,"input",(function(){return Lo})),n.d(r,"gaussianNoise",(function(){return ol})),n.d(r,"gaussianDropout",(function(){return ul})),n.d(r,"alphaDropout",(function(){return cl})),n.d(r,"masking",(function(){return sl}));var a=n(1),i=n(8),o=n(7),u=n(24),c=n(20),s=n(90),l={kernelName:o.a,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(s.a)(Object(u.a)(n,"float32"),-1))}}}},f=n(28),d=n(41),h=n(29),p=n(50),v=n(37),m=n(27),b={kernelName:o.b,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){var t=Object(v.a)(Object(u.a)(n,"float32")),r=Object(p.a)(Object(m.a)(Object(h.a)(1),t));return Object(d.a)(Object(f.a)(e,r))}}}},g={kernelName:o.c,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){var t=Object(p.a)(Object(m.a)(Object(v.a)(Object(u.a)(n,"float32")),1));return Object(f.a)(e,t)}}}},y=n(30),x=n(18),O=n(31),k={kernelName:o.d,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=y.a(r.shape,a.shape);return{a:function(){var t=e,n=y.c(r.shape,o);return n.length>0&&(t=Object(O.a)(t,n)),Object(x.a)(t,r.shape)},b:function(){var t=e,n=y.c(a.shape,o);return n.length>0&&(t=Object(O.a)(t,n)),Object(x.a)(t,a.shape)}}}},w={kernelName:o.e,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},j=n(32),_={kernelName:o.h,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(j.a)(n)}}}},S={kernelName:o.i,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(j.a)(n)}}}},E={kernelName:o.j,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(f.a)(e,Object(p.a)(Object(m.a)(Object(h.a)(1),Object(v.a)(Object(u.a)(n,"float32")))))}}}},C=n(26),A={kernelName:o.k,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){var t=Object(p.a)(Object(C.a)(Object(h.a)(1),Object(v.a)(Object(u.a)(n,"float32"))));return Object(f.a)(e,t)}}}},N={kernelName:o.m,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(y.a)(r.shape,a.shape);return{a:function(){var t=Object(C.a)(Object(v.a)(r),Object(v.a)(a)),n=Object(c.a)(e,Object(f.a)(a,t)),i=Object(y.c)(r.shape,o);return i.length>0&&(n=Object(O.a)(n,i)),Object(x.a)(n,r.shape)},b:function(){var t=Object(C.a)(Object(v.a)(r),Object(v.a)(a)),n=Object(d.a)(Object(c.a)(e,Object(f.a)(r,t))),i=Object(y.c)(a.shape,o);return i.length>0&&(n=Object(O.a)(n,i)),Object(x.a)(n,a.shape)}}}},T={kernelName:o.l,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(f.a)(e,Object(C.a)(Object(v.a)(Object(u.a)(n,"float32")),1))}}}},I={kernelName:o.n,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(f.a)(e,Object(m.a)(Object(h.a)(1),Object(v.a)(Object(u.a)(n,"float32"))))}}}},D=n(12),F=n(6),M=n(19),R=n(11);var z=Object(R.b)({avgPool3dGrad_:function(e,t,n,r,a,i){var u=Object(F.a)(e,"dy","avgPool3dGrad"),c=Object(F.a)(t,"input","avgPool3dGrad"),s=u,l=c,f=!1;4===c.rank&&(f=!0,s=Object(x.a)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),l=Object(x.a)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),M.b(5===s.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(s.rank,".")})),M.b(5===l.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(l.rank,".")})),null!=i&&M.b(M.v(a),(function(){return"Error in avgPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(i," but got pad ").concat(a,".")}));var d={dy:s,input:l},h={filterSize:n,strides:r,pad:a,dimRoundingMode:i},p=D.a.runKernel(o.q,d,h);return f?Object(x.a)(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),L={kernelName:o.p,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.filterSize,o=n.strides,u=n.pad,c=n.dimRoundingMode;return{x:function(){return z(e,r,a,o,u,c)}}}};var P=Object(R.b)({avgPoolGrad_:function(e,t,n,r,a){var i=Object(F.a)(e,"dy","avgPoolGrad"),u=Object(F.a)(t,"input","avgPoolGrad");M.b(u.rank===i.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy (").concat(i.rank,")")}));var c=u,s=i,l=!1;3===u.rank&&(l=!0,c=Object(x.a)(u,[1,u.shape[0],u.shape[1],u.shape[2]]),s=Object(x.a)(i,[1,i.shape[0],i.shape[1],i.shape[2]])),M.b(4===s.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),M.b(4===c.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(c.rank,".")}));var f={dy:s,input:c},d={filterSize:n,strides:r,pad:a},h=D.a.runKernel(o.r,f,d);return l?Object(x.a)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),B={kernelName:o.o,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.filterSize,o=n.strides,u=n.pad;return{x:function(){return P(e,r,a,o,u)}}}},W=n(36),U={kernelName:o.s,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1],u=n.transposeA,c=n.transposeB;return u||c?!u&&c?{a:function(){return Object(W.a)(e,o,!1,!1)},b:function(){return Object(W.a)(e,a,!0,!1)}}:u&&!c?{a:function(){return Object(W.a)(o,e,!1,!0)},b:function(){return Object(W.a)(a,e,!1,!1)}}:{a:function(){return Object(W.a)(o,e,!0,!0)},b:function(){return Object(W.a)(e,a,!0,!0)}}:{a:function(){return Object(W.a)(e,o,!1,!0)},b:function(){return Object(W.a)(a,e,!0,!1)}}}},V=n(108),q={kernelName:o.t,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return Object(V.a)(e,r,a)}}}},H={kernelName:o.v,gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),u=a.length-1;u>=0;u--)if(a[u]===i[u])o[u]=1;else if(1!==a[u])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var c=[],s=0;s<o.length;s++)o[s]>1&&c.push(s);return{x:function(){return Object(O.a)(e,c,!0)}}}},G={kernelName:o.w,gradFunc:function(e){return{x:function(){return e.clone()}}}},K={kernelName:o.x,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},X=n(74),Y=n(75),$=n(68),J=n(49),Q={kernelName:o.y,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.clipValueMin,o=n.clipValueMax;return{x:function(){return Object(J.a)(Object($.a)(Object(X.a)(r,a),Object(Y.a)(r,o)),e,Object(j.a)(e))}}}},Z={kernelName:o.A,inputsToSave:["x"],gradFunc:l.gradFunc},ee=n(84),te={kernelName:o.B,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=n.axis,i=Object(M.I)(a,t[0].shape)[0],o=r.map((function(e){return e[i]}));return Object(ee.a)(e,o,i).map((function(e){return function(){return e}}))}},ne=n(159),re=n(156),ae=n(42),ie={kernelName:o.C,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1],u=n.dilations,c=n.strides,s=n.pad,l=n.dataFormat;return M.b(ae.i(u),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")})),{x:function(){return Object(re.a)(a.shape,e,o,c,s,l)},filter:function(){return Object(ne.a)(a,e,o.shape,c,s,l)}}}},oe=n(73),ue={kernelName:o.E,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1],u=n.strides,c=n.pad,s=n.dataFormat,l=n.dimRoundingMode;return{dy:function(){return Object(oe.a)(e,o,u,c,s,1,l)},filter:function(){return Object(ne.a)(e,a,o.shape,u,c,s,l)}}}};var ce=Object(R.b)({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=Object(x.a)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var u=t;4===u.rank&&(u=Object(x.a)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),M.b(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),M.b(5===u.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(u.shape,".")})),M.b(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),M.b(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),M.b(u.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(u.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var c={x:i,dy:u},s={strides:r,pad:a,filterShape:n};return D.a.runKernel(o.G,c,s)}}),se=n(220),le={kernelName:o.F,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,o=n.pad;M.b(Object(ae.i)(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var u=Object(i.a)(t,2),c=u[0],s=u[1];return{x:function(){return Object(se.a)(c.shape,e,s,a,o)},filter:function(){return ce(c,e,s.shape,a,o)}}}},fe=n(208),de={kernelName:o.I,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(d.a)(Object(fe.a)(Object(u.a)(n,"float32"))),e)}}}},he=n(209),pe={kernelName:o.J,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(he.a)(Object(u.a)(n,"float32")),e)}}}},ve=n(51),me=n(137),be=n(61),ge={kernelName:o.L,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.axis,o=n.exclusive,u=n.reverse;return{x:function(){var t=Object(ve.f)([a],r.rank),n=Object(me.a)(e,a,o,!u);return null!=t&&(n=Object(be.a)(n,t)),n}}}},ye=n(224),xe=n(223),Oe={kernelName:o.O,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,o=n.pad,u=n.dimRoundingMode,c=null==r?[1,1]:r;M.b(ae.i(c),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(c,"'")}));var s=Object(i.a)(t,2),l=s[0],f=s[1];return M.b(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(l.rank,".")})),M.b(4===f.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(f.rank,".")})),M.b(l.shape[3]===f.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(l.shape[3],") must match the inChannels dimension ")+"in filter ".concat(f.shape[2],".")})),M.b(ae.h(a,c),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(c,"'.")})),null!=u&&M.b(M.v(o),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(u," but got pad ").concat(o,".")})),{x:function(){return Object(xe.a)(l.shape,e,f,a,o,r,u)},filter:function(){return Object(ye.a)(l,e,f.shape,a,o,r,u)}}}},ke={kernelName:o.S,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=Object(i.a)(t,2),a=r[0],u=r[1],c={x:a,filter:u,dy:e},s={x:a,filter:u,dy:e};return{x:function(){return D.a.runKernel(o.U,c,n)},filter:function(){return D.a.runKernel(o.T,s,n)}}}},we={kernelName:o.W,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:Object(i.a)(t,1)[0]};return{x:function(){return D.a.runKernel(o.X,n)}}}},je=n(53),_e={kernelName:o.Z,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0],r=Object(c.a)(Object(je.a)(Object(d.a)(Object(v.a)(n))),2/Math.sqrt(Math.PI));return{x:function(){return Object(c.a)(e,r)}}}},Se={kernelName:o.ab,outputsToSave:[!0],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(e,n)}}}},Ee={kernelName:o.bb,inputsToSave:["input"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{input:function(){return Object(x.a)(e,n.shape)}}}},Ce={kernelName:o.cb,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(je.a)(n))}}}},Ae={kernelName:o.gb,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},Ne={kernelName:o.hb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(y.a)(r.shape,a.shape);return{a:function(){var t=Object(f.a)(e,Object(u.a)(a,"float32")),n=Object(y.c)(r.shape,o);return n.length>0?Object(x.a)(Object(O.a)(t,n),r.shape):t},b:function(){var t=Object(c.a)(e,Object(u.a)(r,"float32")),n=Object(y.c)(a.shape,o);n.length>0&&(t=Object(x.a)(Object(O.a)(t,n),a.shape));var i=Object(v.a)(a);return Object(d.a)(Object(f.a)(t,Object(u.a)(i,"float32")))}}}},Te=n(205),Ie=n(93),De={kernelName:o.jb,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=Object(i.a)(t,4),o=a[0],u=a[1],s=a[2],l=a[3],f=null==l?Object(h.a)(1):l,d=Object(y.c)(u.shape,o.shape),p=[];if(1===u.rank){for(var v=0;v<o.shape.length-1;++v)p.push(o.shape[v]);p.push(1)}var b=Object(m.a)(o,u),g=Object(c.a)(e,f),k=Object(Te.a)(Object(C.a)(s,Object(h.a)(r))),w=Object(c.a)(Object(c.a)(Object(c.a)(k,k),k),Object(h.a)(-.5));return{x:function(){return 1===u.rank?Object(x.a)(Object(c.a)(Object(c.a)(e,Object(Ie.a)(Object(x.a)(k,[1,1,1,u.shape[0]]),p)),f),o.shape):Object(x.a)(Object(c.a)(Object(c.a)(e,k),f),o.shape)},mean:function(){var e=Object(c.a)(Object(c.a)(k,Object(h.a)(-1)),g);return 1===u.rank&&(e=Object(O.a)(e,d)),Object(x.a)(e,u.shape)},variance:function(){var e=Object(c.a)(Object(c.a)(w,b),g);return 1===u.rank&&(e=Object(O.a)(e,d)),Object(x.a)(e,u.shape)},scale:function(){var t=Object(c.a)(b,k),n=Object(c.a)(e,t);return 1===u.rank&&(n=Object(O.a)(n,d)),Object(x.a)(n,u.shape)},offset:function(){var t=e;return 1===u.rank&&(t=Object(O.a)(t,d)),Object(x.a)(t,u.shape)}}}},Fe=n(153),Me={kernelName:o.nb,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1],u=n.axis,c=Object(M.I)(u,a.shape)[0];return{x:function(){var t=a.shape,n=o.size,r=t.slice(0,c),i=r.length,s=t.slice(u,t.length).slice(1),l=s.length,f=Re(0,i),d=Re(i+1,i+1+l),h=ze([r,[n],s]),p=Object(x.a)(e,h),v=Object(x.a)(o,[n]),m=ze([[i],f,d]),b=Object(be.a)(p,m),g=Object(Fe.a)(b,v,a.shape[c]),y=Object(ve.h)(m);return g=Object(be.a)(g,y)},indices:function(){return o}}}};function Re(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function ze(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Le={kernelName:o.pb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1];return{a:function(){return Object(j.a)(r)},b:function(){return Object(j.a)(a)}}}},Pe={kernelName:o.rb,gradFunc:function(e){return{x:function(){return Object(u.a)(e,"float32")}}}},Be={kernelName:o.tb,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},We={kernelName:o.ub,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},Ue={kernelName:o.vb,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},Ve=n(59),qe={kernelName:o.yb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.alpha,o=Object(Ve.a)(r,0);return{x:function(){return Object(J.a)(o,e,Object(c.a)(e,a))}}}},He={kernelName:o.Db,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(f.a)(e,Object(C.a)(n,1))}}}},Ge={kernelName:o.Cb,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(f.a)(e,Object(u.a)(n,"float32"))}}}},Ke={kernelName:o.Eb,inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.axis;return{logits:function(){var t=Object(je.a)(r);return Object(m.a)(e,Object(c.a)(Object(O.a)(e,a,!0),t))}}}};var Xe=Object(R.b)({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,c={x:e,y:t,dy:n},s={depthRadius:r,bias:a,alpha:i,beta:u};return D.a.runKernel(o.xb,c,s)}}),Ye={kernelName:o.wb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1],u=n.depthRadius,c=n.bias,s=n.alpha,l=n.beta;return{x:function(){return Xe(a,o,e,u,c,s,l)}}}},$e=n(105);function Je(e,t,n,r){return t.rank<n.rank&&(t=Object(x.a)(t,ve.e(t.shape,r))),e.rank<n.rank&&(e=Object(x.a)(e,ve.e(e.shape,r))),{x:function(){return Object(c.a)(e,Object(u.a)(Object($e.a)(n,t),e.dtype))}}}var Qe={kernelName:o.Ib,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=Je(e,t[1],a,M.I(r,a.shape));return{x:function(){return i.x()}}}},Ze=n(142),et={kernelName:o.Ob,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1];return{a:function(){return Object(c.a)(e,Object(u.a)(Object(X.a)(r,a),"float32"))},b:function(){return Object(c.a)(e,Object(u.a)(Object(Ze.a)(r,a),"float32"))}}}};var tt=Object(R.b)({maxPool3dGrad_:function(e,t,n,r,a,i,u){var c=Object(F.a)(e,"dy","maxPool3dGrad"),s=Object(F.a)(t,"input","maxPool3dGrad"),l=Object(F.a)(n,"output","maxPool3dGrad"),f=c,d=s,h=l,p=!1;4===s.rank&&(p=!0,f=Object(x.a)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),d=Object(x.a)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),h=Object(x.a)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),M.b(5===f.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(f.rank,".")})),M.b(5===d.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(d.rank,".")})),M.b(5===h.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(h.rank,".")})),null!=u&&M.b(M.v(i),(function(){return"Error in maxPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(u," but got pad ").concat(i,".")}));var v={dy:f,input:d,output:h},m={filterSize:r,strides:a,pad:i,dimRoundingMode:u},b=D.a.runKernel(o.Lb,v,m);return p?Object(x.a)(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}}),nt={kernelName:o.Kb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1],u=n.filterSize,c=n.strides,s=n.pad,l=n.dimRoundingMode;return{x:function(){return tt(e,a,o,u,c,s,l)}}}};var rt=Object(R.b)({maxPoolGrad_:function(e,t,n,r,a,i,u){var c=Object(F.a)(e,"dy","maxPoolGrad"),s=Object(F.a)(t,"input","maxPoolGrad"),l=Object(F.a)(n,"output","maxPoolGrad");M.b(s.rank===c.rank,(function(){return"Rank of input (".concat(s.rank,") does not match rank of dy ")+"(".concat(c.rank,")")})),M.b(4===c.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(c.rank,".")})),M.b(4===s.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")})),null!=u&&M.b(M.v(i),(function(){return"Error in maxPoolGrad: pad must be an integer when using, "+"dimRoundingMode ".concat(u," but got pad ").concat(i,".")}));var f={dy:c,input:s,output:l},d={filterSize:r,strides:a,pad:i,dimRoundingMode:u};return D.a.runKernel(o.Mb,f,d)}}),at={kernelName:o.Jb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(i.a)(t,2),a=r[0],o=r[1],u=n.filterSize,c=n.strides,s=n.pad;return{x:function(){return rt(e,a,o,u,c,s)}}}},it=n(64),ot={kernelName:o.Pb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.axis,o=M.I(a,r.shape),u=Object(ve.d)(r.shape,o)[1],s=M.O(u);return{x:function(){var t=r.shape.slice();o.forEach((function(e){t[e]=1}));var n=Object(x.a)(e,t);return Object(f.a)(Object(c.a)(n,Object(it.a)(r.shape,"float32")),s)}}}},ut={kernelName:o.Qb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=Object(i.a)(t,2),o=a[0],u=Je(e,a[1],o,M.I(r,o.shape));return{x:function(){return u.x()}}}},ct={kernelName:o.Rb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1];return{a:function(){return Object(c.a)(e,Object(u.a)(Object(Y.a)(r,a),"float32"))},b:function(){return Object(c.a)(e,Object(u.a)(Object(Ve.a)(r,a),"float32"))}}}},st=n(40),lt={kernelName:o.Sb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Object(st.a)(e,a,r.shape)}}}},ft=n(139),dt={kernelName:o.Tb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(y.a)(r.shape,a.shape);return{a:function(){var t=Object(y.c)(r.shape,o);return t.length>0?Object(x.a)(Object(O.a)(e,t),r.shape):e},b:function(){var t=Object(c.a)(e,Object(d.a)(Object(ft.a)(Object(f.a)(r,a)))),n=Object(y.c)(a.shape,o);return n.length>0?Object(x.a)(Object(O.a)(t,n),a.shape):t}}}},ht={kernelName:o.Vb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(y.a)(r.shape,a.shape);return{a:function(){var t=Object(c.a)(e,Object(u.a)(a,"float32")),n=Object(y.c)(r.shape,o);return n.length>0?Object(x.a)(Object(O.a)(t,n),r.shape):t},b:function(){var t=Object(c.a)(e,Object(u.a)(r,"float32")),n=Object(y.c)(a.shape,o);return n.length>0?Object(x.a)(Object(O.a)(t,n),a.shape):t}}}},pt={kernelName:o.Wb,gradFunc:function(e){return{x:function(){return Object(d.a)(e)}}}},vt=n(88),mt={kernelName:o.bc,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Object(vt.a)(n.shape,"float32")}}}},bt={kernelName:o.cc,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},gt=n(91),yt={kernelName:o.dc,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return Object(gt.a)(e,r).map((function(e){return function(){return e}}))}},xt={kernelName:o.ec,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Object(st.a)(e,a,r.shape)}}}},Ot=n(83),kt=n(63),wt={kernelName:o.gc,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=Object(i.a)(t,3),r=n[0],a=n[1],o=n[2],s=r,l=a,f=y.a(s.shape,l.shape);return{a:function(){var t=Object(u.a)(l,"float32"),n=Object(c.a)(e,Object(c.a)(t,Object(kt.a)(s,Object(m.a)(t,Object(h.a)(1))))),r=y.c(s.shape,f);return r.length>0&&(n=Object(O.a)(n,r)),Object(x.a)(n,s.shape)},b:function(){var t=Object(Ve.a)(s,0),n=Object(J.a)(t,Object(Ot.a)(s),Object(j.a)(s)),r=Object(c.a)(e,Object(c.a)(o,n)),a=y.c(l.shape,f);return a.length>0&&(r=Object(O.a)(r,a)),Object(x.a)(r,l.shape)}}}},jt={kernelName:o.hc,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(Ve.a)(r,0);return{x:function(){return Object(J.a)(o,e,Object(c.a)(e,a))},alpha:function(){var t=Object(J.a)(o,Object(j.a)(e),Object(c.a)(e,r)),n=Object(y.c)(a.shape,e.shape);return n.length>0&&(t=Object(O.a)(t,n)),Object(x.a)(t,a.shape)}}}},_t={kernelName:o.lc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=y.a(r.shape,a.shape);return{a:function(){var t=Object(f.a)(e,Object(u.a)(a,"float32")),n=y.c(r.shape,o);return n.length>0?Object(x.a)(Object(O.a)(t,n),r.shape):t},b:function(){var t=Object(c.a)(e,Object(u.a)(r,"float32")),n=y.c(a.shape,o);n.length>0&&(t=Object(x.a)(Object(O.a)(t,n),a.shape));var i=Object(v.a)(a);return Object(d.a)(Object(f.a)(t,Object(u.a)(i,"float32")))}}}},St={kernelName:o.mc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(f.a)(e,Object(d.a)(Object(v.a)(n)))}}}},Et={kernelName:o.oc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0],r=Object(c.a)(Object(Y.a)(n,6),Object(s.a)(n));return{x:function(){return Object(c.a)(e,Object(u.a)(r,"float32"))}}}},Ct={kernelName:o.nc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(u.a)(Object(s.a)(n),"float32"))}}}},At={kernelName:o.pc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(x.a)(e,n.shape)}}}},Nt={kernelName:o.qc,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:Object(i.a)(t,1)[0]};return{images:function(){return D.a.runKernel(o.rc,r,n)}}}},Tt={kernelName:o.sc,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:Object(i.a)(t,1)[0]};return{images:function(){return D.a.runKernel(o.tc,r,n)}}}},It=n(58),Dt={kernelName:o.uc,gradFunc:function(e,t,n){var r=n.dims,a=Object(M.I)(r,e.shape);return{x:function(){return Object(It.a)(e,a)}}}},Ft={kernelName:o.wc,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},Mt={kernelName:o.xc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(d.a)(Object(f.a)(e,Object(c.a)(Object(kt.a)(n,1.5),2)))}}}},Rt=n(107),zt={kernelName:o.zc,inputsToSave:["condition"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{condition:function(){return Object(u.a)(Object(j.a)(n),"float32")},t:function(){return Object(c.a)(e,Object(u.a)(n,e.dtype))},e:function(){return Object(c.a)(e,Object(u.a)(Object(Rt.a)(n),e.dtype))}}}},Lt=n(168),Pt={kernelName:o.Ac,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){var t=Object(Ve.a)(n,Object(h.a)(0)),r=Object(h.a)(Lt.b),a=Object(h.a)(Lt.a),i=Object(c.a)(e,a),o=Object(c.a)(Object(c.a)(e,r),Object(je.a)(Object(u.a)(n,"float32")));return Object(J.a)(t,i,o)}}}},Bt={kernelName:o.Bc,outputsToSave:[!0],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(c.a)(n,Object(m.a)(Object(h.a)(1),n)))}}}},Wt={kernelName:o.Cc,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},Ut=n(136),Vt={kernelName:o.Dc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(Ut.a)(Object(u.a)(n,"float32")),e)}}}},qt=n(191),Ht={kernelName:o.Ec,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(qt.a)(Object(u.a)(n,"float32")),e)}}}},Gt=n(65),Kt=n(132),Xt={kernelName:o.Fc,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=Object(i.a)(t,1)[0],a=n.begin,o=n.size,u=r.shape,c=Object(Kt.parseSliceParams)(r,a,o),s=Object(i.a)(c,2),l=s[0],f=s[1],d=[],h=0;h<e.rank;h++)d.push([l[h],u[h]-l[h]-f[h]]);return{x:function(){return Object(Gt.a)(e,d)}}}},Yt={kernelName:o.Gc,outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.dim,o=Object(c.a)(e,r);return{logits:function(){return Object(m.a)(o,Object(c.a)(Object(O.a)(o,[a],true),r))}}}},$t=n(77),Jt={kernelName:o.Hc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object($t.a)(n))}}}},Qt=n(103),Zt={kernelName:o.Ic,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return Object(Qt.a)(e,r,a)}}}},en=n(45),tn={kernelName:o.Lc,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return Object(en.a)(e,r)}}}},nn={kernelName:o.Mc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(f.a)(e,Object(c.a)(Object(p.a)(Object(u.a)(n,"float32")),2))}}}},rn={kernelName:o.Nc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(c.a)(Object(u.a)(n,"float32"),2))}}}},an={kernelName:o.Oc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(h.a)(2);return{a:function(){return Object(c.a)(e,Object(c.a)(o,Object(m.a)(r,a)))},b:function(){return Object(c.a)(e,Object(c.a)(o,Object(m.a)(a,r)))}}}},on={kernelName:o.Pc,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},un={kernelName:o.Rc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(i.a)(t,2),r=n[0],a=n[1],o=y.a(r.shape,a.shape);return{a:function(){var t=e,n=y.c(r.shape,o);return n.length>0&&(t=Object(O.a)(t,n)),Object(x.a)(t,r.shape)},b:function(){var t=e,n=y.c(a.shape,o);return n.length>0&&(t=Object(O.a)(t,n)),Object(x.a)(Object(d.a)(t),a.shape)}}}},cn={kernelName:o.Sc,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=r.shape.slice(),o=n.axis;Object(M.I)(o,r.shape).forEach((function(e){a[e]=1}));var u=Object(x.a)(e,a),s=Object(c.a)(u,Object(it.a)(r.shape,"float32"));return{x:function(){return s}}}},sn={kernelName:o.Tc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(f.a)(e,Object(v.a)(Object(Ut.a)(n)))}}}},ln={kernelName:o.Uc,outputsToSave:[!0],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(m.a)(Object(h.a)(1),Object(v.a)(n)),e)}}}},fn={kernelName:o.Vc,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(i.a)(t,1)[0],a=n.reps;return{x:function(){var t=Object(j.a)(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=Object(C.a)(t,Object(st.a)(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=Object(C.a)(t,Object(st.a)(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var u=0;u<a[0];++u)for(var c=0;c<a[1];++c)for(var s=0;s<a[2];++s)t=Object(C.a)(t,Object(st.a)(e,[u*r.shape[0],c*r.shape[1],s*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var f=0;f<a[1];++f)for(var d=0;d<a[2];++d)for(var h=0;h<a[3];++h)t=Object(C.a)(t,Object(st.a)(e,[l*r.shape[0],f*r.shape[1],d*r.shape[2],h*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},dn={kernelName:o.Yc,gradFunc:function(e,t,n){var r=n.perm,a=ve.h(r);return{x:function(){return Object(be.a)(e,a)}}}},hn=n(69),pn={kernelName:o.ad,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return Object(hn.a)(e,r)}}}},vn=n(71),mn=n(106),bn=n(102),gn={kernelName:o.bd,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=Object(i.a)(t,1)[0];return{x:function(){return function(e,t){for(var n=Object(bn.a)(t,Object(j.a)(t)),r=Object(mn.a)(e,n),a=Object(X.a)(t,Object(h.a)(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=Object(vn.a)(a,o+1);a=Object($.a)(a,Object(it.a)(r.shape,"bool"));var u=Object(j.a)(r);return Object(J.a)(a,r,u)}(e,n)}}}};for(var yn={kernelName:o.cd,gradFunc:function(e){return{x:function(){return Object(j.a)(e)}}}},xn=n(70),On=0,kn=[l,b,g,k,w,_,S,E,A,N,T,I,L,B,U,q,H,G,K,Q,Z,te,ue,ie,le,de,pe,ge,Oe,ke,_t,we,_e,Se,Ee,Ce,Ne,Ae,De,Me,Le,Pe,Be,We,Ue,qe,He,Ge,Ke,Ye,Qe,Qe,et,nt,at,ot,ut,ct,lt,dt,ht,pt,mt,bt,yt,xt,xt,wt,jt,St,Et,Ct,At,Nt,Tt,Dt,Ft,Mt,zt,Pt,Bt,Wt,Vt,Ht,Xt,Yt,Jt,Zt,Zt,tn,tn,nn,an,rn,on,un,cn,sn,ln,fn,dn,pn,gn,yn];On<kn.length;On++){var wn=kn[On];Object(xn.e)(wn)}n(247);var jn,_n=n(3),Sn=n(10),En=n(14),Cn=n(15);function An(){return null==jn&&(jn=Object(a.backend)().epsilon()),jn}var Nn=n(13),Tn=n(9),In=n(43),Dn=n(23),Fn=n(155);var Mn=n(225);function Rn(e){var t="function"===typeof Map?new Map:void 0;return(Rn=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Object(Mn.a)(e,arguments,Object(Dn.a)(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Object(Fn.a)(r,e)})(e)}var zn=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(In.a)(r),n.prototype),r}return n}(Rn(Error)),Ln=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(In.a)(r),n.prototype),r}return n}(Rn(Error)),Pn=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(In.a)(r),n.prototype),r}return n}(Rn(Error)),Bn=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(In.a)(r),n.prototype),r}return n}(Rn(Error)),Wn=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(In.a)(r),n.prototype),r}return n}(Rn(Error));Error;function Un(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function Vn(e,t){if(!e)throw new Wn(t)}function qn(e,t){var n,r=0,a=Object(Tn.a)(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(i){a.e(i)}finally{a.f()}return r}function Hn(e){return 1===e.length?e[0]:e}function Gn(e){return Array.isArray(e)?e:[e]}function Kn(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function Xn(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var Yn={};function $n(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function Jn(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return Jn(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?Jn(a):e[r]=a.value)}}function Qn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var o,u=e;if(u in n)o=n[u];else if(u in Yn)o=Yn[u];else if(null==(o=t[u]))throw new Pn("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return o}var c=e;if(null==c.className||null==c.config)throw new Pn("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(c),".\n")+"'className' and 'config' must set.");var s,l,f=c.className;if(f in n){var d=Object(i.a)(n[f],2);s=d[0],l=d[1]}else if(f in Yn){var h=Object(i.a)(Yn.className,2);s=h[0],l=h[1]}else if(f in t){var p=Object(i.a)(t[f],2);s=p[0],l=p[1]}if(null==s)throw new Pn("Unknown ".concat(r,": ").concat(f,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=l){for(var v={},m=0,b=Object.keys(Yn);m<b.length;m++){var g=b[m];v[g]=Yn[g]}for(var y=0,x=Object.keys(n);y<x.length;y++){var O=x[y];v[O]=n[O]}var k=c.config;k.customObjects=v;for(var w=Object.assign({},Yn),j=0,_=Object.keys(n);j<_.length;j++){var S=_[j];Yn[S]=n[S]}Jn(c.config);var E=l(s,c.config,n,a);return Yn=Object.assign({},w),E}for(var C=Object.assign({},Yn),A=0,N=Object.keys(n);A<N.length;A++){var T=N[A];Yn[T]=n[T]}var I=new s(c.config);return Yn=Object.assign({},C),I}function Zn(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function er(e){if(null==e)return e;var t,n=[],r=Object(Tn.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function tr(e){if(null==e)throw new Pn("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function nr(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new Pn("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function rr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return Vn(n>=0),Vn(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function ar(e,t){Array.isArray(e)?(a.util.assert(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return ar(e,"element ".concat(n+1," of ").concat(t))}))):a.util.assert(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(ir(e),".")}))}function ir(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return ir(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function or(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}function ur(e,t){return Object(a.tidy)((function(){return a.sqrt(a.sum(a.mul(e,e),t,!0))}))}var cr=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"getConfig",value:function(){return{}}}]),n}(a.serialization.Serializable),sr=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return Object(Sn.a)(n,[{key:"apply",value:function(e){var t=this;return Object(a.tidy)((function(){var n=ur(e,t.axis),r=a.clipByValue(n,0,t.maxValue);return a.mul(e,a.div(r,a.add(An(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(cr);sr.className="MaxNorm",a.serialization.registerClass(sr);var lr=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return Object(Sn.a)(n,[{key:"apply",value:function(e){var t=this;return Object(a.tidy)((function(){return a.div(e,a.add(An(),ur(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(cr);lr.className="UnitNorm",a.serialization.registerClass(lr);var fr=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return a.relu(e)}}]),n}(cr);fr.className="NonNeg",a.serialization.registerClass(fr);var dr=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return Object(Sn.a)(n,[{key:"apply",value:function(e){var t=this;return Object(a.tidy)((function(){var n=ur(e,t.axis),r=a.add(a.mul(t.rate,a.clipByValue(n,t.minValue,t.maxValue)),a.mul(1-t.rate,n));return a.mul(e,a.div(r,a.add(An(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(cr);dr.className="MinMaxNorm",a.serialization.registerClass(dr);var hr={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function pr(e){return $n(e)}function vr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Qn(e,a.serialization.SerializationMap.getMap().classNameMap,t,"constraint")}function mr(e){return null==e?null:"string"===typeof e?vr({className:e in hr?hr[e]:e,config:{}}):e instanceof cr?e:vr(e)}var br=["channelsFirst","channelsLast"],gr=["nearest","bilinear"],yr=["valid","same","causal"],xr=["max","avg"],Or=["sum","mul","concat","ave"],kr=new Map;function wr(e){nr(br,"DataFormat",e)}function jr(e){nr(yr,"PaddingMode",e)}function _r(e){nr(xr,"PoolMode",e)}var Sr=[];function Er(e,t){Sr.push(e);try{var n=t();return Sr.pop(),n}catch(r){throw Sr.pop(),r}}function Cr(e){if(!Tr(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===Sr.length?"":Sr.join("/")+"/")+e}function Ar(e){if(!Tr(e))throw new Error("Not a valid tensor name: '"+e+"'");kr.has(e)||kr.set(e,0);var t=kr.get(e);if(kr.set(e,kr.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return kr.set(n,1),n}return e}var Nr=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Tr(e){return!!e.match(Nr)}function Ir(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function Dr(e){return e=Array.isArray(e)?new Float32Array(e):e,Object(a.tensor1d)(e)}function Fr(e){return a.min(Dr(e)).dataSync()[0]}function Mr(e){return a.max(Dr(e)).dataSync()[0]}function Rr(e,t){if(t<e)throw new Pn("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function zr(e,t){return e.asType(t)}function Lr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function Pr(e){var t=[Ir(e.shape)];return e.reshape(t)}function Br(e,t,n){return Object(a.tidy)((function(){switch(e.rank){case 1:return a.slice1d(e,t,n);case 2:return a.slice2d(e,[t,0],[n,e.shape[1]]);case 3:return a.slice3d(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return a.slice4d(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return a.slice(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return a.slice(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new Pn("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Wr(e,t,n){return Object(a.tidy)((function(){switch(e.rank){case 1:return a.slice1d(e,t,n);case 2:return a.slice2d(e,[0,t],[e.shape[0],n]);case 3:return a.slice3d(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return a.slice4d(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new Pn("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Ur(e,t,n,r){return Object(a.tidy)((function(){switch(e.rank){case 1:return a.slice1d(e,t,n);case 2:switch(r){case 1:return Br(e,t,n);case 2:return Wr(e,t,n);default:throw new Pn("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return Br(e,t,n);case 2:return a.slice3d(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return Wr(e,t,n);default:throw new Pn("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return Br(e,t,n);case 2:return a.slice4d(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return a.slice4d(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return Wr(e,t,n);default:throw new Pn("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new Pn("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function Vr(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),a.concat(e,n)}function qr(e,t){switch(e.rank){case 1:return a.concat1d([e,t]);case 2:return a.concat2d([e,t],0);case 3:return a.concat3d([e,t],0);case 4:return a.concat4d([e,t],0);default:throw new Pn("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function Hr(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new Pn("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return a.tile(e,t)}function Gr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return a.randomNormal(e,t,n,r,i)}function Kr(e,t,n,r){if(e.rank<2||t.rank<2)throw new Bn("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new Bn("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return a.fused.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?$r(e.rank,r,"channelsLast"):null,activation:n})}var i=e.shape.slice(),o=i.pop();e=e.reshape([-1,o]);var u=t.shape.slice(),c=u.pop(),s=u.pop(),l=[].concat(Object(Nn.a)(u),[c]),f=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=t.transpose(f).reshape([s,-1]);var d=[].concat(Object(Nn.a)(i),Object(Nn.a)(l));return a.fused.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?$r(e.rank,r,"channelsLast"):null,activation:n}).reshape(d)}function Xr(e,t,n){return Object(a.tidy)((function(){return t=Array.isArray(t)?Object(a.tensor1d)(t,"int32"):t.toInt(),a.gather(e,t,n)}))}function Yr(e){return a.mul(e,e)}function $r(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new Pn("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new Pn("Unsupported input rank by biasAdd: ".concat(t.rank))}function Jr(e,t,n){return Object(a.tidy)((function(){return null==n&&(n="channelsLast"),wr(n),e.add($r(e.rank,t,n))}))}function Qr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new Bn("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return a.elu(e)}function Zr(e,t,n,r){return Object(a.tidy)((function(){return a.dropout(e,t,n,r)}))}function ea(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var ta=["fanIn","fanOut","fanAvg"],na=["normal","uniform","truncatedNormal"];var ra=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(a.serialization.Serializable),aa=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){return Object(a.zeros)(e,t)}}]),n}(ra);aa.className="Zeros",a.serialization.registerClass(aa);var ia=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){return Object(a.ones)(e,t)}}]),n}(ra);ia.className="Ones",a.serialization.registerClass(ia);var oa=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),r=t.call(this),"object"!==typeof e)throw new Pn("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new Pn("config must have value set but got ".concat(e));return r.value=e.value,r}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){var n=this;return Object(a.tidy)((function(){return Object(a.mul)(Object(a.scalar)(n.value),Object(a.ones)(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(ra);oa.className="Constant",a.serialization.registerClass(oa);var ua=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){return Object(a.randomUniform)(e,this.minval,this.maxval,t)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(ra);ua.className="RandomUniform",a.serialization.registerClass(ua);var ca=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Bn("randomNormal does not support dType ".concat(t,"."));return Gr(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(ra);ca.className="RandomNormal",a.serialization.registerClass(ca);var sa=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Bn("truncatedNormal does not support dType ".concat(t,"."));return Object(a.truncatedNormal)(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(ra);sa.className="TruncatedNormal",a.serialization.registerClass(sa);var la=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){var n=this;return Object(a.tidy)((function(){if(2!==e.length||e[0]!==e[1])throw new Pn("Identity matrix initializer can only be used for 2D square matrices.");return Object(a.mul)(n.gain,Object(a.eye)(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(ra);la.className="Identity",a.serialization.registerClass(la);var fa=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r,a;if(Object(_n.a)(this,n),r=t.call(this),e.scale<0)throw new Pn("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,a=r.mode,nr(ta,"FanMode",a),r.distribution=null==e.distribution?"normal":e.distribution,function(e){nr(na,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(wr(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=Ir(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=Ir(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=Ir(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],i=n[1],o=this.scale;if("fanIn"===this.mode?o/=Math.max(1,r):"fanOut"===this.mode?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),"normal"===this.distribution){var u=Math.sqrt(o);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Bn("".concat(this.getClassName()," does not support dType ").concat(t,"."));return Object(a.truncatedNormal)(e,0,u,t,this.seed)}var c=Math.sqrt(3*o);return Object(a.randomUniform)(e,-c,c,t)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(ra);fa.className="VarianceScaling",a.serialization.registerClass(fa);var da=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return Object(Sn.a)(n,[{key:"getClassName",value:function(){return fa.className}}]),n}(fa);da.className="GlorotUniform",a.serialization.registerClass(da);var ha=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return Object(Sn.a)(n,[{key:"getClassName",value:function(){return fa.className}}]),n}(fa);ha.className="GlorotNormal",a.serialization.registerClass(ha);var pa=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return Object(Sn.a)(n,[{key:"getClassName",value:function(){return fa.className}}]),n}(fa);pa.className="HeNormal",a.serialization.registerClass(pa);var va=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return Object(Sn.a)(n,[{key:"getClassName",value:function(){return fa.className}}]),n}(fa);va.className="HeUniform",a.serialization.registerClass(va);var ma=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return Object(Sn.a)(n,[{key:"getClassName",value:function(){return fa.className}}]),n}(fa);ma.className="LeCunNormal",a.serialization.registerClass(ma);var ba=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return Object(Sn.a)(n,[{key:"getClassName",value:function(){return fa.className}}]),n}(fa);ba.className="LeCunNormal",a.serialization.registerClass(ba);var ga=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new Bn("Random seed is not implemented for Orthogonal Initializer yet.");return r}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){var n=this;return Object(a.tidy)((function(){if(e.length<2)throw new Bn("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=Gr(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=a.linalg.gramSchmidt(t);return e[0]>e[1]&&(r=r.transpose()),Object(a.mul)(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(ra);ga.className="Orthogonal",a.serialization.registerClass(ga);var ya={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function xa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Qn(e,a.serialization.SerializationMap.getMap().classNameMap,t,"initializer")}function Oa(e){return $n(e)}function ka(e){if("string"===typeof e){var t=e in ya?ya[e]:e;if("GlorotNormal"===t)return new ha;if("GlorotUniform"===t)return new da;if("HeNormal"===t)return new pa;if("HeUniform"===t)return new va;if("LeCunNormal"===t)return new ma;if("LeCunUniform"===t)return new ba;var n={};return n.className=t,n.config={},xa(n)}return e instanceof ra?e:xa(e)}var wa=0;function ja(){return wa++}var _a={};function Sa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in _a||(_a[e]=0),_a[e]+=1,e+_a[e].toString()}function Ea(e){return Array.isArray(e)&&Array.isArray(e[0])}function Ca(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function Aa(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new Pn("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function Na(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return(e=e)[0];throw new Pn("Expected exactly 1 Shape; got ".concat(e.length))}return e}function Ta(e){var t,n=0,r=Object(Tn.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch(i){r.e(i)}finally{r.f()}return n}var Ia="Variable",Da=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ia,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(_n.a)(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=ja(),r=null==r?Ia:r,this.originalName=Cr(r),this.name=Ar(this.originalName),this.trainable_=i,this.constraint=o,this.val=a.variable(t,this.trainable_,this.name,this.dtype)}return Object(Sn.a)(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function Fa(e){return e.map((function(e){return e.read()}))}function Ma(e){e.forEach((function(e){e[0].write(e[1])}))}var Ra=function e(t){Object(_n.a)(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},za=function e(t,n,r,a,i,o,u){Object(_n.a)(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=u,this.id=ja(),null!=o&&(this.originalName=Cr(o),this.name=Ar(this.originalName)),this.rank=n.length},La=0,Pa=function(){function e(t,n){Object(_n.a)(this,e),this.callArgs=n,this.id=La++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=Object(Tn.a)(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(o){a.e(o)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return Object(Sn.a)(e,[{key:"getConfig",value:function(){var e,t=[],n=Object(Tn.a)(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch(a){n.e(a)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),Ba=0,Wa=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(_n.a)(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=Ba++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=Kn(i)+"_"+Sa(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var u=null;null!=r.batchSize&&(u=r.batchSize),o=[u].concat(r.inputShape)}e.batchInputShape=o;var c=r.dtype;null==c&&(c=r.inputDType),null==c&&(c="float32"),e.dtype=c}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return Object(Sn.a)(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new Ln("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new Pn("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return Hn(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return Hn(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new zn("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new zn("Layer ".concat(this.name)+" is not connected, no input to return.");return Hn(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new zn("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new zn("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Hn(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=Gn(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=Gn(this.inputSpec);if(e.length!==t.length)throw new Pn("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new Pn("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new Pn("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new Pn("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new Pn("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var u in a.axes){var c=Number(u),s=a.axes[u],l=c>=0?o[c]:o[o.length+c];if(null!=s&&-1===[s,null].indexOf(l))throw new Pn("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(c," of input shape to ")+"have value ".concat(s," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var f=0;f<a.shape.length;++f){var d=a.shape[f],h=r.shape[f];if(null!=d&&null!=h&&d!==h)throw new Pn("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=Gn(e),i=!0,o=Object(Tn.a)(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof za)){i=!1;break}}}catch(l){o.e(l)}finally{o.f()}var u,c=!0,s=Object(Tn.a)(a);try{for(s.s();!(u=s.n()).done;){if(u.value instanceof za){c=!1;break}}}catch(l){s.e(l)}finally{s.f()}if(i===c)throw new Pn("Arguments to apply() must be all SymbolicTensors or all Tensors");return Er(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=Object(Tn.a)(Gn(e));try{for(o.s();!(r=o.n()).done;){var u=r.value;i.push(u.shape)}}catch(l){o.e(l)}finally{o.f()}n.build(Hn(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&c&&(n._refCount=1)}if(n.assertInputCompatibility(e),c){var s,f=n.call(e,t),d=Gn(f),h=[],p=Object(Tn.a)(d);try{for(p.s();!(s=p.n()).done;){var v=s.value;-1!==a.indexOf(v)&&(v=v.clone()),h.push(v)}}catch(l){p.e(l)}finally{p.f()}if(f=Hn(h),null!=n.activityRegularizer)throw new Bn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f}var m,b=function(e){e=Gn(e);var t,n=[],r=Object(Tn.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(l){r.e(l)}finally{r.f()}return Hn(n)}(e),g=n.computeOutputShape(b),y="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?b[0]:b),m=null!=g&&g.length>0&&Array.isArray(g[0])?g.map((function(r,a){return new za(y,r,n,Gn(e),t,n.name,a)})):new za(y,g,n,Gn(e),t,n.name),n.addInboundNode(e,m,null,null,b,g,t),n._refCount++,null!=n.activityRegularizer)throw new Bn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return m}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new zn("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=Object(Tn.a)(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(o){n.e(o)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new zn("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new Ln("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Ta(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Fa(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;Object(a.tidy)((function(){var n=t.weights;if(n.length!==e.length)throw new Pn('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],i=Fa(n),o=0;o<i.length;++o){var u=i[o],c=n[o],s=e[o];if(!a.util.arraysEqual(u.shape,s.shape))throw new Pn("Layer weight shape ".concat(u.shape," ")+"not compatible with provided weight shape ".concat(s.shape));r.push([c,s])}Ma(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new Pn("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=ka("zeros"));var u=r.apply(t,n),c=new Da(u,n,e,i,o);return u.dispose(),null!=a&&this.addLoss((function(){return a.apply(c.read())})),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=Gn(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,Object(Nn.a)(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=Gn(e);t=Gn(t),n=Gn(n),r=Gn(r),a=Ca(a),i=Ca(i);var c,s=[],l=[],f=[],d=Object(Tn.a)(u);try{for(d.s();!(c=d.n()).done;){var h=c.value;s.push(h.sourceLayer),l.push(h.nodeIndex),f.push(h.tensorIndex)}}catch(v){d.e(v)}finally{d.f()}new Pa({outboundLayer:this,inboundLayers:s,nodeIndices:l,tensorIndices:f,inputTensors:u,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(a.serialization.Serializable);function Ua(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,u=Ua(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]),c=Object(Tn.a)(u);try{for(c.s();!(o=c.n()).done;){var s=o.value;-1===a.indexOf(s)&&a.push(s)}}catch(l){c.e(l)}finally{c.f()}}return a}var Va=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:Sa("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new Pn("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new Pn("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new Pn("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new za(r.dtype,r.batchInputShape,Object(In.a)(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new Pa({outboundLayer:Object(In.a)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){throw new Pn("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(Wa);function qa(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new Pn("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new Va({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}Va.className="InputLayer",a.serialization.registerClass(Va);var Ha,Ga=n(4),Ka=n.n(Ga),Xa=n(17);function Ya(e){return $a.apply(this,arguments)}function $a(){return($a=Object(Xa.a)(Ka.a.mark((function e(t){var n,r,i,o,u,c,s,l;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(o in n=[],r=[],i=[],t)"number"!==typeof(u=t[o])&&(c=u,n.push(c.data()),r.push(o),i.push(c));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(s=e.sent,l=0;l<s.length;++l)t[r[l]]=s[l][0];Object(a.dispose)(i);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ja(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(Ha||(Ha={}));var Qa=function(){function e(){Object(_n.a)(this,e),this.validationData=null}return Object(Sn.a)(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),Za=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;Object(_n.a)(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return Object(Sn.a)(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=Object(Tn.a)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=Object(Tn.a)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,a,i;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=Object(Tn.a)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,a,i;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=Object(Tn.a)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,a,i;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=Object(Tn.a)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,a,i;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=Object(Tn.a)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){var n,r,a;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=Object(Tn.a)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){var n,r,a;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=Object(Tn.a)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ei=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.call(this)}return Object(Sn.a)(n,[{key:"onEpochBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,i,o,u=this;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,i=function(e){var t=n[e];if("number"===typeof t)u.totals.hasOwnProperty(e)||(u.totals[e]=0),u.totals[e]=u.totals[e]+t*r;else{var i;e in u.totals?i=u.totals[e]:u.totals[e]=0;var o=Object(a.tidy)((function(){return Object(a.add)(u.totals[e],Object(a.mul)(t,r))}));u.totals[e]=o,null!=i&&i.dispose()}},n)i(o);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,i,o,u=this;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=19;break}r=Object(Tn.a)(this.params.metrics),e.prev=2,o=function(){var e=i.value;if(null==u.totals[e])return"continue";"number"===typeof u.totals[e]?n[e]=u.totals[e]/u.seen:Object(a.tidy)((function(){var t=Object(a.mul)(Object(a.div)(1,u.seen),u.totals[e]);n[e]=t,u.totals[e].dispose(),Object(a.keep)(n[e])}))},r.s();case 5:if((i=r.n()).done){e.next=11;break}if("continue"!==o()){e.next=9;break}return e.abrupt("continue",9);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(Qa),ti=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"onTrainBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(){var t,n,r,a,i,o,u,c,s;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(u=i[o],t.push(u.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(c=e.sent,s=0;s<c.length;++s)this.history[n[s]][r[s]].dispose(),this.history[n[s]][r[s]]=c[s][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Qa),ni=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e,r){var i;if(Object(_n.a)(this,n),(i=t.call(this)).currentEpoch=0,i.yieldEvery=r||"auto","auto"===i.yieldEvery&&(i.yieldEvery=125),"never"===i.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return a.util.isNumber(i.yieldEvery)&&(i.maybeWait=function(e,t){var n,r=a.util.now();return function(){var i=a.util.now();return i-r<t?n:(r=i,n=e.apply(void 0,arguments))}}(i.maybeWait.bind(Object(In.a)(i)),i.yieldEvery)),i.trainBegin=e.onTrainBegin,i.trainEnd=e.onTrainEnd,i.epochBegin=e.onEpochBegin,i.epochEnd=e.onEpochEnd,i.batchBegin=e.onBatchBegin,i.batchEnd=e.onBatchEnd,i.yield=e.onYield,i}return Object(Sn.a)(n,[{key:"maybeWait",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n,r){var i;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[],null==this.yield){e.next=5;break}return e.next=4,Ya(r);case 4:i.push(this.yield(t,n,r));case 5:return i.push(Object(a.nextFrame)()),e.next=8,Promise.all(i);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,Ya(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,Ya(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(Object(a.nextFrame)()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,Ya(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,Ya(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(Object(a.nextFrame)()):a.util.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,Ya(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,Ya(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Qa);function ri(e,t){return null==e&&(e={}),e instanceof Qa?[e]:Array.isArray(e)&&e[0]instanceof Qa?e:Gn(e).map((function(e){return new ni(e,t)}))}var ai=function(){function e(){Object(_n.a)(this,e)}return Object(Sn.a)(e,null,[{key:"registerCallbackConstructor",value:function(t,n){a.util.assert(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new Pn("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,Object(Nn.a)(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function ii(e,t,n,r,a,i,o,u,c){var s=new ti,l=[new ei].concat(Object(Nn.a)(ai.createCallbacks(t)));null!=e&&l.push.apply(l,Object(Nn.a)(e)),l.push(s);var f=new Za(l);return f.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:u,metrics:c}),{callbackList:f,history:s}}ai.constructors={};var oi=n(25);function ui(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Qn(e,a.serialization.SerializationMap.getMap().classNameMap,t,"layer",n)}function ci(e,t){return Object(a.tidy)((function(){"float32"!==e.dtype&&(e=e.asType("float32"));var n=a.sum(Yr(e),t,!0),r=a.fill(n.shape,An()),i=a.sqrt(a.maximum(n,r));return a.div(e,i)}))}function si(e,t){return Object(a.tidy)((function(){return a.mean(Yr(a.sub(t,e)),-1)}))}function li(e,t){return Object(a.tidy)((function(){return a.mean(a.abs(a.sub(t,e)),-1)}))}function fi(e,t){return Object(a.tidy)((function(){var n=a.sub(e,t),r=a.clipByValue(a.abs(e),An(),Number.MAX_VALUE),i=a.abs(a.div(n,r));return a.mul(100,a.mean(i,-1))}))}function di(e,t){return Object(a.tidy)((function(){var n=a.clipByValue(t,An(),Number.MAX_VALUE),r=a.log(a.add(1,n)),i=a.clipByValue(e,An(),Number.MAX_VALUE),o=a.log(a.add(1,i));return a.mean(Yr(a.sub(r,o)),-1)}))}function hi(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(a.tidy)((function(){if(n)t=a.softmax(t);else{var r=a.sum(t,t.shape.length-1,!0);t=a.div(t,r)}return t=a.clipByValue(t,An(),1-An()),a.neg(a.sum(a.mul(e.toFloat(),a.log(t)),t.shape.length-1))}))}function pi(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(a.tidy)((function(){var r=a.floor(Pr(e)).toInt(),i=(t=a.clipByValue(t,An(),1-An())).shape;return hi(a.oneHot(r,i[i.length-1]).reshape(i),t,n)}))}function vi(e,t){return Object(a.tidy)((function(){var n;return n=a.clipByValue(t,An(),1-An()),n=a.log(a.div(n,a.sub(1,n))),a.mean(function(e,t){if(!a.util.arraysEqual(e.shape,t.shape))throw new Pn("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return Object(a.tidy)((function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())}))}(e,n),-1)}))}function mi(e,t){return Object(a.tidy)((function(){var n=a.clipByValue(e,An(),1),r=a.clipByValue(t,An(),1);return a.sum(a.mul(e,a.log(a.div(n,r))),-1)}))}function bi(e,t){return Object(a.tidy)((function(){var n=ci(e,-1),r=ci(t,-1),i=a.mul(n,r);return a.neg(a.sum(i,-1))}))}var gi={meanSquaredError:si,meanAbsoluteError:li,meanAbsolutePercentageError:fi,meanSquaredLogarithmicError:di,squaredHinge:function(e,t){return Object(a.tidy)((function(){var n=a.maximum(0,a.sub(1,a.mul(e,t)));return a.mean(Yr(n),-1)}))},hinge:function(e,t){return Object(a.tidy)((function(){var n=a.maximum(0,a.sub(1,a.mul(e,t)));return a.mean(n,-1)}))},categoricalHinge:function(e,t){return Object(a.tidy)((function(){var n=a.sum(a.mul(e,t),-1),r=a.max(a.mul(a.sub(1,e),t),-1);return a.maximum(0,a.add(1,a.sub(r,n)))}))},logcosh:function(e,t){return Object(a.tidy)((function(){var n=Math.log(2),r=a.sub(t,e),i=a.sub(a.add(r,a.softplus(a.mul(-2,r))),n);return a.mean(i,-1)}))},categoricalCrossentropy:hi,sparseCategoricalCrossentropy:pi,binaryCrossentropy:vi,kullbackLeiblerDivergence:mi,poisson:function(e,t){return Object(a.tidy)((function(){var n=a.log(a.add(An(),t));return a.mean(a.sub(t,a.mul(e,n)),-1)}))},cosineProximity:bi};function yi(e){if("string"===typeof e){if(e in gi)return gi[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Pn(t)}return e}function xi(e,t){return Object(a.tidy)((function(){var n=a.mul(.5,a.onesLike(t)),r=zr(a.greater(t,n),e.dtype);return a.mean(a.equal(e,r),-1)}))}function Oi(e,t){return Object(a.tidy)((function(){return zr(a.equal(a.argMax(e,-1),a.argMax(t,-1)),"float32")}))}function ki(e,t){return Object(a.tidy)((function(){return a.logicalAnd(e.equal(1),t.equal(1)).sum().cast("float32")}))}function wi(e,t){return Object(a.tidy)((function(){var n=ki(e,t),r=function(e,t){return Object(a.tidy)((function(){return a.logicalAnd(e.equal(0),t.equal(1)).sum().cast("float32")}))}(e,t),i=n.add(r);return a.where(a.greater(i,0),n.div(i),0).cast("float32")}))}function ji(e,t){return vi(e,t)}function _i(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),a.equal(e,t).asType("float32")}var Si=hi,Ei=pi,Ci={binaryAccuracy:xi,categoricalAccuracy:Oi,precision:wi,categoricalCrossentropy:Si,sparseCategoricalCrossentropy:Ei,mse:si,MSE:si,mae:li,MAE:li,mape:fi,MAPE:fi,cosine:bi};function Ai(e){if("string"===typeof e&&e in Ci)return Ci[e];if("string"!==typeof e&&null!=e)return e;throw new Pn("Unknown metric ".concat(e))}function Ni(e){if(Vn(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(gi);n<r.length;n++){var a=r[n];if(gi[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(Ci);i<o.length;i++){var u=o[i];if(Ci[u]===e){t=u;break}}return void 0!==t?t:e.name}var Ti=1048576;function Ii(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!Di(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>Ti&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(Ti,"."))}}function Di(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!Di(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=Object(Tn.a)(e);try{for(i.s();!(a=i.n()).done;){if(!Di(a.value))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function Fi(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=Ri(e),o=["Layer (type)","Output shape","Param #"];if(i?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var u in o.push("Receives inputs"),r=[],e.nodesByDepth){var c;(c=r).push.apply(c,Object(Nn.a)(e.nodesByDepth[u]))}a("_".repeat(t)),zi(o,n,a),a("=".repeat(t));for(var s=e.layers,l=0;l<s.length;++l)i?Li(s[l],n,a):Pi(s[l],n,r,a),a((l===s.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var f=Mi(e),d=Ta(e.nonTrainableWeights);a("Total params: ".concat(f+d)),a("Trainable params: ".concat(f)),a("Non-trainable params: ".concat(d)),a("_".repeat(t))}function Mi(e){return null!=e.collectedTrainableWeights?Ta(e.collectedTrainableWeights):Ta(e.trainableWeights)}function Ri(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var u=o[i];if(u.length>1||1===u.length&&u[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,Object(Nn.a)(u))}if(t){var c,s=Object(Tn.a)(e.layers);try{for(s.s();!(c=s.n()).done;){var l,f=c.value,d=!1,h=Object(Tn.a)(f.inboundNodes);try{for(h.s();!(l=h.n()).done;){var p=l.value;if(-1!==r.indexOf(p)){if(d){t=!1;break}d=!0}}}catch(v){h.e(v)}finally{h.f()}if(!t)break}}catch(v){s.e(v)}finally{s.f()}}return t}function zi(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function Li(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(o){r="multiple"}var a=e.name,i=e.getClassName();zi(["".concat(a," (").concat(i,")"),r,e.countParams().toString()],t,n)}function Pi(e,t,n,r){var a;try{a=JSON.stringify(e.outputShape)}catch(b){a="multiple"}var i,o=[],u=Object(Tn.a)(e.inboundNodes);try{for(u.s();!(i=u.n()).done;){var c=i.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(var s=0;s<c.inboundLayers.length;++s){var l=c.inboundLayers[s].name,f=c.nodeIndices[s],d=c.tensorIndices[s];o.push("".concat(l,"[").concat(f,"][").concat(d,"]"))}}}catch(b){u.e(b)}finally{u.f()}var h=e.name,p=e.getClassName(),v=0===o.length?"":o[0];zi(["".concat(h," (").concat(p,")"),a,e.countParams().toString(),v],t,r);for(var m=1;m<o.length;++m)zi(["","","",o[m]],t,r)}function Bi(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function Wi(e,t){if(null===e)return null;if("string"===typeof e)return Xn(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];Bi(t,a,i)?n.push(i):n.push(Wi(i,t))}return n}for(var o={},u=0,c=Object.keys(e);u<c.length;u++){var s=c[u],l=e[s];if("name"===s&&"string"===typeof l)o[s]=l;else{var f=Xn(s);o[f]=Wi(l,f)}}return o}function Ui(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return Kn(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];Bi(t,a,i)?n.push(i):n.push(Ui(i,t))}return n}for(var o={},u=0,c=Object.keys(e);u<c.length;u++){var s=c[u],l=e[s],f=Kn(s);o[f]="name"!==s&&"className"!==s||"string"!==typeof l?Ui(l,s):l}return o}var Vi="3.5.0";var qi=function(){function e(t){if(Object(_n.a)(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=Object(Tn.a)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(o){a.e(o)}finally{a.f()}}}return Object(Sn.a)(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new Pn("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Object(a.cast)(t,e.dtype)}catch(n){throw new Pn("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof za){if(null==this.id2Value[e.id])throw new Pn("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new Pn("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof za){if(null==this.id2Value[e.id])throw new Pn("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new Pn("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&Object(a.dispose)(this.id2Mask)}}]),e}(),Hi={},Gi={};function Ki(e,t,n,r){var i,o=null!=n&&n.training,u=Array.isArray(e),c=u?e:[e],s=c.map((function(e){return e.name})),l=[],f=t.names(),d=Object(Tn.a)(s);try{for(d.s();!(i=d.n()).done;){var h=i.value;-1!==f.indexOf(h)?l.push(t.getValue(h)):l.push(null)}}catch(L){d.e(L)}finally{d.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var p,v,m=s.join(",")+"|"+t.names().join(",");if(null==Hi[m]){var b=function(e,t){a.util.assert(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var i=Yi(e[0],t);n=i.sorted,r=i.recipientMap}else{var o,u=new Set,c=Object(Tn.a)(e);try{for(c.s();!(o=c.n()).done;){var s,l=Yi(o.value,t),f=l.sorted,d=l.recipientMap,h=Object(Tn.a)(f);try{for(h.s();!(s=h.n()).done;){var p=s.value;u.has(p.name)||(n.push(p),u.add(p.name))}}catch(L){h.e(L)}finally{h.f()}var v=function(e){null==r[e]&&(r[e]=new Set),d[e].forEach((function(t){return r[e].add(t)}))};for(var m in d)v(m)}}catch(L){c.e(L)}finally{c.f()}}return{sorted:n,recipientCounts:Xi(r)}}(c,t);p=b.sorted,v=b.recipientCounts,Hi[m]=p,Gi[m]=v}p=Hi[m],v={},o||Object.assign(v,Gi[m]);for(var g=new qi(t),y=0;y<p.length;++y){if(null!=r){var x=Object(a.memory)().numTensors;x>r.maxNumTensors&&(r.maxNumTensors=x),x<r.minNumTensors&&(r.minNumTensors=x)}var O=p[y],k=O.sourceLayer;if(!(k instanceof Va)){var w,j=[],_=[],S=[],E=!1,C=Object(Tn.a)(O.inputs);try{for(C.s();!(w=C.n()).done;){var A=w.value,N=g.getValue(A),T=g.getMask(A);j.push(N),_.push(T),null!=T&&(E=!0),o||(v[A.name]--,0!==v[A.name]||t.hasKey(A)||-1!==s.indexOf(A.name)||N.isDisposed||!0===A.sourceLayer.stateful||S.push(N))}}catch(L){C.e(L)}finally{C.f()}E&&((n=n||{}).mask=_[0]);var I=Gn(k.apply(j,n)),D=null;k.supportsMasking&&(D=k.computeMask(j,_));for(var F=$i(O),M=Array.isArray(F)?F:[F],R=0;R<M.length;++R){g.hasKey(M[R])||g.add(M[R],I[R],Array.isArray(D)?D[0]:D);var z=s.indexOf(M[R].name);-1!==z&&(l[z]=I[R])}o||Object(a.dispose)(S)}}return g.disposeMasks(),u?l:l[0]}function Xi(e){var t={};for(var n in e)t[n]=e[n].size;return t}function Yi(e,t){var n,r=new Set,a=[],i={},o=Object(Tn.a)(t.names());try{for(o.s();!(n=o.n()).done;){var u=n.value;r.add(u)}}catch(v){o.e(v)}finally{o.f()}var c=[],s=[];for(c.push(e);c.length>0;){var l=c[c.length-1];if(r.has(l.name))c.pop();else{var f=s[s.length-1]===c.length-1;if(0===l.inputs.length||f)c.pop(),a.push(l),r.add(l.name),f&&s.pop();else{s.push(c.length-1);var d,h=Object(Tn.a)(l.inputs);try{for(h.s();!(d=h.n()).done;){var p=d.value;null==i[p.name]&&(i[p.name]=new Set),i[p.name].add(l.name),r.has(p.name)||c.push(p)}}catch(v){h.e(v)}finally{h.f()}}}}return{sorted:a,recipientMap:i}}function $i(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=Object(Tn.a)(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(o){i.e(o)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function Ji(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function Qi(e,t){return Ji(e,t,"classWeight")}function Zi(e,t,n,r){return eo.apply(this,arguments)}function eo(){return(eo=Object(Xa.a)(Ka.a.mark((function e(t,n,r,i){var o,u,c;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==i){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return o=Object(a.tidy)((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1){return t.argMax(1)}if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,o.data();case 7:return e.t1=e.sent,u=e.t0.from.call(e.t0,e.t1),Object(a.dispose)(o),c=[],u.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");c.push(r[e])})),e.abrupt("return",Object(a.tensor1d)(c,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function to(e,t){return Object(a.mul)(e,t)}function no(e,t){var n,r,i=t;n=i.xs,r=i.ys,a.util.assert(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var o=ro("input",e.inputNames,n),u=ro("output",e.outputNames,r),c=o[0].shape[0];a.util.assert(o.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(o.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),a.util.assert(u.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(u.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var s=function(t){a.util.assert(o[t].shape[0]===c,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(e.inputNames[0],".")}))},l=0;l<o.length;l++)s(l);for(var f=function(t){a.util.assert(u[t].shape[0]===c,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(u[t].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(e.inputNames[0],".")}))},d=0;d<u.length;d++)f(d);return{xs:o,ys:u}}function ro(e,t,n){if(n instanceof a.Tensor)return[n];if(Array.isArray(n))return a.util.assert(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,i=[],o=Object(Tn.a)(t);try{for(o.s();!(r=o.n()).done;){var u=r.value;if(null==n[u])throw new Pn("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(u,"'."));i.push(n[u])}}catch(c){o.e(c)}finally{o.f()}return i}function ao(e){if(3===e.length)throw new Bn("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function io(e,t,n){return oo.apply(this,arguments)}function oo(){return(oo=Object(Xa.a)(Ka.a.mark((function e(t,n,r){var i,o,u,c,s,l,f,d,h,p,v,m,b,g,y,x,O,k,w,j,_,S,E,C,A,N,T,I,D,F,M,R,z;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!=r.batchesPerEpoch,a.util.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),a.util.assert(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),a.util.assert(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),a.util.assert(!i||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),a.util.assert(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(o=null!=r.validationData)&&(co(r.validationData)?a.util.assert(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(s=ao(r.validationData),u=s.xs,c=s.ys)),l=t.makeTrainFunction(),f=t.getDedupedMetricsNames(),d=o?f.slice().concat(f.map((function(e){return"val_"+e}))):f.slice(),h=ri(r.callbacks,r.yieldEvery),p=null==r.verbose?1:r.verbose,v=ii(h,p,r.epochs,null,null,uo(n,r),null,o,d),m=v.callbackList,b=v.history,m.setModel(t),t.history=b,e.next=22,m.onTrainBegin();case 22:return t.stopTraining_=!1,g=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:y=e.sent;case 27:if(!(g<r.epochs)){e.next=98;break}return x={},e.next=31,m.onEpochBegin(g);case 31:if(O=0,k=0,i){e.next=37;break}return e.next=36,n.iterator();case 36:y=e.sent;case 37:if(i&&!(O<r.batchesPerEpoch)){e.next=91;break}return e.next=40,y.next();case 40:if(w=e.sent,!i||!w.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(O," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==w.value){e.next=73;break}return j=no(t,w.value),_=j.xs,S=j.ys,(E={}).batch=k,E.size=_[0].shape[0],e.next=51,m.onBatchBegin(k,E);case 51:if(C=[],null==r.classWeight){e.next=64;break}A=Qi(r.classWeight,t.outputNames),N=0;case 55:if(!(N<A.length)){e.next=64;break}return e.t0=C,e.next=59,Zi(S[N],null,A[N]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++N,e.next=55;break;case 64:for(T=_.concat(S).concat(C),I=l(T),a.dispose(T),D=0;D<f.length;++D)F=f[D],M=I[D],E[F]=M,a.keep(M);return e.next=70,m.onBatchEnd(k,E);case 70:Ja(E),k++,O++;case 73:if(!(i?O>=r.batchesPerEpoch:w.done)){e.next=87;break}if(!o){e.next=86;break}if(R=void 0,!co(r.validationData)){e.next=84;break}return e.t2=Gn,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,R=(0,e.t2)(e.t3),e.next=85;break;case 84:R=Gn(t.evaluate(u,c,{batchSize:null==r.validationBatchSize?32:r.validationBatchSize,verbose:0}));case 85:for(z=0;z<t.metricsNames.length;++z)x["val_".concat(t.metricsNames[z])]=R[z];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,m.onEpochEnd(g,x);case 93:if(g++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,m.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])})))).apply(this,arguments)}function uo(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function co(e){return"function"===typeof e.iterator}function so(e){return"function"===typeof e.next}function lo(e,t,n){return fo.apply(this,arguments)}function fo(){return(fo=Object(Xa.a)(Ka.a.mark((function e(t,n,r){var i,o,u,c,s,l,f,d,h;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!=(r=r||{}).batches,o=t.testFunction,u=[],!(r.verbose>0)){e.next=6;break}throw new Bn("Verbose mode is not implemented yet.");case 6:if(a.util.assert(!i||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),!so(n)){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:c=e.t0,s=0,l=0,f=Ka.a.mark((function e(){var n;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.next();case 2:if(n=e.sent,u=a.tidy((function(){return n.value&&function(){var e=no(t,n.value),r=e.xs,i=e.ys,c=r.concat(i),f=a.tidy((function(){return o(c)}));if(a.dispose(c),0===l)for(var d=0;d<f.length;++d)u.push(Object(a.scalar)(0));for(var h=c[0].shape[0],p=function(e){var t=f[e],n=u[e];u[e]=a.tidy((function(){return a.add(u[e],a.mul(h,t))})),l>0&&a.dispose(n)},v=0;v<f.length;++v)p(v);a.dispose(f),s+=h,++l}(),u})),!n.done){e.next=7;break}return i&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(i&&!(l<r.batches)){e.next=25;break}return e.delegateYield(f(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(d=0;d<u.length;++d)h=u[d],u[d]=a.div(u[d],s),a.dispose(h);return e.abrupt("return",Hn(u));case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ho(e){a.util.assert(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function po(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return Br(e,t,n-t)})):Br(e,t,n-t)}function vo(e,t){return a.tidy((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return vo(e,t)})):Xr(e,"int32"===t.dtype?t:t.toInt())}))}function mo(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function bo(e,t,n,r,a,i,o,u,c,s,l,f,d,h,p){return go.apply(this,arguments)}function go(){return(go=Object(Xa.a)(Ka.a.mark((function e(t,n,r,i,o,u,c,s,l,f,d,h,p,v,m){var b,g,y,x,O,k,w,j;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==o&&(o=32),null==u&&(u=1),null==d&&(d=!0),null==p&&(p=0),b=!1,null!=l&&null!=f&&(b=!0),null==m){e.next=10;break}if(b=!0,null!=v){e.next=10;break}throw new Pn("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(g=t.checkNumSamples(r,o,v,"steps_per_epoch"))&&(y=Rr(0,g)),null==c&&(c=1),x=ii(s,c,u,p,g,v,o,b,h),O=x.callbackList,k=x.history,O.setModel(t),t.history=k,e.next=18,O.onTrainBegin();case 18:t.stopTraining_=!1,w=Ka.a.mark((function e(u){var c;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.onEpochBegin(u);case 2:if(c={},null==v){e.next=7;break}throw new Bn("stepsPerEpoch mode is not implemented yet.");case 7:return e.delegateYield(Ka.a.mark((function e(){var u,s,h,p;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("batch"!==d){e.next=4;break}throw new Bn("batch shuffling is not implemneted yet");case 4:d&&a.util.shuffle(y);case 5:u=Object(a.tensor1d)(y),s=mo(g,o),h=Ka.a.mark((function e(d){var h;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h={},e.next=3,O.onBatchBegin(d,h);case 3:return a.tidy((function(){var e=s[d][0],p=s[d][1],v=Br(u,e,p-e);h.batch=d,h.size=p-e;for(var m=vo(r,v),g=n(m),y=0;y<i.length;++y){var x=i[y],O=g[y];h[x]=O,a.keep(O)}if(d===s.length-1&&b)for(var k=t.testLoop(l,f,o),w=0;w<i.length;++w){var j=i[w],_=k[w];a.keep(_),c["val_"+j]=_}})),e.next=6,O.onBatchEnd(d,h);case 6:if(Ja(h),!t.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),p=0;case 9:if(!(p<s.length)){e.next=17;break}return e.delegateYield(h(p),"t0",11);case 11:if("break"!==e.t0){e.next=14;break}return e.abrupt("break",17);case 14:++p,e.next=9;break;case 17:u.dispose();case 18:case"end":return e.stop()}}),e)}))(),"t0",8);case 8:return e.next=10,O.onEpochEnd(u,c);case 10:if(!t.stopTraining_){e.next=12;break}return e.abrupt("return","break");case 12:case"end":return e.stop()}}),e)})),j=p;case 21:if(!(j<u)){e.next=29;break}return e.delegateYield(w(j),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++j,e.next=21;break;case 29:return e.next=31,O.onTrainEnd();case 31:return e.next=33,t.history.syncData();case 33:return e.abrupt("return",t.history);case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yo(e,t,n){return xo.apply(this,arguments)}function xo(){return(xo=Object(Xa.a)(Ka.a.mark((function e(t,n,r){var i,o,u,c,s,l,f,d,h,p,v,m,b,g,y,x,O,k,w,j,_,S,E,C,A=arguments;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=A.length>3&&void 0!==A[3]?A[3]:{},!t.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return t.isTraining=!0,e.prev=4,ho(h=null==i.batchSize?32:i.batchSize),p=!1,e.next=10,t.standardizeUserData(n,r,i.sampleWeight,i.classWeight,p,h);case 10:if(v=e.sent,o=v[0],u=v[1],d=v[2],m=!1,!(null!=i.validationData&&i.validationData.length>0)){e.next=36;break}if(m=!0,2!==i.validationData.length){e.next=22;break}c=i.validationData[0],s=i.validationData[1],e.next=27;break;case 22:if(3!==i.validationData.length){e.next=26;break}throw new Bn("validationData including sample weights is not supported yet.");case 26:throw new Pn("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(i.validationData," is invalid."));case 27:return g=!0,e.next=30,t.standardizeUserData(c,s,null,null,g,h);case 30:y=e.sent,l=y[0],f=y[1],b=l.concat(f),e.next=37;break;case 36:null!=i.validationSplit&&i.validationSplit>0&&i.validationSplit<1?(m=!0,x=Math.floor(o[0].shape[0]*(1-i.validationSplit)),O=o[0].shape[0],l=po(o,x,O),o=po(o,0,x),f=po(u,x,O),u=po(u,0,x),b=l.concat(f)):null!=i.validationSteps&&(m=!0);case 37:return k=o.concat(u).concat(d),t.checkTrainableWeightsConsistency(),w=t.makeTrainFunction(),j=t.getDedupedMetricsNames(),m?(t.makeTestFunction(),_=t.testFunction,S=j.slice().concat(j.map((function(e){return"val_"+e})))):(_=null,b=[],S=j.slice()),E=ri(i.callbacks,i.yieldEvery),e.next=45,bo(t,w,k,j,h,i.epochs,i.verbose,E,_,b,i.shuffle,S,i.initialEpoch,null,null);case 45:return C=e.sent,e.abrupt("return",C);case 47:return e.prev=47,t.isTraining=!1,ko(o,n),ko(u,r),ko(l,c),ko(f,s),null!=d&&a.dispose(d),e.finish(47);case 55:case"end":return e.stop()}}),e,null,[[4,,47,55]])})))).apply(this,arguments)}function Oo(e){var t=[];e instanceof a.Tensor&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(Lr(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function ko(e,t){if(null!=e){var n=[];if(t instanceof a.Tensor)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var i=t[r];n.push(i.id)}var o=[];if(e instanceof a.Tensor)-1===n.indexOf(e.id)&&o.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&o.push(e)}));else if(null!=e)for(var u in e){var c=e[u];-1===n.indexOf(c.id)&&o.push(c)}o.forEach((function(e){e.isDisposed||e.dispose()}))}}function wo(e){return Array.isArray(e)}function jo(e){return!function(e){return e instanceof a.Tensor}(e)&&!wo(e)}function _o(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(wo(e)&&e.length>0)o=!0;else if(jo(e)){for(var u in e)if(e.hasOwnProperty(u)){o=!0;break}}else o=!0;if(o)throw new Pn("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(jo(e)){e=e,r=[];var c,s=Object(Tn.a)(t);try{for(s.s();!(c=s.n()).done;){var l=c.value;if(null==e[l])throw new Pn('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(m){s.e(m)}finally{s.f()}}else if(wo(e)){if((e=e).length!==t.length)throw new Pn("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(e=e,t.length>1)throw new Pn("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=Oo(r),null!=n)for(var f=0;f<t.length;++f)if(null!=n[f]){var d=r[f];if(d.shape.length!==n[f].length)throw new Pn("Error when checking ".concat(i,": expected ").concat(t[f]," ")+"to have ".concat(n[f].length," dimension(s). but got array with ")+"shape ".concat(d.shape));for(var h=0;h<n[f].length;++h)if(0!==h||a){var p=d.shape[h],v=n[f][h];if(null!=v&&v>=0&&p!==v)throw new Pn("Error when checking ".concat(i,": expected ").concat(t[f]," ")+"to have shape [".concat(n[f],"], but got array with shape ")+"[".concat(d.shape,"]."))}}return r}function So(e,t,n){var r=er(e.map((function(e){return e.shape[0]})));r.sort();var i=er(t.map((function(e){return e.shape[0]})));if(i.sort(),r.length>1)throw new Pn("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(i.length>1)throw new Pn("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&i.length>0&&!a.util.arraysEqual(r,i))throw new Pn("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(i[0]," target ")+"sample(s).")}function Eo(e,t,n){for(var r=[si,vi,hi],a=0;a<e.length;++a){var i=e[a],o=t[a],u=n[a];if(null!=o){if(o===hi&&1===i.shape[i.shape.length-1])throw new Pn("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var c=i.shape.slice(1),s=u.slice(1),l=0;l<c.length;++l){var f=c[l],d=s[l];if(null!=d&&f!==d)throw new Pn("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(u,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}function Co(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new Pn("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new Pn("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var u=r[o];if(u.shape.length!==n[o].length)throw new Pn("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(u.shape)));for(var c=0;c<n[o].length;++c)if(0!==c||a){var s=u.shape[c],l=n[o][c];if(null!=l&&l!==s)throw new Pn("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(u.shape),"."))}}}var Ao=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).isTraining=!1,r}return Object(Sn.a)(n,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new Pn("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Fi(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return a.train.adagrad(.01)},Adadelta:function(){return a.train.adadelta(1,.95,An())},Adam:function(){return a.train.adam(.001,.9,.999,An())},Adamax:function(){return a.train.adamax(.002,.9,.999,An(),0)},RMSProp:function(){return a.train.rmsprop(.001,.9,0,An())},SGD:function(){return a.train.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new Pn("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof a.Optimizer))throw new Pn("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Pn("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return yi(e)}))}else{var i=yi(e.loss);this.outputs.forEach((function(e){n.push(i)}))}else{for(var o in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(o))throw new Pn('Unknown entry in loss dictionary: "'.concat(o,'". ')+"Only expected the following keys: ".concat(this.outputNames));var u,c=Object(Tn.a)(this.outputNames);try{for(c.s();!(u=c.n()).done;){var s=u.value;null==e.loss[s]&&console.warn('Output "'.concat(s,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(s," during training")),n.push(yi(e.loss[s]))}}catch(m){c.e(m)}finally{c.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var l=0;l<this.outputs.length;++l){var f=this.internalOutputShapes[l],d=this.outputNames[l];this.feedOutputNames.push(d),this.feedOutputShapes.push(f),this.feedLossFns.push(this.lossFunctions[l])}var h=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Er("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===h.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var p=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=Object(Tn.a)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,u=n.hasOwnProperty(o)?n[o]:[];Array.isArray(u)||(u=[u]),a.push(u)}}catch(m){i.e(m)}finally{i.f()}return a}(e.metrics,this.outputNames),v=function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])};Er("metric",(function(){for(var e=function(e){if(-1!==h.indexOf(e))return"continue";!function(n){var r,a,i,o,u=Object(Tn.a)(n);try{for(u.s();!(o=u.n()).done;){var c=o.value;if("string"===typeof c&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(c)){var s=t.internalOutputShapes[e];1===s[s.length-1]||t.lossFunctions[e]===vi?-1!==["accuracy","acc"].indexOf(c)?a=xi:-1!==["crossentropy","ce"].indexOf(c)&&(a=ji):t.lossFunctions[e]===pi?-1!==["accuracy","acc"].indexOf(c)?a=_i:-1!==["crossentropy","ce"].indexOf(c)&&(a=Ei):-1!==["accuracy","acc"].indexOf(c)?a=Oi:-1!==["crossentropy","ce"].indexOf(c)&&(a=Si);var l=void 0;-1!==["accuracy","acc"].indexOf(c)?l="acc":-1!==["crossentropy","ce"].indexOf(c)&&(l="ce"),i=a,r=""+l}else{var f=Ai(c);i=f,r=""+Ni(c)}var d=void 0;Er(r,(function(){d=i})),v(e,r,d)}}catch(m){u.e(m)}finally{u.f()}}(p[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;ho(r);var a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{var o=i[0].concat(i[1]);this.makeTestFunction();var u=this.testFunction,c=this.testLoop(u,o,r,n.verbose,n.steps);return Hn(c)}finally{ko(i[0],e),ko(i[1],t)}}},{key:"evaluateDataset",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",lo(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new Pn("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new Pn("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new Pn("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],i=this.retrieveSymbolicTensors(r),o=new qi;if(e instanceof a.Tensor&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Pn("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var u=0;u<this.inputs.length;++u)o.add(this.inputs[u],e[u])}else{var c,s=Object(Tn.a)(this.inputs);try{for(s.s();!(c=s.n()).done;){var l=c.value,f=e[l.name];if(null==f)throw new Pn("No value is provided for the model's input ".concat(l.name));o.add(l,f)}}catch(h){s.e(h)}finally{s.f()}}var d=Ki(i,o);return n?d:d[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=Un(null,e.length),r=e.length,a=Object(Tn.a)(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],u=o.map((function(e){return e.name})),c=0;c<e.length;++c){var s=u.indexOf(e[c]);if(-1!==s&&(n[c]=o[s],r--),0===r)break}if(0===r)break}}catch(f){a.e(f)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new Pn("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.tidy((function(){var i=t.checkNumSamples(e);if(r)throw new Bn("Verbose predictLoop() is not implemented yet.");for(var o=mo(i,n),u=t.outputs.map((function(e){return[]})),c=function(n){a.tidy((function(){var r=o[n][0],a=o[n][1],i=po(e,r,a),u=[];if(Array.isArray(i))for(var c=0;c<i.length;++c)u.push({key:t.inputs[c],value:i[c]});else u.push({key:t.inputs[0],value:i});var s=new qi(u);return Ki(t.outputs,s)})).forEach((function(e,t){return u[t].push(e)}))},s=0;s<o.length;++s)c(s);return Hn(u.map((function(e){return a.concat(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Oo(e);Co(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return ho(r),this.predictLoop(n,r)}finally{ko(n,e)}}},{key:"predictOnBatch",value:function(e){Co(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new Ln("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a],o=this.feedLossFns[a];o===pi?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(So(e=_o(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=_o(t,this.feedOutputNames,r,!1,"target")),Eo(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new Pn("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n,r,a){var o,u,c,s,l,f,d,h,p,v=arguments;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!(v.length>4&&void 0!==v[4])||v[4],u=v.length>5?v[5]:void 0,c=this.standardizeUserDataXY(t,n,o,u),s=Object(i.a)(c,2),l=s[0],f=s[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(d=null,null==a){e.next=19;break}h=Qi(a,this.outputNames),d=[],p=0;case 10:if(!(p<h.length)){e.next=19;break}return e.t0=d,e.next=14,Zi(f[p],null,h[p]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++p,e.next=10;break;case 19:return e.abrupt("return",[l,f,d]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0;return a.tidy((function(){var u=r.checkNumSamples(t,n,o,"steps"),c=[];if(i>0)throw new Bn("Verbose mode is not implemented yet.");if(null!=o)throw new Bn("steps mode in testLoop() is not implemented yet");for(var s=mo(u,n),l=Object(a.tensor1d)(Rr(0,u)),f=0;f<s.length;++f){var d=s[f][0],h=s[f][1],p=Br(l,d,h-d),v=vo(t,p),m=e(v);if(0===f)for(var b=0;b<m.length;++b)c.push(Object(a.scalar)(0));for(var g=0;g<m.length;++g){var y=m[g];c[g]=a.add(c[g],a.mul(h-d,y))}}for(var x=0;x<c.length;++x)c[x]=a.div(c[x],u);return c}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(qn(e,r)>1){var i=qn(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),u=[],c=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],c=0;c<e.inputs.length;++c)t.push({key:e.inputs[c],value:r[c]});for(var s,l=new qi(t),f=Ki(e.outputs,l,{training:!0}),d=0;d<e.lossFunctions.length;++d){var h=(0,e.lossFunctions[d])(i[d],f[d]);null!=o[d]&&(h=to(h,o[d]));var p=a.mean(h);n.push(p),s=0===d?h:a.add(s,h)}for(var v=0;v<e.metricsTensors.length;++v){var m=void 0;if(e.outputs.length>1&&v<e.outputs.length)m=n[v];else{var b=e.metricsTensors[v][0],g=e.metricsTensors[v][1];m=a.mean(b(i[g],f[g]))}a.keep(m),u.push(m)}return s=a.mean(s),e.calculateLosses().forEach((function(e){s=a.add(s,e)})),s}),!0,c)].concat(u)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return a.tidy((function(){for(var n,r=[],i=t.slice(0,e.inputs.length),o=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),u=[],c=0;c<e.inputs.length;++c)u.push({key:e.inputs[c],value:i[c]});for(var s=new qi(u),l=Ki(e.outputs,s),f=0;f<e.lossFunctions.length;++f){var d=e.lossFunctions[f],h=a.mean(d(o[f],l[f]));n=0===f?h:a.add(n,h),r.push(n)}for(var p=0;p<e.metricsTensors.length;++p){var v=e.metricsTensors[p][0],m=e.metricsTensors[p][1],b=a.mean(v(o[m],l[m]));r.push(b)}return r}))}}},{key:"fit",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,a=arguments;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},e.abrupt("return",yo(this,t,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",io(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,i,o,u,c,s,l,f,d,h;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,i=r[0],o=r[1],u=this.makeTrainFunction(),c=u(i.concat(o)),s=[],l=Object(Tn.a)(c),e.prev=9,l.s();case 11:if((f=l.n()).done){e.next=19;break}return d=f.value,e.next=15,d.data();case 15:h=e.sent,s.push(h[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),l.e(e.t0);case 24:return e.prev=24,l.f(),e.finish(24);case 27:return a.dispose(c),e.abrupt("return",Hn(s));case 29:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=a.memory().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-a.memory().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=Kn(this.loss);else if(Array.isArray(this.loss)){var t,n=Object(Tn.a)(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(c){n.e(c)}finally{n.f()}e=this.loss.map((function(e){return Kn(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var u=o[i];if("string"!==typeof a[u])throw new Error("Serialization of non-string loss is not supported.");e[u]=Kn(a[u])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[Kn(Ni(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return Kn(Ni(e))}));var e={};for(var t in this.metrics)e[t]=Kn(Ni(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=ui(Wi(e.optimizer_config));if("string"===typeof e.loss)t=Xn(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return Xn(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=Xn(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return Xn(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=Xn(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,i,o,u,c,s,l,f,d;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=a.io.getSaveHandlers(t)).length){e.next=6;break}throw new Pn("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new Pn("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new Pn("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.next=13,a.io.encodeWeights(this.getNamedWeights(n));case 13:if(i=e.sent,!1,null,o=this.toJSON(null,false),u={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(Vi),convertedBy:null},!(null!=n&&n.includeOptimizer)||null==this.optimizer){e.next=34;break}return u.trainingConfig=this.getTrainingConfig(),s="optimizer",e.t0=a.io,e.next=25,this.optimizer.getWeights();case 25:return e.t1=e.sent,e.t2=s,e.next=29,e.t0.encodeWeights.call(e.t0,e.t1,e.t2);case 29:l=e.sent,f=l.data,d=l.specs,(c=i.specs).push.apply(c,Object(Nn.a)(d)),i.data=a.io.concatenateArrayBuffers([i.data,f]);case 34:return null!=this.userDefinedMetadata&&(!0,Ii(this.userDefinedMetadata,this.name,true),u.userDefinedMetadata=this.userDefinedMetadata),u.weightData=i.data,u.weightSpecs=i.specs,e.abrupt("return",t.save(u));case 38:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){Ii(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),n}(function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=Sa(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],er(r.inputs).length!==r.inputs.length)throw new Pn("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));er(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=Object(Tn.a)(r.outputs);try{for(o.s();!(i=o.n()).done;){var u=i.value,c=u.sourceLayer,s=u.nodeIndex,l=u.tensorIndex;r.outputLayers.push(c),r.outputLayersNodeIndices.push(s),r.outputLayersTensorIndices.push(l)}}catch(ke){o.e(ke)}finally{o.f()}var f,d=Object(Tn.a)(r.inputs);try{for(d.s();!(f=d.n()).done;){var h=f.value,p=h.sourceLayer,v=h.nodeIndex,m=h.tensorIndex;Vn(0===v,"input layer has >1 nodes"),Vn(0===m,"input layer has >1 tensors"),r.inputLayers.push(p),r.inputLayersNodeIndices.push(v),r.inputLayersTensorIndices.push(m)}}catch(ke){d.e(ke)}finally{d.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var b=0;b<r.inputLayers.length;b++){var g=r.inputLayers[b];if(!(g instanceof Va))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(b," (0-based) originates ")+"from layer type ".concat(g.getClassName(),"."));r.inputNames.push(g.name),r.feedInputShapes.push(g.batchInputShape),r.feedInputNames.push(g.name)}var y,x=Object(Tn.a)(r.outputLayers);try{for(x.s();!(y=x.n()).done;){var O=y.value;r.outputNames.push(O.name)}}catch(ke){x.e(ke)}finally{x.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var k,w={},j={},_={},S={},E={},C=[],A=function e(t,a,i,o,u,c){null!=o&&null!=u&&null!=c||(o=t.sourceLayer,u=t.nodeIndex,c=t.tensorIndex);var s=o.inboundNodes[u];if(-1!==i.indexOf(s))throw new Ln("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(s)){r.containerNodes.add(n.nodeKey(o,u)),o.id in E||(E[o.id]=Object.keys(E).length),-1===i.indexOf(s)&&i.push(s);for(var l=s.inboundLayers.length,f=0;f<l;f++){e(s.inputTensors[f],a,i,s.inboundLayers[f],s.nodeIndices[f],s.tensorIndices[f])}for(a.push(s);i.indexOf(s)>=0;)i.splice(i.indexOf(s),1);C.push(s)}},N=[],T=[],I=Object(Tn.a)(r.outputs);try{for(I.s();!(k=I.n()).done;){A(k.value,N,T)}}catch(ke){I.e(ke)}finally{I.f()}var D,F=C.slice().reverse(),M=Object(Tn.a)(F);try{for(M.s();!(D=M.n()).done;){var R=D.value;j[R.id]=R,R.id in w||(w[R.id]=0);var z=w[R.id],L=null==_[R.outboundLayer.id]?0:_[R.outboundLayer.id];z=Math.max(z,L),_[R.outboundLayer.id]=z,S[R.outboundLayer.id]=R.outboundLayer,w[R.id]=z;for(var P=0;P<R.inboundLayers.length;P++){var B=R.inboundLayers[P],W=R.nodeIndices[P],U=B.inboundNodes[W],V=null==w[U.id]?0:w[U.id];w[U.id]=Math.max(z+1,V),j[U.id]=U}}}catch(ke){M.e(ke)}finally{M.f()}var q={};for(var H in w){var G=w[H];G in q||(q[G]=[]),q[G].push(j[H])}var K={};for(var X in _){var Y=_[X];Y in K||(K[Y]=[]),K[Y].push(S[X])}var $=Object.keys(K).map((function(e){return parseInt(e,10)})).sort(Zn);r.layers=[];var J,Q=Object(Tn.a)($);try{for(Q.s();!(J=Q.n()).done;){var Z=K[J.value];Z.sort((function(e,t){var n=E[e.id],r=E[t.id];return n<r?-1:n>r?1:0}));var ee,te=Object(Tn.a)(Z);try{for(te.s();!(ee=te.n()).done;){var ne=ee.value;ne instanceof n&&r.internalContainerRefs.push(ne),r.layers.push(ne)}}catch(ke){te.e(ke)}finally{te.f()}}}catch(ke){Q.e(ke)}finally{Q.f()}r.layersByDepth=K,$=Object.keys(q).map((function(e){return parseInt(e,10)})).sort(Zn);var re,ae=r.inputs.slice(),ie=[],oe=Object(Tn.a)($);try{for(oe.s();!(re=oe.n()).done;){var ue,ce=re.value,se=Object(Tn.a)(q[ce]);try{for(se.s();!(ue=se.n()).done;){var le=ue.value,fe=le.outboundLayer;if(null!=fe){var de,he=Object(Tn.a)(le.inputTensors);try{for(he.s();!(de=he.n()).done;){var pe=de.value;if(-1===ae.indexOf(pe))throw new Ln("Graph disconnected: cannot obtain value for tensor ".concat(pe)+' at layer "'.concat(fe.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(ie))}}catch(ke){he.e(ke)}finally{he.f()}var ve,me=Object(Tn.a)(le.outputTensors);try{for(me.s();!(ve=me.n()).done;){var be=ve.value;ae.push(be)}}catch(ke){me.e(ke)}finally{me.f()}ie.push(fe.name)}}}catch(ke){se.e(ke)}finally{se.f()}}}catch(ke){oe.e(ke)}finally{oe.f()}r.nodesByDepth=q;var ge,ye=r.layers.map((function(e){return e.name})),xe=Object(Tn.a)(ye);try{var Oe=function(){var e=ge.value,t=ye.filter((function(t){return t===e})).length;if(1!==t)throw new Ln('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(ye))};for(xe.s();!(ge=xe.n()).done;)Oe()}catch(ke){xe.e(ke)}finally{xe.f()}return r.outboundNodes=[],r.inboundNodes=[],new Pa({outboundLayer:Object(In.a)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return Object(Sn.a)(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=Object(Tn.a)(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(u){n.e(u)}finally{n.f()}var a,i=Object(Tn.a)(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(u){i.e(u)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new Pn("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=Object(Tn.a)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=Object(Tn.a)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Nn.a)(r.nonTrainableWeights))}}catch(c){n.e(c)}finally{n.f()}if(!this.trainable){var a,i=[],o=Object(Tn.a)(this.layers);try{for(o.s();!(a=o.n()).done;){var u=a.value;i.push.apply(i,Object(Nn.a)(u.trainableWeights))}}catch(c){o.e(c)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=Object(Tn.a)(this.layers);try{for(i.s();!(t=i.n()).done;){var o,u=t.value,c=Object(Tn.a)(u.weights);try{for(c.s();!(o=c.n()).done;){var s=o.value;if(null!=r[s.originalName])throw new Pn("Duplicate weight name: ".concat(s.originalName));r[s.originalName]=s,a++}}catch(b){c.e(b)}finally{c.f()}}}catch(b){i.e(b)}finally{i.f()}var l=[];for(var f in e){var d=f;if(null==r[f]){var h=f.split("/"),p=h.slice(0,-2).concat([h[h.length-1]]);d=p.join("/")}if(null!=r[d])l.push([r[d],e[f]]);else if(n)throw new Pn("Provided weight data has no target variable: ".concat(f));delete r[d]}if(n){var v=[];for(var m in r)v.push(m);if(v.length>0)throw new Pn("".concat(v.length," of ").concat(a," weights are not set: ")+"".concat(v))}Ma(l)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(Vi),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Ui(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){e=Gn(e);for(var r=new qi,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return Ki(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return Object(a.tidy)((function(){var r;return e=Gn(e),r=null==t?Un(null,e.length):Gn(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=Ca(e);if(t.length!==this.inputLayers.length)throw new Pn("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Zn);if(o.length>1){var u,c=Object(Tn.a)(o);try{for(c.s();!(u=c.n()).done;){var s,l=u.value,f=this.nodesByDepth[l],d=Object(Tn.a)(f);try{for(d.s();!(s=d.n()).done;){var h=s.value,p=h.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(p.id)){for(var v=[],m=0;m<h.inboundLayers.length;m++){var b=h.inboundLayers[m],g=h.nodeIndices[m],y=h.tensorIndices[m],x=n["".concat(b.name,"_").concat(g,"_").concat(y)];v.push(x)}for(var O=Ca(p.computeOutputShape(Hn(v))),k=p.inboundNodes.indexOf(h),w=0;w<O.length;w++){n["".concat(p.name,"_").concat(k,"_").concat(w)]=O[w]}}}}catch(D){d.e(D)}finally{d.f()}}}catch(D){c.e(D)}finally{c.f()}}for(var j=[],_=[],S=0;S<this.outputLayers.length;S++){var E=this.outputLayers[S],C=this.outputLayersNodeIndices[S],A=this.outputLayersTensorIndices[S],N="".concat(E.name,"_").concat(C,"_").concat(A);_.push(N)}for(var T=0;T<_.length;T++){var I=_[T];Vn(I in n),j.push(n[I])}return Hn(j)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=Un(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],o=e[r],u=t[r];n[a.id]=[o,u]}var c,s=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Zn),l=Object(Tn.a)(s);try{for(l.s();!(c=l.n()).done;){var f,d=c.value,h=this.nodesByDepth[d],p=Object(Tn.a)(h);try{for(p.s();!(f=p.n()).done;){var v,m=f.value,b=m.outboundLayer,g=m.inputTensors,y=m.outputTensors,x=new Array,O=Object(Tn.a)(g);try{for(O.s();!(v=O.n()).done;){var k=v.value;k.id in n&&x.push(n[k.id])}}catch(q){O.e(q)}finally{O.f()}if(x.length===g.length){var w={},j=void 0,_=void 0,S=void 0,E=void 0;if(null!=m.callArgs&&(w=m.callArgs),1===x.length){var C=Object(i.a)(x[0],2),A=C[0],N=C[1];null==w.mask&&(w.mask=N),S=Gn(b.call(A,w)),E=Gn(b.computeMask(A,N)),j=[A],_=[N]}else j=x.map((function(e){return e[0]})),_=x.map((function(e){return e[1]})),null==w.mask&&(w.mask=_),S=Gn(b.call(j,w)),E=Gn(b.computeMask(j,_));if(b.activityRegularizer)throw new Bn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var T=0;T<y.length;++T){var I=y[T],D=S[T],F=E[T];n[I.id]=[D,F]}}}}catch(q){p.e(q)}finally{p.f()}}}catch(q){l.e(q)}finally{l.f()}var M,R=[],z=[],L=[],P=Object(Tn.a)(this.outputs);try{for(P.s();!(M=P.n()).done;){var B=M.value;Vn(B.id in n,"Could not compute output ".concat(B.name," : ").concat(B.id));var W=Object(i.a)(n[B.id],2),U=W[0],V=W[1];L.push(U.shape),R.push(U),z.push(V)}}catch(q){P.e(q)}finally{P.f()}return[R,z,L]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=Object(Tn.a)(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var u=0;u<o.inboundNodes.length;u++){var c=n.nodeKey(o,u);this.containerNodes.has(c)&&(a[c]=t,t+=1)}}}catch(s){i.e(s)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new Pn("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new Pn("Provide either a layer name or layer index");var n,r=Object(Tn.a)(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(i){r.e(i)}finally{r.f()}throw new Pn("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return Object(a.tidy)((function(){var t,r=[],a=Object(Tn.a)(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var u=n.nodeKey(i,o);e.containerNodes.has(u)&&r.push.apply(r,Object(Nn.a)(i.calculateLosses()))}}catch(c){a.e(c)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=Object(Tn.a)(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,u=o.getClassName(),c=o.getConfig(),s=[],l=0;l<o.inboundNodes.length;l++){var f=o.inboundNodes[l],d=n.nodeKey(o,l),h={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),h=f.callArgs}catch(M){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(f.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),h={}}if(f.inboundLayers.length>0){for(var p=[],v=0;v<f.inboundLayers.length;v++){var m=f.inboundLayers[v],b=f.nodeIndices[v],g=f.tensorIndices[v],y=r[n.nodeKey(m,b)];null==y&&(y=0),p.push([m.name,y,g,h])}s.push(p)}}}var x={};x.name=o.name,x.className=u,x.config=c,x.inboundNodes=s,a.push(x)}}catch(M){i.e(M)}finally{i.f()}t.layers=a;for(var O=[],k=0;k<this.inputLayers.length;k++){var w=this.inputLayers[k],j=this.inputLayersNodeIndices[k],_=n.nodeKey(w,j);if(this.containerNodes.has(_)){var S=r[_];null!==S&&void 0!==S||(S=0);var E=this.inputLayersTensorIndices[k];O.push([w.name,S,E])}}t.inputLayers=O;for(var C=[],A=0;A<this.outputLayers.length;A++){var N=this.outputLayers[A],T=this.outputLayersNodeIndices[A],I=n.nodeKey(N,T);if(this.containerNodes.has(I)){var D=r[I];null!==D&&void 0!==D||(D=0);var F=this.outputLayersTensorIndices[A];C.push([N.name,D,F])}}return t.outputLayers=C,t}},{key:"stateful",get:function(){if(this._stateful)throw new Pn("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=Object(Tn.a)(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;Object(a.tidy)((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],u=Object(Tn.a)(t);try{for(u.s();!(a=u.n()).done;){var c=a.value,s=c[0],l=c[1],f=c[2];if(n=null==c[3]?{}:c[3],!(s in r))return void i(e,t);var d=r[s];if(d.inboundNodes.length<=l)return void i(e,t);var h=d.inboundNodes[l];o.push(h.outputTensors[f])}}catch(p){u.e(p)}finally{u.f()}o.length>0&&e.apply(Hn(o),n)}function u(e){var a=e.name,o=ui(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new Pn("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var c,s=t.name,l=t.layers,f=Object(Tn.a)(l);try{for(f.s();!(c=f.n()).done;){var d=c.value;u(d)}}catch(W){f.e(W)}finally{f.f()}for(;!tr(a);){var h,p=Object(Tn.a)(l);try{for(p.s();!(h=p.n()).done;){var v=h.value,m=r[v.name];if(m.name in a){var b=a[m.name];delete a[m.name];var g,y=Object(Tn.a)(b);try{for(y.s();!(g=y.n()).done;){var x=g.value;o(m,x)}}catch(W){y.e(W)}finally{y.f()}}}}catch(W){p.e(W)}finally{p.f()}}var O,k=[],w=[],j=t.inputLayers,_=Object(Tn.a)(j);try{for(_.s();!(O=_.n()).done;){var S=O.value,E=S[0],C=S[1],A=S[2];Vn(E in r);var N=r[E],T=N.inboundNodes[C].outputTensors;k.push(T[A])}}catch(W){_.e(W)}finally{_.f()}var I,D=t.outputLayers,F=Object(Tn.a)(D);try{for(F.s();!(I=F.n()).done;){var M=I.value,R=M[0],z=M[1],L=M[2];Vn(R in r);var P=r[R],B=P.inboundNodes[z].outputTensors;w.push(B[L])}}catch(W){F.e(W)}finally{F.f()}return new e({inputs:k,outputs:w,name:s})}}]),n}(Wa));Ao.className="Model",a.serialization.registerClass(Ao);var No=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return n}(Ao);function To(){return(To=Object(Xa.a)(Ka.a.mark((function e(t,n){var r;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),"string"!==typeof t){e.next=10;break}if(0!==(r=a.io.getLoadHandlers(t,n)).length){e.next=7;break}r.push(a.io.browserHTTPRequest(t,n)),e.next=9;break;case 7:if(!(r.length>1)){e.next=9;break}throw new Pn("Found more than one (".concat(r.length,") load handlers for ")+"URL '".concat(t,"'"));case 9:t=r[0];case 10:return e.abrupt("return",Io(t,void 0,n));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Io(e,t,n){return Do.apply(this,arguments)}function Do(){return(Do=Object(Xa.a)(Ka.a.mark((function e(t,n,r){var i,o,u,c,s,l,f,d,h;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r&&(r={}),null!=t.load){e.next=3;break}throw new Pn("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 3:return e.next=5,t.load();case 5:if(i=e.sent,null!=(o=i.modelTopology).model_config&&(o=o.model_config),u=null==r.strict||r.strict,c=null!=i.weightData&&null!=i.weightSpecs&&u,s=ui(Wi(o),n,c),null!=(l=i.trainingConfig)&&s.loadTrainingConfig(l),null!=i.userDefinedMetadata&&s.setUserDefinedMetadata(i.userDefinedMetadata),null==i.weightData){e.next=24;break}if(null!=i.weightSpecs){e.next=17;break}throw new Pn("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");case 17:if(f=Fo(i.weightData,i.weightSpecs),d=f.modelWeights,h=f.optimizerWeights,s.loadWeights(d,u),!(null!=s.optimizer&&h.length>0)){e.next=22;break}return e.next=22,s.optimizer.setWeights(h);case 22:Object(a.dispose)(d),Object(a.dispose)(h.map((function(e){return e.tensor})));case 24:return e.abrupt("return",s);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fo(e,t){var n=a.io.decodeWeights(e,t),r={},i=[];return t.forEach((function(e){"optimizer"===e.group?i.push({name:e.name,tensor:n[e.name]}):r[e.name]=n[e.name]})),{modelWeights:r,optimizerWeights:i}}No.className="Functional",a.serialization.registerClass(No);var Mo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:Sa("sequential_"),null!=e.layers){var a,i=Object(Tn.a)(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch(u){i.e(u)}finally{i.f()}}return r}return Object(Sn.a)(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new Pn("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof Ao;if(r){if(1!==(t=e).outputs.length)throw new Pn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new Pn("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new Pn("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=qa({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new Pn("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new Pn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Ua(this.outputs[0])}this.inboundNodes=[],new Pa({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Un(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(Na(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Ao({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),Object(oi.a)(Object(Dn.a)(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),Object(oi.a)(Object(Dn.a)(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new Ln("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new Ln("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){var r,a=arguments;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new Ln("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new Ln("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t,n){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new Pn("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new Pn("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=Object(Tn.a)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(i){n.e(i)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new Pn("Legacy serialization format not supported yet.");r=t}else a.util.assert(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,o=t;var u=new e(o);if(!(u instanceof n))throw new Bn("Sequential.fromConfig called on non-Sequential input: ".concat(u));var c,s=Object(Tn.a)(r);try{for(s.s();!(c=s.n()).done;){var l=c.value,f=void 0,d=ui(l,f,i);i&&d.setFastWeightInitDuringBuild(!0),u.add(d)}}catch(h){s.e(h)}finally{s.f()}return u}}]),n}(Ao);function Ro(e){return new Mo(e)}function zo(e,t){return null==t&&(t={}),function(e,t){return To.apply(this,arguments)}(e,t)}function Lo(e){return qa(e)}Mo.className="Sequential",a.serialization.registerClass(Mo);var Po=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"getConfig",value:function(){return{}}}]),n}(a.serialization.Serializable),Bo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Qr(e,t)}}]),n}(Po);Bo.className="elu",a.serialization.registerClass(Bo);var Wo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return a.selu(e)}}]),n}(Po);Wo.className="selu",a.serialization.registerClass(Wo);var Uo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return a.relu(e)}}]),n}(Po);Uo.className="relu",a.serialization.registerClass(Uo);var Vo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return Object(a.tidy)((function(){return a.minimum(6,a.relu(e))}))}}]),n}(Po);Vo.className="relu6",a.serialization.registerClass(Vo);var qo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return e}}]),n}(Po);qo.className="linear",a.serialization.registerClass(qo);var Ho=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return a.sigmoid(e)}}]),n}(Po);Ho.className="sigmoid",a.serialization.registerClass(Ho);var Go=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return function(e){return Object(a.tidy)((function(){var t=a.add(.5,a.mul(.2,e));return a.clipByValue(t,0,1)}))}(e)}}]),n}(Po);Go.className="hardSigmoid",a.serialization.registerClass(Go);var Ko=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return a.softplus(e)}}]),n}(Po);Ko.className="softplus",a.serialization.registerClass(Ko);var Xo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return function(e){return Object(a.tidy)((function(){return a.div(e,a.abs(e).add(1))}))}(e)}}]),n}(Po);Xo.className="softsign",a.serialization.registerClass(Xo);var Yo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return a.tanh(e)}}]),n}(Po);Yo.className="tanh",a.serialization.registerClass(Yo);var $o=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return a.softmax(e,t)}}]),n}(Po);$o.className="softmax",a.serialization.registerClass($o);var Jo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return a.logSoftmax(e,t)}}]),n}(Po);Jo.className="logSoftmax",a.serialization.registerClass(Jo);var Qo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(a.tidy)((function(){return a.sigmoid(e.mul(t)).mul(e)}))}}]),n}(Po);Qo.className="swish",a.serialization.registerClass(Qo);var Zo=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e){return Object(a.tidy)((function(){return a.mul(e,a.tanh(a.softplus(e)))}))}}]),n}(Po);function eu(e){return e.getClassName()}function tu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Qn(e,a.serialization.SerializationMap.getMap().classNameMap,t,"activation")}function nu(e){if(null==e){var t={className:"linear",config:{}};return tu(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},tu(n)}return e instanceof Po?e:tu(e)}function ru(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}Zo.className="mish",a.serialization.registerClass(Zo);var au=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return n}(a.serialization.Serializable),iu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this),ru(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return Object(Sn.a)(n,[{key:"apply",value:function(e){var t=this;return Object(a.tidy)((function(){var n=Object(a.zeros)([1]);return t.hasL1&&(n=Object(a.add)(n,Object(a.sum)(a.mul(t.l1,Object(a.abs)(e))))),t.hasL2&&(n=Object(a.add)(n,Object(a.sum)(a.mul(t.l2,Yr(e))))),n.asScalar()}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(au);iu.className="L1L2",a.serialization.registerClass(iu);var ou={l1l2:"L1L2"};function uu(e){return $n(e)}function cu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Qn(e,a.serialization.SerializationMap.getMap().classNameMap,t,"regularizer")}function su(e){return null==e?null:"string"===typeof e?cu({className:e in ou?ou[e]:e,config:{}}):e instanceof au?e:cu(e)}var lu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return Object(Sn.a)(n,[{key:"call",value:function(e,t){e=Aa(e);var n=Object(a.relu)(e);return null!=this.maxValue&&(n=Object(a.clipByValue)(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);lu.className="ReLU",a.serialization.registerClass(lu);var fu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var n=Aa(e);return Object(a.leakyRelu)(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);fu.className="LeakyReLU",a.serialization.registerClass(fu);var du=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=ka(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=su(e.alphaRegularizer),r.alphaConstraint=mr(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new Pn("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return Object(Sn.a)(n,[{key:"build",value:function(e){var t=(e=Na(e)).slice(1);if(null!=this.sharedAxes){var n,r=Object(Tn.a)(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(o){r.e(o)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new Ra({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=Aa(e),Object(a.prelu)(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:Oa(this.alphaInitializer),alphaRegularizer:uu(this.alphaRegularizer),alphaConstraint:pr(this.alphaConstraint),sharedAxes:this.sharedAxes},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);du.className="PReLU",a.serialization.registerClass(du);var hu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new Bn("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var n=Aa(e);return Object(a.elu)(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);hu.className="ELU",a.serialization.registerClass(hu);var pu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var n=Aa(e);return n.mul(zr(n.greater(this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);pu.className="ThresholdedReLU",a.serialization.registerClass(pu);var vu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new $o).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var n=Aa(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);vu.className="Softmax",a.serialization.registerClass(vu);var mu=n(21);function bu(e,t,n){if("number"===typeof e)return Un(e,t);if(e.length!==t)throw new Pn("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new Pn("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e;var i}function gu(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(null==e)return e;var i,o=t+(t-1)*(a-1);return i="same"===n?e:e-o+1,Math.floor((i+r-1)/r)}function yu(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+Mr([n-t,0]);else{if("same"!==r)throw new Pn("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function xu(e,t){return Object(a.tidy)((function(){return wr(t),"channelsFirst"===t?a.transpose(e,[0,2,3,1]):e}))}function Ou(e,t){return Object(a.tidy)((function(){return wr(t),"channelsFirst"===t?a.transpose(e,[0,2,3,4,1]):e}))}function ku(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",o=arguments.length>5?arguments[5]:void 0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Object(a.tidy)((function(){if(null==o&&(o="channelsLast"),wr(o),3!==e.shape.length)throw new Pn("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new Pn("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new Pn("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===o&&(e=a.transpose(e,[0,2,1])),"causal"===i)throw new Bn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var c=a.conv1d(e,t,r,"same"===i?"same":"valid","NWC",u);return null!=n&&(c=Jr(c,n)),c}))}function wu(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",o=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return Object(a.tidy)((function(){if(null==o&&(o="channelsLast"),wr(o),3!==e.rank&&4!==e.rank)throw new Pn("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new Pn("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var s=xu(e,o);if("causal"===i)throw new Bn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return s=a.fused.conv2d({x:s,filter:t,strides:r,pad:"same"===i?"same":"valid",dilations:u,dataFormat:"NHWC",bias:n,activation:c}),"channelsFirst"===o&&(s=a.transpose(s,[0,3,1,2])),s}))}function ju(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",o=arguments.length>5?arguments[5]:void 0,u=arguments.length>6?arguments[6]:void 0;return Object(a.tidy)((function(){if(null==o&&(o="channelsLast"),wr(o),4!==e.rank&&5!==e.rank)throw new Pn("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new Pn("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var c=Ou(e,o);if("causal"===i)throw new Bn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return c=a.conv3d(c,t,r,"same"===i?"same":"valid","NDHWC",u),null!=n&&(c=Jr(c,n)),"channelsFirst"===o&&(c=a.transpose(c,[0,4,1,2,3])),c}))}var _u=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e,r){var a;if(Object(_n.a)(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,ar(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new Bn("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=bu(r.kernelSize,e,"kernelSize"),a.strides=bu(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,jr(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,wr(a.dataFormat),a.activation=nu(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=ka(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=mr(r.biasConstraint),a.biasRegularizer=su(r.biasRegularizer),a.activityRegularizer=su(r.activityRegularizer),a.dilationRate=bu(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new Pn("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new Pn("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new Pn("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return Object(Sn.a)(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:eu(this.activation),useBias:this.useBias,biasInitializer:Oa(this.biasInitializer),biasRegularizer:uu(this.biasRegularizer),activityRegularizer:uu(this.activityRegularizer),biasConstraint:pr(this.biasConstraint)},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(Vn("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!rr(e.kernelSize,"number",1,3))throw new Pn("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Wa),Su=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e,r){var a;return Object(_n.a)(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,ar(a.filters,"filters"),a.kernelInitializer=ka(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=mr(r.kernelConstraint),a.kernelRegularizer=su(r.kernelRegularizer),a}return Object(Sn.a)(n,[{key:"build",value:function(e){e=Na(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Pn("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:Object(mu.a)({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var t;e=Aa(e);var r=null==n.bias?null:n.bias.read(),a=or(n.activation.getClassName());if(null!=a&&2===n.rank)t=wu(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=ku(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=wu(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new Bn("convolutions greater than 3D are not implemented yet.");t=ju(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=Na(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=gu(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:Oa(this.kernelInitializer),kernelRegularizer:uu(this.kernelRegularizer),kernelConstraint:pr(this.kernelConstraint)},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new Pn("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(_u),Eu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return Object(Sn.a)(n,[{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!rr(e.kernelSize,"number",1,2))throw new Pn("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Su);Eu.className="Conv2D",a.serialization.registerClass(Eu);var Cu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return Object(Sn.a)(n,[{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new Pn("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Su);Cu.className="Conv3D",a.serialization.registerClass(Cu);var Au=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this,e)).inputSpec=[new Ra({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new Pn("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return Object(Sn.a)(n,[{key:"build",value:function(e){if(4!==(e=Na(e)).length)throw new Pn("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Pn("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ra({ndim:4,axes:Object(mu.a)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return a.tidy((function(){var t=Aa(e);if(4!==t.shape.length)throw new Pn("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,i,o=t.shape,u=o[0];"channelsFirst"===n.dataFormat?(r=2,i=3):(r=1,i=2);var c=o[r],s=o[i],l=n.kernelSize[0],f=n.kernelSize[1],d=n.strides[0],h=n.strides[1],p=[u,yu(c,d,l,n.padding),yu(s,h,f,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=a.transpose(t,[0,2,3,1]));var v=a.conv2dTranspose(t,n.kernel.read(),p,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(v=a.transpose(v,[0,3,1,2])),null!=n.bias&&(v=Jr(v,n.bias.read(),n.dataFormat)),null!=n.activation&&(v=n.activation.apply(v)),v}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=Na(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],u=this.strides[0],c=this.strides[1];return a[t]=this.filters,a[n]=yu(a[n],u,i,this.padding),a[r]=yu(a[r],c,o,this.padding),a}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(Eu);Au.className="Conv2DTranspose",a.serialization.registerClass(Au);var Nu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this,e)).inputSpec=[new Ra({ndim:5})],"same"!==r.padding&&"valid"!==r.padding)throw new Pn("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return Object(Sn.a)(n,[{key:"build",value:function(e){if(5!==(e=Na(e)).length)throw new Pn("Input should have rank 5; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Pn("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ra({ndim:5,axes:Object(mu.a)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return a.tidy((function(){var t=Aa(e);if(5!==t.shape.length)throw new Pn("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,i,o,u=t.shape,c=u[0];"channelsFirst"===n.dataFormat?(o=2,r=3,i=4):(o=1,r=2,i=3);var s=u[o],l=u[r],f=u[i],d=n.kernelSize[0],h=n.kernelSize[1],p=n.kernelSize[2],v=n.strides[0],m=n.strides[1],b=n.strides[2],g=[c,yu(s,v,d,n.padding),yu(l,m,h,n.padding),yu(f,b,p,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=a.transpose(t,[0,2,3,4,1]));var y=a.conv3dTranspose(t,n.kernel.read(),g,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(y=a.transpose(y,[0,4,1,2,3])),null!==n.bias&&(y=Jr(y,n.bias.read(),n.dataFormat)),null!==n.activation&&(y=n.activation.apply(y)),y}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a,i=(e=Na(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3,a=4):(t=4,n=1,r=2,a=3);var o=this.kernelSize[0],u=this.kernelSize[1],c=this.kernelSize[2],s=this.strides[0],l=this.strides[1],f=this.strides[2];return i[t]=this.filters,i[n]=yu(i[n],s,o,this.padding),i[r]=yu(i[r],l,u,this.padding),i[a]=yu(i[a],f,c,this.padding),i}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(Cu);Nu.className="Conv3DTranspose",a.serialization.registerClass(Nu);var Tu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e,r){var a;if(Object(_n.a)(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new Pn("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new Pn("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new Pn("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=ka(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=su(r.depthwiseRegularizer),a.depthwiseConstraint=mr(r.depthwiseConstraint),a.pointwiseInitializer=ka(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=su(r.pointwiseRegularizer),a.pointwiseConstraint=mr(r.pointwiseConstraint),a}return Object(Sn.a)(n,[{key:"build",value:function(e){if((e=Na(e)).length<this.rank+2)throw new Pn("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new Pn("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Ra({ndim:this.rank+2,axes:Object(mu.a)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var t;if(e=Aa(e),1===n.rank)throw new Bn("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=a.transpose(e,[0,2,3,1])),t=a.separableConv2d(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=Jr(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=a.transpose(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Oa(this.depthwiseInitializer),e.pointwiseInitializer=Oa(this.pointwiseInitializer),e.depthwiseRegularizer=uu(this.depthwiseRegularizer),e.pointwiseRegularizer=uu(this.pointwiseRegularizer),e.depthwiseConstraint=pr(this.depthwiseConstraint),e.pointwiseConstraint=pr(this.pointwiseConstraint),e}}]),n}(Su);Tu.className="SeparableConv";var Iu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,2,e)}return n}(Tu);Iu.className="SeparableConv2D",a.serialization.registerClass(Iu);var Du=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return Object(Sn.a)(n,[{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!rr(e.kernelSize,"number",1,1))throw new Pn("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Su);Du.className="Conv1D",a.serialization.registerClass(Du);var Fu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){if(e=Aa(e),"channelsLast"===n.dataFormat){var t=Ur(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return Ur(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=Ur(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return Ur(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);Fu.className="Cropping2D",a.serialization.registerClass(Fu);var Mu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r,a;return Object(_n.a)(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wr(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,a=r.interpolation,nr(gr,"InterpolationFormat",a),r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return a.tidy((function(){var t=Aa(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=a.transpose(t,[0,2,3,1]);var i=n.size[0]*r[2],o=n.size[1]*r[3],u="nearest"===n.interpolation?t.resizeNearestNeighbor([i,o]):t.resizeBilinear([i,o]);return a.transpose(u,[0,3,1,2])}var c=n.size[0]*r[1],s=n.size[1]*r[2];return"nearest"===n.interpolation?t.resizeNearestNeighbor([c,s]):t.resizeBilinear([c,s])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);Mu.className="UpSampling2D",a.serialization.registerClass(Mu);var Ru=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=ka(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=mr(e.depthwiseConstraint),r.depthwiseRegularizer=su(e.depthwiseRegularizer),r}return Object(Sn.a)(n,[{key:"build",value:function(e){if((e=Na(e)).length<4)throw new Pn("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new Pn("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;return Object(a.tidy)((function(){null==i&&(i="channelsLast"),wr(i);var u=xu(e,i);if(4!==e.rank)throw new Pn("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new Pn("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return u=a.depthwiseConv2d(u,t,n,"same"===r?"same":"valid","NHWC",o),"channelsFirst"===i&&(u=a.transpose(u,[0,3,1,2])),u}))}(e=Aa(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=Jr(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=Na(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=gu(t,this.kernelSize[0],this.padding,this.strides[0]),i=gu(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Oa(this.depthwiseInitializer),e.depthwiseRegularizer=uu(this.depthwiseRegularizer),e.depthwiseConstraint=pr(this.depthwiseRegularizer),e}}]),n}(_u);function zu(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new Pn("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function Lu(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return a.tidy((function(){var s=t.shape.length;if(s<3)throw new Pn("Input should be at least 3D, but is ".concat(s,"D."));var l=[1,0].concat(Rr(2,s));if(t=a.transpose(t,l),null!=o)throw new Bn("The rnn() functoin of the deeplearn.js backend does not support constants yet.");u&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=i.asType("bool").asType("float32")).rank===s-1&&(i=a.expandDims(i,-1)),i=a.transpose(i,l)),r&&(t=a.reverse(t,0),null!=i&&(i=a.reverse(i,0)));var f,d,h=[],p=n,v=t.shape[0],m=a.unstack(t);null!=i&&(d=a.unstack(i));for(var b,g=function(t){var n=m[t],r=a.tidy((function(){return e(n,p)}));if(null==i)f=r[0],p=r[1];else{var o=a.tidy((function(){var e=d[t],n=a.onesLike(e).sub(e);return{output:r[0].mul(e).add(p[0].mul(n)),newStates:p.map((function(t,a){return r[1][a].mul(e).add(t.mul(n))}))}}));f=o.output,p=o.newStates}c&&h.push(f)},y=0;y<v;++y)g(y);if(c){b=a.stack(h,1)}return[f,b,p]}))}Ru.className="DepthwiseConv2D",a.serialization.registerClass(Ru);var Pu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r,a;if(Object(_n.a)(this,n),r=t.call(this,e),null==e.cell)throw new Pn("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new Ku({cells:e.cell}):e.cell).stateSize)throw new Pn("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new Ra({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return Object(Sn.a)(n,[{key:"getStates",value:function(){return null==this.states_?Rr(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){Ea(e)&&(e=e[0]),e=e;var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=Object(Tn.a)(t);try{for(o.s();!(a=o.n()).done;){var u=a.value;i.push([e[0],u])}}catch(c){o.e(c)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return a.tidy((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new Bn("Constants support is not implemented in RNN yet.");Ea(e)&&(e=e[0]),e=e;var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new Ra({shape:[t,null].concat(Object(Nn.a)(n))});var r,i=[e[0]].concat(e.slice(2));if(this.cell.build(i),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!a.util.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new Pn("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new Ra({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(a.tidy)((function(){if(!t.stateful)throw new zn("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new Pn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return a.zeros([r,e])})):t.states_=[a.zeros([r,t.cell.stateSize])];else if(null==e)a.dispose(t.states_),null!=t.keptStates&&(a.dispose(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return a.zeros([r,e])})):t.states_[0]=a.zeros([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new Pn("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):a.dispose(t.states_);for(var i=0;i<t.states_.length;++i){var o=e[i],u=Array.isArray(t.cell.stateSize)?t.cell.stateSize[i]:t.cell.stateSize,c=[r,u];if(!a.util.arraysEqual(o.shape,c))throw new Pn("State ".concat(i," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(c,", received shape=").concat(o.shape));t.states_[i]=o}}t.states_=t.states_.map((function(e){return a.keep(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=zu(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],u=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var c,s=Object(Tn.a)(r);try{for(s.s();!(c=s.n()).done;){var l=c.value;this.stateSpec.push(new Ra({shape:l.shape}))}}catch(v){s.e(v)}finally{s.f()}u=u.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof za){var f=[e].concat(o),d=this.inputSpec.concat(u),h=this.inputSpec;this.inputSpec=d;var p=Object(oi.a)(Object(Dn.a)(n.prototype),"apply",this).call(this,f,t);return this.inputSpec=h,p}return Object(oi.a)(Object(Dn.a)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=Aa(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new Pn("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var u={training:a},c=Lu((function(e,t){var r=n.cell.call([e].concat(t),u);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),s=c[0],l=c[1],f=c[2];n.stateful&&n.resetStates(f,a);var d=n.returnSequences?l:s;return n.returnState?[d].concat(f):d}))}},{key:"getInitialState",value:function(e){var t=this;return Object(a.tidy)((function(){var n=a.zeros(e.shape);return n=Lr(n=a.sum(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?Hr(n,[1,e]):n})):t.cell.stateSize>1?[Hr(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){Object(oi.a)(Object(Dn.a)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign({},r,e,t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.cell,a=ui(r,n);return new e(Object.assign(t,{cell:a}))}}]),n}(Wa);Pu.className="RNN",a.serialization.registerClass(Pu);var Bu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return n}(Wa),Wu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,ar(r.units,"units"),r.activation=nu(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=ka(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=ka(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=ka(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=su(e.kernelRegularizer),r.recurrentRegularizer=su(e.recurrentRegularizer),r.biasRegularizer=su(e.biasRegularizer),r.kernelConstraint=mr(e.kernelConstraint),r.recurrentConstraint=mr(e.recurrentConstraint),r.biasConstraint=mr(e.biasConstraint),r.dropout=Fr([1,Mr([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Fr([1,Mr([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Object(Sn.a)(n,[{key:"build",value:function(e){e=Na(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){if(2!==(e=e).length)throw new Pn("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var i,o=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Xu({ones:function(){return a.onesLike(e)},rate:n.dropout,training:o})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Xu({ones:function(){return a.onesLike(r)},rate:n.recurrentDropout,training:o}));var u=n.dropoutMask,c=n.recurrentDropoutMask;i=Kr(null!=u?a.mul(e,u):e,n.kernel.read()),null!=n.bias&&(i=Jr(i,n.bias.read())),null!=c&&(r=a.mul(r,c));var s=a.add(i,Kr(r,n.recurrentKernel.read()));return null!=n.activation&&(s=n.activation.apply(s)),[s,s]}))}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:eu(this.activation),useBias:this.useBias,kernelInitializer:Oa(this.kernelInitializer),recurrentInitializer:Oa(this.recurrentInitializer),biasInitializer:Oa(this.biasInitializer),kernelRegularizer:uu(this.kernelRegularizer),recurrentRegularizer:uu(this.recurrentRegularizer),biasRegularizer:uu(this.biasRegularizer),activityRegularizer:uu(this.activityRegularizer),kernelConstraint:pr(this.kernelConstraint),recurrentConstraint:pr(this.recurrentConstraint),biasConstraint:pr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,t)}}]),n}(Bu);Wu.className="SimpleRNNCell",a.serialization.registerClass(Wu);var Uu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),e.cell=new Wu(e),t.call(this,e)}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var r=this;return Object(a.tidy)((function(){null!=r.cell.dropoutMask&&(a.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(a.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var i=null==t?null:t.mask,o=null==t?null:t.training,u=null==t?null:t.initialState;return Object(oi.a)(Object(Dn.a)(n.prototype),"call",r).call(r,e,{mask:i,training:o,initialState:u})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(Pu);Uu.className="SimpleRNN",a.serialization.registerClass(Uu);var Vu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Pn("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,ar(r.units,"units"),r.activation=nu(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=nu(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=ka(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=ka(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=ka(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=su(e.kernelRegularizer),r.recurrentRegularizer=su(e.recurrentRegularizer),r.biasRegularizer=su(e.biasRegularizer),r.kernelConstraint=mr(e.kernelConstraint),r.recurrentConstraint=mr(e.recurrentConstraint),r.biasConstraint=mr(e.biasConstraint),r.dropout=Fr([1,Mr([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Fr([1,Mr([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Object(Sn.a)(n,[{key:"build",value:function(e){var t=(e=Na(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){if(2!==(e=e).length)throw new Pn("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,o=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Xu({ones:function(){return a.onesLike(e)},rate:n.dropout,training:r,count:3})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Xu({ones:function(){return a.onesLike(o)},rate:n.recurrentDropout,training:r,count:3}));var u,c,s,l=n.dropoutMask,f=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=a.mul(e,l[0]));var d=Kr(e,n.kernel.read());n.useBias&&(d=Jr(d,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(o=a.mul(o,f[0]));var h=n.recurrentKernel.read(),p=a.split(h,[2*n.units,n.units],h.rank-1),v=Object(i.a)(p,2),m=v[0],b=v[1],g=Kr(o,m),y=a.split(d,3,d.rank-1),x=Object(i.a)(y,3),O=x[0],k=x[1],w=x[2],j=a.split(g,2,g.rank-1),_=Object(i.a)(j,2),S=_[0],E=_[1];u=n.recurrentActivation.apply(a.add(O,S)),c=n.recurrentActivation.apply(a.add(k,E));var C=Kr(a.mul(c,o),b);s=n.activation.apply(a.add(w,C));var A=a.add(a.mul(u,o),a.mul(a.add(1,a.neg(u)),s));return[A,A]}))}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:eu(this.activation),recurrentActivation:eu(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Oa(this.kernelInitializer),recurrentInitializer:Oa(this.recurrentInitializer),biasInitializer:Oa(this.biasInitializer),kernelRegularizer:uu(this.kernelRegularizer),recurrentRegularizer:uu(this.recurrentRegularizer),biasRegularizer:uu(this.biasRegularizer),activityRegularizer:uu(this.activityRegularizer),kernelConstraint:pr(this.kernelConstraint),recurrentConstraint:pr(this.recurrentConstraint),biasConstraint:pr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,t)}}]),n}(Bu);Vu.className="GRUCell",a.serialization.registerClass(Vu);var qu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Vu(e),t.call(this,e)}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var r=this;return Object(a.tidy)((function(){null!=r.cell.dropoutMask&&(a.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(a.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var i=null==t?null:t.mask,o=null==t?null:t.training,u=null==t?null:t.initialState;return Object(oi.a)(Object(Dn.a)(n.prototype),"call",r).call(r,e,{mask:i,training:o,initialState:u})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(Pu);qu.className="GRU",a.serialization.registerClass(qu);var Hu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,ar(r.units,"units"),r.activation=nu(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=nu(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=ka(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=ka(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=ka(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=su(e.kernelRegularizer),r.recurrentRegularizer=su(e.recurrentRegularizer),r.biasRegularizer=su(e.biasRegularizer),r.kernelConstraint=mr(e.kernelConstraint),r.recurrentConstraint=mr(e.recurrentConstraint),r.biasConstraint=mr(e.biasConstraint),r.dropout=Fr([1,Mr([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Fr([1,Mr([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Object(Sn.a)(n,[{key:"build",value:function(e){var t,n,r=(e=Na(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new((t=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new ia).apply([i]),o=a.apply([2*i]);return qr(qr(n,r),o)}}]),n}(ra)).className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var r=null!=t.training&&t.training;if(3!==(e=e).length)throw new Pn("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var o=e[1],u=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Xu({ones:function(){return a.onesLike(e)},rate:n.dropout,training:r,count:4})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Xu({ones:function(){return a.onesLike(o)},rate:n.recurrentDropout,training:r,count:4}));var c,s,l,f,d=n.dropoutMask,h=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=a.mul(e,d[0]));var p=Kr(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(o=a.mul(o,h[0])),p=a.add(p,Kr(o,n.recurrentKernel.read())),n.useBias&&(p=Jr(p,n.bias.read()));var v=a.split(p,4,p.rank-1),m=Object(i.a)(v,4),b=m[0],g=m[1],y=m[2],x=m[3];c=n.recurrentActivation.apply(b),s=n.recurrentActivation.apply(g),l=a.add(a.mul(s,u),a.mul(c,n.activation.apply(y))),f=n.recurrentActivation.apply(x);var O=a.mul(f,n.activation.apply(l));return[O,O,l]}))}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:eu(this.activation),recurrentActivation:eu(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Oa(this.kernelInitializer),recurrentInitializer:Oa(this.recurrentInitializer),biasInitializer:Oa(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:uu(this.kernelRegularizer),recurrentRegularizer:uu(this.recurrentRegularizer),biasRegularizer:uu(this.biasRegularizer),activityRegularizer:uu(this.activityRegularizer),kernelConstraint:pr(this.kernelConstraint),recurrentConstraint:pr(this.recurrentConstraint),biasConstraint:pr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,t)}}]),n}(Bu);Hu.className="LSTMCell",a.serialization.registerClass(Hu);var Gu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Hu(e),t.call(this,e)}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var r=this;return Object(a.tidy)((function(){null!=r.cell.dropoutMask&&(a.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(a.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var i=null==t?null:t.mask,o=null==t?null:t.training,u=null==t?null:t.initialState;return Object(oi.a)(Object(Dn.a)(n.prototype),"call",r).call(r,e,{mask:i,training:o,initialState:u})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(Pu);Gu.className="LSTM",a.serialization.registerClass(Gu);var Ku=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).cells=e.cells,r}return Object(Sn.a)(n,[{key:"stateSize",get:function(){var e,t=[],n=Object(Tn.a)(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,Object(Nn.a)(r.stateSize)):t.push(r.stateSize)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var r,a=(e=e).slice(1),i=[],o=Object(Tn.a)(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var u=r.value;Array.isArray(u.stateSize)?i.push(a.splice(0,u.stateSize.length)):i.push(a.splice(0,1))}}catch(m){o.e(m)}finally{o.f()}i.reverse();for(var c,s=[],l=0;l<n.cells.length;++l){var f=n.cells[l];a=i[l],c=0===l?[e[0]].concat(a):[c[0]].concat(a),c=f.call(c,t),s.push(c.slice(1))}a=[];var d,h=Object(Tn.a)(s.slice().reverse());try{for(h.s();!(d=h.n()).done;){var p,v=d.value;(p=a).push.apply(p,Object(Nn.a)(v))}}catch(m){h.e(m)}finally{h.f()}return[c[0]].concat(a)}))}},{key:"build",value:function(e){var t;Ea(e)&&(e=e[0]),e=e,this.cells.forEach((function(n,r){Er("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign({},e,t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=Object(Tn.a)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Nn.a)(r.trainableWeights))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=Object(Tn.a)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Nn.a)(r.nonTrainableWeights))}}catch(c){n.e(c)}finally{n.f()}if(!this.trainable){var a,i=[],o=Object(Tn.a)(this.cells);try{for(o.s();!(a=o.n()).done;){var u=a.value;i.push.apply(i,Object(Nn.a)(u.trainableWeights))}}catch(c){o.e(c)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=Object(Tn.a)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Nn.a)(r.weights))}}catch(a){n.e(a)}finally{n.f()}return Fa(t)}},{key:"setWeights",value:function(e){var t,n=[],r=Object(Tn.a)(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),u=0;u<a.weights.length;++u)n.push([a.weights[u],o[u]])}catch(c){r.e(c)}finally{r.f()}Ma(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=Object(Tn.a)(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(ui(o,r))}}catch(u){i.e(u)}finally{i.f()}return new e({cells:a})}}]),n}(Bu);function Xu(e){var t=e.ones,n=e.rate,r=e.training,i=void 0!==r&&r,o=e.count,u=void 0===o?1:o,c=function(){return Zr(t(),n)},s=function(){return ea(c,t,i)};return!u||u<=1?a.keep(s().clone()):Array(u).fill(void 0).map(s).map((function(e){return a.keep(e.clone())}))}Ku.className="StackedRNNCells",a.serialization.registerClass(Ku);var Yu=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},$u=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),e.unroll)throw new Bn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Bn("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new Ra({ndim:5})],r}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var r=this;return a.tidy((function(){if(null!=r.cell.dropoutMask&&(a.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(a.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new Pn("ConvRNN2D cell does not support constants");var i=null==t?null:t.mask,o=null==t?null:t.training,u=null==t?null:t.initialState;return Object(oi.a)(Object(Dn.a)(n.prototype),"call",r).call(r,e,{mask:i,training:o,initialState:u})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(Object(Nn.a)(t.slice(2)))),this.returnState&&(t=[t].concat(Object(Nn.a)(Array(2).fill([e[0]].concat(Object(Nn.a)(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return a.tidy((function(){var n=t.cell.stateSize,r=e.shape,i=t.computeSingleOutputShape(r),o=[i[0]].concat(Object(Nn.a)(i.slice(2))),u=a.zeros(o);return Array.isArray(n)?Array(n.length).fill(u):[u]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.tidy((function(){if(!t.stateful)throw new zn("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,i=t.computeSingleOutputShape(r),o=[i[0]].concat(Object(Nn.a)(i.slice(2)));if(null==r[0])throw new Pn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return a.zeros(o)})):t.states_=[a.zeros(o)];else if(null==e)a.dispose(t.states_),null!=t.keptStates&&(a.dispose(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return a.zeros(o)})):t.states_[0]=a.zeros(o);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new Pn("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):a.dispose(t.states_);for(var u=0;u<t.states_.length;++u){var c=e[u],s=o;if(!a.util.arraysEqual(c.shape,s))throw new Pn("State ".concat(u," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(s,", received shape=").concat(c.shape));t.states_[u]=c}}t.states_=t.states_.map((function(e){return a.keep(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,u=t.dilationRate,c="channelsFirst"===n,s=e[c?3:2],l=e[c?4:3],f=gu(s,a[0],i,o[0],u[0]),d=gu(l,a[1],i,o[1],u[1]);return[].concat(Object(Nn.a)(e.slice(0,2)),Object(Nn.a)(c?[r,f,d]:[f,d,r]))}}]),n}(Pu);$u.className="ConvRNN2D";var Ju=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;Object(_n.a)(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,u=e.padding,c=e.dataFormat,s=e.dilationRate;return(r=t.call(this,Object.assign({},e,{units:a}))).filters=a,ar(r.filters,"filters"),r.kernelSize=bu(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return ar(e,"kernelSize")})),r.strides=bu(o||1,2,"strides"),r.strides.forEach((function(e){return ar(e,"strides")})),r.padding=u||"valid",jr(r.padding),r.dataFormat=c||"channelsLast",wr(r.dataFormat),r.dilationRate=bu(s||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return ar(e,"dilationRate")})),r}return Object(Sn.a)(n,[{key:"build",value:function(e){var t;e=Na(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new Pn("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],i=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var o=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var u;if(this.unitForgetBias){var c=this.biasInitializer,s=this.filters;u=new((t=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"apply",value:function(e,t){return Vr([c.apply([s]),a.ones([s]),c.apply([2*s])])}}]),n}(ra)).className="CustomInit",t)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return a.tidy((function(){if(3!==e.length)throw new Pn("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,o=e[0],u=e[1],c=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Xu({ones:function(){return a.onesLike(o)},rate:n.dropout,training:r,count:4}));var s=n.dropoutMask,l=function(e,t,n){return t&&t[n]?a.mul(t[n],e):e},f=l(o,s,0),d=l(o,s,1),h=l(o,s,2),p=l(o,s,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Xu({ones:function(){return a.onesLike(u)},rate:n.recurrentDropout,training:r,count:4}));var v=n.recurrentDropoutMask,m=l(u,v,0),b=l(u,v,1),g=l(u,v,2),y=l(u,v,3),x=a.split(n.kernel.read(),4,3),O=Object(i.a)(x,4),k=O[0],w=O[1],j=O[2],_=O[3],S=n.useBias?a.split(n.bias.read(),4):[null,null,null,null],E=Object(i.a)(S,4),C=E[0],A=E[1],N=E[2],T=E[3];f=n.inputConv(f,k,C,n.padding),d=n.inputConv(d,w,A,n.padding),h=n.inputConv(h,j,N,n.padding),p=n.inputConv(p,_,T,n.padding);var I=a.split(n.recurrentKernel.read(),4,3),D=Object(i.a)(I,4),F=D[0],M=D[1],R=D[2],z=D[3];m=n.recurrentConv(m,F),b=n.recurrentConv(b,M),g=n.recurrentConv(g,R),y=n.recurrentConv(y,z);var L=n.recurrentActivation.apply(a.add(f,m)),P=n.recurrentActivation.apply(a.add(d,b)),B=a.add(a.mul(P,c),a.mul(L,n.activation.apply(a.add(h,g)))),W=a.mul(n.recurrentActivation.apply(a.add(p,y)),n.activation.apply(B));return[W,W,B]}))}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t=(e.units,Yu(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},t,r)}},{key:"inputConv",value:function(e,t,n,r){var i=a.conv2d(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?Jr(i,n,this.dataFormat):i}},{key:"recurrentConv",value:function(e,t){return a.conv2d(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(Hu);Ju.className="ConvLSTM2DCell",a.serialization.registerClass(Ju);var Qu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){Object(_n.a)(this,n);var r=new Ju(e);return t.call(this,Object.assign({},e,{cell:r}))}return Object(Sn.a)(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}($u);Qu.className="ConvLSTM2D",a.serialization.registerClass(Qu);var Zu=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return Object(Sn.a)(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r=Aa(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return ea((function(){return Zr(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return Object(oi.a)(Object(Dn.a)(n.prototype),"dispose",this).call(this)}}]),n}(Wa);Zu.className="Dropout",a.serialization.registerClass(Zu);var ec=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return Object(Sn.a)(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(Zu);ec.className="SpatialDropout1D",a.serialization.registerClass(ec);var tc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,ar(r.units,"units"),r.activation=nu(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=ka(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=ka(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=mr(e.kernelConstraint),r.biasConstraint=mr(e.biasConstraint),r.kernelRegularizer=su(e.kernelRegularizer),r.biasRegularizer=su(e.biasRegularizer),r.activityRegularizer=su(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return Object(Sn.a)(n,[{key:"build",value:function(e){var t=(e=Na(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:Object(mu.a)({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=Na(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r,a=Aa(e),i=or(n.activation.getClassName());return null!=i?r=Kr(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=Kr(a,n.kernel.read()),null!=n.bias&&(r=Jr(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:eu(this.activation),useBias:this.useBias,kernelInitializer:Oa(this.kernelInitializer),biasInitializer:Oa(this.biasInitializer),kernelRegularizer:uu(this.kernelRegularizer),biasRegularizer:uu(this.biasRegularizer),activityRegularizer:uu(this.activityRegularizer),kernelConstraint:pr(this.kernelConstraint),biasConstraint:pr(this.biasConstraint)},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);tc.className="Dense",a.serialization.registerClass(tc);var nc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){e=Na(e);var t,n=Object(Tn.a)(e.slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new Pn('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(r){n.e(r)}finally{n.f()}return[e[0],Ir(e,1)]}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r=Aa(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=r.transpose(a)}return function(e){if(e.rank<=1)throw new Pn("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],Ir(e.shape,1)];return e.reshape(t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);nc.className="Flatten",a.serialization.registerClass(nc);var rc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=nu(e.activation),r}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r=Aa(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:eu(this.activation)},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);rc.className="Activation",a.serialization.registerClass(rc);var ac=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){return e=Aa(e),t=e,r=n.n,Object(a.tidy)((function(){if(2!==t.shape.length)throw new Pn("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return Hr(Lr(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);ac.className="RepeatVector",a.serialization.registerClass(ac);var ic=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;Object(_n.a)(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return Object(Sn.a)(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var u=r[o];if(this.isUnknown(u)){if(null!==i)throw new Pn("Can only specifiy one unknown dimension.");i=o}else a*=u}var c=Ir(e);if(null!==i){if(0===a||c%a!==0)throw new Pn(n);r[i]=c/a}else if(c!==a)throw new Pn(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r=Aa(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return r.reshape(i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);ic.className="Reshape",a.serialization.registerClass(ic);var oc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var i=Rr(1,e.dims.length+1);if(!a.util.arraysEqual(e.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Ra({ndim:r.dims.length+1})],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){var t=(e=Na(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return Object(a.transpose)(Aa(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);oc.className="Permute",a.serialization.registerClass(oc);var uc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=Aa(e);return Object(a.any)(Object(a.notEqual)(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r=Aa(e),i=Object(a.any)(Object(a.notEqual)(r,n.maskValue),-1,!0);return r.mul(i.asType(r.dtype))}))}}]),n}(Wa);uc.className="Masking",a.serialization.registerClass(uc);var cc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(Gn(e.inputLength))}return r.inputDim=e.inputDim,ar(r.inputDim,"inputDim"),r.outputDim=e.outputDim,ar(r.outputDim,"outputDim"),r.embeddingsInitializer=ka(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=su(e.embeddingsRegularizer),r.activityRegularizer=su(e.activityRegularizer),r.embeddingsConstraint=mr(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return Object(Sn.a)(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return Object(a.tidy)((function(){return n.maskZero?(e=Aa(e),Object(a.notEqual)(e,Object(a.zerosLike)(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=Na(e),null==this.inputLength)return[].concat(Object(Nn.a)(e),[this.outputDim]);var t=Gn(this.inputLength);if(t.length!==e.length-1)throw new Pn('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new Pn('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(Object(Nn.a)(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r=Aa(e);return"int32"!==r.dtype&&(r=zr(r,"int32")),Xr(n.embeddings.read(),r.as1D()).reshape(Na(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Oa(this.embeddingsInitializer),embeddingsRegularizer:uu(this.embeddingsRegularizer),activityRegularizer:uu(this.activityRegularizer),embeddingsConstraint:pr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);cc.className="Embedding",a.serialization.registerClass(cc);var sc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return Object(Sn.a)(n,[{key:"mergeFunction",value:function(e){throw new Bn}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new Pn("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Na(e)]),(e=e).length<2)throw new Pn("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=Object(Tn.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(s){r.e(s)}finally{r.f()}if((n=er(n)).length>1)throw new Pn("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var u=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,u)}var c=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===er(c).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){if(e=e,n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var i,o=Mr(r),u=Object(Tn.a)(e);try{for(u.s();!(i=u.n()).done;){for(var c=i.value,s=c.rank,l=0;l<o-s;++l)c=Lr(c,1);t.push(c)}}catch(E){u.e(E)}finally{u.f()}return n.mergeFunction(t)}var f,d=!1,h=Object(Tn.a)(e);try{for(h.s();!(f=h.n()).done;){var p=f.value,v=p.rank;if(null==v){var m=p.shape,b=m[0],g=m.slice(1).concat([b]),y=p.reshape([b].concat(Ir(m.slice(1))));y=(y=a.transpose(y,[1,0])).reshape(g),t.push(y),d=!0}else if(v>1){var x=Rr(1,v).concat([0]);t.push(a.transpose(p,x)),d=!0}else t.push(p)}}catch(E){h.e(E)}finally{h.f()}var O=n.mergeFunction(t),k=O.rank;if(d)if(null==k){var w=O.shape,j=w[w.length-1],_=[j].concat(w.slice(0,w.length-1));O=a.transpose(O.reshape([-1,j]),[1,0]).reshape(_)}else if(k>1){var S=[k-1].concat(Rr(0,k-1));O=a.transpose(O,S)}return O}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==(e=e)[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=Object(Tn.a)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value;null!=u&&null!==u[0]&&i.push(u[0])}}catch(c){o.e(c)}finally{o.f()}return t=1===(i=er(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return a.tidy((function(){if(null==t)return null;if(!Array.isArray(t))throw new Pn("`mask` should be an Array");if(!Array.isArray(e))throw new Pn("`inputs` should be an Array");if(t.length!==e.length)throw new Pn("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:a.expandDims(e,0)})))[0],r=1;r<t.length-1;++r)n=a.logicalAnd(n,t[r]);return n}))}}]),n}(Wa),lc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"mergeFunction",value:function(e){return Object(a.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=a.add(t,e[n]);return t}))}}]),n}(sc);lc.className="Add",a.serialization.registerClass(lc);var fc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"mergeFunction",value:function(e){return Object(a.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=a.mul(t,e[n]);return t}))}}]),n}(sc);fc.className="Multiply",a.serialization.registerClass(fc);var dc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"mergeFunction",value:function(e){return Object(a.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=a.add(t,e[n]);return a.mul(1/e.length,t)}))}}]),n}(sc);dc.className="Average",a.serialization.registerClass(dc);var hc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"mergeFunction",value:function(e){return Object(a.tidy)((function(){for(var t=e[0],n=1;n<e.length;++n)t=a.maximum(t,e[n]);return t}))}}]),n}(sc);hc.className="Maximum",a.serialization.registerClass(hc);var pc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"mergeFunction",value:function(e){return Object(a.tidy)((function(){for(var t=e[0],n=1;n<e.length;++n)t=a.minimum(t,e[n]);return t}))}}]),n}(sc);pc.className="Minimum",a.serialization.registerClass(pc);var vc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Object(Sn.a)(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new Pn("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;var t,n=!0,r=Object(Tn.a)(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(d){r.e(d)}finally{r.f()}if(!n){for(var i=[],o=0;o<e.length;++o){var u=e[o].slice();u.splice(this.axis,1);var c,s=!1,l=Object(Tn.a)(i);try{for(l.s();!(c=l.n()).done;){var f=c.value;if(a.util.arraysEqual(f,u)){s=!0;break}}}catch(d){l.e(d)}finally{l.f()}s||i.push(u)}if(i.length>1)throw new Pn("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return Object(a.tidy)((function(){return Vr(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Pn("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=Object(Tn.a)(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(u){i.e(u)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new Pn("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Pn("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Pn("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return a.tidy((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var i=[],o=0;o<e.length;++o)null==t[o]?i.push(a.onesLike(e[o]).asType("bool")):t[o].rank<e[o].rank?i.push(a.expandDims(t[o],-1)):i.push(t[o]);var u=a.concat(i,n.axis);return a.all(u,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(sc);function mc(e,t){for(;e<0;)e+=t;return e}vc.className="Concatenate",a.serialization.registerClass(vc);var bc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Object(Sn.a)(n,[{key:"build",value:function(e){a.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Bn("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new Pn("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new Pn("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return mc(t,e[n].shape.length)})):[mc(this.axes,n.shape.length),mc(this.axes,r.shape.length)],this.normalize&&(n=ci(n,t[0]),r=ci(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Bn("batchDot is not implemented for tensors of 4D or higher rank yet");if(a.util.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),a.util.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new Bn("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,i=t.shape.length;null==n&&(n=[r-1,i-2]);var o=n;return a.tidy((function(){var n,a;if(r>i){n=r-i;for(var u=[],c=0;c<n;++c)u.push(1);t=t.reshape(t.shape.concat(u))}else if(i>r){n=i-r;for(var s=[],l=0;l<n;++l)s.push(1);e=e.reshape(e.shape.concat(s))}else n=0;if(2===e.shape.length&&2===t.shape.length)a=o[0]===o[1]?e.mul(t).sum(o[0]):e.transpose([1,0]).mul(t).sum(o[1]);else{var f=o[0]!==e.shape.length-1,d=o[1]===t.shape.length-1;a=e.matMul(t,f,d)}if(n>0){for(var h,p=[],v=h=r>i?r+i-3:r-1;v<h+n;++v)p.push(v);a=a.squeeze(p)}return 1===a.shape.length&&(a=a.expandDims(1)),a}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[mc(this.axes,e.length),mc(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){a.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Bn("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var i=t.concat(n);return 1===i.length&&i.push(1),i}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(sc);bc.className="Dot",a.serialization.registerClass(bc);var gc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r=Aa(e);return ea((function(){return Gr(r.shape,0,n.stddev).add(r)}),(function(){return r}),t.training||!1)}))}}]),n}(Wa);gc.className="GaussianNoise",a.serialization.registerClass(gc);var yc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t);var r=Aa(e);if(n.rate>0&&n.rate<1){return ea((function(){var e=Math.sqrt(n.rate/(1-n.rate));return r.mul(Gr(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(Wa);yc.className="GaussianDropout",a.serialization.registerClass(yc);var xc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return Object(Sn.a)(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||Aa(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return ea((function(){var t=Aa(e),i=-1.7580993408473766,o=Object(a.greaterEqual)(Object(a.randomUniform)(r),n.rate);o=zr(o,"float32");var u=Math.pow((1-n.rate)*(1+n.rate*Math.pow(i,2)),-.5),c=-u*i*n.rate;return t.mul(o).add(o.add(-1).mul(i)).mul(u).add(c)}),(function(){return Aa(e)}),t.training||!1)}return e}))}}]),n}(Wa);function Oc(e,t,n,r,i){var o,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)o=a.batchNorm2d(e,t,n,r,i,u);else if(3===e.rank)o=a.batchNorm3d(e,t,n,r,i,u);else{if(4!==e.rank)throw new Bn("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");o=a.batchNorm4d(e,t,n,r,i,u)}return o}function kc(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Object(a.tidy)((function(){var o=a.moments(e,r),u=o.mean,c=o.variance;return[Oc(e,u,c,n,t,i),u,c]}))}function wc(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Object(a.tidy)((function(){var o,u=a.moments(e,r),c=u.mean,s=u.variance,l=[],f=Object(Tn.a)(Rr(0,e.rank));try{for(f.s();!(o=f.n()).done;){var d=o.value;-1!==r.indexOf(d)?l.push(1):l.push(e.shape[d])}}catch(b){f.e(b)}finally{f.f()}var h=c.reshape(l),p=s.reshape(l),v=null==t?null:t.reshape(l),m=null==n?null:n.reshape(l);return[Oc(e,h,p,m,v,i),c,s]}))}xc.className="AlphaDropout",a.serialization.registerClass(xc);var jc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=ka(e.betaInitializer||"zeros"),r.gammaInitializer=ka(e.gammaInitializer||"ones"),r.movingMeanInitializer=ka(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=ka(e.movingVarianceInitializer||"ones"),r.betaConstraint=mr(e.betaConstraint),r.gammaConstraint=mr(e.gammaConstraint),r.betaRegularizer=su(e.betaRegularizer),r.gammaRegularizer=su(e.gammaRegularizer),r}return Object(Sn.a)(n,[{key:"build",value:function(e){e=Na(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new Pn("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new Ra({ndim:e.length,axes:Object(mu.a)({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var r=null!=t.training&&t.training,o=Aa(e),u=o.shape,c=u.length,s=Rr(0,c),l=n.axis>=0?n.axis:n.axis+c;s.splice(l,1);var f=Un(1,c);f[l]=u[l];var d=s.slice();d.sort();var h=!a.util.arraysEqual(d,Rr(0,c).slice(0,c-1));if(!r)return function(){if(h){var e=n.movingMean.read().reshape(f),t=n.movingVariance.read().reshape(f),r=n.center?n.beta.read().reshape(f):null,a=n.scale?n.gamma.read().reshape(f):null;return Oc(o,e,t,r,a,n.epsilon)}return Oc(o,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var p=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return a.util.arraysEqual(r.slice().sort(),Rr(0,e.rank-1))?kc(e,t,n,r,i):wc(e,t,n,r,i)}(o,n.gamma.read(),n.beta.read(),s,n.epsilon),v=Object(i.a)(p,3),m=v[0],b=v[1],g=v[2],y=function(e,t,n){a.tidy((function(){var r=1-n,a=e.read(),i=a.sub(t).mul(r);e.write(a.sub(i))}))};return y(n.movingMean,b,n.momentum),y(n.movingVariance,g,n.momentum),m}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Oa(this.betaInitializer),gammaInitializer:Oa(this.gammaInitializer),movingMeanInitializer:Oa(this.movingMeanInitializer),movingVarianceInitializer:Oa(this.movingVarianceInitializer),betaRegularizer:uu(this.betaRegularizer),gammaRegularizer:uu(this.gammaRegularizer),betaConstraint:pr(this.betaConstraint),gammaConstraint:pr(this.gammaConstraint)},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);jc.className="BatchNormalization",a.serialization.registerClass(jc);var _c=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=Object(Tn.a)(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(u){i.e(u)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=ka(e.betaInitializer||"zeros"),r.gammaInitializer=ka(e.gammaInitializer||"ones"),r.betaRegularizer=su(e.betaRegularizer),r.gammaRegularizer=su(e.gammaRegularizer),r.supportsMasking=!0,r}return Object(Sn.a)(n,[{key:"build",value:function(e){var t=(e=Na(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=Object(Tn.a)(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(u){a.e(u)}finally{a.f()}if(this.axis.length!==er(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=Aa(e),i=r.shape,o=i.length;return Object(a.tidy)((function(){var e,t=Object(a.moments)(r,n.axis,!0),u=t.mean,c=t.variance,s=Un(1,o),l=Object(Tn.a)(n.axis);try{for(l.s();!(e=l.n()).done;){var f=e.value;s[f]=i[f]}}catch(g){l.e(g)}finally{l.f()}for(var d=function(e){return null!=e&&e.shape.length!==o&&n.axis!==[o-1]?e.reshape(s):e},h=d(n.gamma.read()),p=d(n.beta.read()),v=[],m=[],b=0;b<o;++b)-1!==n.axis.indexOf(b)?(v.push(i[b]),m.push(1)):(v.push(1),m.push(i[b]));return u=u.tile(v),c=c.tile(v),h=h.tile(m),p=p.tile(m),Oc(r,u,c,p,h,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Oa(this.betaInitializer),gammaInitializer:Oa(this.gammaInitializer),betaRegularizer:uu(this.betaRegularizer),gammaRegularizer:uu(this.gammaRegularizer)},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);_c.className="LayerNormalization",a.serialization.registerClass(_c);var Sc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new Pn("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new Pn("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new Pn("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new Ra({ndim:4})],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=Na(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){return t=Aa(e),r=n.padding,i=n.dataFormat,Object(a.tidy)((function(){if(4!==t.rank)throw new Pn("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new Pn("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==i&&(i="channelsLast"),"channelsLast"!==i&&"channelsFirst"!==i)throw new Pn("Unknown data format: ".concat(i,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var e;return e="channelsFirst"===i?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],a.pad(t,e)}));var t,r,i}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa);function Ec(e,t,n,r,i,o){return Object(a.tidy)((function(){var u;wr(i),_r(o),jr(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==o&&(o="max"),e=xu(e,i);var c="same"===r?"same":"valid";return u="max"===o?a.maxPool(e,t,n,c):a.avgPool(e,t,n,c),"channelsFirst"===i&&(u=a.transpose(u,[0,3,1,2])),u}))}function Cc(e,t,n,r,i,o){return Object(a.tidy)((function(){var u;wr(i),_r(o),jr(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==o&&(o="max"),e=Ou(e,i);var c="same"===r?"same":"valid";return u="max"===o?a.maxPool3d(e,t,n,c):a.avgPool3d(e,t,n,c),"channelsFirst"===i&&(u=a.transpose(u,[0,4,1,2,3])),u}))}Sc.className="ZeroPadding2D",a.serialization.registerClass(Sc);var Ac=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new Pn("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(ar(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new Pn("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return ar(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,jr(r.padding),r.inputSpec=[new Ra({ndim:3})],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){var t=gu((e=Na(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){n.invokeCallHook(e,t),e=Lr(Aa(e),2);var r=n.poolingFunction(Aa(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return a.squeeze(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa),Nc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return wr(a),jr(r),Ec(e,t,n,r,a,"max")}}]),n}(Ac);Nc.className="MaxPooling1D",a.serialization.registerClass(Nc);var Tc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return wr(a),jr(r),Ec(e,t,n,r,a,"avg")}}]),n}(Ac);Tc.className="AveragePooling1D",a.serialization.registerClass(Tc);var Ic=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new Pn("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return ar(r.poolSize,"poolSize"),ar(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wr(r.dataFormat),jr(r.padding),r.inputSpec=[new Ra({ndim:4})],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){e=Na(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=gu(t,this.poolSize[0],this.padding,this.strides[0]),n=gu(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){return n.invokeCallHook(e,t),n.poolingFunction(Aa(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa),Dc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return wr(a),jr(r),Ec(e,t,n,r,a,"max")}}]),n}(Ic);Dc.className="MaxPooling2D",a.serialization.registerClass(Dc);var Fc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return wr(a),jr(r),Ec(e,t,n,r,a,"avg")}}]),n}(Ic);Fc.className="AveragePooling2D",a.serialization.registerClass(Fc);var Mc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;if(Object(_n.a)(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new Pn("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return ar(r.poolSize,"poolSize"),ar(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wr(r.dataFormat),jr(r.padding),r.inputSpec=[new Ra({ndim:5})],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){e=Na(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=gu(t,this.poolSize[0],this.padding,this.strides[0]),n=gu(n,this.poolSize[1],this.padding,this.strides[1]),r=gu(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){return n.invokeCallHook(e,t),n.poolingFunction(Aa(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa),Rc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return wr(a),jr(r),Cc(e,t,n,r,a,"max")}}]),n}(Mc);Rc.className="MaxPooling3D",a.serialization.registerClass(Rc);var zc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e)}return Object(Sn.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return wr(a),jr(r),Cc(e,t,n,r,a,"avg")}}]),n}(Mc);zc.className="AveragePooling3D",a.serialization.registerClass(zc);var Lc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).inputSpec=[new Ra({ndim:3})],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new Bn}}]),n}(Wa),Pc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e||{})}return Object(Sn.a)(n,[{key:"call",value:function(e,t){return Object(a.tidy)((function(){var t=Aa(e);return a.mean(t,1)}))}}]),n}(Lc);Pc.className="GlobalAveragePooling1D",a.serialization.registerClass(Pc);var Bc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){return Object(_n.a)(this,n),t.call(this,e||{})}return Object(Sn.a)(n,[{key:"call",value:function(e,t){return Object(a.tidy)((function(){var t=Aa(e);return a.max(t,1)}))}}]),n}(Lc);Bc.className="GlobalMaxPooling1D",a.serialization.registerClass(Bc);var Wc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,wr(r.dataFormat),r.inputSpec=[new Ra({ndim:4})],r}return Object(Sn.a)(n,[{key:"computeOutputShape",value:function(e){return e=e,"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new Bn}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Wa),Uc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var t=Aa(e);return"channelsLast"===n.dataFormat?a.mean(t,[1,2]):a.mean(t,[2,3])}))}}]),n}(Wc);Uc.className="GlobalAveragePooling2D",a.serialization.registerClass(Uc);var Vc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){return Object(_n.a)(this,n),t.apply(this,arguments)}return Object(Sn.a)(n,[{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var t=Aa(e);return"channelsLast"===n.dataFormat?a.max(t,[1,2]):a.max(t,[2,3])}))}}]),n}(Wc);Vc.className="GlobalMaxPooling2D",a.serialization.registerClass(Vc);var qc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).layer=e.layer,r}return Object(Sn.a)(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){Object(oi.a)(Object(Dn.a)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.layer,a=ui(r,n);delete t.layer;var i={layer:a};return Object.assign(i,t),new e(i)}}]),n}(Wa),Hc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;return Object(_n.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return Object(Sn.a)(n,[{key:"build",value:function(e){if((e=Na(e)).length<3)throw new Pn("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),Object(oi.a)(Object(Dn.a)(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=Na(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){return Lu((function(e,r){return[Aa(n.layer.call(e,t)),[]]}),e=Aa(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(qc);Hc.className="TimeDistributed",a.serialization.registerClass(Hc);var Gc=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r;Object(_n.a)(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=ui(i),a.goBackwards=!0!==a.goBackwards;var o,u={};if(u.className=e.layer.getClassName(),u.config=a,r.backwardLayer=ui(u),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,o=r.mergeMode,nr(Or,"BidirectionalMergeMode",o),e.weights)throw new Bn("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return Object(Sn.a)(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),a=a,this.returnState?(r=a.slice(1),t=a[0]):t=a[0],t=t,"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):Hn(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=zu(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return Object(oi.a)(Object(Dn.a)(n.prototype),"apply",this).call(this,e,t);var o=[],u=[];if(null!=r){var c=r.length;if(c%2>0)throw new Pn("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,Object(Nn.a)(r));var s=r.map((function(e){return new Ra({shape:e.shape})}));this.forwardLayer.stateSpec=s.slice(0,c/2),this.backwardLayer.stateSpec=s.slice(c/2),u.push.apply(u,Object(Nn.a)(s))}if(null!=a)throw new Bn("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof za,f=0,d=o;f<d.length;f++){if(d[f]instanceof za!==l)throw new Pn("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var h=[e].concat(o),p=this.inputSpec.concat(u),v=this.inputSpec;this.inputSpec=p;var m=Object(oi.a)(Object(Dn.a)(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=v,m}return Object(oi.a)(Object(Dn.a)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Object(a.tidy)((function(){var r,i,o,u,c=t.initialState;if(null==c)r=n.forwardLayer.call(e,t),i=n.backwardLayer.call(e,t);else{var s=c.slice(0,c.length/2),l=c.slice(c.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:s})),i=n.backwardLayer.call(e,Object.assign(t,{initialState:l}))}return n.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),n.returnSequences&&(i=a.reverse(i,1)),"concat"===n.mergeMode?u=Vr([r,i]):"sum"===n.mergeMode?u=a.add(r,i):"ave"===n.mergeMode?u=a.mul(.5,a.add(r,i)):"mul"===n.mergeMode?u=a.mul(r,i):null==n.mergeMode&&(u=[r,i]),n.returnState?null==n.mergeMode?u.concat(o):[u].concat(o):u}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;Er(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),Er(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){Object(oi.a)(Object(Dn.a)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=Object(oi.a)(Object(Dn.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=ui(t.layer);if(delete t.layer,null!=t.numConstants)throw new Bn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(qc);function Kc(e){return new Va(e)}function Xc(e){return new hu(e)}function Yc(e){return new lu(e)}function $c(e){return new fu(e)}function Jc(e){return new du(e)}function Qc(e){return new vu(e)}function Zc(e){return new pu(e)}function es(e){return new Du(e)}function ts(e){return new Eu(e)}function ns(e){return new Au(e)}function rs(e){return new Cu(e)}function as(e){return new Nu(e)}function is(e){return new Iu(e)}function os(e){return new Fu(e)}function us(e){return new Mu(e)}function cs(e){return new Ru(e)}function ss(e){return new rc(e)}function ls(e){return new tc(e)}function fs(e){return new Zu(e)}function ds(e){return new ec(e)}function hs(e){return new nc(e)}function ps(e){return new ac(e)}function vs(e){return new ic(e)}function ms(e){return new oc(e)}function bs(e){return new cc(e)}function gs(e){return new lc(e)}function ys(e){return new dc(e)}function xs(e){return new vc(e)}function Os(e){return new hc(e)}function ks(e){return new pc(e)}function ws(e){return new fc(e)}function js(e){return new bc(e)}function _s(e){return new jc(e)}function Ss(e){return new _c(e)}function Es(e){return new Sc(e)}function Cs(e){return new Tc(e)}function As(e){return Cs(e)}function Ns(e){return Cs(e)}function Ts(e){return new Fc(e)}function Is(e){return Ts(e)}function Ds(e){return Ts(e)}function Fs(e){return new zc(e)}function Ms(e){return Fs(e)}function Rs(e){return Fs(e)}function zs(e){return new Pc(e)}function Ls(e){return new Uc(e)}function Ps(e){return new Bc(e)}function Bs(e){return new Vc(e)}function Ws(e){return new Nc(e)}function Us(e){return new Dc(e)}function Vs(e){return new Rc(e)}function qs(e){return new qu(e)}function Hs(e){return new Vu(e)}function Gs(e){return new Gu(e)}function Ks(e){return new Hu(e)}function Xs(e){return new Uu(e)}function Ys(e){return new Wu(e)}function $s(e){return new Qu(e)}function Js(e){return new Ju(e)}function Qs(e){return new Pu(e)}function Zs(e){return new Ku(e)}function el(e){return new Gc(e)}function tl(e){return new Hc(e)}Gc.className="Bidirectional",a.serialization.registerClass(Gc);var nl=Ps,rl=Bs,al=Ws,il=Us;function ol(e){return new gc(e)}function ul(e){return new yc(e)}function cl(e){return new xc(e)}function sl(e){return new uc(e)}var ll=n(121),fl=n(94),dl=n(56),hl=n(79),pl=function(){function e(){Object(_n.a)(this,e),this.size=null}return Object(Sn.a)(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return a.util.assert(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),vl(Object(Xa.a)(Ka.a.mark((function t(){return Ka.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,ml));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,vl(Object(Xa.a)(Ka.a.mark((function t(){return Ka.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,vl(Object(Xa.a)(Ka.a.mark((function t(){return Ka.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return a.tidy((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return vl(Object(Xa.a)(Ka.a.mark((function n(){return Ka.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return a.tidy((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return vl(Object(Xa.a)(Ka.a.mark((function n(){return Ka.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return vl(Object(Xa.a)(Ka.a.mark((function n(){return Ka.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,vl(Object(Xa.a)(Ka.a.mark((function t(){var r;return Ka.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(dl.e)(Object(Xa.a)(Ka.a.mark((function e(){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",Object(dl.d)(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,vl(Object(Xa.a)(Ka.a.mark((function t(){return Ka.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,i=fl.alea(t||a.util.now().toString());return vl(Object(Xa.a)(Ka.a.mark((function t(){var a;return Ka.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.int32(),n&&(a+=i.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,a.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,vl(Object(Xa.a)(Ka.a.mark((function t(){return Ka.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function vl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){Object(En.a)(a,n);var r=Object(Cn.a)(a);function a(){var e;return Object(_n.a)(this,a),(e=r.apply(this,arguments)).size=t,e}return Object(Sn.a)(a,[{key:"iterator",value:function(){var t=Object(Xa.a)(Ka.a.mark((function t(){return Ka.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(pl))}function ml(e){if(null===e)return null;var t=e[0];return Object(hl.a)(t)?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof a.Tensor?a.stack(e):a.tensor(e)}(e),recurse:!1}:{value:null,recurse:!0}}pl.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote"),dl.a,dl.a,n(318).a;function bl(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&a.util.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var gl=a.kernel_impls.whereImpl,yl=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(){var e;return Object(_n.a)(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new a.DataStorage(Object(In.a)(e),Object(a.engine)()),e}return Object(Sn.a)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,Object(a.env)().get("IS_NODE")&&a.backend_util.warn("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&a.util.isString(n[0])){var i=n.map((function(e){return a.util.encodeString(e)}));r=this.write(i,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"refCount",value:function(e){return this.data.has(e)?this.data.get(e).refCount:0}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;if("complex64"===n){var i=this.readSync(r.real.dataId),o=this.readSync(r.imag.dataId);return a.backend_util.mergeRealAndImagArrays(i,o)}return this.data.get(e).values}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return a.util.decodeString(e)}))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(a.buffer)(e.shape,e.dtype,n)}},{key:"makeOutput",value:function(e,t,n){var r=this.write(e,t,n);return Object(a.engine)().makeTensorFromDataId(r,t,n,this)}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;var n=this.data.get(e),r=n.complexTensorInfos;null!=r&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"time",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){var n,r;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.util.now(),t(),r=a.util.now()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){bl([e],"where");var t=this.readSync(e.dataId);return gl(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return Object(oi.a)(Object(Dn.a)(n.prototype),"epsilon",this).call(this)}}]),n}(a.KernelBackend);yl.nextDataId=0;function xl(e,t,n){return function(r){var i=r.inputs,o=r.attrs,u=r.backend,c=i.x;if(bl(c,e),"string"===c.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");for(var s=u,l=s.data.get(c.dataId).values,f=a.util.sizeFromShape(c.shape),d=n||c.dtype,h=a.util.getArrayFromDType(d,f),p=0;p<f;++p)h[p]=t(l[p],o);return s.makeTensorInfo(c.shape,d,h)}}function Ol(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,u=a.x;if(bl(u,e),"string"===u.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var c=o,s=c.data.get(u.dataId).values,l=n||u.dtype,f=t(s,l,i);return c.makeTensorInfo(u.shape,l,f)}}Object(a.registerBackend)("cpu",(function(){return new yl}),1);var kl=xl(a.Elu,(function(e){return e>=0?e:Math.exp(e)-1})),wl={kernelName:a.Elu,backendName:"cpu",kernelFunc:kl};function jl(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var _l={kernelName:a.Identity,backendName:"cpu",kernelFunc:jl};function Sl(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.alpha;bl([i],"leakyRelu");for(var u=a.util.sizeFromShape(i.shape),c=n.data.get(i.dataId).values,s=a.util.getTypedArrayFromDType("float32",u),l=0;l<c.length;l++)s[l]=c[l]<0?o*c[l]:c[l];return n.makeTensorInfo(i.shape,"float32",s)}var El={kernelName:a.LeakyRelu,backendName:"cpu",kernelFunc:Sl};function Cl(e){return function(t,n,r,i,o){var u=a.backend_util.assertAndGetBroadcastShape(t,n),c=u.length,s=a.util.computeStrides(u),l=a.util.sizeFromShape(u),f=a.util.getTypedArrayFromDType(o,l),d=t.length,h=n.length,p=a.util.computeStrides(t),v=a.util.computeStrides(n),m=a.backend_util.getBroadcastDims(t,u),b=a.backend_util.getBroadcastDims(n,u);if(m.length+b.length===0)for(var g=0;g<f.length;++g)f[g]=e(r[g%r.length],i[g%i.length]);else for(var y=function(t){var n=a.util.indexToLoc(t,c,s),o=n.slice(-d);m.forEach((function(e){return o[e]=0}));var u=a.util.locToIndex(o,d,p),l=n.slice(-h);b.forEach((function(e){return l[e]=0}));var g=a.util.locToIndex(l,h,v);f[t]=e(r[u],i[g])},x=0;x<f.length;++x)y(x);return[f,u]}}var Al=Cl((function(e,t){return e<0?t*e:e}));function Nl(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;bl([r,a],"prelu");var o=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=Al(r.shape,a.shape,o,u,r.dtype),s=Object(i.a)(c,2),l=s[0],f=s[1];return n.makeTensorInfo(f,r.dtype,l)}var Tl={kernelName:a.Prelu,backendName:"cpu",kernelFunc:Nl},Il=xl(a.Relu,(function(e){return Math.max(0,e)})),Dl={kernelName:a.Relu,backendName:"cpu",kernelFunc:Il},Fl=xl(a.Relu6,(function(e){return Math.min(Math.max(0,e),6)})),Ml={kernelName:a.Relu6,backendName:"cpu",kernelFunc:Fl},Rl=xl(a.Sigmoid,(function(e){return 1/(1+Math.exp(-e))})),zl={kernelName:a.Sigmoid,backendName:"cpu",kernelFunc:Rl};function Ll(e,t,n,r,a){if("linear"===n)return jl({inputs:{x:t},backend:e});if("relu"===n)return Il({inputs:{x:t},backend:e});if("elu"===n)return kl({inputs:{x:t},backend:e});if("relu6"===n)return Fl({inputs:{x:t},backend:e});if("prelu"===n)return Nl({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return Sl({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return Rl({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function Pl(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,u=n.makeTensorInfo(r.shape,"complex64");return n.data.get(u.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},u}var Bl={kernelName:a.Complex,backendName:"cpu",kernelFunc:Pl};function Wl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){var r=Wl(e,t,"float32"),i=Wl(e,t,"float32");return Pl({inputs:{real:r,imag:i},backend:e})}var o=a.util.makeZerosTypedArray(a.util.sizeFromShape(t),n);return e.makeTensorInfo(t,n,o)}function Ul(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var Vl={kernelName:a.Real,backendName:"cpu",kernelFunc:Ul};function ql(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.dtype;if("complex64"===u){if("complex64"===o.dtype)return jl({inputs:{x:o},backend:n});var c=Wl(n,o.shape,o.dtype),s=ql({inputs:{x:o},backend:n,attrs:{dtype:"float32"}}),l=Pl({inputs:{real:s,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(s),l}if("complex64"===o.dtype){var f=Ul({inputs:{input:o},backend:n}),d=ql({inputs:{x:f},backend:n,attrs:{dtype:u}});return n.disposeIntermediateTensorInfo(f),d}if(!a.util.hasEncodingLoss(o.dtype,u)){var h=jl({inputs:{x:o},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:u}}if("int32"===u){var p=n.data.get(o.dataId).values,v=Int32Array.from(p);return n.makeTensorInfo(o.shape,"int32",v)}if("bool"===u){var m=n.data.get(o.dataId).values,b=a.util.toTypedArray([0],o.dtype),g=Cl((function(e,t){return e!==t?1:0}))(o.shape,[],m,b,"bool"),y=Object(i.a)(g,2),x=y[0],O=y[1];return n.makeTensorInfo(O,"bool",x)}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(u))}var Hl={kernelName:a.Cast,backendName:"cpu",kernelFunc:ql};function Gl(e,t,n,r){return null==n?function(n){var a=n.inputs,o=n.backend,u=a.a,c=a.b,s=o;bl([u,c],e);var l=s.data.get(u.dataId).values,f=s.data.get(c.dataId).values,d=r||u.dtype,h=t(u.shape,c.shape,l,f,d),p=Object(i.a)(h,2),v=p[0],m=p[1];return s.makeTensorInfo(m,d,v)}:function(e){var a=e.inputs,o=e.backend,u=a.a,c=a.b,s=o;if("complex64"===u.dtype||"complex64"===c.dtype){var l=ql({inputs:{x:u},backend:s,attrs:{dtype:"complex64"}}),f=s.data.get(l.dataId),d=f.complexTensorInfos.real,h=f.complexTensorInfos.imag,p=s.data.get(d.dataId).values,v=s.data.get(h.dataId).values,m=ql({inputs:{x:c},backend:s,attrs:{dtype:"complex64"}}),b=s.data.get(m.dataId),g=b.complexTensorInfos.real,y=b.complexTensorInfos.imag,x=s.data.get(g.dataId).values,O=s.data.get(y.dataId).values,k=n(u.shape,c.shape,p,v,x,O),w=Object(i.a)(k,3),j=w[0],_=w[1],S=w[2],E=s.makeTensorInfo(S,"float32",j),C=s.makeTensorInfo(S,"float32",_),A=Pl({inputs:{real:E,imag:C},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(m),s.disposeIntermediateTensorInfo(E),s.disposeIntermediateTensorInfo(C),A}var N=s.data.get(u.dataId).values,T=s.data.get(c.dataId).values,I=r||u.dtype,D=t(u.shape,c.shape,N,T,I),F=Object(i.a)(D,2),M=F[0],R=F[1];return s.makeTensorInfo(R,I,M)}}function Kl(e){return function(t,n,r,i,o,u){var c=a.backend_util.assertAndGetBroadcastShape(t,n),s=a.util.sizeFromShape(c),l=c.length,f=a.util.computeStrides(c),d=a.util.getTypedArrayFromDType("float32",s),h=a.util.getTypedArrayFromDType("float32",s),p=a.backend_util.getBroadcastDims(t,c),v=a.backend_util.getBroadcastDims(n,c),m=a.backend_util.mergeRealAndImagArrays(r,i),b=a.backend_util.mergeRealAndImagArrays(o,u),g=t.length,y=a.util.computeStrides(t),x=n.length,O=a.util.computeStrides(n);if(p.length+v.length===0)for(var k=0;k<d.length;k++){var w=k%m.length,j=k%b.length,_=e(m[2*w],m[2*w+1],b[2*j],b[2*j+1]);d[k]=_.real,h[k]=_.imag}else for(var S=function(t){var n=a.util.indexToLoc(t,l,f),r=n.slice(-g);p.forEach((function(e){return r[e]=0}));var i=a.util.locToIndex(r,g,y),o=n.slice(-x);v.forEach((function(e){return o[e]=0}));var u=a.util.locToIndex(o,x,O),c=e(m[2*i],m[2*i+1],b[2*u],b[2*u+1]);d[t]=c.real,h[t]=c.imag},E=0;E<d.length;E++)S(E);return[d,h,c]}}var Xl=Cl((function(e,t){return e+t})),Yl=Kl((function(e,t,n,r){return{real:e+n,imag:t+r}})),$l=Gl(a.Add,Xl,Yl),Jl={kernelName:a.Add,backendName:"cpu",kernelFunc:$l};function Ql(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.shape,u=a.util.sizeFromShape(i.shape),c=a.util.inferFromImplicitShape(o,u),s=a.util.sizeFromShape(c);a.util.assert(u===s,(function(){return"The new shape (".concat(c,") has ").concat(s," elements and the old ")+"shape (".concat(i.shape,") has ").concat(u," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(i.dataId);var l=n.data.get(i.dataId);if(null!=l.complexTensorInfos){var f=l.complexTensorInfos.real,d=l.complexTensorInfos.imag;f.shape=c,d.shape=c}return{dataId:i.dataId,shape:c,dtype:i.dtype}}var Zl={kernelName:a.Reshape,backendName:"cpu",kernelFunc:Ql};function ef(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.a,u=t.b,c=r.transposeA,s=r.transposeB;bl([o,u],"matMul");var l=o.shape.length,f=u.shape.length,d=c?o.shape[l-2]:o.shape[l-1],h=s?u.shape[f-1]:u.shape[f-2],p=c?o.shape[l-1]:o.shape[l-2],v=s?u.shape[f-2]:u.shape[f-1],m=o.shape.slice(0,-2),b=u.shape.slice(0,-2),g=a.util.sizeFromShape(m),y=a.util.sizeFromShape(b),x=g===y||1===g||1===y;a.util.assert(l>=2&&f>=2&&x,(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(m,") and (").concat(b,").")}));var O=(g>y?o.shape.slice(0,-2):u.shape.slice(0,-2)).concat([p,v]);a.util.assert(d===h,(function(){return"Error in matMul: inner shapes (".concat(d,") and (")+"".concat(h,") of Tensors with shapes ").concat(o.shape," and ")+"".concat(u.shape," and transposeA=").concat(c)+" and transposeB=".concat(s," must match.")}));for(var k=s?[y,v,h]:[y,h,v],w=Ql({inputs:{x:o},backend:n,attrs:{shape:c?[g,d,p]:[g,p,d]}}),j=Ql({inputs:{x:u},backend:n,attrs:{shape:k}}),_=c?w.shape[1]:w.shape[2],S=c?w.shape[2]:w.shape[1],E=s?j.shape[1]:j.shape[2],C=Math.max(g,y),A=n.data.get(w.dataId).values,N=n.data.get(j.dataId).values,T=a.util.computeStrides(w.shape),I=a.util.computeStrides(j.shape),D=c?[T[0],1,T[1]]:[T[0],T[1],1],F=Object(i.a)(D,3),M=F[0],R=F[1],z=F[2],L=s?[1,I[1],I[0]]:[I[1],1,I[0]],P=Object(i.a)(L,3),B=P[0],W=P[1],U=P[2],V=S*E,q=Object(a.buffer)([C,S,E],w.dtype),H=q.values,G=n.blockSize,K=0;K<C;K++)for(var X=0;X<S;X+=G)for(var Y=0;Y<E;Y+=G)for(var $=0;$<_;$+=G)for(var J=Math.min(X+G,S),Q=Math.min(Y+G,E),Z=Math.min($+G,_),ee=X;ee<J;ee++)for(var te=Y;te<Q;te++){for(var ne=0,re=$;re<Z;re++){var ae=Math.min(K,g-1)*M,ie=Math.min(K,y-1)*U;ne+=A[ae+ee*R+re*z]*N[re*B+te*W+ie]}H[K*V+(ee*E+te)]+=ne}return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(j),n.makeTensorInfo(O,q.dtype,q.values)}var tf={kernelName:a.BatchMatMul,backendName:"cpu",kernelFunc:ef};var nf={kernelName:a._FusedMatMul,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,u=a.a,c=a.b,s=a.bias,l=a.preluActivationWeights,f=o.transposeA,d=o.transposeB,h=o.activation,p=o.leakyreluAlpha,v=[];t=ef({inputs:{a:u,b:c},attrs:{transposeA:f,transposeB:d},backend:i}),s&&(n=$l({inputs:{a:t,b:s},backend:i}),v.push(t),t=n),h&&(r=Ll(i,t,h,l,p),v.push(t),t=r);for(var m=0,b=v;m<b.length;m++){var g=b[m];i.disposeIntermediateTensorInfo(g)}return t}};function rf(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var af={kernelName:a.Abs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;bl(t,"abs");var r=new Float32Array(a.util.sizeFromShape(t.shape));return r=rf(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,"float32")}},of=xl(a.Acos,(function(e){return Math.acos(e)})),uf={kernelName:a.Acos,backendName:"cpu",kernelFunc:of},cf=xl(a.Acosh,(function(e){return Math.acosh(e)})),sf={kernelName:a.Acosh,backendName:"cpu",kernelFunc:cf};var lf={kernelName:a.AddN,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;bl(t,"addN");for(var i=r.map((function(e){return n.data.get(e.dataId).values})),o=Object(a.buffer)(r[0].shape,r[0].dtype),u=o.values,c=0;c<r.length;c++)for(var s=i[c],l=0;l<u.length;l++)u[l]+=s[l];return n.makeTensorInfo(o.shape,o.dtype,o.values)}};function ff(e,t,n,r,i){for(var o=t.length,u=a.util.sizeFromShape(t),c=a.util.computeStrides(t),s=a.util.computeStrides(i),l=a.util.getTypedArrayFromDType(n,a.util.sizeFromShape(i)),f=0;f<u;++f){for(var d=a.util.indexToLoc(f,o,c),h=new Array(d.length),p=0;p<h.length;p++)h[p]=d[r[p]];l[a.util.locToIndex(h,o,s)]=e[f]}return l}function df(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;bl(a,"transpose");for(var o=a.shape.length,u=new Array(o),c=0;c<u.length;c++)u[c]=a.shape[i[c]];var s=ff(r.data.get(a.dataId).values,a.shape,a.dtype,i,u);return{dataId:r.write(s,u,a.dtype),shape:u,dtype:a.dtype}}var hf={kernelName:a.Transpose,backendName:"cpu",kernelFunc:df};var pf={kernelName:a.All,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.axis,c=r.keepDims;bl(o,"all");var s=a.util.parseAxisParam(u,o.shape),l=s,f=a.backend_util.getAxesPermutation(l,o.shape.length),d=o;null!=f&&(d=df({inputs:{x:o},backend:n,attrs:{perm:f}}),l=a.backend_util.getInnerMostAxes(l.length,o.shape.length)),a.backend_util.assertAxesAreInnerMostDims("all",l,d.shape.length);for(var h=a.backend_util.computeOutAndReduceShapes(d.shape,l),p=Object(i.a)(h,2),v=p[0],m=p[1],b=a.util.sizeFromShape(m),g=a.util.makeZerosTypedArray(a.util.sizeFromShape(v),d.dtype),y=n.data.get(d.dataId).values,x=0;x<g.length;++x){for(var O=x*b,k=y[O],w=0;w<b;++w){var j=y[O+w];k=k&&j}g[x]=k}null!=f&&n.disposeIntermediateTensorInfo(d);var _=n.makeTensorInfo(v,d.dtype,g);if(c){var S=Ql({inputs:{x:_},backend:n,attrs:{shape:a.backend_util.expandShapeToKeepDim(v,s)}});return n.disposeIntermediateTensorInfo(_),S}return _}};var vf={kernelName:a.Any,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.axis,c=r.keepDims;bl(o,"any");var s=a.util.parseAxisParam(u,o.shape),l=s,f=a.backend_util.getAxesPermutation(l,o.shape.length),d=o;null!=f&&(d=df({inputs:{x:o},backend:n,attrs:{perm:f}}),l=a.backend_util.getInnerMostAxes(l.length,o.shape.length)),a.backend_util.assertAxesAreInnerMostDims("any",l,d.shape.length);for(var h=a.backend_util.computeOutAndReduceShapes(d.shape,l),p=Object(i.a)(h,2),v=p[0],m=p[1],b=a.util.sizeFromShape(m),g=a.util.makeZerosTypedArray(a.util.sizeFromShape(v),d.dtype),y=n.data.get(d.dataId).values,x=0;x<g.length;++x){for(var O=x*b,k=y[O],w=0;w<b;++w){var j=y[O+w];k=k||j}g[x]=k}null!=f&&n.disposeIntermediateTensorInfo(d);var _=n.makeTensorInfo(v,d.dtype,g);if(c){var S=Ql({inputs:{x:_},backend:n,attrs:{shape:a.backend_util.expandShapeToKeepDim(v,s)}});return n.disposeIntermediateTensorInfo(_),S}return _}};var mf={kernelName:a.ArgMax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.axis;bl(o,"argMax");var c=a.util.parseAxisParam(u,o.shape),s=a.backend_util.getAxesPermutation(c,o.shape.length),l=o,f=[];null!=s&&(l=df({inputs:{x:o},backend:n,attrs:{perm:s}}),f.push(l),c=a.backend_util.getInnerMostAxes(c.length,l.shape.length)),c=[c[0]],a.backend_util.assertAxesAreInnerMostDims("argMax",c,l.shape.length);for(var d=a.backend_util.computeOutAndReduceShapes(l.shape,c),h=Object(i.a)(d,2),p=h[0],v=h[1],m=a.util.sizeFromShape(p),b=a.util.makeZerosTypedArray(m,"int32"),g=a.util.sizeFromShape(v),y=n.data.get(l.dataId).values,x=0;x<b.length;++x){for(var O=x*g,k=y[O],w=0,j=0;j<g;++j){var _=y[O+j];_>k&&(k=_,w=j)}b[x]=w}return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(p,"int32",b)}};var bf={kernelName:a.ArgMin,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.axis;bl(o,"argMin");var c=a.util.parseAxisParam(u,o.shape),s=a.backend_util.getAxesPermutation(c,o.shape.length),l=o,f=[];null!=s&&(l=df({inputs:{x:o},backend:n,attrs:{perm:s}}),f.push(l),c=a.backend_util.getInnerMostAxes(c.length,l.shape.length)),c=[c[0]],a.backend_util.assertAxesAreInnerMostDims("argMin",c,l.shape.length);for(var d=a.backend_util.computeOutAndReduceShapes(l.shape,c),h=Object(i.a)(d,2),p=h[0],v=h[1],m=a.util.sizeFromShape(p),b=a.util.makeZerosTypedArray(m,"int32"),g=a.util.sizeFromShape(v),y=n.data.get(l.dataId).values,x=0;x<b.length;++x){for(var O=x*g,k=y[O],w=0,j=0;j<g;++j){var _=y[O+j];_<k&&(k=_,w=j)}b[x]=w}return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(p,"int32",b)}},gf=xl(a.Asin,(function(e){return Math.asin(e)})),yf={kernelName:a.Asin,backendName:"cpu",kernelFunc:gf},xf=xl(a.Asinh,(function(e){return Math.asinh(e)})),Of={kernelName:a.Asinh,backendName:"cpu",kernelFunc:xf},kf=xl(a.Atan,(function(e){return Math.atan(e)})),wf={kernelName:a.Atan,backendName:"cpu",kernelFunc:kf},jf=Cl((function(e,t){return Math.atan2(e,t)})),_f=Gl(a.Atan2,jf),Sf={kernelName:a.Atan2,backendName:"cpu",kernelFunc:_f},Ef=xl(a.Atanh,(function(e){return Math.atanh(e)})),Cf={kernelName:a.Atanh,backendName:"cpu",kernelFunc:Ef};function Af(e,t,n,r,i,o){for(var u=i.strideHeight,c=i.strideWidth,s=i.dilationHeight,l=i.dilationWidth,f=i.effectiveFilterHeight,d=i.effectiveFilterWidth,h=i.padInfo.top,p=i.padInfo.left,v="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Object(a.buffer)(i.outShape,n),b=m.values,g=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],x=i.outShape[3],O=0;O<i.batchSize;++O)for(var k=O*g,w=O*r[0],j=0;j<i.inChannels;++j)for(var _=0;_<i.outHeight;++_)for(var S=_*u-h,E=Math.max(0,S),C=Math.min(i.inHeight,f+S),A=k+_*y,N=0;N<i.outWidth;++N){for(var T=N*c-p,I=Math.max(0,T),D=Math.min(i.inWidth,d+T),F=v,M=0,R=0,z=E;z<C;z+=s){for(var L=w+z*r[1],P=I;P<D;P+=l){var B=e[L+P*r[2]+j];"max"===o&&B>F?F=B:"avg"===o&&(M+=B,R++)}if(isNaN(F))break}b[A+N*x+j]="avg"===o?M/R:F}return m}function Nf(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=Object(a.buffer)(r.outShape,"int32"),c=r.strideHeight,s=r.strideWidth,l=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,v=r.padInfo.left,m=Object(a.buffer)(t,n,e),b=0;b<r.batchSize;++b)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var x=y*c-p,O=x;O<0;)O+=l;for(var k=Math.min(r.inHeight,d+x),w=0;w<r.outWidth;++w){for(var j=w*s-v,_=j;_<0;)_+=f;for(var S=Math.min(r.inWidth,h+j),E=Number.NEGATIVE_INFINITY,C=-1,A=O;A<k;A+=l)for(var N=A-x,T=_;T<S;T+=f){var I=T-j,D=m.get(b,A,T,g);D>E&&(E=D,C=i?o?((b*r.inHeight+A)*r.inWidth+T)*r.inChannels+g:(A*r.inWidth+T)*r.inChannels+g:N*h+I)}u.set(C,b,y,w,g)}}return u}function Tf(e,t,n,r,i,o){for(var u=i.strideDepth,c=i.strideHeight,s=i.strideWidth,l=i.dilationDepth,f=i.dilationHeight,d=i.dilationWidth,h=i.effectiveFilterDepth,p=i.effectiveFilterHeight,v=i.effectiveFilterWidth,m=i.padInfo.front,b=i.padInfo.top,g=i.padInfo.left,y="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=Object(a.buffer)(i.outShape,n),O=x.values,k=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],w=i.outShape[2]*i.outShape[3]*i.outShape[4],j=i.outShape[3]*i.outShape[4],_=i.outShape[4],S=0;S<i.batchSize;++S)for(var E=S*k,C=S*r[0],A=0;A<i.inChannels;++A)for(var N=0;N<i.outDepth;++N){for(var T=N*u-m,I=T;I<0;)I+=l;for(var D=Math.min(i.inDepth,h+T),F=E+N*w,M=0;M<i.outHeight;++M){for(var R=M*c-b,z=R;z<0;)z+=f;for(var L=Math.min(i.inHeight,p+R),P=F+M*j,B=0;B<i.outWidth;++B){for(var W=B*s-g,U=W;U<0;)U+=d;for(var V=Math.min(i.inWidth,v+W),q=P+B*_,H=y,G=0,K=0,X=I;X<D;X+=l){for(var Y=C+X*r[1],$=z;$<L;$+=f){for(var J=Y+$*r[2],Q=U;Q<V;Q+=d){var Z=e[J+Q*r[3]+A];if("max"===o&&Z>H?H=Z:"avg"===o&&(G+=Z,K++),isNaN(H))break}if(isNaN(H))break}if(isNaN(H))break}O[q+A]="avg"===o?G/K:H}}}return x}var If={kernelName:a.AvgPool,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x;bl(i,"avgPool");var o=r.filterSize,u=r.strides,c=r.pad,s=r.dimRoundingMode;a.util.assert(a.backend_util.eitherStridesOrDilationsAreOne(u,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(u," and dilations '").concat(1,"'")}));var l,f=a.backend_util.computePool2DInfo(i.shape,o,u,1,c,s);if(1===f.filterWidth&&1===f.filterHeight&&a.util.arraysEqual(f.inShape,f.outShape))l=jl({inputs:{x:i},backend:n});else{var d=n.data.get(i.dataId).values,h=a.util.computeStrides(i.shape),p=Af(d,i.shape,i.dtype,h,f,"avg");l=n.makeTensorInfo(f.outShape,i.dtype,p.values)}return l}};var Df={kernelName:a.AvgPool3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.filterSize,u=r.strides,c=r.pad,s=r.dimRoundingMode,l=r.dataFormat;bl(i,"avgPool3d");var f=a.backend_util.computePool3DInfo(i.shape,o,u,1,c,s,l),d=Tf(n.data.get(i.dataId).values,i.shape,i.dtype,a.util.computeStrides(i.shape),f,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};var Ff={kernelName:a.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.input,u=r.filterSize,c=r.strides,s=r.pad,l=r.dimRoundingMode;bl([i,o],"avgPool3DGrad");for(var f=a.backend_util.computePool3DInfo(o.shape,u,c,1,s,l),d=f.strideDepth,h=f.strideHeight,p=f.strideWidth,v=f.filterDepth,m=f.filterHeight,b=f.filterWidth,g=f.dilationDepth,y=f.dilationHeight,x=f.dilationWidth,O=f.effectiveFilterDepth,k=f.effectiveFilterHeight,w=f.effectiveFilterWidth,j=O-1-f.padInfo.front,_=w-1-f.padInfo.left,S=k-1-f.padInfo.top,E=Object(a.buffer)(o.shape,"float32"),C=1/(v*m*b),A=n.bufferSync(i),N=0;N<f.batchSize;++N)for(var T=0;T<f.inChannels;++T)for(var I=0;I<f.inDepth;++I)for(var D=0;D<f.inHeight;++D)for(var F=0;F<f.inWidth;++F){for(var M=I-j,R=D-S,z=F-_,L=0,P=0;P<O;P+=g){var B=(M+P)/d;if(!(B<0||B>=f.outDepth||Math.floor(B)!==B))for(var W=0;W<k;W+=y){var U=(R+W)/h;if(!(U<0||U>=f.outHeight||Math.floor(U)!==U))for(var V=0;V<w;V+=x){var q=(z+V)/p;if(!(q<0||q>=f.outWidth||Math.floor(q)!==q))L+=A.get(N,B,U,q,T)}}}E.set(L*C,N,I,D,F,T)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}};var Mf={kernelName:a.AvgPoolGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.input,u=o;bl([i,o],"avgPoolGrad");for(var c=r.filterSize,s=r.strides,l=r.pad,f=a.backend_util.computePool2DInfo(u.shape,c,s,1,l),d=f.strideHeight,h=f.strideWidth,p=f.filterHeight,v=f.filterWidth,m=f.dilationHeight,b=f.dilationWidth,g=f.effectiveFilterHeight,y=f.effectiveFilterWidth,x=y-1-f.padInfo.left,O=g-1-f.padInfo.top,k=Object(a.buffer)(u.shape,"float32"),w=1/(p*v),j=n.data.get(i.dataId).values,_=Object(a.buffer)(i.shape,"float32",j),S=0;S<f.batchSize;++S)for(var E=0;E<f.inChannels;++E)for(var C=0;C<f.inHeight;++C)for(var A=0;A<f.inWidth;++A){for(var N=C-O,T=A-x,I=0,D=0;D<g;D+=m){var F=(N+D)/d;if(!(F<0||F>=f.outHeight||Math.floor(F)!==F))for(var M=0;M<y;M+=b){var R=(T+M)/h;if(!(R<0||R>=f.outWidth||Math.floor(R)!==R))I+=_.get(S,F,R,E)}}k.set(I*w,S,C,A,E)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var Rf={kernelName:a.FusedBatchNorm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.scale,u=t.offset,c=t.mean,s=t.variance;a.util.assert(c.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),a.util.assert(null==u||c.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),a.util.assert(null==o||c.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),bl([i,c,s,o,u],"batchNorm");var l=r.varianceEpsilon;null==l&&(l=.001);for(var f=n.data.get(i.dataId).values,d=n.data.get(c.dataId).values,h=n.data.get(s.dataId).values,p=o?n.data.get(o.dataId).values:new Float32Array([1]),v=u?n.data.get(u.dataId).values:new Float32Array([0]),m=new Float32Array(f.length),b=v.length,g=p.length,y=h.length,x=d.length,O=0,k=0,w=0,j=0,_=0;_<f.length;++_)m[_]=v[O++]+(f[_]-d[k++])*p[w++]/Math.sqrt(h[j++]+l),O>=b&&(O=0),k>=x&&(k=0),w>=g&&(w=0),j>=y&&(j=0);return n.makeTensorInfo(i.shape,i.dtype,m)}};function zf(e,t,n,r,i){var o=a.slice_util.isSliceContinous(r,t,n),u=a.util.sizeFromShape(n),c=a.util.computeStrides(r);if(o){var s=a.slice_util.computeFlatOffset(t,c);return"string"===i?e.slice(s,s+u):e.subarray(s,s+u)}for(var l="string"===i?a.backend_util.fromUint8ToStringArray(e):e,f=Object(a.buffer)(r,i,l),d=Object(a.buffer)(n,i),h=0;h<d.size;++h){var p=d.indexToLoc(h),v=p.map((function(e,n){return e+t[n]}));d.set.apply(d,[f.get.apply(f,Object(Nn.a)(v))].concat(Object(Nn.a)(p)))}return"string"===i?a.backend_util.fromStringArrayToUint8(d.values):d.values}function Lf(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.begin,c=r.size;bl(o,"slice");var s=a.slice_util.parseSliceParams(o,u,c),l=Object(i.a)(s,2),f=l[0],d=l[1];a.slice_util.assertParamsValid(o,f,d);var h=zf(n.data.get(o.dataId).values,f,d,o.shape,o.dtype);return n.makeTensorInfo(d,o.dtype,h)}var Pf={kernelName:a.Slice,backendName:"cpu",kernelFunc:Lf};var Bf={kernelName:a.BatchToSpaceND,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.blockShape,u=r.crops;bl([i],"batchToSpaceND");var c=o.reduce((function(e,t){return e*t})),s=a.backend_util.getReshaped(i.shape,o,c),l=a.backend_util.getPermuted(s.length,o.length),f=a.backend_util.getReshapedPermuted(i.shape,o,c),d=a.backend_util.getSliceBeginCoords(u,o.length),h=a.backend_util.getSliceSize(f,u,o.length),p=Ql({inputs:{x:i},backend:n,attrs:{shape:s}}),v=df({inputs:{x:p},backend:n,attrs:{perm:l}}),m=Ql({inputs:{x:v},backend:n,attrs:{shape:f}}),b=Lf({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),b}};function Wf(e,t,n,r,i){for(var o=a.util.sizeFromShape(r),u=a.util.makeZerosTypedArray(i,n),c=0;c<e.length;c++){var s=e[c];if(s<0)throw new Error("Input x must be non-negative!");s>=i||(u[s]+=o>0?t[c]:1)}return u}function Uf(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e.shape[0],o=e.shape[1],u=Object(a.buffer)([i,n],t.dtype),c=0;c<i;c++)for(var s=0;s<o;s++){var l=e.get(c,s);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?u.set(1,c,l):t.size>0?u.set(u.get(c,l)+t.get(c,s),c,l):u.set(u.get(c,l)+1,c,l))}return u}var Vf={kernelName:a.Bincount,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=Wf(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}};function qf(e){return function(t,n,r){for(var i=a.util.getTypedArrayFromDType(n,t.length),o=0;o<t.length;++o)i[o]=e(t[o],r);return i}}var Hf=qf((function(e){return Math.ceil(e)})),Gf=Ol(a.Ceil,Hf),Kf={kernelName:a.Ceil,backendName:"cpu",kernelFunc:Gf},Xf=xl(a.ClipByValue,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),Yf={kernelName:a.ClipByValue,backendName:"cpu",kernelFunc:Xf},$f={kernelName:a.ComplexAbs,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(a.util.sizeFromShape(t.shape)),i=n.data.get(t.dataId),o=i.complexTensorInfos.real,u=i.complexTensorInfos.imag,c=n.data.get(o.dataId).values,s=n.data.get(u.dataId).values,l=0;l<c.length;l++){var f=c[l],d=s[l];r[l]=Math.hypot(f,d)}return n.makeOutput(r,t.shape,"float32")}};function Jf(e,t,n,r){var i=a.util.getArrayFromDType(n,a.util.sizeFromShape(t));if(r&&"string"!==n){var o=0;e.forEach((function(e){var t=a.util.sizeFromShape(e.shape);i.set(e.vals,o),o+=t}))}else{var u=0;e.forEach((function(e){for(var r="string"===n?a.backend_util.fromUint8ToStringArray(e.vals):e.vals,o=0,c=0;c<e.shape[0];++c)for(var s=c*t[1]+u,l=0;l<e.shape[1];++l)i[s+l]=r[o++];u+=e.shape[1]}))}return i}function Qf(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var Zf={kernelName:a.Imag,backendName:"cpu",kernelFunc:Qf};function ed(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,i=a.util.parseAxisParam(r,t[0].shape)[0],o=a.backend_util.computeOutShape(t.map((function(e){return e.shape})),i);if(0===a.util.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);var u=t.filter((function(e){return a.util.sizeFromShape(e.shape)>0}));if(1===u.length)return jl({inputs:{x:u[0]},backend:n});var c=u.map((function(e){return e.shape}));if(a.backend_util.assertParamsConsistent(c,i),"complex64"===u[0].dtype){var s=u.map((function(e){return Ul({inputs:{input:e},backend:n})})),l=u.map((function(e){return Qf({inputs:{input:e},backend:n})})),f=ed({inputs:s,backend:n,attrs:{axis:i}}),d=ed({inputs:l,backend:n,attrs:{axis:i}}),h=Pl({inputs:{real:f,imag:d},backend:n});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),h}var p=u.map((function(e){var t=a.util.sizeFromShape(e.shape.slice(i));return Ql({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),v=p.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));o=a.backend_util.computeOutShape(p.map((function(e){return e.shape})),1);var m=1===p[0].shape[0],b=Jf(v,o,t[0].dtype,m),g=a.backend_util.computeOutShape(u.map((function(e){return e.shape})),i),y=n.makeTensorInfo(g,t[0].dtype,b);return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),y}var td={kernelName:a.Concat,backendName:"cpu",kernelFunc:ed};function nd(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=r.strides,c=r.pad,s=r.dataFormat,l=r.dilations,f=r.dimRoundingMode;bl([i,o],"conv2d");for(var d=a.backend_util.convertConv2DDataFormat(s),h=a.backend_util.computeConv2DInfo(i.shape,o.shape,u,l,c,f,!1,d),p=h.filterHeight,v=h.filterWidth,m=h.dilationHeight,b=h.dilationWidth,g=h.padInfo.left,y=h.padInfo.top,x="channelsLast"===h.dataFormat,O=new a.TensorBuffer(h.outShape,i.dtype),k=a.util.computeStrides(i.shape),w=a.util.computeStrides(o.shape),j=k[0],_=x?k[1]:k[2],S=x?k[2]:1,E=x?1:k[1],C=O.strides[0],A=x?O.strides[1]:O.strides[2],N=x?O.strides[2]:1,T=x?1:O.strides[1],I=n.data.get(i.dataId).values,D=n.data.get(o.dataId).values,F=O.values,M=0;M<h.batchSize;++M)for(var R=M*j,z=M*C,L=0;L<h.outHeight;++L)for(var P=z+L*A,B=L*h.strideHeight-y,W=0;W<p;++W){var U=B+W*m;if(!(U<0||U>=h.inHeight))for(var V=W*w[0],q=R+U*_,H=0;H<h.outWidth;++H)for(var G=P+H*N,K=H*h.strideWidth-g,X=0;X<v;++X){var Y=K+X*b;if(!(Y<0||Y>=h.inWidth))for(var $=q+Y*S,J=V+X*w[1],Q=0;Q<h.inChannels;++Q){for(var Z=I[$+Q*E],ee=0;ee<h.outChannels;++ee)F[G+ee*T]+=Z*D[J+ee];J+=h.outChannels}}}return n.makeTensorInfo(O.shape,O.dtype,F)}var rd={kernelName:a.Conv2D,backendName:"cpu",kernelFunc:nd};var ad={kernelName:a.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.dy,u=r.strides,c=r.pad,s=r.dataFormat,l=r.dimRoundingMode,f=r.filterShape;bl([i,o],"conv2dBackpropFilter");for(var d=a.backend_util.convertConv2DDataFormat(s),h=a.backend_util.computeConv2DInfo(i.shape,f,u,1,c,l,!1,d),p=h.strideHeight,v=h.strideWidth,m=h.filterHeight,b=h.filterWidth,g="channelsLast"===h.dataFormat,y=new a.TensorBuffer(h.filterShape,"float32"),x=h.padInfo.left,O=h.padInfo.top,k=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,j=new a.TensorBuffer(i.shape,i.dtype,k),_=new a.TensorBuffer(o.shape,o.dtype,w),S=0;S<m;++S)for(var E=Math.max(0,Math.ceil((O-S)/p)),C=Math.min(h.outHeight,(h.inHeight+O-S)/p),A=0;A<b;++A)for(var N=Math.max(0,Math.ceil((x-A)/v)),T=Math.min(h.outWidth,(h.inWidth+x-A)/v),I=0;I<h.inChannels;++I)for(var D=0;D<h.outChannels;++D){for(var F=0,M=0;M<h.batchSize;++M)for(var R=E;R<C;++R)for(var z=S+R*p-O,L=N;L<T;++L){var P=A+L*v-x;F+=g?j.get(M,z,P,I)*_.get(M,R,L,D):j.get(M,I,z,P)*_.get(M,D,R,L)}y.set(F,S,A,I,D)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var id={kernelName:a.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.dy,u=t.filter,c=r.inputShape,s=r.strides,l=r.pad,f=r.dataFormat,d=r.dimRoundingMode;bl([o,u],"conv2dBackpropInput");var h=a.util.computeStrides(u.shape),p=a.util.computeStrides(o.shape),v=a.backend_util.convertConv2DDataFormat(f),m=a.backend_util.computeConv2DInfo(c,u.shape,s,1,l,d,!1,v),b=new a.TensorBuffer(m.inShape,"float32"),g=b.values,y=n.data.get(o.dataId).values,x=n.data.get(u.dataId).values,O=Object(i.a)(h,3),k=O[0],w=O[1],j=O[2],_=m.batchSize,S=m.filterHeight,E=m.filterWidth,C=m.inChannels,A=m.inHeight,N=m.inWidth,T=m.outChannels,I=m.outHeight,D=m.outWidth,F=m.strideHeight,M=m.strideWidth;v=m.dataFormat;for(var R=S-1-m.padInfo.top,z=E-1-m.padInfo.left,L="channelsLast"===v,P=b.strides[0],B=L?b.strides[1]:b.strides[2],W=L?b.strides[2]:1,U=L?1:b.strides[1],V=p[0],q=L?p[1]:p[2],H=L?p[2]:1,G=L?1:p[1],K=0;K<_;++K)for(var X=0;X<C;++X)for(var Y=0;Y<A;++Y)for(var $=Y-R,J=Math.max(0,Math.ceil($/F)),Q=Math.min(I,(S+$)/F),Z=0;Z<N;++Z){for(var ee=Z-z,te=Math.max(0,Math.ceil(ee/M)),ne=Math.min(D,(E+ee)/M),re=0,ae=J;ae<Q;++ae)for(var ie=ae*F-$,oe=te;oe<ne;++oe)for(var ue=V*K+q*ae+H*oe,ce=k*(S-1-ie)+w*(E-1-(oe*M-ee))+j*X,se=0;se<T;++se){re+=y[ue+G*se]*x[ce+se]}g[P*K+B*Y+W*Z+U*X]=re}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var od={kernelName:a.Conv3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=r.strides,c=r.pad,s=r.dilations;bl([i,o],"conv3d");for(var l=a.backend_util.computeConv3DInfo(i.shape,o.shape,u,s,c),f=l.filterDepth,d=l.filterHeight,h=l.filterWidth,p=l.dilationDepth,v=l.dilationHeight,m=l.dilationWidth,b=l.padInfo,g=b.front,y=b.left,x=b.top,O=new a.TensorBuffer(l.outShape,i.dtype),k=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,j=O.values,_=a.util.computeStrides(i.shape),S=a.util.computeStrides(o.shape),E=0;E<l.batchSize;++E)for(var C=E*_[0],A=E*O.strides[0],N=0;N<l.outDepth;++N)for(var T=A+N*O.strides[1],I=N*l.strideDepth-g,D=0;D<f;++D){var F=I+D*p;if(!(F<0||F>=l.inDepth))for(var M=D*S[0],R=C+F*_[1],z=0;z<l.outHeight;++z)for(var L=T+z*O.strides[2],P=z*l.strideHeight-x,B=0;B<d;++B){var W=P+B*v;if(!(W<0||W>=l.inHeight))for(var U=M+B*S[1],V=R+W*_[2],q=0;q<l.outWidth;++q)for(var H=L+q*l.outChannels,G=q*l.strideWidth-y,K=0;K<h;++K){var X=G+K*m;if(!(X<0||X>=l.inWidth))for(var Y=U+K*S[2],$=V+X*l.inChannels,J=Y,Q=0;Q<l.inChannels;++Q){for(var Z=k[$+Q],ee=0;ee<l.outChannels;++ee)j[H+ee]+=Z*w[J+ee];J+=l.outChannels}}}}return n.makeTensorInfo(O.shape,O.dtype,O.values)}};var ud={kernelName:a.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=t.dy,c=r.strides,s=r.pad,l=r.filterShape;bl([o,u],"conv3dBackpropFilterV2");for(var f=a.util.computeStrides(o.shape),d=a.util.computeStrides(u.shape),h=a.backend_util.computeConv3DInfo(o.shape,l,c,1,s),p=h.strideDepth,v=h.strideHeight,m=h.strideWidth,b=h.filterDepth,g=h.filterHeight,y=h.filterWidth,x=new a.TensorBuffer(h.filterShape,"float32"),O=x.values,k=Object(i.a)(x.strides,4),w=k[0],j=k[1],_=k[2],S=k[3],E=n.data.get(u.dataId).values,C=Object(i.a)(d,4),A=C[0],N=C[1],T=C[2],I=C[3],D=n.data.get(o.dataId).values,F=Object(i.a)(f,4),M=F[0],R=F[1],z=F[2],L=F[3],P=h.padInfo.front,B=h.padInfo.left,W=h.padInfo.top,U=0;U<b;++U)for(var V=Math.max(0,Math.ceil((P-U)/p)),q=Math.min(h.outDepth,(h.inDepth+P-U)/p),H=U*w,G=0;G<g;++G)for(var K=Math.max(0,Math.ceil((W-G)/v)),X=Math.min(h.outHeight,(h.inHeight+W-G)/v),Y=G*j+H,$=0;$<y;++$)for(var J=Math.max(0,Math.ceil((B-$)/m)),Q=Math.min(h.outWidth,(h.inWidth+B-$)/m),Z=$*_+Y,ee=0;ee<h.inChannels;++ee)for(var te=ee*S+Z,ne=0;ne<h.outChannels;++ne){for(var re=0,ae=0;ae<h.batchSize;++ae)for(var ie=ae*M,oe=ae*A,ue=V;ue<q;++ue)for(var ce=(U+ue*p-P)*R+ie,se=ue*N+oe,le=K;le<X;++le)for(var fe=(G+le*v-W)*z+ce,de=le*T+se,he=J;he<Q;++he){var pe=he*I+de;re+=D[($+he*m-B)*L+fe+ee]*E[pe+ne]}O[te+ne]=re}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var cd={kernelName:a.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.dy,u=t.filter,c=r.pad,s=r.strides,l=r.inputShape;bl([o],"conv3dBackpropInputV2");for(var f=a.util.computeStrides(o.shape),d=a.util.computeStrides(u.shape),h=a.backend_util.computeConv3DInfo(l,u.shape,s,1,c),p=new a.TensorBuffer(h.inShape,"float32"),v=p.values,m=Object(i.a)(p.strides,4),b=m[0],g=m[1],y=m[2],x=m[3],O=n.data.get(o.dataId).values,k=Object(i.a)(f,4),w=k[0],j=k[1],_=k[2],S=k[3],E=n.data.get(u.dataId).values,C=Object(i.a)(d,4),A=C[0],N=C[1],T=C[2],I=C[3],D=h.batchSize,F=h.filterDepth,M=h.filterHeight,R=h.filterWidth,z=h.inChannels,L=h.inDepth,P=h.inHeight,B=h.inWidth,W=h.outChannels,U=h.outDepth,V=h.outHeight,q=h.outWidth,H=h.strideDepth,G=h.strideHeight,K=h.strideWidth,X=F-1-h.padInfo.front,Y=M-1-h.padInfo.top,$=R-1-h.padInfo.left,J=0;J<D;++J)for(var Q=0;Q<z;++Q)for(var Z=0;Z<L;++Z)for(var ee=Z-X,te=Math.max(0,Math.ceil(ee/H)),ne=Math.min(U,(F+ee)/H),re=0;re<P;++re)for(var ae=re-Y,ie=Math.max(0,Math.ceil(ae/G)),oe=Math.min(V,(M+ae)/G),ue=0;ue<B;++ue){for(var ce=ue-$,se=Math.max(0,Math.ceil(ce/K)),le=Math.min(q,(R+ce)/K),fe=0,de=te;de<ne;++de)for(var he=de*H-ee,pe=ie;pe<oe;++pe)for(var ve=pe*G-ae,me=se;me<le;++me)for(var be=w*J+j*de+_*pe+S*me,ge=A*(F-1-he)+N*(M-1-ve)+T*(R-1-(me*K-ce))+I*Q,ye=0;ye<W;++ye){fe+=O[be+ye]*E[ge+ye]}v[b*J+g*Z+y*re+x*ue+Q]=fe}return n.makeTensorInfo(p.shape,p.dtype,p.values)}},sd=xl(a.Cos,(function(e){return Math.cos(e)})),ld={kernelName:a.Cos,backendName:"cpu",kernelFunc:sd},fd=xl(a.Cosh,(function(e){return Math.cosh(e)})),dd={kernelName:a.Cosh,backendName:"cpu",kernelFunc:fd};var hd={kernelName:a.CropAndResize,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,o=t.image,u=t.boxes,c=t.boxInd,s=r.cropSize,l=r.method,f=r.extrapolationValue,d=Object(i.a)(o.shape,4),h=d[0],p=d[1],v=d[2],m=d[3],b=u.shape[0],g=Object(i.a)(s,2),y=g[0],x=g[1],O=Object(a.buffer)([b,y,x,m],"float32"),k=n.data.get(u.dataId).values,w=n.data.get(c.dataId).values,j=n.data.get(o.dataId).values,_=a.util.computeStrides(o.shape),S=a.util.computeStrides(O.shape),E=0;E<b;E++){var C=4*E,A=k[C],N=k[C+1],T=k[C+2],I=k[C+3],D=w[E];if(!(D>=h))for(var F=y>1?(T-A)*(p-1)/(y-1):0,M=x>1?(I-N)*(v-1)/(x-1):0,R=0;R<y;R++){var z=y>1?A*(p-1)+R*F:.5*(A+T)*(p-1);if(z<0||z>p-1)for(var L=0;L<x;L++)for(var P=0;P<m;P++){var B=P+L*S[2]+R*S[1]+E*S[0];O.values[B]=f}else if("bilinear"===l)for(var W=Math.floor(z),U=Math.ceil(z),V=z-W,q=0;q<x;q++){var H=x>1?N*(v-1)+q*M:.5*(N+I)*(v-1);if(H<0||H>v-1)for(var G=0;G<m;G++){var K=G+q*S[2]+R*S[1]+E*S[0];O.values[K]=f}else for(var X=Math.floor(H),Y=Math.ceil(H),$=H-X,J=0;J<m;J++){var Q=J+X*_[2]+W*_[1]+D*_[0],Z=j[Q],ee=j[Q=J+Y*_[2]+W*_[1]+D*_[0]],te=j[Q=J+X*_[2]+U*_[1]+D*_[0]],ne=Z+(ee-Z)*$,re=te+(j[Q=J+Y*_[2]+U*_[1]+D*_[0]]-te)*$;Q=J+q*S[2]+R*S[1]+E*S[0],O.values[Q]=ne+(re-ne)*V}}else for(var ae=0;ae<x;++ae){var ie=x>1?N*(v-1)+ae*M:.5*(N+I)*(v-1);if(ie<0||ie>v-1)for(var oe=0;oe<m;oe++){var ue=oe+ae*S[2]+R*S[1]+E*S[0];O.values[ue]=f}else for(var ce=Math.round(ie),se=Math.round(z),le=0;le<m;le++){var fe=le+ce*_[2]+se*_[1]+D*_[0],de=le+ae*S[2]+R*S[1]+E*S[0];O.values[de]=j[fe]}}}}return n.makeTensorInfo(O.shape,O.dtype,O.values)}};var pd={kernelName:a.Cumsum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.axis,u=r.exclusive,c=r.reverse;bl(i,"cumsum");var s=a.backend_util.getAxesPermutation([o],i.shape.length),l=i;null!=s&&(l=df({inputs:{x:i},backend:n,attrs:{perm:s}}));var f=a.backend_util.getInnerMostAxes(1,i.shape.length)[0];if(f!==l.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(f));for(var d=Object(a.upcastType)(l.dtype,"int32"),h=a.util.makeZerosTypedArray(a.util.sizeFromShape(l.shape),d),p=n.data.get(l.dataId).values,v=l.shape[l.shape.length-1],m=c?function(e,t){return e+v-t-1}:function(e,t){return e+t},b=0;b<p.length;b+=v)for(var g=0;g<v;g++){var y=m(b,g);if(0===g)h[y]=u?0:p[y];else{var x=m(b,g-1);h[y]=u?p[x]+h[x]:p[y]+h[x]}}var O=n.makeTensorInfo(l.shape,d,h);if(null!=s){var k=df({inputs:{x:O},backend:n,attrs:{perm:a.backend_util.getUndoAxesPermutation(s)}});return n.disposeIntermediateTensorInfo(O),n.disposeIntermediateTensorInfo(l),k}return O}};var vd={kernelName:a.DenseBincount,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=r.binaryOutput;if(1===a.shape.length){var c=Wf(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}if(2===a.shape.length){var s=Uf(n.bufferSync(a),n.bufferSync(i),o,u);return n.makeTensorInfo(s.shape,i.dtype,s.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var md={kernelName:a.DepthToSpace,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.blockSize,u=r.dataFormat;a.util.assert("NHWC"===u,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(u)})),a.util.assert(o>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(o)}));for(var c=i.shape[0],s=i.shape[1],l=i.shape[2],f=i.shape[3],d=s*o,h=l*o,p=f/(o*o),v=n.data.get(i.dataId).values,m=new Float32Array(c*d*h*p),b=0,g=0;g<c;++g)for(var y=0;y<d;++y)for(var x=Math.floor(y/o),O=y%o,k=0;k<h;++k)for(var w=Math.floor(k/o),j=(O*o+k%o)*p,_=0;_<p;++_){var S=_+j+f*(w+l*(x+s*g));m[b++]=v[S]}return n.makeTensorInfo([c,d,h,p],i.dtype,m)}};function bd(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=r.strides,c=r.pad,s=r.dilations,l=r.dimRoundingMode;bl([i,o],"depthwiseConv2DNative");var f=a.util.computeStrides(i.shape),d=a.util.computeStrides(o.shape),h=s;null==h&&(h=[1,1]),a.util.assert(a.backend_util.eitherStridesOrDilationsAreOne(u,h),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(h,"'")}));for(var p=a.backend_util.computeConv2DInfo(i.shape,o.shape,u,h,c,l,!0),v=p.filterHeight,m=p.filterWidth,b=p.dilationHeight,g=p.dilationWidth,y=p.padInfo,x=y.left,O=y.top,k=p.outChannels/p.inChannels,w=new a.TensorBuffer(p.outShape,i.dtype),j=n.data.get(i.dataId).values,_=n.data.get(o.dataId).values,S=w.values,E=0;E<p.batchSize;++E)for(var C=E*f[0],A=E*w.strides[0],N=0;N<p.outHeight;++N)for(var T=A+N*w.strides[1],I=N*p.strideHeight-O,D=0;D<v;++D){var F=I+D*b;if(!(F<0||F>=p.inHeight))for(var M=D*d[0],R=C+F*f[1],z=0;z<p.outWidth;++z)for(var L=T+z*w.strides[2],P=z*p.strideWidth-x,B=0;B<m;++B){var W=P+B*g;if(!(W<0||W>=p.inWidth))for(var U=M+B*d[1],V=R+W*p.inChannels,q=L,H=U,G=0;G<p.inChannels;++G){for(var K=j[V+G],X=0;X<k;++X)S[q+X]+=K*_[H+X];q+=k,H+=k}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var gd={kernelName:a.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:bd};var yd={kernelName:a.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.dy,u=r.strides,c=r.dilations,s=r.pad,l=r.dimRoundingMode,f=r.filterShape;bl([i,o],"depthwiseConv2dNativeBackpropFilter");for(var d=a.backend_util.computeConv2DInfo(i.shape,f,u,c,s,l,!0),h=d.strideHeight,p=d.strideWidth,v=d.filterHeight,m=d.filterWidth,b=new a.TensorBuffer(d.filterShape,"float32"),g=d.padInfo.left,y=d.padInfo.top,x=d.outChannels/d.inChannels,O=n.data.get(i.dataId).values,k=new a.TensorBuffer(i.shape,i.dtype,O),w=n.data.get(o.dataId).values,j=new a.TensorBuffer(o.shape,o.dtype,w),_=0;_<v;++_)for(var S=Math.max(0,Math.ceil((y-_)/h)),E=Math.min(d.outHeight,(d.inHeight+y-_)/h),C=0;C<m;++C)for(var A=Math.max(0,Math.ceil((g-C)/p)),N=Math.min(d.outWidth,(d.inWidth+g-C)/p),T=0;T<d.outChannels;++T){for(var I=Math.trunc(T/x),D=T%x,F=0,M=0;M<d.batchSize;++M)for(var R=S;R<E;++R)for(var z=_+R*h-y,L=A;L<N;++L){var P=C+L*p-g;F+=k.get(M,z,P,I)*j.get(M,R,L,T)}b.set(F,_,C,I,D)}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var xd={kernelName:a.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.dy,u=t.filter,c=r.strides,s=r.dilations,l=r.pad,f=r.dimRoundingMode,d=r.inputShape;bl([o,u],"depthwiseConv2DNativeBackpropInput");for(var h=a.util.computeStrides(o.shape),p=a.util.computeStrides(u.shape),v=a.backend_util.computeConv2DInfo(d,u.shape,c,s,l,f,!0),m=new a.TensorBuffer(v.inShape,"float32"),b=m.values,g=Object(i.a)(m.strides,3),y=g[0],x=g[1],O=g[2],k=n.data.get(o.dataId).values,w=Object(i.a)(h,3),j=w[0],_=w[1],S=w[2],E=n.data.get(u.dataId).values,C=Object(i.a)(p,3),A=C[0],N=C[1],T=C[2],I=v.batchSize,D=v.filterHeight,F=v.filterWidth,M=v.inChannels,R=v.inHeight,z=v.inWidth,L=v.outChannels,P=v.outHeight,B=v.outWidth,W=v.strideHeight,U=v.strideWidth,V=D-1-v.padInfo.top,q=F-1-v.padInfo.left,H=L/M,G=0;G<I;++G)for(var K=0;K<M;++K)for(var X=0;X<R;++X)for(var Y=X-V,$=Math.max(0,Math.ceil(Y/W)),J=Math.min(P,(D+Y)/W),Q=0;Q<z;++Q){for(var Z=Q-q,ee=Math.max(0,Math.ceil(Z/U)),te=Math.min(B,(F+Z)/U),ne=0,re=$;re<J;++re)for(var ae=re*W-Y,ie=ee;ie<te;++ie)for(var oe=j*G+_*re+S*ie,ue=A*(D-1-ae)+N*(F-1-(ie*U-Z))+T*K,ce=0;ce<H;++ce){ne+=k[oe+(K*H+ce)]*E[ue+ce]}b[y*G+x*X+O*Q+K]=ne}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};var Od={kernelName:a.Diag,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,i=a.util.sizeFromShape(r.shape),o=n.data.get(r.dataId).values,u=Object(a.buffer)([i,i],r.dtype),c=u.values,s=0;s<o.length;s++)c[s*i+s]=o[s];var l=[].concat(Object(Nn.a)(r.shape),Object(Nn.a)(r.shape));return n.makeTensorInfo(l,u.dtype,u.values)}},kd={kernelName:a.Dilation2D,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=r.strides,c=r.pad,s=r.dilations,l=n,f=l.data.get(i.dataId).values,d=i.shape.length,h=l.data.get(o.dataId).values,p=o.shape.length,v=a.backend_util.computeDilation2DInfo(i.shape,o.shape,u,c,"NHWC",s),m=v.batchSize,b=v.inHeight,g=v.inWidth,y=v.inChannels,x=v.outHeight,O=v.outWidth,k=v.padInfo,w=v.strideHeight,j=v.strideWidth,_=v.filterHeight,S=v.filterWidth,E=v.dilationHeight,C=v.dilationWidth,A=v.outShape,N=a.util.sizeFromShape(A),T=A.length,I=a.util.getArrayFromDType(i.dtype,N),D=0;D<m;++D)for(var F=0;F<x;++F)for(var M=F*w-k.top,R=0;R<O;++R)for(var z=R*j-k.left,L=0;L<y;++L){for(var P=Number.MIN_SAFE_INTEGER,B=0;B<_;++B){var W=M+B*E;if(W>=0&&W<b)for(var U=0;U<S;++U){var V=z+U*C;if(V>=0&&V<g){var q=a.util.locToIndex([D,W,V,L],d,a.util.computeStrides(i.shape)),H=a.util.locToIndex([B,U,L],p,a.util.computeStrides(o.shape)),G=f[q]+h[H];G>P&&(P=G)}}}I[a.util.locToIndex([D,F,R,L],T,a.util.computeStrides(A))]=P}return{dataId:l.write(a.util.toTypedArray(I,i.dtype),A,i.dtype),shape:A,dtype:i.dtype}}},wd={kernelName:a.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=t.dy,c=r.strides,s=r.pad,l=r.dilations,f=n,d=a.util.toNestedArray(i.shape,f.data.get(i.dataId).values),h=a.util.toNestedArray(o.shape,f.data.get(o.dataId).values),p=a.backend_util.computeDilation2DInfo(i.shape,o.shape,c,s,"NHWC",l),v=p.batchSize,m=p.inHeight,b=p.inWidth,g=p.inChannels,y=p.outHeight,x=p.outWidth,O=p.padInfo,k=p.strideHeight,w=p.strideWidth,j=p.filterHeight,_=p.filterWidth,S=p.dilationHeight,E=p.dilationWidth,C=p.outShape;a.util.assert(u.rank===C.length,(function(){return"Error in ".concat(a.Dilation2DBackpropFilter,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(u.rank)}));for(var A=a.util.toNestedArray(C,f.data.get(u.dataId).values),N=a.util.makeZerosNestedTypedArray(o.shape,o.dtype),T=0;T<v;++T)for(var I=0;I<y;++I)for(var D=I*k-O.top,F=0;F<x;++F)for(var M=F*w-O.left,R=0;R<g;++R){for(var z=Number.MIN_SAFE_INTEGER,L=0,P=0,B=0;B<j;++B){var W=D+B*S;if(W>=0&&W<m)for(var U=0;U<_;++U){var V=M+U*E;if(V>=0&&V<b){var q=d[T][W][V][R]+h[B][U][R];q>z&&(z=q,L=B,P=U)}}}N[L][P][R]+=A[T][I][F][R]}return{dataId:f.write(a.util.toTypedArray(N,i.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}},jd={kernelName:a.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=t.dy,c=r.strides,s=r.pad,l=r.dilations,f=n,d=a.util.toNestedArray(i.shape,f.data.get(i.dataId).values),h=a.util.toNestedArray(o.shape,f.data.get(o.dataId).values),p=a.backend_util.computeDilation2DInfo(i.shape,o.shape,c,s,"NHWC",l),v=p.batchSize,m=p.inHeight,b=p.inWidth,g=p.inChannels,y=p.outHeight,x=p.outWidth,O=p.padInfo,k=p.strideHeight,w=p.strideWidth,j=p.filterHeight,_=p.filterWidth,S=p.dilationHeight,E=p.dilationWidth,C=p.outShape;a.util.assert(u.rank===C.length,(function(){return"Error in ".concat(a.Dilation2DBackpropInput,", dy ")+"must have the same rank as output ".concat(C.length,", but got ")+"".concat(u.rank)}));for(var A=a.util.toNestedArray(C,f.data.get(u.dataId).values),N=a.util.makeZerosNestedTypedArray(i.shape,i.dtype),T=0;T<v;++T)for(var I=0;I<y;++I)for(var D=I*k-O.top,F=0;F<x;++F)for(var M=F*w-O.left,R=0;R<g;++R){for(var z=Number.MIN_SAFE_INTEGER,L=D<0?0:D,P=M<0?0:M,B=0;B<j;++B){var W=D+B*S;if(W>=0&&W<m)for(var U=0;U<_;++U){var V=M+U*E;if(V>=0&&V<b){var q=d[T][W][V][R]+h[B][U][R];q>z&&(z=q,L=W,P=V)}}}N[T][L][P][R]+=A[T][I][F][R]}return{dataId:f.write(a.util.toTypedArray(N,i.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},_d=Cl((function(e,t){return e*t})),Sd=Kl((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),Ed=Gl(a.Multiply,_d,Sd),Cd={kernelName:a.Multiply,backendName:"cpu",kernelFunc:Ed};function Ad(e){var t,n=e.inputs,r=e.backend,o=e.attrs,u=n.x,c=o.axis,s=o.keepDims;bl(u,"sum");var l=(t="bool"===u.dtype?ql({inputs:{x:u},backend:r,attrs:{dtype:"int32"}}):jl({inputs:{x:u},backend:r})).shape.length,f=a.util.parseAxisParam(c,t.shape),d=a.backend_util.getAxesPermutation(f,l),h=f,p=t;null!=d&&(p=df({inputs:{x:t},backend:r,attrs:{perm:d}}),h=a.backend_util.getInnerMostAxes(h.length,l)),a.backend_util.assertAxesAreInnerMostDims("sum",h,p.shape.length);for(var v=a.backend_util.computeOutAndReduceShapes(p.shape,h),m=Object(i.a)(v,2),b=m[0],g=m[1],y=Wl(r,b,a.backend_util.upcastType(p.dtype,"int32")),x=a.util.sizeFromShape(g),O=r.data.get(y.dataId).values,k=r.data.get(p.dataId).values,w=0;w<O.length;++w){for(var j=w*x,_=0,S=0;S<x;++S)_+=k[j+S];O[w]=_}if(s){var E=y;y=Ql({inputs:{x:y},backend:r,attrs:{shape:a.backend_util.expandShapeToKeepDim(y.shape,f)}}),r.disposeIntermediateTensorInfo(E)}return r.disposeIntermediateTensorInfo(t),null!=d&&r.disposeIntermediateTensorInfo(p),y}var Nd={kernelName:a.Sum,backendName:"cpu",kernelFunc:Ad};var Td={kernelName:a.Einsum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.equation,i=t,o=a.backend_util.decodeEinsumEquation(r,i.length),u=o.allDims,c=o.summedDims,s=o.idDims;a.backend_util.checkEinsumDimSizes(u.length,s,i);for(var l=a.backend_util.getEinsumComputePath(c,s),f=l.path,d=l.steps,h=d.length,p=null,v=u.length,m=[],b=0;b<h;++b){var g,y=Object(Tn.a)(d[b]);try{for(y.s();!(g=y.n()).done;){var x=g.value,O=a.backend_util.getEinsumPermutation(v,s[x]),k=O.permutationIndices,w=O.expandDims,j=void 0;a.backend_util.isIdentityPermutation(k)?j=i[x]:(j=df({inputs:{x:i[x]},backend:n,attrs:{perm:k}}),m.push(j));for(var _=j.shape.slice(),S=0;S<w.length;++S)_.splice(w[S],0,1);a.util.arraysEqual(j.shape,_)||(j=Ql({inputs:{x:j},backend:n,attrs:{shape:_}}),m.push(j)),null===p?p=j:(p=Ed({inputs:{a:j,b:p},backend:n}),m.push(p))}}catch(N){y.e(N)}finally{y.f()}b<h-1&&(f[b]>=0&&(p=Ad({inputs:{x:p},backend:n,attrs:{axis:f[b]-(u.length-v),keepDims:!1}}),m.push(p)),v--)}for(var E=0,C=m;E<C.length;E++){var A=C[E];A!==p&&n.disposeIntermediateTensorInfo(A)}return p}};var Id={kernelName:a.EluGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,i=t.y;bl([r,i],"eluGrad");for(var o=new Float32Array(a.util.sizeFromShape(i.shape)),u=n.data.get(i.dataId).values,c=n.data.get(r.dataId).values,s=0;s<u.length;++s){var l=u[s];o[s]=l>=1?c[s]:c[s]*(l+1)}return n.makeTensorInfo(i.shape,"float32",o)}},Dd=Cl((function(e,t){return e===t?1:0})),Fd=Gl(a.Equal,Dd,null,"bool"),Md={kernelName:a.Equal,backendName:"cpu",kernelFunc:Fd},Rd=a.backend_util.ERF_P,zd=a.backend_util.ERF_A1,Ld=a.backend_util.ERF_A2,Pd=a.backend_util.ERF_A3,Bd=a.backend_util.ERF_A4,Wd=a.backend_util.ERF_A5,Ud=xl(a.Erf,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+Rd*n);return t*(1-((((Wd*r+Bd)*r+Pd)*r+Ld)*r+zd)*r*Math.exp(-n*n))})),Vd={kernelName:a.Erf,backendName:"cpu",kernelFunc:Ud},qd=qf((function(e){return Math.exp(e)})),Hd=Ol(a.Exp,qd),Gd={kernelName:a.Exp,backendName:"cpu",kernelFunc:Hd};function Kd(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.input,o=r.dim,u=i.shape.length,c=i.shape.slice(),s=o;return o<0&&(a.util.assert(-(u+1)<=o,(function(){return"Axis must be in the interval [".concat(-(u+1),", ").concat(u,"]")})),s=u+o+1),c.splice(s,0,1),Ql({inputs:{x:i},backend:n,attrs:{shape:c}})}var Xd={kernelName:a.ExpandDims,backendName:"cpu",kernelFunc:Kd},Yd=qf((function(e){return Math.expm1(e)})),$d=Ol(a.Expm1,Yd),Jd={kernelName:a.Expm1,backendName:"cpu",kernelFunc:$d},Qd=Cl((function(e,t){return e/t})),Zd=Gl(a.RealDiv,Qd),eh={kernelName:a.RealDiv,backendName:"cpu",kernelFunc:Zd},th=Cl((function(e,t){return e-t})),nh=Kl((function(e,t,n,r){return{real:e-n,imag:t-r}})),rh=Gl(a.Sub,th,nh),ah={kernelName:a.Sub,backendName:"cpu",kernelFunc:rh};function ih(e,t,n){for(var r=e.shape,i=r[0],o=r[1],u=n.data.get(e.dataId),c=u.complexTensorInfos.real,s=u.complexTensorInfos.imag,l=[i,o],f=a.util.sizeFromShape(l),d=a.util.getTypedArrayFromDType("float32",f),h=a.util.getTypedArrayFromDType("float32",f),p=0;p<i;p++){for(var v=Lf({inputs:{x:c},backend:n,attrs:{begin:[p,0],size:[1,o]}}),m=Lf({inputs:{x:s},backend:n,attrs:{begin:[p,0],size:[1,o]}}),b=Pl({inputs:{real:v,imag:m},backend:n}),g=oh(b,t,n),y=g.real,x=g.imag,O=a.backend_util.mergeRealAndImagArrays(y,x),k=0;k<o;k++){var w=a.backend_util.getComplexWithIndex(O,k);d[p*o+k]=w.real,h[p*o+k]=w.imag}n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b)}var j=n.makeTensorInfo(l,"float32",d),_=n.makeTensorInfo(l,"float32",h),S=Pl({inputs:{real:j,imag:_},backend:n});return n.disposeIntermediateTensorInfo(j),n.disposeIntermediateTensorInfo(_),S}function oh(e,t,n){var r=a.util.sizeFromShape(e.shape),i=n.data.get(e.dataId),o=n.data.get(i.complexTensorInfos.real.dataId).values,u=n.data.get(i.complexTensorInfos.imag.dataId).values;if(0===((g=r)&g-1)){var c=uh(o,u,r,t,n),s=[e.shape[0],e.shape[1]];if(t){var l=n.makeTensorInfo(s,"float32",c.real),f=n.makeTensorInfo(s,"float32",c.imag),d=n.makeTensorInfo([],"float32",a.util.createScalarValue(r,"float32")),h=jl({inputs:{x:d},backend:n}),p=eh.kernelFunc({inputs:{a:l,b:d},backend:n}),v=eh.kernelFunc({inputs:{a:f,b:h},backend:n}),m=n.data.get(p.dataId).values,b=n.data.get(v.dataId).values;return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),{real:m,imag:b}}return c}var g,y=function(e,t,n){for(var r=new Float32Array(2*t),i=0;i<t;i++){for(var o=0,u=0,c=0;c<t;c++){var s=a.backend_util.exponent(i*c,t,n),l=a.backend_util.getComplexWithIndex(e,c);o+=l.real*s.real-l.imag*s.imag,u+=l.real*s.imag+l.imag*s.real}n&&(o/=t,u/=t),a.backend_util.assignToTypedArray(r,o,u,i)}return r}(a.backend_util.mergeRealAndImagArrays(o,u),r,t);return a.backend_util.splitRealAndImagArrays(y)}function uh(e,t,n,r,i){if(1===n)return{real:e,imag:t};var o=a.backend_util.mergeRealAndImagArrays(e,t),u=n/2,c=a.backend_util.complexWithEvenIndex(o),s=c.real,l=c.imag,f=[s.length],d=i.makeTensorInfo(f,"float32",s),h=i.makeTensorInfo(f,"float32",l),p=Pl({inputs:{real:d,imag:h},backend:i}),v=a.backend_util.complexWithOddIndex(o),m=v.real,b=v.imag,g=[m.length],y=i.makeTensorInfo(g,"float32",m),x=i.makeTensorInfo(g,"float32",b),O=Pl({inputs:{real:y,imag:x},backend:i}),k=uh(s,l,u,r,i),w=k.real,j=k.imag,_=[w.length],S=i.makeTensorInfo(_,"float32",w),E=i.makeTensorInfo(_,"float32",j),C=Pl({inputs:{real:S,imag:E},backend:i}),A=uh(m,b,u,r,i),N=A.real,T=A.imag,I=[N.length],D=i.makeTensorInfo(I,"float32",N),F=i.makeTensorInfo(I,"float32",T),M=Pl({inputs:{real:D,imag:F},backend:i}),R=a.backend_util.exponents(n,r),z=[R.real.length],L=i.makeTensorInfo(z,"float32",R.real),P=i.makeTensorInfo(z,"float32",R.imag),B=Pl({inputs:{real:L,imag:P},backend:i}),W=Ed({inputs:{a:B,b:M},backend:i}),U=$l({inputs:{a:C,b:W},backend:i}),V=rh({inputs:{a:C,b:W},backend:i}),q=Ul({inputs:{input:U},backend:i}),H=Ul({inputs:{input:V},backend:i}),G=Qf({inputs:{input:U},backend:i}),K=Qf({inputs:{input:V},backend:i}),X=ed({inputs:[q,H],backend:i,attrs:{axis:0}}),Y=ed({inputs:[G,K],backend:i,attrs:{axis:0}}),$=i.data.get(X.dataId).values,J=i.data.get(Y.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(O),i.disposeIntermediateTensorInfo(S),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(C),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo(M),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(P),i.disposeIntermediateTensorInfo(B),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(K),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(Y),{real:$,imag:J}}var ch={kernelName:a.FFT,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,i=a.util.sizeFromShape(r.shape),o=r.shape[r.shape.length-1],u=Ql({inputs:{x:r},backend:n,attrs:{shape:[i/o,o]}}),c=ih(u,!1,n),s=Ql({inputs:{x:c},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),s}};function sh(e){var t=e.backend,n=e.attrs,r=n.shape,i=n.value,o=n.dtype||a.util.inferDtype(i),u=a.util.getArrayFromDType(o,a.util.sizeFromShape(r));return function(e,t,n){e.fill(t)}(u,i),t.makeTensorInfo(r,o,u)}var lh={kernelName:a.Fill,backendName:"cpu",kernelFunc:sh};var fh={kernelName:a.FlipLeftRight,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,o=n,u=a.util.getTypedArrayFromDType(r.dtype,a.util.sizeFromShape(r.shape)),c=Object(i.a)(r.shape,4),s=c[0],l=c[1],f=c[2],d=c[3],h=o.data.get(r.dataId).values,p=0;p<s;p++)for(var v=p*f*l*d,m=0;m<l;m++)for(var b=m*(f*d),g=0;g<f;g++)for(var y=g*d,x=0;x<d;x++){var O=[s,m,g,x][2],k=Math.round(f-O),w=v+b+y+x,j=h[w];if(k>=0&&k<f)j=h[v+b+k*d+x];u[w]=j}return{dataId:o.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},dh=qf((function(e){return Math.floor(e)})),hh=Ol(a.Floor,dh),ph={kernelName:a.Floor,backendName:"cpu",kernelFunc:hh},vh=Cl((function(e,t){return Math.floor(e/t)})),mh=Gl(a.FloorDiv,vh,null,"int32"),bh={kernelName:a.FloorDiv,backendName:"cpu",kernelFunc:mh};var gh={kernelName:a.FusedConv2D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,u=t.preluActivationWeights,c=r.strides,s=r.pad,l=r.dataFormat,f=r.dilations,d=r.dimRoundingMode,h=r.activation,p=r.leakyreluAlpha,v=nd({inputs:{x:a,filter:i},backend:n,attrs:{strides:c,pad:s,dataFormat:l,dilations:f,dimRoundingMode:d}});if(o){var m=v;v=$l({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(h){var b=v;v=Ll(n,v,h,u,p),n.disposeIntermediateTensorInfo(b)}return v}};var yh={kernelName:a.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,u=t.preluActivationWeights,c=r.strides,s=r.pad,l=r.dataFormat,f=r.dilations,d=r.dimRoundingMode,h=r.activation,p=r.leakyreluAlpha,v=bd({inputs:{x:a,filter:i},backend:n,attrs:{strides:c,pad:s,dataFormat:l,dilations:f,dimRoundingMode:d}});if(o){var m=v;v=$l({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(m)}if(h){var b=v;v=Ll(n,v,h,u,p),n.disposeIntermediateTensorInfo(b)}return v}};var xh={kernelName:a.GatherNd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,o=t.indices,u=a.util.sizeFromShape(r.shape),c=o.shape,s=c[c.length-1],l=a.backend_util.prepareAndValidate(r,o),f=Object(i.a)(l,4),d=f[0],h=f[1],p=f[2],v=f[3];if(0===h)return n.makeTensorInfo(d,r.dtype,[]);for(var m=Object(a.buffer)([h,p],r.dtype),b=n.data.get(o.dataId).values,g=n.data.get(r.dataId).values,y=0;y<h;y++){for(var x=[],O=0,k=0;k<s;k++){var w=b[y*s+k];O+=w*v[k],x.push(w)}if(O<0||O>=u/p)throw new Error("Invalid indices: ".concat(x," does not index into ").concat(r.shape));for(var j=0;j<p;j++)m.values[y*p+j]=g[O*p+j]}return n.makeTensorInfo(d,m.dtype,m.values)}};function Oh(e,t,n){for(var r=Object(a.buffer)(n,e.dtype),i=0;i<r.size;++i){var o=r.indexToLoc(i).slice(),u=o[0],c=o[2],s=t.locToIndex([u,c]);o[2]=t.values[s];var l=e.locToIndex(o);r.values[i]=e.values[l]}return r}var kh={kernelName:a.GatherV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.indices,u=r.axis,c=r.batchDims;bl([i,o],"gatherV2");var s=c;null==c&&(s=0);var l=a.util.sizeFromShape(o.shape),f=a.util.parseAxisParam(u,i.shape)[0],d=a.backend_util.segment_util.collectGatherOpShapeInfo(i,o,f,s),h=Ql({inputs:{x:i},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),p=Ql({inputs:{x:o},backend:n,attrs:{shape:[d.batchSize,l/d.batchSize]}}),v=[d.batchSize,d.outerSize,l/d.batchSize,d.sliceSize],m=n.bufferSync(p),b=Oh(n.bufferSync(h),m,v);return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.makeTensorInfo(d.outputShape,b.dtype,b.values)}},wh=Cl((function(e,t){return e>t?1:0})),jh=Gl(a.Greater,wh,null,"bool"),_h={kernelName:a.Greater,backendName:"cpu",kernelFunc:jh},Sh=Cl((function(e,t){return e>=t?1:0})),Eh=Gl(a.GreaterEqual,Sh,null,"bool"),Ch={kernelName:a.GreaterEqual,backendName:"cpu",kernelFunc:Eh};var Ah={kernelName:a.IFFT,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,i=a.util.sizeFromShape(r.shape),o=r.shape[r.shape.length-1],u=Ql({inputs:{x:r},backend:n,attrs:{shape:[i/o,o]}}),c=ih(u,!0,n),s=Ql({inputs:{x:c},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),s}},Nh=xl(a.IsFinite,(function(e){return Number.isFinite(e)?1:0}),"bool"),Th={kernelName:a.IsFinite,backendName:"cpu",kernelFunc:Nh},Ih=xl(a.IsInf,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),Dh={kernelName:a.IsInf,backendName:"cpu",kernelFunc:Ih},Fh=xl(a.IsNan,(function(e){return Number.isNaN(e)?1:0}),"bool"),Mh={kernelName:a.IsNan,backendName:"cpu",kernelFunc:Fh},Rh=Cl((function(e,t){return e<t?1:0})),zh=Gl(a.Less,Rh,null,"bool"),Lh={kernelName:a.Less,backendName:"cpu",kernelFunc:zh},Ph=Cl((function(e,t){return e<=t?1:0})),Bh=Gl(a.LessEqual,Ph,null,"bool"),Wh={kernelName:a.LessEqual,backendName:"cpu",kernelFunc:Bh};function Uh(e,t,n){var r=(t-e)/(n-1),i=a.util.makeZerosTypedArray(n,"float32");i[0]=e;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return i}var Vh={kernelName:a.LinSpace,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=Uh(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},qh=qf((function(e){return Math.log(e)})),Hh=Ol(a.Log,qh),Gh={kernelName:a.Log,backendName:"cpu",kernelFunc:Hh},Kh=xl(a.Log1p,(function(e){return Math.log1p(e)})),Xh={kernelName:a.Log1p,backendName:"cpu",kernelFunc:Kh},Yh=Cl((function(e,t){return e&&t})),$h=Gl(a.LogicalAnd,Yh,null,"bool"),Jh={kernelName:a.LogicalAnd,backendName:"cpu",kernelFunc:$h},Qh=xl(a.LogicalNot,(function(e){return e?0:1}),"bool"),Zh={kernelName:a.LogicalNot,backendName:"cpu",kernelFunc:Qh},ep=Cl((function(e,t){return e||t})),tp=Gl(a.LogicalOr,ep,null,"bool"),np={kernelName:a.LogicalOr,backendName:"cpu",kernelFunc:tp};var rp={kernelName:a.LRN,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.depthRadius,u=r.bias,c=r.alpha,s=r.beta;bl(i,"LRN");var l=i.shape[3],f=l-1,d=n.data.get(i.dataId).values,h=a.util.sizeFromShape(i.shape),p=new Float32Array(h);function v(e){for(var t=e%l,n=e-t+Math.max(0,t-o),r=e-t+Math.min(t+o,f),a=0;n<=r;n++){var i=d[n];a+=i*i}return a}for(var m=0;m<h;m++){var b=v(m),g=d[m]*Math.pow(u+c*b,-s);p[m]=g}return n.makeTensorInfo(i.shape,i.dtype,p)}};var ap={kernelName:a.LRNGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.y,u=t.dy,c=r.depthRadius,s=r.bias,l=r.alpha,f=r.beta;bl(u,"LRNGrad");for(var d=a.util.sizeFromShape(u.shape),h=u.shape[3],p=n.data.get(u.dataId).values,v=n.data.get(i.dataId).values,m=n.data.get(o.dataId).values,b=new Float32Array(d),g=d,y=0;y<g;y++){for(var x=y%h,O=y-x+Math.max(0,x-c),k=y-x+Math.min(h,x+c+1),w=0,j=O;j<k;j++)w+=Math.pow(v[j],2);w=l*w+s;for(var _=O;_<k;_++){var S=-2*l*f*v[_]*m[y]/w;y===_&&(S+=Math.pow(w,-f)),S*=p[y],b[_]+=S}}return n.makeTensorInfo(u.shape,i.dtype,b)}};function ip(e,t,n,r){for(var i=a.util.getTypedArrayFromDType(r,a.util.sizeFromShape(n)),o=0;o<i.length;++o){for(var u=o*t,c=e[u],s=0;s<t;++s){var l=e[u+s];l>c&&(c=l)}i[o]=c}return i}function op(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.reductionIndices,c=r.keepDims,s=n,l=o.shape,f=l.length,d=a.util.parseAxisParam(u,l),h=d,p=a.backend_util.getAxesPermutation(h,f),v=s.data.get(o.dataId).values;if(null!=p){for(var m=new Array(f),b=0;b<m.length;b++)m[b]=l[p[b]];v=ff(v,l,o.dtype,p,m),h=a.backend_util.getInnerMostAxes(h.length,f),l=m}bl(o,"max"),a.backend_util.assertAxesAreInnerMostDims("max",h,f);var g=a.backend_util.computeOutAndReduceShapes(l,h),y=Object(i.a)(g,2),x=y[0],O=y[1],k=ip(v,a.util.sizeFromShape(O),x,o.dtype),w=s.write(k,x,o.dtype),j=x;c&&(j=a.backend_util.expandShapeToKeepDim(x,d));return{dataId:w,shape:j,dtype:o.dtype}}var up={kernelName:a.Max,backendName:"cpu",kernelFunc:op},cp=Cl((function(e,t){return Math.max(e,t)})),sp=Gl(a.Maximum,cp),lp={kernelName:a.Maximum,backendName:"cpu",kernelFunc:sp};var fp={kernelName:a.MaxPool,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x;bl(i,"maxPool");var o=r.filterSize,u=r.strides,c=r.pad,s=r.dimRoundingMode;a.util.assert(a.backend_util.eitherStridesOrDilationsAreOne(u,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(u," and dilations '").concat(1,"'")}));var l,f=a.backend_util.computePool2DInfo(i.shape,o,u,1,c,s);if(1===f.filterWidth&&1===f.filterHeight&&a.util.arraysEqual(f.inShape,f.outShape))l=jl({inputs:{x:i},backend:n});else{var d=n.data.get(i.dataId).values,h=a.util.computeStrides(i.shape),p=Af(d,i.shape,i.dtype,h,f,"max");l=n.makeTensorInfo(f.outShape,i.dtype,p.values)}return l}};var dp={kernelName:a.MaxPool3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.filterSize,u=r.strides,c=r.pad,s=r.dimRoundingMode,l=r.dataFormat;bl(i,"maxPool3d");var f=a.backend_util.computePool3DInfo(i.shape,o,u,1,c,s,l),d=Tf(n.data.get(i.dataId).values,i.shape,i.dtype,a.util.computeStrides(i.shape),f,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};var hp={kernelName:a.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.input,u=r.filterSize,c=r.strides,s=r.pad,l=r.dimRoundingMode;bl([i,o],"maxPool3DGrad");for(var f=a.backend_util.computePool3DInfo(o.shape,u,c,1,s,l),d=function(e,t){for(var n=Object(a.buffer)(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,o=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,s=t.dilationWidth,l=t.effectiveFilterDepth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,p=t.padInfo.top,v=t.padInfo.left,m=0;m<t.batchSize;++m)for(var b=0;b<t.inChannels;++b)for(var g=0;g<t.outDepth;++g){for(var y=g*r-h,x=y;x<0;)x+=u;for(var O=Math.min(t.inDepth,l+y),k=0;k<t.outHeight;++k){for(var w=k*i-p,j=w;j<0;)j+=c;for(var _=Math.min(t.inHeight,f+w),S=0;S<t.outWidth;++S){for(var E=S*o-v,C=E;C<0;)C+=s;for(var A=Math.min(t.inWidth,d+E),N=Number.NEGATIVE_INFINITY,T=-1,I=x;I<O;I+=u)for(var D=I-y,F=j;F<_;F+=c)for(var M=F-w,R=C;R<A;R+=s){var z=R-E,L=e.get(m,I,F,R,b);L>=N&&(N=L,T=D*f*d+M*f+z)}n.set(T,m,g,k,S,b)}}}return n}(n.bufferSync(o),f),h=f.strideDepth,p=f.strideHeight,v=f.strideWidth,m=f.dilationDepth,b=f.dilationHeight,g=f.dilationWidth,y=f.effectiveFilterDepth,x=f.effectiveFilterHeight,O=f.effectiveFilterWidth,k=y-1-f.padInfo.front,w=O-1-f.padInfo.left,j=x-1-f.padInfo.top,_=Object(a.buffer)(o.shape,"float32"),S=n.bufferSync(i),E=0;E<f.batchSize;++E)for(var C=0;C<f.inChannels;++C)for(var A=0;A<f.inDepth;++A)for(var N=0;N<f.inHeight;++N)for(var T=0;T<f.inWidth;++T){for(var I=A-k,D=N-j,F=T-w,M=0,R=0;R<y;R+=m){var z=(I+R)/h;if(!(z<0||z>=f.outDepth||Math.floor(z)!==z))for(var L=0;L<x;L+=b){var P=(D+L)/p;if(!(P<0||P>=f.outHeight||Math.floor(P)!==P))for(var B=0;B<O;B+=g){var W=(F+B)/v;if(!(W<0||W>=f.outWidth||Math.floor(W)!==W)){var U=y*x*O-1-d.get(E,z,P,W,C)===R*x*O+L*O+B?1:0;if(0!==U)M+=S.get(E,z,P,W,C)*U}}}}_.set(M,E,A,N,T,C)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}};var pp={kernelName:a.MaxPoolGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.input,u=o;bl([o,t.output],"maxPoolGrad");for(var c=r.filterSize,s=r.strides,l=r.pad,f=r.dimRoundingMode,d=a.backend_util.computePool2DInfo(u.shape,c,s,1,l,f),h=n.data.get(u.dataId).values,p=Object(a.buffer)(d.outShape,u.dtype,Nf(h,u.shape,u.dtype,d).values),v=d.strideHeight,m=d.strideWidth,b=d.dilationHeight,g=d.dilationWidth,y=d.effectiveFilterHeight,x=d.effectiveFilterWidth,O=x-1-d.padInfo.left,k=y-1-d.padInfo.top,w=Object(a.buffer)(u.shape,"float32"),j=n.data.get(i.dataId).values,_=Object(a.buffer)(i.shape,"float32",j),S=0;S<d.batchSize;++S)for(var E=0;E<d.inChannels;++E)for(var C=0;C<d.inHeight;++C)for(var A=0;A<d.inWidth;++A){for(var N=C-k,T=A-O,I=0,D=0;D<y;D+=b){var F=(N+D)/v;if(!(F<0||F>=d.outHeight||Math.floor(F)!==F))for(var M=0;M<x;M+=g){var R=(T+M)/m;if(!(R<0||R>=d.outWidth||Math.floor(R)!==R)){var z=y*x-1-p.get(S,F,R,E)===D*x+M?1:0;if(0!==z)I+=_.get(S,F,R,E)*z}}}w.set(I,S,C,A,E)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var vp={kernelName:a.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,o=t.x,u=n.filterSize,c=n.strides,s=n.pad,l=n.includeBatchInIndex,f=r;bl(o,"MaxPoolWithArgmax");var d=f.data.get(o.dataId).values,h=a.backend_util.computePool2DInfo(o.shape,u,c,[1,1],s),p=function(e,t,n,r,i){var o=Af(e,0,n,a.util.computeStrides(t),i,"max"),u=Nf(e,t,n,i,!0,r);return[o.values,u.values]}(d,o.shape,o.dtype,l,h),v=Object(i.a)(p,2),m=v[0],b=v[1],g=f.write(m,h.outShape,o.dtype),y=f.write(b,h.outShape,o.dtype);return[{dataId:g,shape:h.outShape,dtype:o.dtype},{dataId:y,shape:h.outShape,dtype:"int32"}]}};var mp={kernelName:a.Mean,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.axis,u=r.keepDims,c=a.util.parseAxisParam(o,i.shape),s=a.backend_util.computeOutAndReduceShapes(i.shape,c)[1],l=a.util.sizeFromShape(s),f=[],d=n.makeTensorInfo([],"float32",new Float32Array([l]));f.push(d);var h=ql({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});f.push(h);var p=Zd({inputs:{a:h,b:d},backend:n});f.push(p);var v=Ad({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:u}});return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}};var bp={kernelName:a.Min,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.axis,c=r.keepDims;bl(o,"min");var s=a.util.parseAxisParam(u,o.shape),l=s,f=a.backend_util.getAxesPermutation(l,o.shape.length),d=o;null!=f&&(d=df({inputs:{x:o},backend:n,attrs:{perm:f}}),l=a.backend_util.getInnerMostAxes(l.length,o.shape.length)),a.backend_util.assertAxesAreInnerMostDims("min",l,d.shape.length);for(var h=a.backend_util.computeOutAndReduceShapes(d.shape,l),p=Object(i.a)(h,2),v=p[0],m=p[1],b=a.util.sizeFromShape(m),g=a.util.makeZerosTypedArray(a.util.sizeFromShape(v),d.dtype),y=n.data.get(d.dataId).values,x=0;x<g.length;++x){for(var O=x*b,k=y[O],w=0;w<b;++w){var j=y[O+w];j<k&&(k=j)}g[x]=k}null!=f&&n.disposeIntermediateTensorInfo(d);var _=n.makeTensorInfo(v,d.dtype,g);if(c){var S=Ql({inputs:{x:_},backend:n,attrs:{shape:a.backend_util.expandShapeToKeepDim(v,s)}});return n.disposeIntermediateTensorInfo(_),S}return _}},gp=Cl((function(e,t){return Math.min(e,t)})),yp=Gl(a.Minimum,gp),xp={kernelName:a.Minimum,backendName:"cpu",kernelFunc:yp};var Op={kernelName:a.MirrorPad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.paddings,u=r.mode;bl(i,"mirrorPad");for(var c=o.map((function(e,t){return e[0]+i.shape[t]+e[1]})),s=o.map((function(e){return e[0]})),l=o.map((function(e,t){return e[0]+i.shape[t]})),f="reflect"===u?0:1,d=n.data.get(i.dataId).values,h=i.shape.length,p=a.util.computeStrides(i.shape),v=a.util.sizeFromShape(c),m=c.length,b=a.util.computeStrides(c),g=a.util.getTypedArrayFromDType(i.dtype,v),y=0;y<v;y++){for(var x=a.util.indexToLoc(y,m,b),O=0;O<m;O++)x[O]<s[O]?x[O]=2*s[O]-x[O]-f:x[O]>=l[O]&&(x[O]=2*(l[O]-1)-x[O]+f);x=x.map((function(e,t){return e-s[t]}));var k=a.util.locToIndex(x,h,p);g[y]=d[k]}return{dataId:n.write(g,c,i.dtype),shape:c,dtype:i.dtype}}},kp=Cl((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),wp=Gl(a.Mod,kp),jp={kernelName:a.Mod,backendName:"cpu",kernelFunc:wp};function _p(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.logits,o=r.dim,u=i.shape.length,c=o;if(-1===c&&(c=u-1),c!==u-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(u," and dim was ").concat(c));var s=a.util.parseAxisParam([c],i.shape),l=op({inputs:{x:i},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),f=a.backend_util.expandShapeToKeepDim(l.shape,s),d=Ql({inputs:{x:l},backend:n,attrs:{shape:f}}),h=rh({inputs:{a:i,b:d},backend:n}),p=Hd({inputs:{x:h},backend:n}),v=Ad({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:!1}}),m=Ql({inputs:{x:v},backend:n,attrs:{shape:f}}),b=Zd({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),b}var Sp={kernelName:a.Softmax,backendName:"cpu",kernelFunc:_p};var Ep={kernelName:a.Multinomial,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.logits,o=r.numSamples,u=r.seed,c=r.normalized;bl(i,"multinomial");for(var s=c?i:_p({inputs:{logits:i},backend:n,attrs:{dim:-1}}),l=s.shape[0],f=s.shape[1],d=n.data.get(s.dataId).values,h=[l,o],p=a.util.makeZerosTypedArray(a.util.sizeFromShape(h),"int32"),v=0;v<l;++v){var m=v*f,b=new Float32Array(f-1);b[0]=d[m];for(var g=1;g<b.length;++g)b[g]=b[g-1]+d[m+g];for(var y=fl.alea(u.toString()),x=v*o,O=0;O<o;++O){var k=y();p[x+O]=b.length;for(var w=0;w<b.length;w++)if(k<b[w]){p[x+O]=w;break}}}return c||n.disposeIntermediateTensorInfo(s),n.makeTensorInfo(h,"int32",p)}};function Cp(e,t,n){var r=a.util.createScalarValue(-1,n);return _d([],t,r,e,n)}var Ap={kernelName:a.Neg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;bl(r,"neg");var a=Cp(n.data.get(r.dataId).values,r.shape,r.dtype),o=Object(i.a)(a,2),u=o[0],c=o[1];return n.makeTensorInfo(c,r.dtype,u)}},Np=a.kernel_impls.nonMaxSuppressionV3Impl;var Tp={kernelName:a.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,c=r.scoreThreshold;bl(a,"NonMaxSuppression");var s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,f=Np(s,l,o,u,c).selectedIndices;return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},Ip=a.kernel_impls.nonMaxSuppressionV4Impl;var Dp={kernelName:a.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,c=r.scoreThreshold,s=r.padToMaxOutputSize;bl(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,d=Ip(l,f,o,u,c,s),h=d.selectedIndices,p=d.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},Fp=a.kernel_impls.nonMaxSuppressionV5Impl;var Mp={kernelName:a.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,c=r.scoreThreshold,s=r.softNmsSigma;bl(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,d=Fp(l,f,o,u,c,s),h=d.selectedIndices,p=d.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},Rp=Cl((function(e,t){return e!==t?1:0})),zp=Gl(a.NotEqual,Rp,null,"bool"),Lp={kernelName:a.NotEqual,backendName:"cpu",kernelFunc:zp};var Pp={kernelName:a.OneHot,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.indices,o=r.depth,u=r.onValue,c=r.offValue;bl(i,"oneHot");var s=a.util.sizeFromShape(i.shape),l=new Float32Array(s*o);l.fill(c);for(var f=n.data.get(i.dataId).values,d=0;d<s;++d)f[d]>=0&&f[d]<o&&(l[d*o+f[d]]=u);return n.makeTensorInfo([].concat(Object(Nn.a)(i.shape),[o]),"int32",l)}};function Bp(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=Ul({inputs:{input:r},backend:n}),i=Bp({inputs:{x:a},backend:n}),o=Qf({inputs:{input:r},backend:n}),u=Bp({inputs:{x:o},backend:n}),c=Pl({inputs:{real:i,imag:u},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}return sh({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var Wp={kernelName:a.ZerosLike,backendName:"cpu",kernelFunc:Bp};var Up={kernelName:a.OnesLike,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=Ul({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),u=Qf({inputs:{input:a},backend:r}),c=Bp({inputs:{x:u},backend:r}),s=Pl({inputs:{real:o,imag:c},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(c),s}return sh({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function Vp(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return Kd({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var i=t[0].shape,o=t[0].dtype;t.forEach((function(e){a.util.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),a.util.assert(o===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var u=[],c=ed({inputs:t.map((function(e){var t=Kd({inputs:{input:e},backend:n,attrs:{dim:r}});return u.push(t),t})),backend:n,attrs:{axis:r}});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}var qp={kernelName:a.Pack,backendName:"cpu",kernelFunc:Vp};var Hp={kernelName:a.PadV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.paddings,u=r.constantValue;bl(i,"pad");var c=o.map((function(e,t){return e[0]+i.shape[t]+e[1]})),s=o.map((function(e){return e[0]})),l=n.data.get(i.dataId).values,f=a.util.sizeFromShape(i.shape),d=i.shape.length,h=a.util.computeStrides(i.shape),p=a.util.sizeFromShape(c),v=c.length,m=a.util.computeStrides(c),b=a.util.getTypedArrayFromDType(i.dtype,p);0!==u&&b.fill(u);for(var g=0;g<f;g++){var y=a.util.indexToLoc(g,d,h).map((function(e,t){return e+s[t]}));b[a.util.locToIndex(y,v,m)]=l[g]}return{dataId:n.write(b,c,i.dtype),shape:c,dtype:i.dtype}}},Gp=Cl((function(e,t){return Math.pow(e,t)})),Kp=Gl(a.Pow,Gp),Xp={kernelName:a.Pow,backendName:"cpu",kernelFunc:Kp};function Yp(e,t,n,r){for(var o=a.backend_util.computeOutAndReduceShapes(e,r),u=Object(i.a)(o,2),c=u[0],s=u[1],l=Object(a.upcastType)(t,"int32"),f=a.util.makeZerosTypedArray(a.util.sizeFromShape(c),l),d=a.util.sizeFromShape(s),h=0;h<f.length;++h){for(var p=h*d,v=1,m=0;m<d;++m)v*=n[p+m];f[h]=v}return{outVals:f,outShape:c,outDtype:l}}var $p={kernelName:a.Prod,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.axis,u=r.keepDims;bl(i,"prod");var c=i.shape.length,s=a.util.parseAxisParam(o,i.shape),l=a.backend_util.getAxesPermutation(s,c),f=s,d=i,h=[];null!=l&&(d=df({inputs:{x:i},backend:n,attrs:{perm:l}}),h.push(d),f=a.backend_util.getInnerMostAxes(f.length,c));var p=n.data.get(d.dataId).values,v=Yp(d.shape,d.dtype,p,f),m=v.outVals,b=v.outShape,g=v.outDtype,y=b;return u&&(y=a.backend_util.expandShapeToKeepDim(b,s)),h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,g,m)}};function Jp(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return a.util.makeZerosTypedArray(0,r);var i=Math.abs(Math.ceil((t-e)/n)),o=a.util.makeZerosTypedArray(i,r);t<e&&1===n&&(n=-1),o[0]=e;for(var u=1;u<o.length;u++)o[u]=o[u-1]+n;return o}var Qp={kernelName:a.Range,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=Jp(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},Zp=xl(a.Reciprocal,(function(e){return 1/e})),ev={kernelName:a.Reciprocal,backendName:"cpu",kernelFunc:Zp};var tv={kernelName:a.ResizeBilinear,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.images,u=r.alignCorners,c=r.halfPixelCenters,s=r.size;bl(o,"resizeBilinear");for(var l=a.util.computeStrides(o.shape),f=Object(i.a)(s,2),d=f[0],h=f[1],p=Object(i.a)(o.shape,4),v=p[0],m=p[1],b=p[2],g=p[3],y=n.data.get(o.dataId).values,x=new Float32Array(a.util.sizeFromShape([v,d,h,g])),O=[u&&d>1?m-1:m,u&&h>1?b-1:b],k=[u&&d>1?d-1:d,u&&h>1?h-1:h],w=0,j=O[0]/k[0],_=O[1]/k[1],S=0;S<v;S++)for(var E=0;E<d;E++){var C=void 0;C=c?j*(E+.5)-.5:j*E;for(var A=Math.max(0,Math.floor(C)),N=C-A,T=Math.min(m-1,Math.ceil(C)),I=S*l[0]+A*l[1],D=S*l[0]+T*l[1],F=0;F<h;F++){var M=void 0;M=c?_*(F+.5)-.5:_*F;for(var R=Math.max(0,Math.floor(M)),z=M-R,L=Math.min(b-1,Math.ceil(M)),P=I+R*l[2],B=D+R*l[2],W=I+L*l[2],U=D+L*l[2],V=0;V<g;V++){var q=y[P+V],H=y[B+V],G=q+(y[W+V]-q)*z,K=G+(H+(y[U+V]-H)*z-G)*N;x[w++]=K}}}return n.makeTensorInfo([v,d,h,g],"float32",x)}};var nv={kernelName:a.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.images,u=t.dy,c=r.alignCorners;bl([u,o],"resizeBilinearGrad");for(var s=a.util.computeStrides(o.shape),l=Object(i.a)(o.shape,4),f=l[0],d=l[1],h=l[2],p=l[3],v=Object(i.a)(u.shape,3),m=v[1],b=v[2],g=new Float32Array(f*d*h*p),y=[c&&m>1?d-1:d,c&&b>1?h-1:h],x=[c&&m>1?m-1:m,c&&b>1?b-1:b],O=y[0]/x[0],k=y[1]/x[1],w=n.data.get(u.dataId).values,j=0,_=0;_<f;_++)for(var S=_*s[0],E=0;E<m;E++)for(var C=E*O,A=Math.floor(C),N=Math.min(Math.ceil(C),d-1),T=S+A*s[1],I=S+N*s[1],D=C-A,F=1-D,M=0;M<b;M++)for(var R=M*k,z=Math.floor(R),L=Math.min(Math.ceil(R),h-1),P=R-z,B=1-P,W=T+z*s[2],U=T+L*s[2],V=I+z*s[2],q=I+L*s[2],H=F*B,G=F*P,K=D*B,X=D*P,Y=0;Y<p;Y++){var $=w[j++];g[W+Y]+=$*H,g[U+Y]+=$*G,g[V+Y]+=$*K,g[q+Y]+=$*X}return n.makeTensorInfo([f,h,d,p],"float32",g)}};var rv={kernelName:a.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.images,u=r.alignCorners,c=r.halfPixelCenters,s=r.size;bl(o,"resizeNearestNeighbor");for(var l=a.util.computeStrides(o.shape),f=Object(i.a)(s,2),d=f[0],h=f[1],p=Object(i.a)(o.shape,4),v=p[0],m=p[1],b=p[2],g=p[3],y=n.data.get(o.dataId).values,x=new Float32Array(v*d*h*g),O=[u&&d>1?m-1:m,u&&h>1?b-1:b],k=[u&&d>1?d-1:d,u&&h>1?h-1:h],w=O[0]/k[0],j=O[1]/k[1],_=0,S=0;S<v;S++)for(var E=S*l[0],C=0;C<d;C++){var A=c?w*(C+.5):w*C,N=Math.min(m-1,u?Math.round(A):Math.floor(A));c&&(N=Math.max(0,N));for(var T=E+N*l[1],I=0;I<h;I++){var D=c?j*(I+.5):j*I,F=Math.min(b-1,u?Math.round(D):Math.floor(D));c&&(F=Math.max(0,F));for(var M=T+F*l[2],R=0;R<g;R++){var z=y[M+R];x[_++]=z}}}return n.makeTensorInfo([v,d,h,g],o.dtype,x)}};var av={kernelName:a.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.images,u=t.dy,c=r.alignCorners;bl([u,o],"resizeNearestNeighborGrad");for(var s=a.util.computeStrides(o.shape),l=a.util.computeStrides(u.shape),f=Object(i.a)(o.shape,4),d=f[0],h=f[1],p=f[2],v=f[3],m=Object(i.a)(u.shape,3),b=m[1],g=m[2],y=new Float32Array(d*h*p*v),x=n.data.get(u.dataId).values,O=[c&&b>1?h-1:h,c&&g>1?p-1:p],k=[c&&b>1?b-1:b,c&&g>1?g-1:g],w=O[0]/k[0],j=O[1]/k[1],_=1/w,S=1/j,E=2*Math.ceil(_)+2,C=2*Math.ceil(S)+2,A=0;A<d;A++)for(var N=A*s[0],T=0;T<h;T++)for(var I=N+T*s[1],D=Math.floor(T*_),F=Math.floor(D-E/2),M=0;M<p;M++)for(var R=I+M*s[2],z=Math.floor(M*S),L=Math.floor(z-C/2),P=0;P<v;P++){for(var B=0,W=0;W<E;W++){var U=W+F;if(!(U<0||U>=b)){var V=N+U*l[1],q=U*w;if(T===Math.min(h-1,c?Math.round(q):Math.floor(q)))for(var H=0;H<C;H++){var G=H+L;if(!(G<0||G>=g)){var K=V+G*l[2],X=G*j;M===Math.min(p-1,c?Math.round(X):Math.floor(X))&&(B+=x[K+P])}}}}y[R+P]=B}return n.makeTensorInfo(o.shape,o.dtype,y)}};var iv={kernelName:a.Reverse,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.dims;bl(i,"reverse");var u=i.shape.length,c=a.util.parseAxisParam(o,i.shape);if(0===u)return jl({inputs:{x:i},backend:n});for(var s=new a.TensorBuffer(i.shape,i.dtype),l=n.bufferSync(i),f=function(e){var t=s.indexToLoc(e),n=t.slice();c.forEach((function(e){return n[e]=i.shape[e]-1-n[e]})),s.set.apply(s,[l.get.apply(l,Object(Nn.a)(n))].concat(Object(Nn.a)(t)))},d=0;d<s.size;d++)f(d);return n.makeTensorInfo(s.shape,s.dtype,s.values)}},ov={kernelName:a.RotateWithOffset,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,o=t.image,u=n.radians,c=n.fillValue,s=n.center,l=r,f=a.util.getTypedArrayFromDType(o.dtype,a.util.sizeFromShape(o.shape)),d=Object(i.a)(o.shape,4),h=d[0],p=d[1],v=d[2],m=d[3],b=a.backend_util.getImageCenter(s,p,v),g=Object(i.a)(b,2),y=g[0],x=g[1],O=Math.sin(u),k=Math.cos(u),w=l.data.get(o.dataId).values,j=0;j<h;j++)for(var _=j*v*p*m,S=0;S<p;S++)for(var E=S*(v*m),C=0;C<v;C++)for(var A=C*m,N=0;N<m;N++){var T=[h,S,C,N],I=T[2],D=T[1],F=(I-y)*k-(D-x)*O,M=(I-y)*O+(D-x)*k;F=Math.round(F+y),M=Math.round(M+x);var R=c;if("number"!==typeof c&&(R=3===N?255:c[N]),F>=0&&F<v&&M>=0&&M<p)R=w[_+M*(v*m)+F*m+N];f[_+E+A+N]=R}return{dataId:l.write(f,o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}},uv=xl(a.Round,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),cv={kernelName:a.Round,backendName:"cpu",kernelFunc:uv},sv=qf((function(e){return 1/Math.sqrt(e)})),lv=Ol(a.Rsqrt,sv),fv={kernelName:a.Rsqrt,backendName:"cpu",kernelFunc:lv};function dv(e,t,n,r,i,o,u,c,s,l){var f=[r/i,i],d=e.values,h=t.values;if(0===r)return Object(a.buffer)(n,t.dtype);var p=Object(a.buffer)(f,t.dtype);p.values.fill(s);for(var v=0;v<o;v++){for(var m=[],b=0,g=0;g<u;g++){var y=d[v*u+g];m.push(y),b+=y*c[g]}if(b<0||b>=r/i)throw new Error("Invalid indices: ".concat(m," does not index into ").concat(n));for(var x=0;x<i;x++)l?p.values[b*i+x]+=h[v*i+x]:p.values[b*i+x]=0===t.rank?h[0]:h[v*i+x]}return p}var hv={kernelName:a.ScatterNd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.indices,o=t.updates,u=r.shape,c=a.backend_util.calculateShapes(o,i,u),s=c.sliceRank,l=c.numUpdates,f=c.sliceSize,d=c.strides,h=c.outputSize,p=dv(n.bufferSync(i),n.bufferSync(o),u,h,f,l,s,d,0,!0);return n.makeTensorInfo(u,p.dtype,p.values)}};var pv={kernelName:a.Select,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,i=t.t,o=t.e;bl([r,i,o],"select");for(var u=r.shape.length,c=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,f=Object(a.upcastType)(i.dtype,o.dtype),d=a.util.makeZerosTypedArray(a.util.sizeFromShape(i.shape),f),h=0,p=0===u||u>1||1===i.shape.length?1:a.util.sizeFromShape(i.shape.slice(1)),v=0;v<c.length;v++)for(var m=0;m<p;m++)1===c[v]?d[h++]=s[v]:d[h++]=l[v];return n.makeTensorInfo(i.shape,f,d)}},vv=a.backend_util.SELU_SCALEALPHA,mv=a.backend_util.SELU_SCALE,bv=xl(a.Selu,(function(e){return e>=0?mv*e:vv*(Math.exp(e)-1)})),gv={kernelName:a.Selu,backendName:"cpu",kernelFunc:bv},yv=xl(a.Sign,(function(e){return e<0?-1:e>0?1:0})),xv={kernelName:a.Sign,backendName:"cpu",kernelFunc:yv},Ov=xl(a.Sin,(function(e){return Math.sin(e)})),kv={kernelName:a.Sin,backendName:"cpu",kernelFunc:Ov},wv=xl(a.Sinh,(function(e){return Math.sinh(e)})),jv={kernelName:a.Sinh,backendName:"cpu",kernelFunc:wv},_v=Math.log(1.1920928955078125e-7)+2,Sv=xl(a.Softplus,(function(e){var t=e>-_v,n=e<_v,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),Ev={kernelName:a.Softplus,backendName:"cpu",kernelFunc:Sv};var Cv={kernelName:a.SpaceToBatchND,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.blockShape,u=r.paddings;bl([i],"spaceToBatchND");var c=a.util.sizeFromShape(o),s=[[0,0]];s.push.apply(s,Object(Nn.a)(u));for(var l=1+o.length;l<i.shape.length;++l)s.push([0,0]);var f=Hp.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:s,constantValue:0}}),d=a.backend_util.getReshaped(f.shape,o,c,!1),h=a.backend_util.getPermuted(d.length,o.length,!1),p=a.backend_util.getReshapedPermuted(f.shape,o,c,!1),v=Ql({inputs:{x:f},backend:n,attrs:{shape:d}}),m=df({inputs:{x:v},backend:n,attrs:{perm:h}}),b=Ql({inputs:{x:m},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),b}};function Av(e,t,n,r,i){for(var o=a.util.sizeFromShape(r),u=t[0],c=i.length,s=[],l=1,f=-1,d=0;d<c;++d){var h=i[d];if(-1===h){if(-1!==f)throw new Error("only one output dimension may be -1, not both ".concat(f," and ").concat(d));f=d,s.push(1)}else{if(h<0)throw new Error("size ".concat(d," must be non-negative, not ").concat(h));l*=h,s.push(h)}}if(-1!==f){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");var p=Math.trunc(o/l);if(l*p!==o)throw new Error("Input to reshape is a SparseTensor with ".concat(o,"\n          dense values, but the requested shape requires a multiple of ").concat(l,". inputShape=").concat(r," outputShape= ").concat(s));s[f]=p}var v=a.util.sizeFromShape(s);if(v!==o)throw new Error("Input to reshape is a tensor with ".concat(o," dense values, but the requested shape has ").concat(v,". inputShape=").concat(r," outputShape=").concat(s));var m=r.length,b=[];if(m>0){b[m-1]=1;for(var g=m-2;g>=0;--g)b[g]=b[g+1]*r[g+1]}var y=[];if(c>0){y[c-1]=1;for(var x=c-2;x>=0;--x)y[x]=y[x+1]*s[x+1]}for(var O=a.util.getArrayFromDType(n,u*c),k=0;k<u;++k){for(var w=0,j=0;j<m;++j)w+=e[k*m+j]*b[j];for(var _=0;_<c;++_)O[k*c+_]=Math.trunc(w/y[_]),w%=y[_]}return[O,[u,c],s]}var Nv={kernelName:a.SparseReshape,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,o=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));var u=Array.from(n.data.get(a.dataId).values),c=n.data.get(r.dataId).values,s=Array.from(n.data.get(o.dataId).values),l=Av(c,r.shape,r.dtype,u,s),f=Object(i.a)(l,3),d=f[0],h=f[1],p=f[2];return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([p.length],o.dtype,new Int32Array(p))]}};var Tv={kernelName:a.SparseToDense,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.sparseIndices,o=t.sparseValues,u=t.defaultValue,c=r.outputShape,s=a.backend_util.calculateShapes(o,i,c),l=s.sliceRank,f=s.numUpdates,d=s.sliceSize,h=s.strides,p=s.outputSize,v=dv(n.bufferSync(i),n.bufferSync(o),c,p,d,f,l,h,n.data.get(u.dataId).values[0],!1);return n.makeTensorInfo(c,v.dtype,v.values)}};var Iv={kernelName:a.SplitV,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.numOrSizeSplits,u=r.axis,c=a.util.parseAxisParam(u,i.shape)[0],s=a.backend_util.prepareSplitSize(i,o,c),l=new Array(i.shape.length).fill(0),f=i.shape.slice();return s.map((function(e){var t=Object(Nn.a)(f);t[c]=e;var r=Lf({inputs:{x:i},backend:n,attrs:{begin:l,size:t}});return l[c]+=e,r}))}},Dv=xl(a.Sqrt,(function(e){return Math.sqrt(e)})),Fv={kernelName:a.Sqrt,backendName:"cpu",kernelFunc:Dv},Mv={kernelName:a.Square,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;bl(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),u=0;u<i.length;++u){var c=i[u];o[u]=c*c}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Rv=Cl((function(e,t){var n=e-t;return n*n})),zv=Gl(a.SquaredDifference,Rv),Lv={kernelName:a.SquaredDifference,backendName:"cpu",kernelFunc:zv},Pv=xl(a.Step,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),Bv={kernelName:a.Step,backendName:"cpu",kernelFunc:Pv};function Wv(e,t,n,r){for(var i=Object(a.buffer)(e,t.dtype),o=0;o<i.size;o++){for(var u=i.indexToLoc(o),c=new Array(u.length),s=0;s<c.length;s++)c[s]=u[s]*n[s]+r[s];i.set.apply(i,[t.get.apply(t,c)].concat(Object(Nn.a)(u)))}return i}var Uv={kernelName:a.StridedSlice,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.begin,u=r.end,c=r.strides,s=r.beginMask,l=r.endMask,f=r.ellipsisMask,d=r.newAxisMask,h=r.shrinkAxisMask;bl(i,"stridedSlice");var p,v=a.slice_util.sliceInfo(i.shape,o,u,c,s,l,f,d,h),m=v.nonStrided,b=v.$begin,g=v.$strides,y=v.size,x=v.newShape,O=v.outShape,k=Ql({inputs:{x:i},backend:n,attrs:{shape:x}});if(m){var w=Lf({inputs:{x:k},backend:n,attrs:{begin:b,size:y}});p=Ql({inputs:{x:w},backend:n,attrs:{shape:O}}),n.disposeIntermediateTensorInfo(w)}else if(O.some((function(e){return 0===e})))p=n.makeTensorInfo(O,i.dtype,[]);else{var j=Wv(O,n.bufferSync(k),g,b);p=n.makeTensorInfo(j.shape,j.dtype,j.values)}var _=Ql({inputs:{x:p},backend:n,attrs:{shape:O}});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(p),_}},Vv=xl(a.Tan,(function(e){return Math.tan(e)})),qv={kernelName:a.Tan,backendName:"cpu",kernelFunc:Vv},Hv=xl(a.Tanh,(function(e){return Math.tanh(e)})),Gv={kernelName:a.Tanh,backendName:"cpu",kernelFunc:Hv};function Kv(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var i=Object(a.buffer)(n,e.dtype),o=0;o<i.values.length;++o){for(var u=i.indexToLoc(o),c=new Array(e.rank),s=0;s<c.length;s++)c[s]=u[s]%e.shape[s];var l=e.locToIndex(c);i.values[o]=e.values[l]}return i}var Xv={kernelName:a.Tile,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;bl(a,"tile");var o=Kv(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}};function Yv(e,t,n,r,i){for(var o=t[t.length-1],u=e.length/o,c=o,s=a.util.getTypedArrayFromDType(n,u*r),l=a.util.getTypedArrayFromDType("int32",u*r),f=0;f<u;f++){for(var d=f*c,h=e.subarray(d,d+c),p=[],v=0;v<h.length;v++)p.push({value:h[v],index:v});p.sort((function(e,t){return t.value-e.value}));for(var m=f*r,b=s.subarray(m,m+r),g=l.subarray(m,m+r),y=0;y<r;y++)b[y]=p[y].value,g[y]=p[y].index}var x=t.slice();return x[x.length-1]=r,[Object(a.buffer)(x,n,s),Object(a.buffer)(x,"int32",l)]}var $v={kernelName:a.TopK,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.k;r.sorted,bl(a,"topk");var u=Yv(n.data.get(a.dataId).values,a.shape,a.dtype,o),c=Object(i.a)(u,2),s=c[0],l=c[1];return[n.makeTensorInfo(s.shape,s.dtype,s.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}};var Jv={kernelName:a.Transform,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,o=t.image,u=t.transforms,c=n.interpolation,s=n.fillMode,l=n.fillValue,f=n.outputShape,d=Object(i.a)(o.shape,4),h=d[0],p=d[1],v=d[2],m=d[3],b=null!=f?f:[p,v],g=Object(i.a)(b,2),y=g[0],x=g[1],O=[h,y,x,m],k=a.util.computeStrides(o.shape),w=k[0],j=k[1],_=k[2],S=a.util.getTypedArrayFromDType(o.dtype,a.util.sizeFromShape(O));S.fill(l);for(var E=r.data.get(o.dataId).values,C=r.data.get(u.dataId).values,A=0;A<h;++A){for(var N=1===u.shape[0]?C:C.subarray(8*A,8*A+8),T=0;T<y;++T)for(var I=0;I<x;++I)for(var D=0;D<m;++D){var F=void 0,M=N[6]*I+N[7]*T+1;if(0!==M){var R=(N[0]*I+N[1]*T+N[2])/M,z=(N[3]*I+N[4]*T+N[5])/M,L=Qv(R,v,s),P=Qv(z,p,s);switch(c){case"nearest":F=em(E,p,v,w,j,_,A,P,L,D,l);break;case"bilinear":F=tm(E,p,v,w,j,_,A,P,L,D,l);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(c))}S[A*w+T*j+I*_+D]=F}}return r.makeTensorInfo(O,o.dtype,S)}return{dataId:r.write(S,O,o.dtype),shape:o.shape,dtype:o.dtype}}};function Qv(e,t,n){switch(n){case"reflect":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{var i=2*t;(n-=i*Math.trunc(n/i))>=t&&(n=i-n-1)}return a.util.clamp(0,n,t-1)}(e,t);case"wrap":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{var i=t-1;n-=t*Math.trunc(n/i)}return a.util.clamp(0,n,t-1)}(e,t);case"nearest":return function(e,t){return a.util.clamp(0,e,t-1)}(e,t);case"constant":default:return function(e,t){return e}(e)}}function Zv(e,t,n,r,a,i,o,u,c,s,l){return 0<=u&&u<t&&0<=c&&c<n?e[o*r+u*a+c*i+s]:l}function em(e,t,n,r,a,i,o,u,c,s,l){return Zv(e,t,n,r,a,i,o,Math.round(u),Math.round(c),s,l)}function tm(e,t,n,r,a,i,o,u,c,s,l){var f=Math.floor(u),d=Math.floor(c),h=f+1,p=d+1;return(h-u)*((p-c)*Zv(e,t,n,r,a,i,o,f,d,s,l)+(c-d)*Zv(e,t,n,r,a,i,o,f,p,s,l))+(u-f)*((p-c)*Zv(e,t,n,r,a,i,o,h,d,s,l)+(c-d)*Zv(e,t,n,r,a,i,o,h,p,s,l))}function nm(e,t,n,r){for(var i=a.util.parseAxisParam(t,n)[0],o=[1,n[0],1],u=0;u<i;u++)o[0]*=n[u];o[1]=n[i];for(var c=i+1;c<n.length;c++)o[2]*=n[c];for(var s={},l=new Int32Array(n[i]),f=new a.TensorBuffer(o,r,e),d=[],h=1===o[0]&&1===o[2],p=0;p<n[i];p++){var v=void 0;if(h)v=e[p].toString();else{for(var m=[],b=0;b<o[0];b++)for(var g=0;g<o[2];g++)m.push(f.get(b,p,g));v=m.join(",")}if(void 0!==s[v])l[p]=s[v];else{var y=Object.keys(s).length;s[v]=y,l[p]=y,d.push(p)}}var x=o.slice();x[1]=Object.keys(s).length;var O=new a.TensorBuffer(x,r);d.forEach((function(e,t){for(var n=0;n<o[0];n++)for(var r=0;r<o[2];r++)O.set(f.get(n,e,r),n,t,r)}));var k=n.slice();return k[i]=x[1],{outputValues:O.values,outputShape:k,indices:l}}var rm={kernelName:a.Unique,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;bl(i,"unique");var o=nm(r.data.get(i.dataId).values,a,i.shape,i.dtype),u=o.outputValues,c=o.outputShape,s=o.indices;return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([s.length],"int32",s)]}};var am={kernelName:a.Unpack,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,u=a.shape[i],c=new Array(o-1),s=0,l=0;l<o;l++)l!==i&&(c[s++]=a.shape[l]);var f=new Array(o).fill(0),d=a.shape.slice();d[i]=1;for(var h=new Array(u),p=0;p<h.length;p++){f[i]=p;var v=Lf({inputs:{x:a},backend:n,attrs:{begin:f,size:d}});h[p]=Ql({inputs:{x:v},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(v)}return h}};for(var im={kernelName:a.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.segmentIds,u=r.numSegments;bl(i,"unsortedSegmentSum");for(var c=[],s=[],l=i.shape.length-o.shape.length,f=o,d=0;d<l;++d){var h=Kd({inputs:{input:f},backend:n,attrs:{dim:d+1}});f=h,s.push(h)}for(var p=0;p<u;++p){var v=a.util.createScalarValue(p,"int32"),m=n.makeTensorInfo([],"int32",v),b=Fd({inputs:{a:m,b:f},backend:n}),g=ql({inputs:{x:b},backend:n,attrs:{dtype:"float32"}}),y=Ed({inputs:{a:g,b:i},backend:n}),x=Ad({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});c.push(x),s.push(m),s.push(b),s.push(g),s.push(y),s.push(x)}var O=Vp({inputs:c,backend:n,attrs:{axis:0}});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),O}},om=0,um=[nf,af,uf,sf,Jl,lf,pf,vf,mf,bf,yf,Of,wf,Sf,Cf,If,Df,Ff,Mf,tf,Rf,Bf,Vf,Hl,Kf,Yf,Bl,$f,td,ad,id,rd,ud,cd,od,ld,dd,hd,pd,vd,md,gd,yd,xd,Od,kd,jd,wd,eh,Td,wl,Id,Md,Vd,Gd,Xd,Jd,ch,lh,fh,ph,bh,gh,yh,xh,kh,_h,Ch,_l,Ah,Zf,Th,Dh,Mh,El,Lh,Wh,Vh,Gh,Xh,Jh,Zh,np,rp,ap,lp,fp,dp,hp,pp,vp,up,mp,bp,xp,Op,jp,Ep,Cd,Ap,Tp,Dp,Mp,Lp,Pp,Up,qp,Hp,Xp,Tl,$p,Qp,Vl,ev,Dl,Ml,Zl,tv,nv,rv,av,iv,ov,cv,fv,hv,pv,gv,zl,xv,kv,jv,Pf,Sp,Ev,Cv,Nv,Tv,Iv,Fv,Mv,Lv,Bv,Uv,ah,Nd,qv,Gv,Xv,$v,hf,Jv,rm,am,im,Wp];om<um.length;om++){var cm=um[om];Object(a.registerKernel)(cm)}var sm,lm,fm,dm={},hm={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function pm(e){if(!(e in dm)){var t=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);if(t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete dm[e]}),!1),1===e)return t.getContext("webgl",hm)||t.getContext("experimental-webgl",hm);return t.getContext("webgl2",hm)}(e);if(null===t)return console.log("Could not get context for WebGL version",e),null;dm[e]=t}var n=dm[e];return n.isContextLost()?(delete dm[e],pm(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),dm[e])}function vm(e,t){return[t,e]}function mm(e){var t=a.util.sizeFromShape(e),n=Math.ceil(t/4);return a.util.sizeToSquarishShape(n)}function bm(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function gm(e,t){var n,r,i,o,u,c,s,l,f,d=e;return 2===Object(a.env)().getNumber("WEBGL_VERSION")?(n=d.R32F,r=d.R16F,i=d.RGBA16F,o=d.RGBA32F,u=d.RED,c=4,s=1,l=d.HALF_FLOAT,f=d.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,o=d.RGBA,u=e.RGBA,c=4,s=4,l=null!=t?t.HALF_FLOAT_OES:null,f=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:u,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:c,defaultNumChannels:s,textureTypeHalfFloat:l,textureTypeFloat:f}}function ym(e,t){var n=t();return Object(a.env)().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(sm||(sm={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(lm||(lm={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(fm||(fm={}));function xm(e){return!!(Object(a.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function Om(e,t){return Fm(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function km(e,t){var n=Fm(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(ym(e,(function(){return e.shaderSource(n,t)})),ym(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=_m.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],i=e.split("\n"),o=i.length.toString().length+2,u=i.map((function(e,t){return a.util.rightPad((t+1).toString(),o)+e})),c=0,s=0;s<u.length;s++)c=Math.max(u[s].length,c);var l=u.slice(0,r-1),f=u.slice(r-1,r),d=u.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(a.util.rightPad(f[0],c)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var wm,jm,_m=/ERROR: [0-9]+:([0-9]+):/g;function Sm(e,t){if(ym(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Em(e,t,n,r,a,i,o){var u=e.getAttribLocation(t,n);return-1!==u&&(ym(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),ym(e,(function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,i,o)})),ym(e,(function(){return e.enableVertexAttribArray(u)})),!0)}function Cm(e,t,n){return Fm(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function Am(e,t,n){return e.getUniformLocation(t,n)}function Nm(e,t,n,r){ym(e,(function(){return function(e,t,n){Mm(e,n),ym(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),ym(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),ym(e,(function(){return e.uniform1i(n,r)}))}function Tm(e,t,n){ym(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),ym(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function Im(e,t){ym(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),ym(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function Dm(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function Fm(e,t,n){var r=ym(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function Mm(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function Rm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return a.util.sizeFromShape(e.slice(0,e.length-t))}function zm(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Lm(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Rm(e)].concat(Object(Nn.a)(zm(e)))),t}function Pm(e){return e%2===0}function Bm(e,t){if(e=e.slice(-2),t=t.slice(-2),a.util.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(Pm(n)&&Pm(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&Pm(e[0])&&Pm(t[0])}function Wm(e,t){return null!=e.getExtension(t)}function Um(e){try{if(null!=pm(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function Vm(e){if(0===e)return!1;var t=pm(e);if(1!==e){if(Wm(t,"EXT_color_buffer_float"))return qm(t);var n="EXT_color_buffer_half_float";if(Wm(t,n)){var r=t.getExtension(n);return function(e,t){var n=gm(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var u=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),u}(t,r)}return!1}return!!Wm(t,"OES_texture_float")&&(!!Wm(t,"WEBGL_color_buffer_float")&&qm(t))}function qm(e){var t=gm(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function Hm(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&a.util.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var Gm=Object(a.env)();function Km(){var e,t,n,r,i,o,u,c,s,l;return 2===Object(a.env)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",i="texture",o="outputColor",u="out vec4 outputColor;",c="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",s="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",u="",c="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",s="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:u,defineSpecialNaN:c,defineSpecialInf:s,defineRound:l}}function Xm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=a.util.computeStrides(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function Ym(e){var t=a.util.computeStrides(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}Gm.registerFlag("HAS_WEBGL",(function(){return Gm.getNumber("WEBGL_VERSION")>0})),Gm.registerFlag("WEBGL_VERSION",(function(){return Um(2)?2:Um(1)?1:0})),Gm.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),Gm.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Gm.get("WEBGL_VERSION")})),Gm.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Gm.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Gm.registerFlag("WEBGL_PACK",(function(){return Gm.getBool("HAS_WEBGL")})),Gm.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_PACK_CLIP",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_PACK_REDUCE",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_CONV_IM2COL",(function(){return Gm.getBool("WEBGL_PACK")})),Gm.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==wm){var t=pm(e);wm=t.getParameter(t.MAX_TEXTURE_SIZE)}return wm}(Gm.getNumber("WEBGL_VERSION"))})),Gm.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==jm){var t=pm(e);jm=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,jm)}(Gm.getNumber("WEBGL_VERSION"))})),Gm.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=Gm.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=pm(e);return Wm(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Wm(t,"EXT_disjoint_timer_query")?1:0}(e)})),Gm.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Gm.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!a.device_util.isMobile()})),Gm.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=pm(e);if(1===e){if(!Wm(t,"OES_texture_float"))return!1}else if(!Wm(t,"EXT_color_buffer_float"))return!1;return qm(t)}(Gm.getNumber("WEBGL_VERSION"))})),Gm.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Gm.getBool("WEBGL_FORCE_F16_TEXTURES")&&Gm.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Gm.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Vm(Gm.getNumber("WEBGL_VERSION"))})),Gm.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=Gm.getNumber("WEBGL_VERSION"))&&null!=pm(e).fenceSync;var e})),Gm.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Gm.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Gm.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),Gm.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return a.device_util.isMobile()&&Gm.getBool("IS_CHROME")?1:-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))}));var $m="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",Jm=function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=sm.DENSE;var n=mm(t),r=Km();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(Xm(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},Qm=function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=sm.DENSE;var n=mm(t),r=Km();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(Xm(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},Zm=function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.outTexUsage=lm.DOWNLOAD;var n=Km();this.outputShape=t,this.userCode="\n      ".concat($m,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},eb=function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=lm.DOWNLOAD;var n=Km();this.outputShape=t,this.userCode="\n      ".concat($m,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},tb=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(_n.a)(this,e),this.variableNames=["A"];var a=Km(),o=Object(i.a)(n,2),u=o[0],c=o[1];this.outputShape=t;var s="result";r&&(s="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(Ym(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(c,";\n        int c = imod(flatIndex, ").concat(c,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(c,".0, ").concat(u,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(s,", 0., 0., 0.);\n      }\n    ")},nb=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=Km(),o=Object(i.a)(n,2),u=o[0],c=o[1];this.outputShape=t;var s="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var f=0;f<=1;f++)for(var d=0;d<=1;d++){var h=2*f+d;s+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(d," < ").concat(t[2],") {\n            localCoords[2] += ").concat(d,";\n            if(localCoords[1] + ").concat(f," < ").concat(t[1],") {\n              localCoords[1] += ").concat(f,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(c,";\n              c = imod(flatIndex, ").concat(c,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(c,".0, ").concat(u,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(h,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(h,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(h,"] = values[2];\n              } else {\n                result[").concat(h,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(Ym(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(s,"\n\n        ").concat(a.output," = ").concat(l,";\n      }\n    ")};function rb(e){var t=Km();return function(e,t){var n=Fm(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(ym(e,(function(){return e.shaderSource(n,t)})),ym(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function ab(e){return function(e,t){var n=Fm(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return ym(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),ym(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function ib(e){return function(e,t){var n=Fm(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return ym(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),ym(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function ob(e,t,n,r,i,o){!function(e,t){var n=Object(a.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var i="[".concat(e,"x").concat(t,"]"),o="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+i+" greater than WebGL maximum on this browser / GPU "+o+".")}}(t,n);var u=function(e){return Fm(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),c=e.TEXTURE_2D;return ym(e,(function(){return e.bindTexture(c,u)})),ym(e,(function(){return e.texParameteri(c,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),ym(e,(function(){return e.texParameteri(c,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),ym(e,(function(){return e.texParameteri(c,e.TEXTURE_MIN_FILTER,e.NEAREST)})),ym(e,(function(){return e.texParameteri(c,e.TEXTURE_MAG_FILTER,e.NEAREST)})),ym(e,(function(){return e.texImage2D(c,0,r,t,n,0,i,o,null)})),ym(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),u}function ub(e){return e.internalFormatFloat}function cb(e){return e.internalFormatHalfFloat}function sb(e){return e.downloadTextureFormat}function lb(e){return e.internalFormatPackedFloat}function fb(e){return e.internalFormatPackedHalfFloat}function db(e,t,n,r,a,o,u,c){var s=e,l=new Float32Array(function(e,t){var n=bm(e,t),r=Object(i.a)(n,2);return r[0]*r[1]*4}(o,u));return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,l),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),l}var hb=function(){function e(t){Object(_n.a)(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Object(a.env)().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){dm[e]=t}(n,t)):this.gl=pm(n);var r="WEBGL_color_buffer_float",i="EXT_color_buffer_half_float";if(1===Object(a.env)().getNumber("WEBGL_VERSION")){var o="OES_texture_half_float";if(this.textureFloatExtension=Om(this.gl,"OES_texture_float"),Wm(this.gl,o))this.textureHalfFloatExtension=Om(this.gl,o);else if(Object(a.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Wm(this.gl,i))this.colorBufferHalfFloatExtension=Om(this.gl,i);else if(Object(a.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Wm(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Wm(this.gl,i))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(i)}this.vertexBuffer=ab(this.gl),this.indexBuffer=ib(this.gl),this.framebuffer=function(e){return Fm(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=gm(this.gl,this.textureHalfFloatExtension)}return Object(Sn.a)(e,[{key:"debug",get:function(){return Object(a.env)().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;ym(t,(function(){return t.finish()})),ym(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),ym(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),ym(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),ym(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),ym(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=vm(t,n),o=Object(i.a)(a,2);return ob(e,o[0],o[1],ub(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=vm(t,n),o=Object(i.a)(a,2);return ob(e,o[0],o[1],cb(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=vm(t,n),o=Object(i.a)(a,2);return ob(e,o[0],o[1],sb(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){ym(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?ym(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):ym(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),ym(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,u,c;ym(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(o=new Float32Array(n*r*4),u=e.FLOAT,c=i.internalFormatPackedFloat),o.set(a),ym(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,c,n,r,0,e.RGBA,u,o)})),ym(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=bm(t,n),o=Object(i.a)(a,2);return ob(e,o[0],o[1],fb(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=bm(t,n),o=Object(i.a)(a,2);return ob(e,o[0],o[1],lb(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(Im(this.gl,this.framebuffer),this.outputTexture=null),ym(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=vm(t,n),o=Object(i.a)(a,2),u=o[0],c=o[1],s=new Uint8Array(t*n*4);return ym(e,(function(){return e.readPixels(0,0,u,c,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return db(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();ym(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return ym(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),ym(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),ym(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(Object(a.env)().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=i.clientWaitSync(o,0,0);return e===i.ALREADY_SIGNALED||e===i.CONDITION_SATISFIED},t=o}else Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return ym(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){this.throwIfDisposed();var t=this.gl,n=km(t,e),r=rb(t),a=function(e){return Fm(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(t);return ym(t,(function(){return t.attachShader(a,r)})),ym(t,(function(){return t.attachShader(a,n)})),function(e,t){if(ym(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,a),this.debug&&Sm(t,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(e,t,n){return ym(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),Em(e,t,"clipSpacePos",n,3,20,0)&&Em(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&ym(this.gl,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&Sm(this.gl,this.program),ym(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?Cm(this.gl,e,t):Am(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),ym(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Nm(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=bm(t,n),a=Object(i.a)(r,2),o=a[0],u=a[1];this.setOutputMatrixTextureDriver(e,o,u)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&Sm(this.gl,this.program),Dm(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),ym(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),ym(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Om(this.gl,2===Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i}},{key:"endQuery",value:function(){if(2!==Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){var n=this;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.util.repeatedTry((function(){return n.disposed||n.isQueryAvailable(t,Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||a.util.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),Tm(this.gl,e,this.framebuffer),this.debug&&Dm(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(Tm(this.gl,this.outputTexture,this.framebuffer),this.debug&&Dm(this.gl)):Im(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;Tm(r,e,this.framebuffer),this.debug&&Dm(r),this.outputTexture=e,ym(r,(function(){return r.viewport(0,0,t,n)})),ym(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),ym(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var pb=a.backend_util.getBroadcastDims;function vb(e,t,n,r){var i=[];e.forEach((function(e){var t=a.util.sizeFromShape(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?i.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(i.push("uniform sampler2D ".concat(e.name,";")),i.push("uniform int offset".concat(e.name,";")))}));var o,u,c=i.join("\n"),s=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";r+=n?bb(e):mb(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;a.length<=i.length&&(r+=n?jb(e,t):_b(e,t));return r}(e,t,r)})).join("\n"),l=t.texShape,f=Km(),d=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(f),h=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(gb,"\n    ").concat(yb,"\n    ").concat(xb,"\n  ")}(f);return t.isPacked?(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===n[0])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    ");if(1===n[1])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(a.util.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",u="b, r, c",c=2;c<e.length-1;c++)i*=e[e.length-c-1],o="\n      int b".concat(c," = index / ").concat(i,";\n      index -= b").concat(c," * ").concat(i,";\n    ")+o,u="b".concat(c,", ")+u;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(u,");\n    }\n  ")}(e,t)}}(t.logicalShape,l),u=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(f)):(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){if(1===t[0])return"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t);case 2:return function(e,t){if(a.util.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=Xm(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=Xm(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=Xm(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=Xm(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,l),u=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(f)),r&&(h+=Ob),[h,d,u,c,o,s,n].join("\n")}function mb(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=Object(i.a)(e.shapeInfo.texShape,2),a=r[0],o=r[1];if(1===a&&1===o)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var u=Object(i.a)(e.shapeInfo.texShape,2),c=u[0],s=u[1],l=kb(t);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(s,", ").concat(l,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(wb(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=kb(t);if(1===i)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(1===a)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");return"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape;if(null!=i&&a.util.arraysEqual(t,i)){var o=i[0],u=i[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}var c=a.util.squeezeShape(t),s=c.newShape,l=c.keptDims,f=s;if(f.length<t.length){var d=Eb(e,f),h=["row","col"];return"\n      ".concat(mb(d),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(Cb(h,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(wb(e),"\n      }\n    ");var p=i[0],v=i[1],m=kb(n);if(1===v)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(p,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");if(1===p)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(v,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(m,";\n    vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[1]*t[2],o=t[2],u=a.util.squeezeShape(t),c=u.newShape,s=u.keptDims,l=c;if(l.length<t.length){var f=Eb(e,l),d=["row","col","depth"];return"\n        ".concat(mb(f),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(Cb(d,s),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(wb(e),"\n      }\n    ");var h=e.shapeInfo.texShape,p=h[0],v=h[1],m=e.shapeInfo.flatOffset;if(v===i&&null==m)return"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(v,".0, ").concat(p,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(v===o&&null==m)return"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(v,".0, ").concat(p,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var b=kb(n);return"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(b,";\n        vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[3],o=t[2]*i,u=t[1]*o,c=a.util.squeezeShape(t),s=c.newShape,l=c.keptDims;if(s.length<t.length){var f=Eb(e,s),d=["row","col","depth","depth2"];return"\n      ".concat(mb(f),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(Cb(d,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(u,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(wb(e),"\n      }\n    ");var h=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],m=p[1];if(m===u&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===i&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var b=kb(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(m,", index + ").concat(b,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],o=t[3]*i,u=t[2]*o,c=t[1]*u,s=a.util.squeezeShape(t),l=s.newShape,f=s.keptDims;if(l.length<t.length){var d=Eb(e,l),h=["row","col","depth","depth2","depth3"];return"\n      ".concat(mb(d),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(Cb(h,f),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(u,", ").concat(o,", ").concat(i,")) +\n          depth3;\n        ").concat(wb(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,m=v[0],b=v[1];if(b===c&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(u,", ").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(b,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(b===i&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(b,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=kb(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(u," + depth * ").concat(o," +\n          depth2 * ").concat(i," + depth3 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(b,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=a.util.squeezeShape(t),o=i.newShape,u=i.keptDims;if(o.length<t.length){var c=Eb(e,o),s=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(mb(c),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(Cb(s,u),");\n      }\n    ")}var l=t[5],f=t[4]*l,d=t[3]*f,h=t[2]*d,p=t[1]*h;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(h,", ").concat(d,", ").concat(f,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(l,", 1)));\n        ").concat(wb(e),"\n      }\n    ");var v=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,b=m[0],g=m[1];if(g===p&&null==v)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(h,", ").concat(d,", ").concat(f,", ").concat(l,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(b,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===l&&null==v)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(b,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=kb(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(h," + depth * ").concat(d," +\n          depth2 * ").concat(f," + depth3 * ").concat(l," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(b,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function bb(e){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Km();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Km();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(i.texture2D,"(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,o=i[0],u=i[1],c=Km();if(null!=i&&a.util.arraysEqual(t,i))return"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n\n        return ").concat(c.texture2D,"(").concat(n,", uv);\n      }\n    ");var s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],l=Math.ceil(t[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(s[0],", ").concat(s[1],", row, col);\n      return ").concat(c.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0]){var o=[1,2],u=Eb(e,t.slice(1)),c=["b","row","col"];return"\n        ".concat(bb(u),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(Cb(c,o),");\n        }\n      ")}var s=i[0],l=i[1],f=Math.ceil(t[2]/2),d=f*Math.ceil(t[1]/2),h=Km();return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(s,", ").concat(l,", ").concat(d,", ").concat(f,", b, row, col);\n      return ").concat(h.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=o[0],c=o[1],s=Math.ceil(t[n-1]/2),l=s*Math.ceil(t[n-2]/2),f="int b, int row, int col",d="b * ".concat(l," + (row / 2) * ").concat(s," + (col / 2)"),h=2;h<n-1;h++)f="int b".concat(h,", ")+f,l*=t[n-h-1],d="b".concat(h," * ").concat(l," + ")+d;var p=Km();return"\n    vec4 ".concat(a,"(").concat(f,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(c,";\n      int texC = index - texR * ").concat(c,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(c,", ").concat(u,");\n      return ").concat(p.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e)}}var gb="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",yb="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",xb="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ob="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function kb(e){return"offset".concat(e)}function wb(e){var t=e.name,n=a.util.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function jb(e,t){var n,r=e.name,i=r.charAt(0).toUpperCase()+r.slice(1),o="get"+i+"AtOutCoords",u=e.shapeInfo.logicalShape.length,c=t.logicalShape.length,s=pb(e.shapeInfo.logicalShape,t.logicalShape),l=Sb(c),f=c-u,d=["x","y","z","w","u","v"];n=0===u?"":c<2&&s.length>=1?"coords = 0;":s.map((function(e){return"coords.".concat(d[e+f]," = 0;")})).join("\n");var h="";h=c<2&&u>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(d[t+f])})).join(", ");var p="return outputValue;",v=1===a.util.sizeFromShape(e.shapeInfo.logicalShape),m=1===a.util.sizeFromShape(t.logicalShape);if(1!==u||v||m){if(v&&!m)p=1===c?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){var b=u-2,g=u-1;s.indexOf(b)>-1&&s.indexOf(g)>-1?p="return vec4(outputValue.x);":s.indexOf(b)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(g)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(o,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(i,"(").concat(h,");\n      ").concat(p,"\n    }\n  ")}function _b(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.texShape,u=e.shapeInfo.texShape,c=e.shapeInfo.logicalShape.length,s=t.logicalShape.length;if(!e.shapeInfo.isUniform&&c===s&&null==e.shapeInfo.flatOffset&&a.util.arraysEqual(u,o))return"\n      float ".concat(i,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var l,f=Sb(s),d=pb(e.shapeInfo.logicalShape,t.logicalShape),h=s-c,p=["x","y","z","w","u","v"];l=0===c?"":s<2&&d.length>=1?"coords = 0;":d.map((function(e){return"coords.".concat(p[e+h]," = 0;")})).join("\n");var v="";return v=s<2&&c>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(p[t+h])})).join(", "),"\n    float ".concat(i,"() {\n      ").concat(f," coords = getOutputCoords();\n      ").concat(l,"\n      return get").concat(r,"(").concat(v,");\n    }\n  ")}function Sb(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function Eb(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Cb(e,t){return t.map((function(t){return e[t]})).join(", ")}function Ab(e,t,n,r){var i=t.userCode,o=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),u=o.map((function(e){return e.shapeInfo})),c={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=vb(o,c,i,t.packedInputs),l=e.createProgram(s),f=null,d=e.getUniformLocation(l,"NAN",!1);1===Object(a.env)().getNumber("WEBGL_VERSION")&&(f=e.getUniformLocation(l,"INFINITY",!1));for(var h={},p=0;p<t.variableNames.length;p++){var v=t.variableNames[p];h[v]=e.getUniformLocation(l,v,false),h["offset".concat(v)]=e.getUniformLocation(l,"offset".concat(v),false)}return{program:t,source:s,webGLProgram:l,uniformLocations:h,inShapeInfos:u,outShapeInfo:c,infLoc:f,nanLoc:d}}function Nb(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,i=t[n],o=i.shape;if(!a.util.arraysEqual(r,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(o," must match"));if(!e.isUniform||!i.isUniform){var u=e.texShape,c=i.isUniform?null:i.texData.texShape;if(!a.util.arraysEqual(u,c))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(u," and ").concat(c," must match"))}}))}function Tb(e,t,n,r,i){Nb(t.inShapeInfos,n),Nb([t.outShapeInfo],[r]);var o=r.texData.texture,u=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(o,u[0],u[1]):e.setOutputMatrixTexture(o,u[0],u[1]),e.setProgram(t.webGLProgram),1===Object(a.env)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var i=t.program.variableNames[r],o=t.uniformLocations[i],u=t.uniformLocations["offset".concat(i)];if(null!=o)if(n.isUniform)if(a.util.sizeFromShape(n.shape)<2)e.gl.uniform1f(o,n.uniformValues[0]);else{var c=n.uniformValues;c instanceof Float32Array||(c=new Float32Array(c)),e.gl.uniform1fv(o,c)}else null!=n.texData.slice&&null!=u&&e.gl.uniform1i(u,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,o,r)})),null!=i&&i(e,t.webGLProgram),e.executeProgram()}function Ib(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(n,"_").concat(t)}));var a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a}var Db=Xl,Fb=Wf,Mb=Uf,Rb=Hf,zb=Jf,Lb=qd,Pb=Yd,Bb=dh,Wb=Oh,Ub=wh,Vb=Rh,qb=Uh,Hb=qh,Gb=ip,Kb=cp,Xb=gp,Yb=_d,$b=Cp,Jb=Yp,Qb=Jp,Zb=sv,eg=rf,tg=zf,ng=Av,rg=Wv,ag=th,ig=Kv,og=Yv,ug=ff,cg=nm;function sg(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function lg(e,t){return 1===t?[e]:sg(e,t)}var fg=function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=lg("rc",n),a=Sb(n),i=function(e,t,n){if(1===e)return"rc > ".concat(t[0]);for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),o=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),u=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),o=2;o<e;o++)i="".concat(t[t.length-1-o],",")+i;n.push(i)}return n}(n,t);if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0");return"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(i,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(u,"));\n          }\n        }\n      ")}};var dg=function e(t,n){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e){var t=Xm(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t,"\n      return ivec3(r, c, d);\n    }\n  ")}(n),"\n      ").concat(Ym(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")};var hg=function(){function e(t){Object(_n.a)(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return Object(Sn.a)(e,[{key:"acquireTexture",value:function(e,t,n){var r=vg(t,n),a=mg(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=pg(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var u=this.freeTextures[a].shift();return this.usedTextures[a].push(u),u}return r===fm.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===fm.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===fm.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===fm.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===fm.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var i=vg(n,r),o=mg(t,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);var u=pg(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),c=Object(a.env)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==c&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=u):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=u),this.numUsedTextures--;var s=this.usedTextures[o],l=s.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(l,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function pg(e,t,n,r,a){var o,u=function(e,t){switch(e){case fm.PACKED_2X2_FLOAT32:return lb(t);case fm.PACKED_2X2_FLOAT16:return fb(t);case fm.UNPACKED_FLOAT32:return ub(t);case fm.UNPACKED_FLOAT16:return cb(t);case fm.PACKED_4X1_UNSIGNED_BYTE:return sb(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var c=bm(e[0],e[1]),s=Object(i.a)(c,2);o=s[0]*s[1]}else{var l=vm(e[0],e[1]),f=Object(i.a)(l,2);o=f[0]*f[1]}return o*function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(t))}(n,u)}function vg(e,t){if(e===lm.UPLOAD)return fm.PACKED_2X2_FLOAT32;if(e===lm.RENDER||null==e)return function(e){return Object(a.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?fm.PACKED_2X2_FLOAT32:fm.UNPACKED_FLOAT32:e?fm.PACKED_2X2_FLOAT16:fm.UNPACKED_FLOAT16}(t);if(e===lm.DOWNLOAD||e===lm.PIXELS)return fm.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function mg(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var bg=function e(t,n){Object(_n.a)(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},gg="if (isnan(x)) return x;",yg="return x;",xg="return abs(x);";var Og="return (x >= 0.0) ? x : (exp(x) - 1.0);",kg=gg+"\n  return (x < 0.0) ? 0.0 : x;\n",wg=gg+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",jg="return x;",_g="return 1.0 / (1.0 + exp(-1.0 * x));",Sg="return x;",Eg="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Cg="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Ag="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Ng="return 1.0 / (1.0 + exp(-1.0 * x));",Tg=function e(t,n){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},Ig=function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=lg("rc",n),a=Sb(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),u=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(u,"));\n      }\n    ")},Dg=a.kernel_impls.whereImpl,Fg={};var Mg=function(e){Object(En.a)(n,e);var t=Object(Cn.a)(n);function n(e){var r,i;if(Object(_n.a)(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!Object(a.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var o=pm(Object(a.env)().getNumber("WEBGL_VERSION"));r.binaryCache=((i=Object(a.env)().getNumber("WEBGL_VERSION"))in Fg||(Fg[i]={}),Fg[i]),r.gpgpu=new hb(o),r.canvas=o.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new hg(r.gpgpu),r.numMBBeforeWarning=null==Object(a.env)().global.screen?1024:Object(a.env)().global.screen.height*Object(a.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new a.DataStorage(Object(In.a)(r),Object(a.engine)()),r}return Object(Sn.a)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"write",value:function(e,t,n){if((Object(a.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Object(a.env)().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:lm.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,i){if(Object(a.env)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:lm.UPLOAD,refCount:i})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,i=t.complexTensorInfos,o=t.slice,u=t.shape,c=t.isPacked;if(null!=o){var s;s=c?new Tg(u,jg):new bg(u,jg);var l=this.runWebGLProgram(s,[{dataId:e,shape:u,dtype:r}],r),f=this.readSync(l.dataId);return this.disposeIntermediateTensorInfo(l),f}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var d,h,p=null!=this.activeTimers;if(p&&(d=a.util.now()),"complex64"===r){var v=this.readSync(i.real.dataId),m=this.readSync(i.imag.dataId);h=a.backend_util.mergeRealAndImagArrays(v,m)}else h=this.getValuesFromTexture(e);return p&&(this.downloadWaitMs+=a.util.now()-d),this.convertAndCacheOnCPU(e,h)}},{key:"read",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){var n,r,i,o,u,c,s,l,f,d,h,p,v,m,b,g,y,x,O,k,w,j;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),i=r.values,o=r.shape,u=r.slice,c=r.dtype,s=r.complexTensorInfos,l=r.isPacked,null==u){e.next=11;break}return f=l?new Tg(o,jg):new bg(o,jg),d=this.runWebGLProgram(f,[{dataId:t,shape:o,dtype:c}],c),h=this.read(d.dataId),this.disposeIntermediateTensorInfo(d),e.abrupt("return",h);case 11:if(null==i){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(Object(a.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==Object(a.env)().getNumber("WEBGL_VERSION")){e.next=15;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 15:if(p=null,"complex64"!==c&&Object(a.env)().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(t),b=this.texData.get(v.dataId),p=(m=this.gpgpu).createBufferFromTexture.apply(m,[b.texture].concat(Object(Nn.a)(mm(o))))),this.pendingRead.set(t,[]),"complex64"===c){e.next=21;break}return e.next=21,this.gpgpu.createAndWaitForFence();case 21:if("complex64"!==c){e.next=30;break}return e.next=24,Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]);case 24:y=e.sent,x=y[0],O=y[1],g=a.backend_util.mergeRealAndImagArrays(x,O),e.next=31;break;case 30:null==p?g=this.getValuesFromTexture(t):(k=a.util.sizeFromShape(o),g=this.gpgpu.downloadFloat32MatrixFromBuffer(p,k));case 31:return null!=v&&this.disposeIntermediateTensorInfo(v),w=this.convertAndCacheOnCPU(t,g),j=this.pendingRead.get(t),this.pendingRead.delete(t),j.forEach((function(e){return e(w)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Object(a.engine)().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",w);case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return a.util.decodeString(e)}))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(a.buffer)(e.shape,e.dtype,n)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!xm(n)){if(Object(a.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,i=t.isPacked,o=a.util.sizeFromShape(n);if(Object(a.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u,c=this.decode(e),s=this.texData.get(c.dataId),l=(u=this.gpgpu).downloadMatrixFromPackedTexture.apply(u,[s.texture].concat(Object(Nn.a)(mm(n)))).subarray(0,o);return this.disposeIntermediateTensorInfo(c),l}var f=Object(a.env)().getBool("WEBGL_PACK")&&!0===i,d=f?Lm(n):n,h=f?new eb(d):new Zm(d),p=this.runWebGLProgram(h,[{shape:d,dtype:r,dataId:e}],"float32"),v=this.texData.get(p.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(p),m}},{key:"timerAvailable",value:function(){return Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){var n,r,i,o,u,c,s;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeTimers,r=[],i=!1,null==this.programTimersStack?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,t(),o=a.util.flatten(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),u=a.util.flatten(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,i&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=19;break}return e.next=14,Promise.all(o);case 14:s=e.sent,c.kernelMs=a.util.sum(s),c.getExtraProfileInfo=function(){return s.map((function(e,t){return{name:u[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=20;break;case 19:c.kernelMs={error:"WebGL query timers are not supported in this environment."};case 20:return this.uploadWaitMs=0,this.downloadWaitMs=0,e.abrupt("return",c);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:a.util.now(),endMs:null}}},{key:"endTimer",value:function(e){return Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=a.util.now(),e)}},{key:"getQueryTime",value:function(){var e=Object(Xa.a)(Ka.a.mark((function e(t){var n;return Ka.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object(a.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e),r=n.complexTensorInfos;return null!=r&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,u=t.slice,c=u&&u.origDataId||e,s=this.dataRefCount.get(c);s>1?this.dataRefCount.set(c,s-1):(this.dataRefCount.delete(c),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128;return Object(a.env)().getBool("WEBGL_CPU_FORWARD")&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&a.util.sizeFromShape(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){a.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return Dg(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new Tg(e.shape,t),i=this.compileAndRun(r,[e],n);return Object(a.engine)().makeTensorFromDataId(i.dataId,i.shape,i.dtype)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=eg(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Object(a.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,xg,e.dtype);var n=new bg(e.shape,xg),r=this.compileAndRun(n,[e]);return Object(a.engine)().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&a.util.isString(n[0])){var i=n.map((function(e){return a.util.encodeString(e)}));r=this.write(i,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){var r=this.makeTensorInfo(e,t,n).dataId;return Object(a.engine)().makeTensorFromDataId(r,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new Ig(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new fg(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[Rm(e.shape)].concat(Object(Nn.a)(zm(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[Rm(t)].concat(Object(Nn.a)(zm(t))),i=new dg(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=Lm(a);t=r?new Qm(o):new Jm(o);return{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var i=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=this.makeTensorInfo(e.outputShape,n),c=this.texData.get(u.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===sm.DENSE){var s=mm(e.outputShape);c.texShape=s.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(c.usage=e.outTexUsage),0===a.util.sizeFromShape(u.shape))return c.values=a.util.getTypedArrayFromDType(u.dtype,0),u;var l=[],f=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&a.util.sizeFromShape(t.shape)<=Object(a.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!==!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),l.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!Bm(n.shape,t.shape)){var r=t,o=t.shape;t.shape=n.shape,t=i.packedReshape(t,o),l.push(t),n=i.texData.get(t.dataId),r.shape=o}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(u.dataId);var d,h={shape:u.shape,texData:c,isUniform:!1},p=Ib(e,f,h),v=this.getAndSaveBinary(p,(function(){return Ab(i.gpgpu,e,f,h)})),m=null!=this.activeTimers;m&&(d=this.startTimer()),Tb(this.gpgpu,v,f,h,r),l.forEach((function(e){return i.disposeIntermediateTensorInfo(e)})),m&&(d=this.endTimer(d),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(d)}));var b=Object(a.env)().get("WEBGL_FLUSH_THRESHOLD");if(b>0){var g=a.util.now();g-this.lastGlFlushTime>b&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!Object(a.env)().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&!1===o){var y=this.unpackTensor(u);return this.disposeIntermediateTensorInfo(u),y}return u}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return i}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!Object(a.env)().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(a.tidy)((function(){if(!Object(a.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=Object(a.env)().getBool("DEBUG");Object(a.env)().set("DEBUG",!1);var n=e.abs(Object(a.scalar)(1e-8)).dataSync()[0];if(Object(a.env)().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,o=t.values,u=t.texture,c=t.usage,s=t.isPacked;if(null==u){var l,f=null!=this.activeTimers;f&&(l=a.util.now());var d=t.texShape;if(null==d&&(d=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(a.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?a.util.nearestLargerEven(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var r=a.util.squeezeShape(e);e=r.newShape}var o=a.util.sizeFromShape(e);if(e.length<=1&&o<=n)return[1,o];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var u=Rm(e),c=2,s=2;if(e.length){var l=zm(e),f=Object(i.a)(l,2);c=f[0],s=f[1]}return o=u*(c/2)*(s/2),a.util.sizeToSquarishShape(o).map((function(e){return 2*e}))}return a.util.sizeToSquarishShape(o)}(n,s),t.texShape=d),null!=o){var h,p=Lm(n),v=d[1],m=d[0],b=o instanceof Uint8Array;if(s){var g=bm(d[0],d[1]),y=Object(i.a)(g,2);v=y[0],m=y[1],h=new nb(p,[m,v],b)}else h=new tb(p,[m,v],b);var x=this.makeTensorInfo([m,v],r);this.texData.get(x.dataId).usage=b?lm.PIXELS:lm.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),v,m,o);var O=this.runWebGLProgram(h,[x],r,null,!0),k=this.texData.get(O.dataId);t.texture=k.texture,t.texShape=k.texShape,t.isPacked=k.isPacked,t.usage=k.usage,this.disposeIntermediateTensorInfo(x),this.texData.delete(O.dataId),t.values=null,f&&(this.uploadWaitMs+=a.util.now()-l)}else{var w=this.acquireTexture(d,c,r,s);t.texture=w}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*a.util.bytesPerElement(t)}}]),n}(a.KernelBackend);Mg.nextDataId=0;a.device_util.isBrowser()&&Object(a.registerBackend)("webgl",(function(){return new Mg}),2);var Rg=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["A","B"],this.outputShape=a.backend_util.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")},zg=function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(_n.a)(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a.backend_util.assertAndGetBroadcastShape(n,r);var o=this.outputShape.length,u="";if(i)if(0===o||1===a.util.sizeFromShape(this.outputShape))u="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var c=Sb(o);if(u="\n          ".concat(c," coords = getOutputCoords();\n        "),1===o)u+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var s=lg("coords",o);u+="\n            bool nextRowOutOfBounds =\n              (".concat(s[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(s[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(u,"\n\n        setOutput(result);\n      }\n    ")};function Lg(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var Pg={kernelName:a.Identity,backendName:"webgl",kernelFunc:Lg};function Bg(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),u=Lg({inputs:{x:r},backend:n}),c=Lg({inputs:{x:a},backend:n});return o.complexTensorInfos={real:u,imag:c},i}var Wg={kernelName:a.Complex,backendName:"webgl",kernelFunc:Bg},Ug="return (a < 0.) ? b * a : a;",Vg="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var qg={kernelName:a.LeakyRelu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.alpha,u=n.makeTensorInfo([],"float32",a.util.createScalarValue(o,"float32")),c=Object(a.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zg(Vg,i.shape,u.shape):new Rg(Ug,i.shape,u.shape),s=n.runWebGLProgram(c,[i,u],i.dtype);return n.disposeIntermediateTensorInfo(u),s}},Hg="return (a < 0.) ? b * a : a;",Gg="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var Kg={kernelName:a.Prelu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=t.alpha,o=Object(a.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zg(Gg,r.shape,i.shape):new Rg(Hg,r.shape,i.shape);return n.runWebGLProgram(o,[r,i],r.dtype)}};function Xg(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,i=e.dtype;return function(e){var o,u=e.inputs,c=e.backend,s=u.x,l=c,f=i||s.dtype;if(l.shouldExecuteOnCPU([s])&&null!=r){var d=l.texData.get(s.dataId),h=r(d.values,f);return l.makeTensorInfo(s.shape,f,h)}return o=Object(a.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new Tg(s.shape,n):new bg(s.shape,t),l.runWebGLProgram(o,[s],f)}}function Yg(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,o=void 0!==r&&r,u=e.supportsComplex,c=void 0!==u&&u,s=e.cpuKernelImpl,l=e.dtype;return function(e){var r=e.inputs,u=e.backend,f=r.a,d=r.b,h=u;if(c&&"complex64"===f.dtype){var p=h.texData.get(f.dataId),v=h.texData.get(d.dataId),m=[[p.complexTensorInfos.real,v.complexTensorInfos.real],[p.complexTensorInfos.imag,v.complexTensorInfos.imag]].map((function(e){var n=Object(i.a)(e,2),r=n[0],o=n[1],u={dataId:r.dataId,dtype:r.dtype,shape:f.shape},c={dataId:o.dataId,dtype:o.dtype,shape:d.shape},s=new Rg(t,f.shape,d.shape);return h.runWebGLProgram(s,[u,c],Object(a.upcastType)(r.dtype,o.dtype))})),b=Object(i.a)(m,2),g=b[0],y=b[1],x=Bg({inputs:{real:g,imag:y},backend:h});return h.disposeIntermediateTensorInfo(g),h.disposeIntermediateTensorInfo(y),x}var O,k=l||Object(a.upcastType)(f.dtype,d.dtype);if(h.shouldExecuteOnCPU([f,d])&&null!=s){var w=h.texData.get(f.dataId),j=h.texData.get(d.dataId),_=s(f.shape,d.shape,w.values,j.values,k),S=Object(i.a)(_,2),E=S[0],C=S[1],A=h.makeTensorInfo(C,k);return h.texData.get(A.dataId).values=E,A}return O=Object(a.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new zg(n,f.shape,d.shape,o):new Rg(t,f.shape,d.shape),h.runWebGLProgram(O,[f,d],k)}}function $g(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?Sg:yg;if("relu"===e)return t?Cg:kg;if("elu"===e)return t?Eg:Og;if("relu6"===e)return t?Ag:wg;if("prelu"===e)return t?Gg:Hg;if("leakyrelu"===e)return t?Vg:Ug;if("sigmoid"===e)return t?Ng:_g;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var Jg=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Object(_n.a)(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;var l=a?t[1]:t[2],f=Math.ceil(l/2),d=a?"i * 2, rc.y":"rc.y, i * 2",h=i?"rc.z, i * 2":"i * 2, rc.z",p=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",b="";u&&(m=c?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(u,"\n        }"):s?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(u,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(u,"\n        }"),b="result = activation(result);");var g=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha");var y="rc.x",x="rc.x";t[0]<n[0]?y="int(min(float(rc.x), ".concat(t[0]-1,".))"):n[0]<t[0]&&(x="int(min(float(rc.x), ".concat(n[0]-1,".))")),this.userCode="\n      ".concat(m,"\n\n      const float sharedDimension = ").concat(f,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(f,"; i++) {\n          int batchA = ").concat(y,";\n          int batchB = ").concat(x,";\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(v[0],");\n          result += (").concat(p[1]," * ").concat(v[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(g,"\n\n        ").concat(b,"\n\n        setOutput(result);\n      }\n    ")},Qg="return areal * breal - aimag * bimag;",Zg="return areal * bimag + aimag * breal;",ey=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=a.backend_util.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")},ty="return a * b;";function ny(e){var t,n=e.inputs,r=e.backend,o=n.a,u=n.b,c=a.backend_util.upcastType(o.dtype,u.dtype);if("complex64"===o.dtype){var s=r.texData.get(o.dataId),l=r.texData.get(u.dataId),f=new ey(Qg,o.shape,u.shape),d=new ey(Zg,o.shape,u.shape),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:o.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:o.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:u.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:u.shape}],p=r.runWebGLProgram(f,h,"float32"),v=r.runWebGLProgram(d,h,"float32"),m=Bg({inputs:{real:p,imag:v},backend:r});return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(v),m}if(r.shouldExecuteOnCPU([o,u])){var b=r.texData.get(o.dataId),g=r.texData.get(u.dataId),y=Yb(o.shape,u.shape,b.values,g.values,c),x=Object(i.a)(y,2),O=x[0],k=x[1],w=r.makeTensorInfo(k,c);return r.texData.get(w.dataId).values=O,w}return t=Object(a.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zg(ty,o.shape,u.shape):new Rg(ty,o.shape,u.shape),r.runWebGLProgram(t,[o,u],c)}var ry={kernelName:a.Multiply,backendName:"webgl",kernelFunc:ny};function ay(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.shape,u=n,c=a.util.sizeFromShape(i.shape),s=a.util.inferFromImplicitShape(o,c),l=a.util.sizeFromShape(s);a.util.assert(c===l,(function(){return"The new shape (".concat(s,") has ").concat(l," elements and the old ")+"shape (".concat(i.shape,") has ").concat(c," elements. The new shape and old ")+"shape must have the same number of elements."}));var f=u.texData.get(i.dataId);return!f.isPacked||Bm(i.shape,s)||null!==f.texture&&Bm(f.shape,s)?(u.incRef(i.dataId),{dataId:i.dataId,shape:s,dtype:i.dtype}):function(e,t,n){var r=[Rm(e.shape)].concat(Object(Nn.a)(zm(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[Rm(t)].concat(Object(Nn.a)(zm(t))),o=new dg(i,r),u=n.runWebGLProgram(o,[a],e.dtype,null,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(i,s,u)}var iy={kernelName:a.Reshape,backendName:"webgl",kernelFunc:ay},oy=function e(t,n){Object(_n.a)(this,e),this.variableNames=["x"];var r=t.windowSize,i=t.batchSize,o=t.inSize,u=t.outSize;this.outputShape=[i,u];var c=4*Math.floor(r/4),s=r%4,l="sumValue += dot(values, ones);";if(null!=n){var f=1/n;l="sumValue += dot(values * ".concat(a.util.isInt(f)?f.toPrecision(2):f,", ones);")}var d="";o%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")},uy=function e(t,n){Object(_n.a)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var u="0.0",c="";"prod"===n?u="1.0":"min"===n?(u="1.0 / 1e-20",c="min"):"max"===n&&(u="-1.0 / 1e-20",c="max");var s="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?s="sumValue":"prod"===n?s="prodValue":"all"===n?s="allValue":"any"===n&&(s="anyValue");var l=4*Math.floor(r/4),f=r%4,d="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(c,"(values, minMaxValue);\n      }\n    "),h="vec4";"all"===n?(u="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===n&&(u="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(u,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(u,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===f,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===f,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===f,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(s,");\n      }\n    ")};function cy(e,t,n,r){for(var i=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=a.backend_util.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),o=e,u=0;u<i.length;u++){var c,s=i[u],l=s.inSize,f=s.windowSize,d=s.outSize,h=void 0;h="mean"===n?0===u?new oy({windowSize:f,inSize:l,batchSize:e.shape[0],outSize:d},l):new oy({windowSize:f,inSize:l,batchSize:e.shape[0],outSize:d}):new uy({windowSize:f,inSize:l,batchSize:e.shape[0],outSize:d},n),c=o,o=r.runWebGLProgram(h,[o],t),c.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(c)}return o}var sy=function e(t,n){Object(_n.a)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=Sb(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")};var ly=function e(t,n){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=Sb(this.rank),o=sg("rc",this.rank),u=new Array(this.rank),c=0;c<n.length;c++)u[n[c]]=o[c];var s="vec2(".concat(u.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),f="getChannel(getA(".concat(u.join(),"), ").concat(s,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(f,";\n      if(").concat(l,") {\n        result[1] = ").concat(f,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(f,";\n        if(").concat(l,") {\n          result[3] = ").concat(f,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function fy(e,t,n){var r=Object(a.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ly(e.shape,t):new sy(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function dy(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var o=t,u=e.shape.length,c=a.util.parseAxisParam(o,e.shape),s=c,l=a.backend_util.getAxesPermutation(s,u),f=null!=l,d=e;f&&(d=fy(e,l,r),s=a.backend_util.getInnerMostAxes(s.length,u)),a.backend_util.assertAxesAreInnerMostDims("sum",s,u);var h=a.backend_util.computeOutAndReduceShapes(d.shape,s),p=Object(i.a)(h,2),v=p[0],m=p[1],b=v;n&&(b=a.backend_util.expandShapeToKeepDim(v,c));var g=a.util.sizeFromShape(m),y=ay({inputs:{x:d},attrs:{shape:[a.util.sizeFromShape(e.shape)/g,g]},backend:r}),x=cy(y,Object(a.sumOutType)(e.dtype),"sum",r),O=ay({inputs:{x:x},attrs:{shape:b},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(x),f&&r.disposeIntermediateTensorInfo(d),O}(t.x,r.axis,r.keepDims,n)}var hy={kernelName:a.Sum,backendName:"webgl",kernelFunc:dy};function py(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,u=r,c=i.shape.length,s=new Array(c),l=0;l<s.length;l++)s[l]=i.shape[o[l]];if(u.shouldExecuteOnCPU([i])){var f=u.texData.get(i.dataId).values,d=ug(f,i.shape,i.dtype,o,s);t=u.makeTensorInfo(s,i.dtype),u.texData.get(t.dataId).values=d}else t=fy(i,o,u);return t}var vy={kernelName:a.Transpose,backendName:"webgl",kernelFunc:py};function my(e){var t=e.a,n=e.b,r=e.transposeA,i=e.transposeB,o=e.backend,u=e.bias,c=void 0===u?null:u,s=e.preluActivationWeights,l=void 0===s?null:s,f=e.leakyreluAlpha,d=void 0===f?0:f,h=e.activation,p=void 0===h?null:h,v=t.shape.length,m=n.shape.length,b=r?t.shape[v-2]:t.shape[v-1],g=i?n.shape[m-1]:n.shape[m-2],y=r?t.shape[v-1]:t.shape[v-2],x=i?n.shape[m-2]:n.shape[m-1],O=t.shape.slice(0,-2),k=n.shape.slice(0,-2),w=a.util.sizeFromShape(O),j=a.util.sizeFromShape(k),_=w===j||1===w||1===j;a.util.assert(v>=2&&m>=2&&_,(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(O,") and (").concat(k,").")}));var S=(w>j?t.shape.slice(0,-2):n.shape.slice(0,-2)).concat([y,x]);a.util.assert(b===g,(function(){return"Error in matMul: inner shapes (".concat(b,") and (")+"".concat(g,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(i," must match.")}));var E,C=r?[w,b,y]:[w,y,b],A=i?[j,x,g]:[j,g,x],N=ay({inputs:{x:t},backend:o,attrs:{shape:C}}),T=ay({inputs:{x:n},backend:o,attrs:{shape:A}}),I=[N,T],D=Math.max(w,j),F=r?N.shape[1]:N.shape[2],M=null!=c,R=null!=l,z="leakyrelu"===p,L=null!=p?$g(p,!0):null;if((1===y||1===x)&&F>1e3&&!1===(M||R||z||null!=L)){var P=N,B=T;r&&(P=py({inputs:{x:N},backend:o,attrs:{perm:[0,2,1]}}),I.push(P)),i&&(B=py({inputs:{x:T},backend:o,attrs:{perm:[0,2,1]}}),I.push(B));var W=1===x,U=P;1!==x&&(U=ay({inputs:{x:P},backend:o,attrs:{shape:[D,F,1]}}),I.push(U));var V=1===x?2:1,q=B;W&&(q=ay({inputs:{x:B},backend:o,attrs:{shape:[D,1,F]}}),I.push(q));var H=ny({inputs:{a:U,b:q},backend:o});E=dy({inputs:{x:H},backend:o,attrs:{axis:V,keepDims:!0}}),I.push(H)}else{var G=Object(a.upcastType)(t.dtype,n.dtype),K=new Jg(C,A,[D,y,x],r,i,M,L,R,z),X=[N,T];if(null!=c&&X.push(c),R&&X.push(l),z){var Y=o.makeTensorInfo([],"float32",a.util.createScalarValue(d,"float32"));X.push(Y),I.push(Y)}E=o.runWebGLProgram(K,X,G)}var $=ay({inputs:{x:E},backend:o,attrs:{shape:S}});I.push(E);for(var J=0,Q=I;J<Q.length;J++){var Z=Q[J];o.disposeIntermediateTensorInfo(Z)}return $}var by={kernelName:a._FusedMatMul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,u=t.preluActivationWeights,c=r.transposeA,s=r.transposeB,l=r.activation;return my({a:a,b:i,transposeA:c,transposeB:s,backend:n,bias:o,preluActivationWeights:u,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},gy="return abs(x);";var yy={kernelName:a.Abs,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,i=n.x;if(r.shouldExecuteOnCPU([i])&&"complex64"!==i.dtype){var o=r.texData.get(i.dataId),u=eg(o.values);return r.makeTensorInfo(i.shape,i.dtype,u)}return t=Object(a.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Tg(i.shape,gy):new bg(i.shape,gy),r.runWebGLProgram(t,[i],i.dtype)}},xy=Xg({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),Oy={kernelName:a.Acos,backendName:"webgl",kernelFunc:xy},ky=Xg({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),wy={kernelName:a.Acosh,backendName:"webgl",kernelFunc:ky},jy="return a + b;",_y=Yg({opSnippet:jy,packedOpSnippet:jy,supportsComplex:!0,cpuKernelImpl:Db}),Sy={kernelName:a.Add,backendName:"webgl",kernelFunc:_y},Ey=function e(t,n){Object(_n.a)(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")},Cy=function e(t,n){Object(_n.a)(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")};var Ay={kernelName:a.AddN,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,i=n;if(1===i.length)return Lg({inputs:{x:i[0]},backend:r});if(i.length>Object(a.env)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(i.length/2),u=e({inputs:i.slice(0,o),backend:r}),c=e({inputs:i.slice(o),backend:r});return e({inputs:[u,c],backend:r})}var s=i.map((function(e){return e.dtype})).reduce((function(e,t){return Object(a.upcastType)(e,t)})),l=i.map((function(e){return e.shape})),f=Object(a.env)().getBool("WEBGL_PACK")?new Cy(i[0].shape,l):new Ey(i[0].shape,l);return r.runWebGLProgram(f,i,s)}};var Ny={kernelName:a.All,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.axis,c=r.keepDims,s=o.shape.length,l=a.util.parseAxisParam(u,o.shape),f=l,d=a.backend_util.getAxesPermutation(f,s),h=o;null!=d&&(h=py({inputs:{x:o},backend:n,attrs:{perm:d}}),f=a.backend_util.getInnerMostAxes(f.length,s)),a.backend_util.assertAxesAreInnerMostDims("all",f,s);var p,v=a.backend_util.computeOutAndReduceShapes(h.shape,f),m=Object(i.a)(v,2),b=m[0],g=m[1],y=ay({inputs:{x:h},backend:n,attrs:{shape:[-1,a.util.sizeFromShape(g)]}}),x=cy(y,y.dtype,"all",n);return p=ay(c?{inputs:{x:x},backend:n,attrs:{shape:a.backend_util.expandShapeToKeepDim(b,l)}}:{inputs:{x:x},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=d&&n.disposeIntermediateTensorInfo(h),p}};var Ty={kernelName:a.Any,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.axis,c=r.keepDims,s=o.shape.length,l=a.util.parseAxisParam(u,o.shape),f=l,d=a.backend_util.getAxesPermutation(f,s),h=o;null!=d&&(h=py({inputs:{x:o},backend:n,attrs:{perm:d}}),f=a.backend_util.getInnerMostAxes(f.length,s)),a.backend_util.assertAxesAreInnerMostDims("any",f,s);var p,v=a.backend_util.computeOutAndReduceShapes(h.shape,f),m=Object(i.a)(v,2),b=m[0],g=m[1],y=ay({inputs:{x:h},backend:n,attrs:{shape:[-1,a.util.sizeFromShape(g)]}}),x=cy(y,y.dtype,"any",n);return p=ay(c?{inputs:{x:x},backend:n,attrs:{shape:a.backend_util.expandShapeToKeepDim(b,l)}}:{inputs:{x:x},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=d&&n.disposeIntermediateTensorInfo(h),p}},Iy=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var u="max"===n?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(c,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(u," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")},Dy=function e(t,n,r,i){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,a.util.assert(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var o=t[t.length-1],u=Math.ceil(o/n);this.outputShape=t.slice(0,-1),u>1&&this.outputShape.push(u),i||this.variableNames.push("bestIndicesA");var c,s,l=this.outputShape,f=l.length,d=Sb(f),h=lg("coords",f);if(1===u){var p=Sb(s=f+1);c="\n        ".concat(p," sourceLocR = ").concat(p,"(").concat(h.join(),", 0);\n        ++").concat(h[f-1],";\n        ").concat(p," sourceLocG = ").concat(p,"(").concat(h.join(),", 0);\n        ++").concat(h[f-2],";\n        ").concat(p," sourceLocA = ").concat(p,"(").concat(h.join(),", 0);\n        --").concat(h[f-1],";\n        ").concat(p," sourceLocB = ").concat(p,"(").concat(h.join(),", 0);\n        --").concat(h[f-2],";")}else s=f,c="\n        ".concat(d," sourceLocR = coords;\n        ++").concat(h[f-1],";\n        ").concat(d," sourceLocG = coords;\n        ++").concat(h[f-2],";\n        ").concat(d," sourceLocA = coords;\n        --").concat(h[f-1],";\n        ").concat(d," sourceLocB = coords;\n        --").concat(h[f-2],";");var v=["x","y","z","w","u","v"].slice(0,s),m="."+v[s-1],b=v.map((function(e){return"int "+e})),g=lg("sourceLocR",s-1).concat("inIdx.r"),y=lg("sourceLocG",s-1).concat("inIdx.g"),x=lg("sourceLocB",s-1).concat("inIdx.b"),O=lg("sourceLocA",s-1).concat("inIdx.a"),k="max"===r?"greaterThan":"lessThan",w=i?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),"),\n                             getBestIndicesAChannel(").concat(O.join(),")));"),j="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(x.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(O.join(),") : 0.)"),_=i?"":"\n      float getBestIndicesAChannel(".concat(b.join(),") {\n        return getChannel(getBestIndicesA(").concat(v.join(),"),\n                                          vec2(").concat(v.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(b.join(),") {\n        return getChannel(getA(").concat(v.join(),"),\n                               vec2(").concat(v.slice(-2).join(),"));\n      }\n      ").concat(_,"\n      void main() {\n        ").concat(d," coords = getOutputCoords();\n        bool hasNextCol = ").concat(h[f-1]," < ").concat(l[f-1]-1,";\n        bool hasNextRow = ").concat(h[f-2]," < ").concat(l[f-2]-1,";\n        ").concat(c,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(m,", sourceLocG").concat(m,",\n          sourceLocB").concat(m,", sourceLocA").concat(m,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(j,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(j,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(k,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")};function Fy(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.shape[0],o=t.shape[1];null!=r&&(i=r.shape[0],o=r.shape[1]);var u=a.backend_util.computeOptimalWindowSize(o),c={windowSize:u,inSize:o,batchSize:i,outSize:Math.ceil(o/u)},s=new Iy(c,n,null==r),l=[t];null!=r&&l.push(r);var f=e.runWebGLProgram(s,l,"int32");if(1===f.shape[1])return f;var d=Fy(e,t,n,f);return e.disposeIntermediateTensorInfo(f),d}function My(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=null!=r?r.shape:t.shape,o=i[i.length-1],u=a.backend_util.computeOptimalWindowSize(o),c=new Dy(i,u,n,null==r),s=null==r?[t]:[t,r],l=e.runWebGLProgram(c,s,"int32");if(l.shape.length===t.shape.length){var f=My(e,t,n,l);return e.disposeIntermediateTensorInfo(l),f}return l}function Ry(e,t,n,r){var o=[n];if(a.backend_util.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),o,t.shape.length),!Object(a.env)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var u=[],c=a.backend_util.computeOutAndReduceShapes(t.shape,o),s=Object(i.a)(c,2),l=s[0],f=s[1],d=a.util.sizeFromShape(f),h=ay({inputs:{x:t},backend:e,attrs:{shape:[-1,d]}});u.push(h);var p=Fy(e,h,r);u.push(p);var v=ay({inputs:{x:p},backend:e,attrs:{shape:l}});return u.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),v}return My(e,t,r)}var zy={kernelName:a.ArgMax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.axis,u=a.util.parseAxisParam(o,i.shape),c=a.backend_util.getAxesPermutation(u,i.shape.length),s=i,l=[];null!=c&&(s=py({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(s),u=a.backend_util.getInnerMostAxes(u.length,s.shape.length)),a.backend_util.assertAxesAreInnerMostDims("argMax",[u[0]],s.shape.length);var f=Ry(n,s,u[0],"max");return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),f}};var Ly={kernelName:a.ArgMin,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.axis,u=a.util.parseAxisParam(o,i.shape),c=a.backend_util.getAxesPermutation(u,i.shape.length),s=i,l=[];null!=c&&(s=py({inputs:{x:i},backend:n,attrs:{perm:c}}),l.push(s),u=a.backend_util.getInnerMostAxes(u.length,s.shape.length)),a.backend_util.assertAxesAreInnerMostDims("argMin",[u[0]],s.shape.length);var f=Ry(n,s,u[0],"min");return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),f}},Py=Xg({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),By={kernelName:a.Asin,backendName:"webgl",kernelFunc:Py},Wy=Xg({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),Uy={kernelName:a.Asinh,backendName:"webgl",kernelFunc:Wy},Vy=Xg({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),qy={kernelName:a.Atan,backendName:"webgl",kernelFunc:Vy},Hy=Yg({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),Gy={kernelName:a.Atan2,backendName:"webgl",kernelFunc:Hy},Ky=Xg({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Xy={kernelName:a.Atanh,backendName:"webgl",kernelFunc:Ky},Yy=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(_n.a)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,u=t.strideHeight,c=t.strideWidth,s=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===n,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),b="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="0.0";if(v||(g="-1.0 / 1e-20"),r){var y=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(u,", ").concat(c,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(s,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(y," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?m:b:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var x="max",O="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(O="avgValue / count");var k=4*Math.floor(o/4),w=o%4,j="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(x,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(u,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(p,");\n      const float initializationValue = ").concat(g,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(g,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(s,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(k,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(j,"\n          }\n\n          int xC = xCCorner + ").concat(k,";\n          if (").concat(1===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(j,"\n          } else if (").concat(2===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(j,"\n          } else if (").concat(3===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(j,"\n          }\n        }\n        setOutput(").concat(O,");\n      }\n    ")}},$y=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(_n.a)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,u=t.strideDepth,c=t.strideHeight,s=t.strideWidth,l=t.dilationDepth,f=t.dilationHeight,d=t.dilationWidth,h=t.effectiveFilterDepth,p=t.effectiveFilterHeight,v=t.effectiveFilterWidth,m=t.padInfo.front,b=t.padInfo.top,g=t.padInfo.left;this.outputShape=t.outShape;var y="avg"===n,x="0.0";if(y||(x="-1.0 / 1e-20"),r){var O=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(u,", ").concat(c,", ").concat(s,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(b,", ").concat(g,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(f,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(O," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="max",w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / count");var j=4*Math.floor(o/4),_=o%4,S="\n      if (".concat(y,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(k,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(u,", ").concat(c,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(b,", ").concat(g,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(f,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(j,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(S,"\n            }\n\n            int xC = xCCorner + ").concat(j,";\n            if (").concat(1===_,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(2===_,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(S,"\n            } else if (").concat(3===_,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(S,"\n            }\n          }\n          setOutput(").concat(w,");\n        }\n      }\n    ")}};var Jy={kernelName:a.AvgPool,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x;Hm(i,"avgPool");var o=r.filterSize,u=r.strides,c=r.pad,s=r.dimRoundingMode;a.util.assert(a.backend_util.eitherStridesOrDilationsAreOne(u,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(u," and dilations '").concat(1,"'")}));var l=a.backend_util.computePool2DInfo(i.shape,o,u,1,c,s);if(1===l.filterWidth&&1===l.filterHeight&&a.util.arraysEqual(l.inShape,l.outShape))return Lg({inputs:{x:i},backend:n});var f=new Yy(l,"avg",!1);return n.runWebGLProgram(f,[i],"float32")}};var Qy={kernelName:a.AvgPool3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.filterSize,u=r.strides,c=r.pad,s=r.dimRoundingMode,l=r.dataFormat,f=a.backend_util.computePool3DInfo(i.shape,o,u,[1,1,1],c,s,l),d=new $y(f,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}},Zy=function e(t){Object(_n.a)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterHeight,s=t.effectiveFilterWidth,l=c-1-t.padInfo.top,f=s-1-t.padInfo.left,d=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(f,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(c,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(s,";\n            wC+= ").concat(u,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},ex=function e(t){Object(_n.a)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,s=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=f-1-t.padInfo.front,v=d-1-t.padInfo.top,m=h-1-t.padInfo.left,b=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(p,", ").concat(v,", ").concat(m,");\n      const float avgMultiplier = float(").concat(b,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(c,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(s,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var tx={kernelName:a.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.input,u=r.filterSize,c=r.strides,s=r.pad,l=r.dimRoundingMode,f=a.backend_util.computePool3DInfo(o.shape,u,c,[1,1,1],s,l),d=new ex(f);return n.runWebGLProgram(d,[i],o.dtype)}};var nx={kernelName:a.AvgPoolGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.input,u=o;Hm([i,o],"avgPoolGrad");var c=r.filterSize,s=r.strides,l=r.pad,f=a.backend_util.computePool2DInfo(u.shape,c,s,1,l),d=new Zy(f);return n.runWebGLProgram(d,[i],u.dtype)}};var rx={kernelName:a.BatchMatMul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return my({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},ax=function e(t,n,r,i,o,u){Object(_n.a)(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],a.backend_util.assertAndGetBroadcastShape(t,n),a.backend_util.assertAndGetBroadcastShape(t,r);var c="0.0";null!=i&&(a.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");var s="1.0";null!=o&&(a.backend_util.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(c,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(u,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")},ix=function e(t,n,r,i,o,u){Object(_n.a)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],a.backend_util.assertAndGetBroadcastShape(t,n),a.backend_util.assertAndGetBroadcastShape(t,r);var c="vec4(0.0)";null!=i&&(a.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=o&&(a.backend_util.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(c,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(u,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")},ox={kernelName:a.FusedBatchNorm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.mean,u=t.variance,c=t.offset,s=t.scale;a.util.assert(o.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),a.util.assert(null==c||o.shape.length===c.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),a.util.assert(null==s||o.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var l=r.varianceEpsilon;null==l&&(l=.001);var f=[i,o,u],d=null;null!=c&&(d=c.shape,f.push(c));var h=null;null!=s&&(h=s.shape,f.push(s));var p=Object(a.env)().getBool("WEBGL_PACK_NORMALIZATION")?new ix(i.shape,o.shape,u.shape,d,h,l):new ax(i.shape,o.shape,u.shape,d,h,l);return n.runWebGLProgram(p,f,f[0].dtype)}},ux=function(){function e(t){Object(_n.a)(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Sb(this.rank),a="uniform int start[".concat(this.rank,"];"),i=function(e){if(1===e)return"sourceLoc";if(e<=6)return cx.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),o=t.map((function(e,t){return"sourceLoc.".concat(cx[t]," = start[").concat(t,"] + coords.").concat(cx[t],";")}));n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),cx=["x","y","z","w","u","v"];var sx=function(){function e(t){Object(_n.a)(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Sb(this.rank),r=lg("coords",this.rank),a=lg("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),u="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),c=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),s=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(s,"\n        vec4 result = vec4(0.);\n        ").concat(u,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}();function lx(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.begin,c=r.size,s=a.slice_util.parseSliceParams(o,u,c),l=Object(i.a)(s,2),f=l[0],d=l[1];if(a.slice_util.assertParamsValid(o,f,d),0===a.util.sizeFromShape(d))return n.makeTensorInfo(d,o.dtype,[]);if(n.shouldExecuteOnCPU([o])||"string"===o.dtype){var h=n.texData.get(o.dataId),p=tg(h.values,f,d,o.shape,o.dtype);return n.makeTensorInfo(d,o.dtype,p)}var v=n.texData.get(o.dataId).isPacked,m=a.slice_util.isSliceContinous(o.shape,f,d);if(v||!m){var b=Object(a.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sx(d):new ux(d),g=b.getCustomSetupFunc(f);return n.runWebGLProgram(b,[o],o.dtype,g)}return n.uploadToGPU(o.dataId),function(e,t,n,r){var i=r.texData.get(e.dataId),o=r.makeTensorInfo(n,e.dtype),u=r.texData.get(o.dataId);Object.assign(u,i),u.refCount=1,u.shape=n,u.dtype=e.dtype;var c=a.slice_util.computeFlatOffset(t,a.util.computeStrides(e.shape));i.slice&&(c+=i.slice.flatOffset),u.slice={flatOffset:c,origDataId:i.slice&&i.slice.origDataId||e.dataId};var s=r.dataRefCount.get(u.slice.origDataId)||1;return r.dataRefCount.set(u.slice.origDataId,s+1),o}(o,f,d,n)}var fx={kernelName:a.Slice,backendName:"webgl",kernelFunc:lx},dx={kernelName:a.BatchToSpaceND,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.blockShape,u=r.crops;a.util.assert(i.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var c=o.reduce((function(e,t){return e*t})),s=a.backend_util.getReshaped(i.shape,o,c),l=a.backend_util.getPermuted(s.length,o.length),f=a.backend_util.getReshapedPermuted(i.shape,o,c),d=a.backend_util.getSliceBeginCoords(u,o.length),h=a.backend_util.getSliceSize(f,u,o.length),p=[],v=ay({inputs:{x:i},backend:n,attrs:{shape:s}}),m=py({inputs:{x:v},backend:n,attrs:{perm:l}}),b=ay({inputs:{x:m},backend:n,attrs:{shape:f}}),g=lx({inputs:{x:b},backend:n,attrs:{begin:d,size:h}});return p.push(v),p.push(m),p.push(b),p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var hx={kernelName:a.Bincount,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=n.readSync(a.dataId),c=n.readSync(i.dataId),s=Fb(u,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}},px=Yg({opSnippet:"return float(a != b);",dtype:"bool"}),vx={kernelName:a.NotEqual,backendName:"webgl",kernelFunc:px};function mx(e){var t=e.inputs,n=e.backend,r=t.input;return Lg({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var bx={kernelName:a.Real,backendName:"webgl",kernelFunc:mx};var gx={kernelName:a.Cast,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,i=t.attrs,o=n.x,u=i.dtype;if("complex64"===u){if("complex64"===o.dtype)return Lg({inputs:{x:o},backend:r});var c=a.zeros(o.shape),s=e({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),l=Bg({inputs:{real:s,imag:c},backend:r});return c.dispose(),r.disposeIntermediateTensorInfo(s),l}if("complex64"===o.dtype){var f=mx({inputs:{input:o},backend:r}),d=e({inputs:{x:f},backend:r,attrs:{dtype:u}});return r.disposeIntermediateTensorInfo(f),d}if(!a.util.hasEncodingLoss(o.dtype,u)){var h=Lg({inputs:{x:o},backend:r});return{dataId:h.dataId,shape:h.shape,dtype:u}}if("int32"===u)return function(e,t){var n=new bg(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===u){var p=r.makeTensorInfo([],"bool",a.util.getTypedArrayFromDType("bool",1)),v=px({inputs:{a:o,b:p},backend:r});return r.disposeIntermediateTensorInfo(p),v}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(u))}},yx="return ceil(x);",xx=Xg({opSnippet:yx,packedOpSnippet:yx,cpuKernelImpl:Rb}),Ox={kernelName:a.Ceil,backendName:"webgl",kernelFunc:xx},kx=function(){function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),wx=function(){function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}();var jx={kernelName:a.ClipByValue,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,i=e.attrs,o=n.x,u=i.clipValueMin,c=i.clipValueMax,s=(t=Object(a.env)().getBool("WEBGL_PACK_CLIP")?new wx(o.shape):new kx(o.shape)).getCustomSetupFunc(u,c);return r.runWebGLProgram(t,[o],o.dtype,s)}},_x=function e(t){Object(_n.a)(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "};function Sx(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var Ex={kernelName:a.ComplexAbs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new _x(r.shape),o=[Sx(r,a.complexTensorInfos.real),Sx(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},Cx=function e(t){Object(_n.a)(this,e),this.outputShape=[],this.outputShape=a.backend_util.computeOutShape(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var i=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],o=1;o<n.length;o++){var u=n[o-1];i.push("else if (yC < ".concat(n[o],") ")+"setOutput(getT".concat(o,"(yR, yC-").concat(u,"));"))}var c=n.length,s=n[n.length-1];i.push("else setOutput(getT".concat(c,"(yR, yC-").concat(s,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(i.join("\n        "),"\n      }\n    ")},Ax=function e(t,n){Object(_n.a)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=a.backend_util.computeOutShape(t,n);var r=this.outputShape,i=r.length,o=Sb(i),u=lg("coords",i),c=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var s=new Array(t.length-1);s[0]=t[0][n];for(var l=1;l<s.length;l++)s[l]=s[l-1]+t[l][n];for(var f=c[n],d=c.slice(-2),h=c.join(),p="if (".concat(f," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(h,"), vec2(").concat(d.join(),"));\n        }"),v=1;v<s.length;v++){var m=s[v-1];p+="\n        if (".concat(f," < ").concat(s[v],"  && ").concat(f," >= ").concat(s[v-1],") {\n          return getChannel(\n            getT").concat(v,"(").concat(Nx(c,f,m),"),\n            vec2(").concat(Nx(d,f,m),"));\n        }")}var b=s.length,g=s[s.length-1];p+="\n        return getChannel(\n          getT".concat(b,"(").concat(Nx(c,f,g),"),\n          vec2(").concat(Nx(d,f,g),"));"),this.userCode="\n      float getValue(".concat(c.map((function(e){return"int "+e})),") {\n        ").concat(p,"\n      }\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(u,"), 0., 0., 0.);\n\n        ").concat(u[i-1]," = ").concat(u[i-1]," + 1;\n        if (").concat(u[i-1]," < ").concat(r[i-1],") {\n          result.g = getValue(").concat(u,");\n        }\n\n        ").concat(u[i-2]," = ").concat(u[i-2]," + 1;\n        if (").concat(u[i-2]," < ").concat(r[i-2],") {\n          result.a = getValue(").concat(u,");\n        }\n\n        ").concat(u[i-1]," = ").concat(u[i-1]," - 1;\n        if (").concat(u[i-2]," < ").concat(r[i-2]," &&\n            ").concat(u[i-1]," < ").concat(r[i-1],") {\n          result.b = getValue(").concat(u,");\n        }\n        setOutput(result);\n      }\n    ")};function Nx(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function Tx(e){var t=e.inputs,n=e.backend,r=t.input;return Lg({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var Ix={kernelName:a.Imag,backendName:"webgl",kernelFunc:Tx};function Dx(e,t,n){var r=e[0].dtype;if("complex64"===r){var i=e.map((function(e){return mx({inputs:{input:e},backend:n})})),o=e.map((function(e){return Tx({inputs:{input:e},backend:n})})),u=Dx(i,t,n),c=Dx(o,t,n),s=Bg({inputs:{real:u,imag:c},backend:n});return i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),s}var l=n.shouldExecuteOnCPU(e);if("string"===r&&(l=!0),l){var f=e.map((function(e){var r=a.util.sizeFromShape(e.shape.slice(t));return ay({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),d=f.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),h=a.backend_util.computeOutShape(f.map((function(e){return e.shape})),1),p=1===f[0].shape[0],v=zb(d,h,r,p),m=a.backend_util.computeOutShape(e.map((function(e){return e.shape})),t),b=n.makeTensorInfo(m,r,v);return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),b}if(e.length>Object(a.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var g=Math.floor(e.length/2),y=Dx(e.slice(0,g),t,n),x=Dx(e.slice(g),t,n),O=Dx([y,x],t,n);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),O}if(Object(a.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){var k=new Ax(e.map((function(e){return e.shape})),t);return n.runWebGLProgram(k,e,r)}var w=function(e,t,n){var r=a.backend_util.computeOutShape(e.map((function(e){return e.shape})),t);return{tensors2D:e.map((function(e){return ay({inputs:{x:e},attrs:{shape:[-1,a.util.sizeFromShape(e.shape.slice(t))]},backend:n})})),outShape:r}}(e,t,n),j=w.tensors2D,_=w.outShape,S=new Cx(j.map((function(e){return e.shape}))),E=n.runWebGLProgram(S,j,r);j.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var C=ay({inputs:{x:E},attrs:{shape:_},backend:n});return n.disposeIntermediateTensorInfo(E),C}function Fx(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,i=a.util.parseAxisParam(r,t[0].shape)[0],o=a.backend_util.computeOutShape(t.map((function(e){return e.shape})),i);if(0===a.util.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);var u=t.filter((function(e){return a.util.sizeFromShape(e.shape)>0}));if(1===u.length)return Lg({inputs:{x:u[0]},backend:n});var c=u.map((function(e){return e.shape}));return a.backend_util.assertParamsConsistent(c,i),Dx(u,i,n)}var Mx={kernelName:a.Concat,backendName:"webgl",kernelFunc:Fx},Rx=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(_n.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,u=t.padInfo.left,c=t.strideHeight,s=t.strideWidth,l=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),v=t.inChannels%4,m="channelsLast"===t.dataFormat,b=m?1:2,g=m?2:3,y=m?3:1,x="",O="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),O="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(b,"], coords[").concat(g,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===v,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===v,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===v,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(k,"\n        ").concat(O,"\n        setOutput(result);\n      }\n    ")},zx=function e(t){Object(_n.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,s=t.dilationHeight,l=t.dilationWidth,f=t.filterDepth,d=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(u,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(f,"; wF++) {\n          int xF = xFCorner + wF * ").concat(c,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(s,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Lx=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,i=r.inChannels,o=r.strideWidth,u=r.strideHeight,c=r.padInfo,s=r.outWidth,l=r.dilationWidth,f=r.dilationHeight,d=r.dataFormat,h=c.left,p=c.top,v=i*a,m=Km(),b="channelsLast"===d,g=b?0:1,y=b?1:2,x="",O=0;O<=1;O++)for(var k=0;k<=1;k++)x+="\n          blockIndex = rc.y + ".concat(k,";\n          pos = rc.x + ").concat(O,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(s,")) * ").concat(u," - ").concat(p,";\n            d0 = offsetY + ").concat(f," * (pos / ").concat(v,");\n\n            if(d0 < ").concat(n[g]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(s,".) * ").concat(o,". - ").concat(h,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(v,".) / ").concat(i,".));\n\n              if(d1 < ").concat(n[y]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(i,".));\n\n                if (").concat(b,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*O+k,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*O+k,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(x,"\n\n        ").concat(m.output," = result;\n      }\n    ")};function Px(e){var t,n=e.x,r=e.filter,i=e.convInfo,o=e.backend,u=e.bias,c=void 0===u?null:u,s=e.preluActivationWeights,l=void 0===s?null:s,f=e.leakyreluAlpha,d=void 0===f?0:f,h=e.activation,p=void 0===h?null:h,v=n.shape,m=o.texData.get(n.dataId),b=i.inChannels,g=v[0]*v[1]*v[2],y=i.outChannels,x="channelsLast"===i.dataFormat,O=[],k=(1===g||1===y)&&b>1e3,w=v[2]%2!==0&&!!m.isPacked;if(!k&&Object(a.env)().getBool("WEBGL_LAZILY_UNPACK")&&Object(a.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&w){var j=x?v[0]*v[1]*(v[2]+1):v[0]*v[2]*(v[3]+1),_={dataId:n.dataId,shape:[1,j,i.inChannels],dtype:n.dtype},S=m.shape;m.shape=m.shape.slice(),m.shape[m.shape.length-2]++,a.util.assert(Bm(m.shape,_.shape),(function(){return"packed reshape ".concat(m.shape," to ").concat(_.shape," isn't free")}));var E=ay({inputs:{x:r},backend:o,attrs:{shape:[1,i.inChannels,i.outChannels]}});O.push(E);var C=my({a:_,b:E,backend:o,transposeA:false,transposeB:false,bias:c,activation:p,preluActivationWeights:l,leakyreluAlpha:d}),A=o.texData.get(C.dataId);a.util.assert(A.isPacked,(function(){return"batchMatMul result is expected to be packed"})),m.shape=S,A.shape=i.outShape,(t=Lg({inputs:{x:C},backend:o})).shape=i.outShape,O.push(C)}else{var N=ay({inputs:{x:n},backend:o,attrs:{shape:[1,x?v[0]*v[1]*v[2]:v[0]*v[2]*v[3],i.inChannels]}}),T=ay({inputs:{x:r},backend:o,attrs:{shape:[1,i.inChannels,i.outChannels]}}),I=my({a:N,b:T,transposeA:false,transposeB:false,backend:o,bias:c,activation:p,preluActivationWeights:l,leakyreluAlpha:d});t=ay({inputs:{x:I},backend:o,attrs:{shape:i.outShape}}),O.push(N),O.push(T),O.push(I)}for(var D=0,F=O;D<F.length;D++){var M=F[D];o.disposeIntermediateTensorInfo(M)}return t}function Bx(e){var t=e.x,n=e.filter,r=e.convInfo,i=e.backend,o=e.bias,u=void 0===o?null:o,c=e.preluActivationWeights,s=void 0===c?null:c,l=e.leakyreluAlpha,f=void 0===l?0:l,d=e.activation,h=void 0===d?null:d,p=r.filterWidth,v=r.filterHeight,m=r.inChannels,b=r.outWidth,g=r.outHeight,y="channelsLast"===r.dataFormat,x=p*v*m,O=g*b,k=[x,O],w=[],j=ay({inputs:{x:t},backend:i,attrs:{shape:t.shape.slice(1)}}),_=ay({inputs:{x:n},backend:i,attrs:{shape:[1,x,a.util.sizeFromShape(n.shape)/x]}});w.push(j),w.push(_);var S=new Lx(k,j.shape,r),E=i.runWebGLProgram(S,[j],"float32"),C=ay({inputs:{x:E},backend:i,attrs:{shape:[1,k[0],k[1]]}});w.push(E),w.push(C);var A=null!=u,N=null!=s,T="leakyrelu"===h,I=h?$g(h,!0):null,D=new Jg(C.shape,_.shape,[1,O,r.outChannels],!0,!1,A,I,N,T),F=[C,_];if(u&&F.push(u),N&&F.push(s),T){var M=i.makeTensorInfo([],"float32",a.util.createScalarValue(f,"float32"));F.push(M),w.push(M)}var R=i.runWebGLProgram(D,F,"float32"),z=ay({inputs:{x:R},backend:i,attrs:{shape:y?[1,g,b,r.outChannels]:[1,r.outChannels,g,b]}});w.push(R);for(var L=0,P=w;L<P.length;L++){var B=P[L];i.disposeIntermediateTensorInfo(B)}return z}var Wx={kernelName:a.Conv2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,i=e.attrs,o=n.x,u=n.filter,c=i.strides,s=i.pad,l=i.dataFormat,f=i.dilations,d=i.dimRoundingMode,h=a.backend_util.convertConv2DDataFormat(l),p=a.backend_util.computeConv2DInfo(o.shape,u.shape,c,f,s,d,!1,h);if(1!==p.filterHeight||1!==p.filterWidth||1!==p.dilationHeight||1!==p.dilationWidth||1!==p.strideHeight||1!==p.strideWidth||"SAME"!==p.padInfo.type&&"VALID"!==p.padInfo.type)if(Object(a.env)().getBool("WEBGL_CONV_IM2COL")&&1===o.shape[0])t=Bx({x:o,filter:u,convInfo:p,backend:r});else{var v=new Rx(p);t=r.runWebGLProgram(v,[o,u],"float32")}else t=Px({x:o,filter:u,convInfo:p,backend:r});var m=ay({inputs:{x:t},backend:r,attrs:{shape:p.outShape}});return r.disposeIntermediateTensorInfo(t),m}},Ux=function e(t){Object(_n.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Vx=function e(t){Object(_n.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left,s=o?1:2,l=o?2:3,f=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(f,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(s,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},qx=function e(t){Object(_n.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,u=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(u,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Hx=function e(t){Object(_n.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,c=n-1-t.padInfo.front,s=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(c,", ").concat(s,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var Gx={kernelName:a.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.dy,u=r.strides,c=r.pad,s=r.dataFormat,l=r.dimRoundingMode,f=r.filterShape,d=a.backend_util.convertConv2DDataFormat(s),h=a.backend_util.computeConv2DInfo(i.shape,f,u,1,c,l,!1,d),p=new Ux(h);return n.runWebGLProgram(p,[i,o],"float32")}};var Kx={kernelName:a.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.filter,u=r.inputShape,c=r.strides,s=r.pad,l=r.dataFormat,f=r.dimRoundingMode,d=a.backend_util.convertConv2DDataFormat(l),h=a.backend_util.computeConv2DInfo(u,o.shape,c,1,s,f,!1,d),p=new Vx(h);return n.runWebGLProgram(p,[i,o],"float32")}};var Xx={kernelName:a.Conv3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=r.strides,c=r.pad,s=r.dilations,l=a.backend_util.computeConv3DInfo(i.shape,o.shape,u,s,c),f=new zx(l);return n.runWebGLProgram(f,[i,o],"float32")}};var Yx={kernelName:a.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.dy,u=r.strides,c=r.pad,s=r.filterShape,l=a.backend_util.computeConv3DInfo(i.shape,s,u,1,c),f=new qx(l);return n.runWebGLProgram(f,[i,o],"float32")}};var $x={kernelName:a.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.filter,u=r.pad,c=r.strides,s=r.inputShape,l=a.backend_util.computeConv3DInfo(s,o.shape,c,1,u),f=new Hx(l);return n.runWebGLProgram(f,[i,o],"float32")}},Jx=Xg({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),Qx={kernelName:a.Cos,backendName:"webgl",kernelFunc:Jx},Zx=Xg({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),eO={kernelName:a.Cosh,backendName:"webgl",kernelFunc:Zx},tO=function e(t,n,r,a,o){Object(_n.a)(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var u=Object(i.a)(t,4),c=u[0],s=u[1],l=u[2],f=u[3],d=Object(i.a)(n,1)[0],h=Object(i.a)(r,2),p=h[0],v=h[1];this.outputShape=[d,p,v,f];var m="bilinear"===a?1:0,b="".concat(s-1,".0"),g="".concat(l-1,".0"),y=p>1?["".concat((s-1)/(p-1)),"(y2-y1) * height_ratio","y1*".concat(b," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(b)],x=Object(i.a)(y,3),O=x[0],k=x[1],w=x[2],j=v>1?["".concat((l-1)/(v-1)),"(x2-x1) * width_ratio","x1*".concat(g," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(g)],_=Object(i.a)(j,3),S=_[0],E=_[1],C=_[2];this.userCode="\n      const float height_ratio = float(".concat(O,");\n      const float width_ratio = float(").concat(S,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(c,") {\n          return;\n        }\n\n        float height_scale = ").concat(k,";\n        float width_scale = ").concat(E,";\n\n        float in_y = ").concat(w,";\n        if( in_y < 0.0 || in_y > ").concat(b," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n        float in_x = ").concat(C,";\n        if( in_x < 0.0 || in_x > ").concat(g," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(m," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")},nO={kernelName:a.CropAndResize,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,u=r.cropSize,c=r.method,s=r.extrapolationValue,l=new tO(a.shape,i.shape,u,c,s);return n.runWebGLProgram(l,[a,i,o],"float32")}},rO=function(){function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,i=n?"0.0":"getX(".concat(aO(a,"coords"),")"),o=t[t.length-1],u="",c="";n?(u=r?"end != ".concat(o-1):"end != 0",c=r?"end + 1":"end - 1"):(u=r?"end + pow2 < ".concat(o):"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(Sb(a)," coords = getOutputCoords();\n        int end = ").concat(iO(a,"coords"),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(u,") {\n          int idx = ").concat(c,";\n          ").concat(iO(a,"coords")," = idx;\n          val += getX(").concat(aO(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.index&&(t.index=n.getUniformLocation(r,"index")),n.gl.uniform1f(t.index,e)}}}]),e}();function aO(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}function iO(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}var oO={kernelName:a.Cumsum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.axis,u=r.exclusive,c=r.reverse,s=i.shape.length,l=a.backend_util.getAxesPermutation([o],s),f=i;null!=l&&(f=py({inputs:{x:i},backend:n,attrs:{perm:l}}));var d=a.backend_util.getInnerMostAxes(1,s)[0];if(d!==s-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(i.shape.length-1," ")+"but got axis=".concat(o));for(var h=f.shape[d],p=Lg({inputs:{x:f},backend:n}),v=0;v<=Math.ceil(Math.log2(h))-1;v++){var m=new rO(f.shape,!1,c),b=m.getCustomSetupFunc(v),g=p;p=n.runWebGLProgram(m,[p],p.dtype,b),n.disposeIntermediateTensorInfo(g)}if(u){var y=new rO(f.shape,u,c),x=p;p=n.runWebGLProgram(y,[p],p.dtype),n.disposeIntermediateTensorInfo(x)}if(null!=l){var O=py({inputs:{x:p},backend:n,attrs:{perm:a.backend_util.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),O}return p}};var uO={kernelName:a.DenseBincount,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=r.binaryOutput;if(1===a.shape.length){var c=n.readSync(a.dataId),s=n.readSync(i.dataId),l=Fb(c,s,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var f=n.bufferSync(a),d=n.bufferSync(i),h=Mb(f,d,o,u);return n.makeTensorInfo(h.shape,i.dtype,h.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},cO=function(){function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return Object(Sn.a)(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var sO={kernelName:a.DepthToSpace,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.blockSize,u=r.dataFormat;a.util.assert(o>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(o)}));var c=i.shape[0],s="NHWC"===u?i.shape[1]:i.shape[2],l="NHWC"===u?i.shape[2]:i.shape[3],f="NHWC"===u?i.shape[3]:i.shape[1],d=s*o,h=l*o,p=f/(o*o),v=new cO("NHWC"===u?[c,d,h,p]:[c,p,d,h],o,u);return n.runWebGLProgram(v,[i],i.dtype)}},lO=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(_n.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,u=t.inWidth,c=t.padInfo.top,s=t.padInfo.left,l=t.strideHeight,f=t.strideWidth,d=t.dilationHeight,h=t.dilationWidth,p=t.filterHeight,v=t.filterWidth,m=t.outChannels/t.inChannels,b="",g="";r&&(b=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),g="result = activation(result);");var y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(f,");\n      const ivec2 pads = ivec2(").concat(c,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(m,";\n        int q = d2 - d1 * ").concat(m,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(p,"; wR++) {\n          int xR = xRCorner + wR * ").concat(d,";\n\n          if (xR < 0 || xR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(v,"; wC++) {\n            int xC = xCCorner + wC * ").concat(h,";\n\n            if (xC < 0 || xC >= ").concat(u,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(y,"\n        ").concat(g,"\n        setOutput(result);\n      }\n    ")},fO=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(_n.a)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var u=t.outChannels/t.inChannels,c=t.inHeight,s=t.inWidth,l=t.padInfo.top,f=t.padInfo.left,d=t.strideHeight,h=t.strideWidth,p=t.dilationHeight,v=t.dilationWidth,m=t.filterHeight,b=t.filterWidth,g=b,y="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",x=0;x<b;x++)y+="\n          vec4 xTexelC".concat(2*x,";\n          vec4 xC").concat(x,";");for(var O=0;O<m;O++){for(var k=0;k<b;k++)y+="\n          xTexelC".concat(2*k," = vec4(0.0);\n          xC").concat(k," = vec4(0.0);");y+="\n        xR = xRCorner + ".concat(O*p,";\n        if (xR >=0 && xR < ").concat(c,") {\n      ");for(var w=0;w<g/2+1;w++){var j=2*w;if(y+="\n          xC = xCCorner + ".concat(j*v,";\n          "),1===h){if(j<b&&(f%2===1?(y+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < ".concat(s,") {\n                  xTexelC").concat(j," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= ").concat(s,") {\n                    xTexelC").concat(j,".zw = vec2(0.0);\n                  }\n                }\n              "),y+=1===v&&j>0?"\n                xC".concat(j," = vec4(xTexelC").concat(j-2,".zw, xTexelC").concat(j,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < ".concat(s,") {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= ").concat(s,") {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC").concat(j," = vec4(previous.zw, xTexelC").concat(j,".xy);\n                  } else {\n                    xC").concat(j," = vec4(0.0, 0.0, xTexelC").concat(j,".xy);\n                  }\n                  ")):y+="\n                if (xC >= 0 && xC < ".concat(s,") {\n                  xTexelC").concat(j," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= ").concat(s,") {\n                    xTexelC").concat(j,".zw = vec2(0.0);\n                  }\n                }\n\n                xC").concat(j," = xTexelC").concat(j,";\n                "),j+1<b)){var _=f%2===0?a.util.nearestLargerEven(v):v;v%2===0&&f%2===1||v%2!==0&&f%2!==1?(y+="\n                  xCOffset = xC + ".concat(f%2," + ").concat(_,";\n\n                  if (xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelC").concat(j+2," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= ").concat(s,") {\n                      xTexelC").concat(j+2,".zw = vec2(0.0);\n                    }\n                  }\n                  "),v>1&&(y+="\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < ".concat(s,") {\n                      xTexelC").concat(j," = getX(batch, xR, xCOffset, d1);\n                    }\n                    ")),y+="\n                  xC".concat(j+1," = vec4(xTexelC").concat(j,".zw, xTexelC").concat(j+2,".xy);\n                  ")):y+=1===_?"\n                    xC".concat(j+1," = xTexelC").concat(j,";\n                    "):"\n                    xCOffset = xC + ".concat(_,";\n\n                    if (xCOffset >= 0 && xCOffset < ").concat(s,") {\n                      xTexelC").concat(j+2," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= ").concat(s,") {\n                        xTexelC").concat(j+2,".zw = vec2(0.0);\n                      }\n                    }\n\n                    xC").concat(j+1," = xTexelC").concat(j+2,";\n                    ")}}else j<b&&(f%2===1?(y+="\n                xCOffset = xC + 1 - ".concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelC").concat(j," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= ").concat(s,") {\n                    xTexelC").concat(j,".zw = vec2(0.0);\n                  }\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(s,") {\n                  xTexelC").concat(j+2," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= ").concat(s,") {\n                    xTexelC").concat(j+2,".zw = vec2(0.0);\n                  }\n                }\n\n                xC").concat(j," = vec4(xTexelC").concat(j,".zw, xTexelC").concat(j+2,".zw);\n              "),j+1<b&&(y+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + ".concat(h,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC").concat(j+1," = vec4(xTexelC").concat(j+2,".xy, final.xy);\n                "))):(y+="\n                if(xC >= 0 && xC < ".concat(s,") {\n                  xTexelC").concat(j," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= ").concat(s,") {\n                    xTexelC").concat(j,".zw = vec2(0.0);\n                  }\n                }\n\n                xCOffset = xC + ").concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelC").concat(j+2," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= ").concat(s,") {\n                    xTexelC").concat(j+2,".zw = vec2(0.);\n                  }\n                }\n\n                xC").concat(j," = vec4(\n                  xTexelC").concat(j,".xy, xTexelC").concat(j+2,".xy);\n              "),j+1<b&&(y+="\n                  xC".concat(j+1," = vec4(xTexelC").concat(j,".zw, xTexelC").concat(j+2,".zw);\n                "))));j<b&&(y+="\n            wTexel = getW(".concat(O,", ").concat(j,", d1, q);\n            dotProd += xC").concat(j," * vec4(wTexel.xz, wTexel.xz);\n          "),j+1<b&&(y+="\n              wTexel = getW(".concat(O,", ").concat(j+1,", d1, q);\n              dotProd += xC").concat(j+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}y+="\n        }\n      "}var S="",E="";r&&(S=i?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):o?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),E="result = activation(result);");var C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(S,"\n\n      const ivec2 strides = ivec2(").concat(d,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(l,", ").concat(f,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(u,";\n        int q = d2 - d1 * ").concat(u,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(y,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(C,"\n        ").concat(E,"\n        setOutput(result);\n      }\n    ")};var dO={kernelName:a.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=r.strides,c=r.pad,s=r.dilations,l=r.dimRoundingMode,f=s;null==f&&(f=[1,1]),a.util.assert(a.backend_util.eitherStridesOrDilationsAreOne(u,f),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(f,"'")}));var d,h=a.backend_util.computeConv2DInfo(i.shape,o.shape,u,f,c,l,!0);return d=Object(a.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new fO(h):new lO(h),n.runWebGLProgram(d,[i,o],"float32")}},hO=function e(t){Object(_n.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},pO=function e(t){Object(_n.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,u=r-1-t.padInfo.left,c=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(c,"; dm++) {\n              int d2 = d1 * ").concat(c," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var vO={kernelName:a.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.dy,u=r.strides,c=r.dilations,s=r.pad,l=r.dimRoundingMode,f=r.filterShape,d=a.backend_util.computeConv2DInfo(i.shape,f,u,c,s,l,!0),h=new hO(d);return n.runWebGLProgram(h,[i,o],"float32")}};var mO={kernelName:a.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.filter,u=r.strides,c=r.dilations,s=r.pad,l=r.dimRoundingMode,f=r.inputShape,d=a.backend_util.computeConv2DInfo(f,o.shape,u,c,s,l,!0),h=new pO(d);return n.runWebGLProgram(h,[i,o],"float32")}},bO=function e(t){Object(_n.a)(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "};var gO={kernelName:a.Diag,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=[].concat(Object(Nn.a)(r.shape),Object(Nn.a)(r.shape)),o=a.util.sizeFromShape(r.shape),u=ay({inputs:{x:r},backend:n,attrs:{shape:[o]}}),c=new bO(o),s=n.runWebGLProgram(c,[u],u.dtype),l=ay({inputs:{x:s},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(s),l}},yO=function e(t){Object(_n.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,u=t.filterHeight,c=t.filterWidth,s=t.dilationHeight,l=t.dilationWidth,f=a.top,d=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(u,"; h++) {\n          int hIn = hBeg + h * ").concat(s,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(c,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")};var xO={kernelName:a.Dilation2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,i=e.attrs,o=n.x,u=n.filter,c=i.strides,s=i.pad,l=i.dilations,f=a.backend_util.computeDilation2DInfo(o.shape,u.shape,c,s,"NHWC",l),d=new yO(f),h=ay({inputs:{x:t=r.runWebGLProgram(d,[o,u],"float32")},backend:r,attrs:{shape:f.outShape}});return r.disposeIntermediateTensorInfo(t),h}};var OO={kernelName:a.Einsum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.equation,i=t,o=a.backend_util.decodeEinsumEquation(r,i.length),u=o.allDims,c=o.summedDims,s=o.idDims;a.backend_util.checkEinsumDimSizes(u.length,s,i);for(var l=a.backend_util.getEinsumComputePath(c,s),f=l.path,d=l.steps,h=d.length,p=null,v=u.length,m=[],b=0;b<h;++b){var g,y=Object(Tn.a)(d[b]);try{for(y.s();!(g=y.n()).done;){var x=g.value,O=a.backend_util.getEinsumPermutation(v,s[x]),k=O.permutationIndices,w=O.expandDims,j=void 0;a.backend_util.isIdentityPermutation(k)?j=i[x]:(j=py({inputs:{x:i[x]},backend:n,attrs:{perm:k}}),m.push(j));for(var _=j.shape.slice(),S=0;S<w.length;++S)_.splice(w[S],0,1);a.util.arraysEqual(j.shape,_)||(j=ay({inputs:{x:j},backend:n,attrs:{shape:_}}),m.push(j)),null===p?p=j:(p=ny({inputs:{a:j,b:p},backend:n}),m.push(p))}}catch(N){y.e(N)}finally{y.f()}b<h-1&&(f[b]>=0&&(p=dy({inputs:{x:p},backend:n,attrs:{axis:f[b]-(u.length-v),keepDims:!1}}),m.push(p)),v--)}for(var E=0,C=m;E<C.length;E++){var A=C[E];A!==p&&n.disposeIntermediateTensorInfo(A)}return p}},kO=Xg({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),wO={kernelName:a.Elu,backendName:"webgl",kernelFunc:kO},jO={kernelName:a.EluGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,i=t.y,o=Object(a.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zg("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,i.shape):new Rg("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,i.shape);return n.runWebGLProgram(o,[r,i],r.dtype)}},_O=Yg({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool"}),SO={kernelName:a.Equal,backendName:"webgl",kernelFunc:_O},EO=Xg({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(a.backend_util.ERF_P,";\n  float a1 = ").concat(a.backend_util.ERF_A1,";\n  float a2 = ").concat(a.backend_util.ERF_A2,";\n  float a3 = ").concat(a.backend_util.ERF_A3,";\n  float a4 = ").concat(a.backend_util.ERF_A4,";\n  float a5 = ").concat(a.backend_util.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),CO={kernelName:a.Erf,backendName:"webgl",kernelFunc:EO},AO="return exp(x);",NO=Xg({opSnippet:AO,packedOpSnippet:AO,cpuKernelImpl:Lb}),TO={kernelName:a.Exp,backendName:"webgl",kernelFunc:NO};function IO(e){var t=e.inputs,n=e.attrs,r=e.backend,i=n.dim,o=t.input,u=o.shape.length,c=o.shape.slice(),s=i;return i<0&&(a.util.assert(-(u+1)<=i,(function(){return"Axis must be in the interval [".concat(-(u+1),", ").concat(u,"]")})),s=u+i+1),c.splice(s,0,1),ay({inputs:{x:o},backend:r,attrs:{shape:c}})}var DO={kernelName:a.ExpandDims,backendName:"webgl",kernelFunc:IO},FO="return exp(x) - 1.0;",MO=Xg({opSnippet:FO,packedOpSnippet:FO,cpuKernelImpl:Pb}),RO={kernelName:a.Expm1,backendName:"webgl",kernelFunc:MO},zO=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),u=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(u,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")};function LO(e,t,n){var r=n.texData.get(e.dataId),i=a.util.sizeFromShape(e.shape),o=e.shape[e.shape.length-1],u=ay({inputs:{x:e},backend:n,attrs:{shape:[i/o,o]}}),c=u.shape,s=new zO("real",c,t),l=new zO("imag",c,t),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],d=n.runWebGLProgram(s,f,"float32"),h=n.runWebGLProgram(l,f,"float32"),p=Bg({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);var v=ay({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(p),v}var PO={kernelName:a.FFT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return LO(t.input,!1,n)}},BO=function(){function e(t,n){Object(_n.a)(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}();function WO(e){var t=e.backend,n=e.attrs,r=n.shape,i=n.value,o=n.dtype;if("string"===(o=o||a.util.inferDtype(i))){var u=a.util.getArrayFromDType(o,a.util.sizeFromShape(r));return u.fill(i),t.makeTensorInfo(r,o,u)}var c=new BO(r,i),s=c.getCustomSetupFunc(i);return t.runWebGLProgram(c,[],o,s)}var UO,VO={kernelName:a.Fill,backendName:"webgl",kernelFunc:WO},qO=function e(t){Object(_n.a)(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},HO={kernelName:a.FlipLeftRight,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new qO(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},GO="return floor(x);",KO=Xg({opSnippet:GO,packedOpSnippet:GO,cpuKernelImpl:Bb}),XO={kernelName:a.Floor,backendName:"webgl",kernelFunc:KO},YO=Yg({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),$O={kernelName:a.FloorDiv,backendName:"webgl",kernelFunc:YO},JO=function e(t){Object(_n.a)(this,e),this.variableNames=["A"];var n=Km(),r=Object(i.a)(t,2),a=r[0],o=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(o,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")},QO=function e(t){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=Km(),r=Object(i.a)(t,2),a=r[0],o=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(o,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")},ZO={kernelName:a.FromPixels,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,u=r.numChannels,c="undefined"!==typeof HTMLVideoElement&&o instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&o instanceof HTMLImageElement,l=c?[o.videoWidth,o.videoHeight]:[o.width,o.height],f=Object(i.a)(l,2),d=f[0],h=f[1],p=[h,d],v=[h,d,u];(s||c)&&(null==UO&&(UO=document.createElement("canvas").getContext("2d")),UO.canvas.width=d,UO.canvas.height=h,UO.drawImage(o,0,0,d,h),o=UO.canvas);var m=n.makeTensorInfo(p,"int32");n.texData.get(m.dataId).usage=lm.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(m.dataId),o);var b=Object(a.env)().getBool("WEBGL_PACK")?new QO(v):new JO(v),g=n.runWebGLProgram(b,[m],"int32");return n.disposeData(m.dataId),g}};var ek={kernelName:a.FusedConv2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,i=e.attrs,o=n.x,u=n.filter,c=n.bias,s=n.preluActivationWeights,l=i.strides,f=i.pad,d=i.dataFormat,h=i.dilations,p=i.dimRoundingMode,v=i.activation,m=i.leakyreluAlpha,b=a.backend_util.convertConv2DDataFormat(d),g=a.backend_util.computeConv2DInfo(o.shape,u.shape,l,h,f,p,!1,b),y=[];if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(Object(a.env)().getBool("WEBGL_CONV_IM2COL")&&1===o.shape[0])t=Bx({x:o,filter:u,convInfo:g,backend:r,bias:c,activation:v,preluActivationWeights:s,leakyreluAlpha:m});else{var x=null!=c,O=null!=s,k="leakyrelu"===v,w=v?$g(v,!1):null,j=new Rx(g,x,w,O,k),_=[o,u];if(c&&_.push(c),s&&_.push(s),k){var S=r.makeTensorInfo([],"float32",a.util.createScalarValue(m,"float32"));_.push(S),y.push(S)}t=r.runWebGLProgram(j,_,"float32")}else t=Px({x:o,filter:u,convInfo:g,backend:r,bias:c,activation:v,preluActivationWeights:s,leakyreluAlpha:m});var E=ay({inputs:{x:t},backend:r,attrs:{shape:g.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),E}};var tk={kernelName:a.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.filter,u=t.bias,c=t.preluActivationWeights,s=r.strides,l=r.pad,f=r.dilations,d=r.dimRoundingMode,h=r.activation,p=r.leakyreluAlpha,v=[],m=f;null==m&&(m=[1,1]),a.util.assert(a.backend_util.eitherStridesOrDilationsAreOne(s,m),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(m,"'")}));var b,g=a.backend_util.computeConv2DInfo(i.shape,o.shape,s,m,l,d,!0),y=Object(a.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,x=h?$g(h,y):null,O=[i,o],k=null!=u,w=null!=c,j="leakyrelu"===h;if(k&&O.push(u),w&&O.push(c),j){var _=n.makeTensorInfo([],"float32",a.util.createScalarValue(p,"float32"));O.push(_),v.push(_)}b=y?new fO(g,k,x,w,j):new lO(g,k,x,w,j);var S=n.runWebGLProgram(b,O,"float32");return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),S}},nk=function e(t,n,r){Object(_n.a)(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=Sb(n.length),i=Sb(r.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(o,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")};var rk={kernelName:a.GatherNd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,o=t.indices,u=o.shape,c=u[u.length-1],s=a.backend_util.prepareAndValidate(r,o),l=Object(i.a)(s,4),f=l[0],d=l[1],h=l[2],p=l[3],v=ay({inputs:{x:o},backend:n,attrs:{shape:[d,c]}}),m=ay({inputs:{x:r},backend:n,attrs:{shape:[a.util.sizeFromShape(r.shape)/h,h]}}),b=new nk(c,p,[d,h]),g=n.runWebGLProgram(b,[m,v],m.dtype),y=ay({inputs:{x:g},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}},ak=function e(t,n){Object(_n.a)(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=Sb(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("int(getIndices(resRC.x, resRC.z))"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")};var ik={kernelName:a.GatherV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.indices,u=r.axis,c=r.batchDims,s=a.util.parseAxisParam(u,i.shape)[0],l=a.backend_util.segment_util.collectGatherOpShapeInfo(i,o,s,c),f=a.util.sizeFromShape(o.shape),d=[],h=ay({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),p=ay({inputs:{x:o},backend:n,attrs:{shape:[l.batchSize,f/l.batchSize]}});d.push(h),d.push(p);var v=[l.batchSize,l.outerSize,f/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([i,o])||"string"===i.dtype){var m=n.bufferSync(p),b=n.bufferSync(h),g=Wb(b,m,v);return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(l.outputShape,g.dtype,g.values)}var y=new ak(h.shape,v),x=n.runWebGLProgram(y,[h,p],h.dtype);d.push(x);var O=ay({inputs:{x:x},backend:n,attrs:{shape:l.outputShape}});return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),O}},ok=Yg({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:Ub,dtype:"bool"}),uk={kernelName:a.Greater,backendName:"webgl",kernelFunc:ok},ck=Yg({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool"}),sk={kernelName:a.GreaterEqual,backendName:"webgl",kernelFunc:ck};var lk={kernelName:a.IFFT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return LO(t.input,!0,n)}},fk=Xg({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),dk={kernelName:a.IsFinite,backendName:"webgl",kernelFunc:fk},hk=Xg({opSnippet:"return float(isinf(x));",dtype:"bool"}),pk={kernelName:a.IsInf,backendName:"webgl",kernelFunc:hk},vk=Xg({opSnippet:"return float(isnan(x));",dtype:"bool"}),mk={kernelName:a.IsNan,backendName:"webgl",kernelFunc:vk},bk=Yg({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:Vb,dtype:"bool"}),gk={kernelName:a.Less,backendName:"webgl",kernelFunc:bk},yk=Yg({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",dtype:"bool"}),xk={kernelName:a.LessEqual,backendName:"webgl",kernelFunc:yk};var Ok={kernelName:a.LinSpace,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=qb(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},kk=Xg({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Hb}),wk={kernelName:a.Log,backendName:"webgl",kernelFunc:kk},jk=Xg({opSnippet:"return log(1.0 + x);"}),_k={kernelName:a.Log1p,backendName:"webgl",kernelFunc:jk},Sk=Yg({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),Ek={kernelName:a.LogicalAnd,backendName:"webgl",kernelFunc:Sk},Ck=Xg({opSnippet:"return float(!(x >= 1.0));"}),Ak={kernelName:a.LogicalNot,backendName:"webgl",kernelFunc:Ck},Nk=Yg({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),Tk={kernelName:a.LogicalOr,backendName:"webgl",kernelFunc:Nk},Ik=function e(t,n,r,a,i){Object(_n.a)(this,e),this.variableNames=["x"],this.outputShape=[];var o,u=n,c=t[3]-1;this.outputShape=t;var s="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(s,")"):1===i?"1.0/(".concat(s,")"):"exp(log(".concat(s,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(u,"; j <= ").concat(u,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(c,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")},Dk=function e(t,n,r,a,i){Object(_n.a)(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,u=n,c=t[3]-1;this.outputShape=t;var s="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(s,")"):1===i?"1.0/(".concat(s,")"):"exp(log(".concat(s,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(u,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(u,"; j <= ").concat(u,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(c,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")},Fk={kernelName:a.LRN,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.depthRadius,u=r.bias,c=r.alpha,s=r.beta,l=Object(a.env)().getBool("WEBGL_PACK_NORMALIZATION")?new Dk(i.shape,o,u,c,s):new Ik(i.shape,o,u,c,s);return n.runWebGLProgram(l,[i],i.dtype)}},Mk=function e(t,n,r,a,i){Object(_n.a)(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")},Rk={kernelName:a.LRNGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,u=r.depthRadius,c=r.bias,s=r.alpha,l=r.beta,f=new Mk(a.shape,u,c,s,l);return n.runWebGLProgram(f,[a,i,o],a.dtype)}};function zk(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.reductionIndices,c=r.keepDims,s=o.shape.length,l=a.util.parseAxisParam(u,o.shape),f=l,d=a.backend_util.getAxesPermutation(f,s),h=null!=d,p=n.shouldExecuteOnCPU([o]),v=o;if(h){if(p){for(var m=n.texData.get(v.dataId).values,b=new Array(s),g=0;g<b.length;g++)b[g]=o.shape[d[g]];var y=ug(m,o.shape,o.dtype,d,b);v=n.makeTensorInfo(b,o.dtype),n.texData.get(v.dataId).values=y}else v=fy(o,d,n);f=a.backend_util.getInnerMostAxes(f.length,s)}a.backend_util.assertAxesAreInnerMostDims("max",f,s);var x,O=a.backend_util.computeOutAndReduceShapes(v.shape,f),k=Object(i.a)(O,2),w=k[0],j=k[1],_=w;if(c&&(_=a.backend_util.expandShapeToKeepDim(w,l)),p){var S=n.texData.get(v.dataId).values,E=Gb(S,a.util.sizeFromShape(j),_,o.dtype);x=n.makeTensorInfo(_,o.dtype),n.texData.get(x.dataId).values=E}else x=function(e,t,n,r){var i=a.util.sizeFromShape(t),o=ay({inputs:{x:e},attrs:{shape:[a.util.sizeFromShape(e.shape)/i,i]},backend:r}),u=cy(o,e.dtype,"max",r),c=ay({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),c}(v,j,_,n);return h&&n.disposeIntermediateTensorInfo(v),x}var Lk={kernelName:a.Max,backendName:"webgl",kernelFunc:zk},Pk=Yg({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Kb}),Bk={kernelName:a.Maximum,backendName:"webgl",kernelFunc:Pk};var Wk={kernelName:a.MaxPool,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x;Hm(i,"maxPool");var o=r.filterSize,u=r.strides,c=r.pad,s=r.dimRoundingMode;a.util.assert(a.backend_util.eitherStridesOrDilationsAreOne(u,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(u," and dilations '").concat(1,"'")}));var l=a.backend_util.computePool2DInfo(i.shape,o,u,1,c,s);if(1===l.filterWidth&&1===l.filterHeight&&a.util.arraysEqual(l.inShape,l.outShape))return Lg({inputs:{x:i},backend:n});var f=new Yy(l,"max",!1);return n.runWebGLProgram(f,[i],i.dtype)}};var Uk={kernelName:a.MaxPool3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.filterSize,u=r.strides,c=r.pad,s=r.dataFormat,l=r.dimRoundingMode,f=a.backend_util.computePool3DInfo(i.shape,o,u,[1,1,1],c,l,s),d=new $y(f,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}},Vk=function e(t){Object(_n.a)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,u=i-1-t.padInfo.top,c=o-1-t.padInfo.left,s=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(s," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},qk=function e(t){Object(_n.a)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,s=t.effectiveFilterHeight,l=t.effectiveFilterWidth,f=c-1-t.padInfo.front,d=s-1-t.padInfo.top,h=l-1-t.padInfo.left,p=c*s*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(d,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(c,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(s,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(u,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(p," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(s," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var Hk={kernelName:a.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.input,u=r.filterSize,c=r.strides,s=r.pad,l=r.dimRoundingMode,f=a.backend_util.computePool3DInfo(o.shape,u,c,[1,1,1],s,l),d=new $y(f,"max",!0),h=n.runWebGLProgram(d,[o],o.dtype),p=new qk(f),v=n.runWebGLProgram(p,[i,h],o.dtype);return n.disposeIntermediateTensorInfo(h),v}};var Gk={kernelName:a.MaxPoolGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.dy,o=t.input,u=o;Hm([o,t.output],"maxPoolGrad");var c=r.filterSize,s=r.strides,l=r.pad,f=r.dimRoundingMode,d=a.backend_util.computePool2DInfo(u.shape,c,s,1,l,f),h=new Yy(d,"max",!0),p=n.runWebGLProgram(h,[u],u.dtype),v=new Vk(d),m=n.runWebGLProgram(v,[i,p],u.dtype);return n.disposeIntermediateTensorInfo(p),m}};var Kk={kernelName:a.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,o=t.x,u=n.filterSize,c=n.strides,s=n.pad,l=n.includeBatchInIndex,f=r;a.util.assert(4===o.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.shape.length,".")}));var d=[1,1];a.util.assert(a.backend_util.eitherStridesOrDilationsAreOne(c,d),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(c," and dilations '").concat(d,"'")}));var h=a.backend_util.computePool2DInfo(o.shape,u,c,d,s),p=function(e,t,n,r){var a=new Yy(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new Yy(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(o,l,h,f),v=Object(i.a)(p,2);return[v[0],v[1]]}};var Xk={kernelName:a.Mean,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,o=t.x,u=n.keepDims,c=n.axis,s=r,l=o.shape.length,f=a.util.parseAxisParam(c,o.shape),d=f,h=a.backend_util.getAxesPermutation(d,l),p=null!=h,v=s.shouldExecuteOnCPU([o]),m=[],b=o;if(p){if(v){for(var g=s.texData.get(b.dataId).values,y=new Array(l),x=0;x<y.length;x++)y[x]=o.shape[h[x]];var O=ug(g,o.shape,o.dtype,h,y);b=s.makeTensorInfo(y,o.dtype),s.texData.get(b.dataId).values=O}else b=fy(o,h,s);m.push(b),d=a.backend_util.getInnerMostAxes(d.length,l)}a.backend_util.assertAxesAreInnerMostDims("sum",d,l);var k=a.backend_util.computeOutAndReduceShapes(b.shape,d),w=Object(i.a)(k,2),j=w[0],_=w[1],S=j;u&&(S=a.backend_util.expandShapeToKeepDim(j,f));for(var E=function(e,t,n,r){var i=a.util.sizeFromShape(t),o=ay({inputs:{x:e},attrs:{shape:[a.util.sizeFromShape(e.shape)/i,i]},backend:r}),u=cy(o,"float32","mean",r),c=ay({inputs:{x:u},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),c}(b,_,S,s),C=0,A=m;C<A.length;C++){var N=A[C];s.disposeIntermediateTensorInfo(N)}return E}};var Yk={kernelName:a.Min,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.x,u=r.axis,c=r.keepDims,s=o.shape.length,l=a.util.parseAxisParam(u,o.shape),f=l,d=a.backend_util.getAxesPermutation(f,s),h=o;null!=d&&(h=py({inputs:{x:o},backend:n,attrs:{perm:d}}),f=a.backend_util.getInnerMostAxes(f.length,o.shape.length)),a.backend_util.assertAxesAreInnerMostDims("min",f,s);var p,v=a.backend_util.computeOutAndReduceShapes(h.shape,f),m=Object(i.a)(v,2),b=m[0],g=m[1],y=ay({inputs:{x:h},backend:n,attrs:{shape:[-1,a.util.sizeFromShape(g)]}}),x=cy(y,y.dtype,"min",n);return p=ay(c?{inputs:{x:x},backend:n,attrs:{shape:a.backend_util.expandShapeToKeepDim(b,l)}}:{inputs:{x:x},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=d&&n.disposeIntermediateTensorInfo(h),p}},$k=Yg({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Xb}),Jk={kernelName:a.Minimum,backendName:"webgl",kernelFunc:$k},Qk=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Sb(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),s="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(s,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(s,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(c,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(u,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(s,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(s,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")},Zk=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Sb(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),c=lg("rc",a),s=lg("source",a),l="".concat(c[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(s.slice(-2).join(),")"),d="reflect"===r?0:1,h="";if(1===a){var p="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");h="\n        ".concat(i," rc = outputLoc;\n        ").concat(p,"\n        result[0] = getChannel(getX(").concat(s.join(),"), ").concat(f,");\n        ").concat(c[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(p,"\n          result[1] = getChannel(getX(").concat(s.join(),"), ").concat(f,");\n        }\n      ")}else{var v="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");h="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(s.join(),"), ").concat(f,");\n        ").concat(c[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(s.join(),"), ").concat(f,");\n        }\n        rc = outputLoc;\n        ").concat(c[a-2]," += 1;\n        if(").concat(c[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(v,"\n          result[2] = getChannel(getX(").concat(s.join(),"), ").concat(f,");\n          ").concat(c[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(v,"\n            result[3] = getChannel(getX(").concat(s.join(),"), ").concat(f,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")},ew={kernelName:a.MirrorPad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.paddings,u=r.mode,c=Object(a.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Zk(i.shape,o,u):new Qk(i.shape,o,u);return n.runWebGLProgram(c,[i],i.dtype)}},tw=Yg({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),nw={kernelName:a.Mod,backendName:"webgl",kernelFunc:tw},rw=function(){function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}(),aw=Yg({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),iw={kernelName:a.RealDiv,backendName:"webgl",kernelFunc:aw},ow="return a - b;",uw=Yg({opSnippet:ow,packedOpSnippet:ow,supportsComplex:!0,cpuKernelImpl:ag}),cw={kernelName:a.Sub,backendName:"webgl",kernelFunc:uw};function sw(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.logits,o=r.dim,u=a.util.parseAxisParam([o],i.shape),c=zk({inputs:{x:i},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),s=a.backend_util.expandShapeToKeepDim(c.shape,u),l=ay({inputs:{x:c},backend:n,attrs:{shape:s}}),f=uw({inputs:{a:i,b:l},backend:n}),d=NO({inputs:{x:f},backend:n}),h=dy({inputs:{x:d},backend:n,attrs:{axis:u,keepDims:!1}}),p=ay({inputs:{x:h},backend:n,attrs:{shape:s}}),v=aw({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),v}var lw={kernelName:a.Softmax,backendName:"webgl",kernelFunc:sw};var fw={kernelName:a.Multinomial,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,u=r.normalized,c=u?a:sw({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),s=c.shape[0],l=c.shape[1],f=new rw(s,l,i),d=f.getCustomSetupFunc(o),h=n.runWebGLProgram(f,[c],"int32",d);return u||n.disposeIntermediateTensorInfo(c),h}},dw="return -x;";var hw={kernelName:a.Neg,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,o=n.x;if(r.shouldExecuteOnCPU([o])){var u=r.texData.get(o.dataId),c=$b(u.values,o.shape,o.dtype),s=Object(i.a)(c,2),l=s[0],f=s[1];return r.makeTensorInfo(f,o.dtype,l)}return t=Object(a.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Tg(o.shape,dw):new bg(o.shape,dw),r.runWebGLProgram(t,[o],o.dtype)}},pw=a.kernel_impls.nonMaxSuppressionV3Impl;var vw={kernelName:a.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(e){a.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,i=t.boxes,o=t.scores,u=r.maxOutputSize,c=r.iouThreshold,s=r.scoreThreshold,l=n.readSync(i.dataId),f=n.readSync(o.dataId),d=pw(l,f,u,c,s).selectedIndices;return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},mw=a.kernel_impls.nonMaxSuppressionV4Impl;var bw={kernelName:a.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(e){a.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,i=t.boxes,o=t.scores,u=r.maxOutputSize,c=r.iouThreshold,s=r.scoreThreshold,l=r.padToMaxOutputSize,f=n.readSync(i.dataId),d=n.readSync(o.dataId),h=mw(f,d,u,c,s,l),p=h.selectedIndices,v=h.validOutputs;return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([v]))]}},gw=a.kernel_impls.nonMaxSuppressionV5Impl;var yw={kernelName:a.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(e){a.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,i=t.boxes,o=t.scores,u=r.maxOutputSize,c=r.iouThreshold,s=r.scoreThreshold,l=r.softNmsSigma,f=n.readSync(i.dataId),d=n.readSync(o.dataId),h=gw(f,d,u,c,s,l),p=h.selectedIndices,v=h.selectedScores;return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}},xw=function e(t,n,r,a){Object(_n.a)(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")},Ow={kernelName:a.OneHot,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.indices,o=r.depth,u=r.onValue,c=r.offValue,s=a.util.sizeFromShape(i.shape),l=new xw(s,o,u,c),f=ay({inputs:{x:i},backend:n,attrs:{shape:[s]}}),d=n.runWebGLProgram(l,[f],i.dtype);n.disposeIntermediateTensorInfo(f);var h=ay({inputs:{x:d},backend:n,attrs:{shape:[].concat(Object(Nn.a)(i.shape),[o])}});return n.disposeIntermediateTensorInfo(d),h}};function kw(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=mx({inputs:{input:r},backend:n}),i=kw({inputs:{x:a},backend:n}),o=Tx({inputs:{input:r},backend:n}),u=kw({inputs:{x:o},backend:n}),c=Bg({inputs:{real:i,imag:u},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}return WO({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var ww={kernelName:a.ZerosLike,backendName:"webgl",kernelFunc:kw};var jw={kernelName:a.OnesLike,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=mx({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),u=Tx({inputs:{input:a},backend:r}),c=kw({inputs:{x:u},backend:r}),s=Bg({inputs:{real:o,imag:c},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(c),s}return WO({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var _w={kernelName:a.Pack,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return IO({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var i=t[0].shape,o=t[0].dtype;t.forEach((function(e){a.util.assertShapesMatch(i,e.shape,"All tensors passed to stack must have matching shapes"),a.util.assert(o===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var u=[],c=Fx({inputs:t.map((function(e){var t=IO({inputs:{input:e},backend:n,attrs:{dim:r}});return u.push(t),t})),backend:n,attrs:{axis:r}});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}},Sw=function(){function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Sb(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(u,");\n      uniform float value;\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(c,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(u,";\n        uniform float value;\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),Ew=function(){function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=Sb(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),c=lg("rc",a),s=lg("source",a),l="".concat(c[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(s.slice(-2).join(),")"),d=["".concat(i," rc = outputLoc;"),"".concat(c[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(c[a-2]," += 1;\n       if(").concat(c[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(c[a-1]," += 1;\n         if(").concat(l,") {")],h=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",v=0,m=1===a?2:4;v<m;v++)p+="\n        ".concat(d[v],"\n        if (").concat(h,") {\n          result[").concat(v,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(s.join(),"), ").concat(f,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(u,");\n      uniform float value;\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),Cw=function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.paddings,u=r.constantValue,c=Object(a.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ew(i.shape,o,u):new Sw(i.shape,o,u),s=c.getCustomSetupFunc(u);return n.runWebGLProgram(c,[i],i.dtype,s)},Aw={kernelName:a.PadV2,backendName:"webgl",kernelFunc:Cw},Nw=Yg({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),Tw={kernelName:a.Pow,backendName:"webgl",kernelFunc:Nw};var Iw={kernelName:a.Prod,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,o=e.attrs,u=n.x,c=o.axis,s=o.keepDims,l=u.shape.length,f=[],d=a.util.parseAxisParam(c,u.shape),h=d,p=a.backend_util.getAxesPermutation(h,l),v=u;if(null!=p&&(v=py({inputs:{x:u},backend:r,attrs:{perm:p}}),h=a.backend_util.getInnerMostAxes(h.length,l),f.push(v)),a.backend_util.assertAxesAreInnerMostDims("prod",h,l),r.shouldExecuteOnCPU([v])){var m=r.texData.get(v.dataId).values,b=Jb(v.shape,v.dtype,m,h),g=b.outVals,y=b.outShape,x=b.outDtype;t=r.makeTensorInfo(y,x,g)}else{var O=a.backend_util.computeOutAndReduceShapes(v.shape,h),k=Object(i.a)(O,2),w=k[0],j=k[1],_=a.util.sizeFromShape(j),S=ay({inputs:{x:v},backend:r,attrs:{shape:[-1,_]}}),E=cy(S,Object(a.sumOutType)(u.dtype),"prod",r);t=ay({inputs:{x:E},backend:r,attrs:{shape:w}}),f.push(S),f.push(E)}if(s){f.push(t);var C=a.backend_util.expandShapeToKeepDim(t.shape,d);t=ay({inputs:{x:t},backend:r,attrs:{shape:C}})}return f.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}},Dw=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,u=Qb(r,a,i,o);return t.makeTensorInfo([u.length],o,u)},Fw={kernelName:a.Range,backendName:"webgl",kernelFunc:Dw},Mw=Xg({opSnippet:"return 1.0 / x;"}),Rw={kernelName:a.Reciprocal,backendName:"webgl",kernelFunc:Mw},zw=Xg({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Lw={kernelName:a.Relu,backendName:"webgl",kernelFunc:zw},Pw=Xg({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Bw={kernelName:a.Relu6,backendName:"webgl",kernelFunc:Pw},Ww=function e(t,n,r,a,o){Object(_n.a)(this,e),this.variableNames=["A"],this.outputShape=[];var u=Object(i.a)(t,4),c=u[0],s=u[1],l=u[2],f=u[3];this.outputShape=[c,n,r,f];var d,h=[a&&n>1?s-1:s,a&&r>1?l-1:l],p=[a&&n>1?n-1:n,a&&r>1?r-1:r];d=o?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(h[0]/p[0],",\n          ").concat(h[1]/p[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")},Uw=function e(t,n,r,a,o){Object(_n.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var u=Object(i.a)(t,4),c=u[0],s=u[1],l=u[2],f=u[3];this.outputShape=[c,n,r,f];var d,h=[a&&n>1?s-1:s,a&&r>1?l-1:l],p=[a&&n>1?n-1:n,a&&r>1?r-1:r];d=o?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(h[0]/p[0],",\n          ").concat(h[1]/p[1],",\n          ").concat(h[1]/p[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(l,".0,\n                                     ").concat(l,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(f-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")};var Vw={kernelName:a.ResizeBilinear,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.images,u=r.alignCorners,c=r.halfPixelCenters,s=r.size,l=Object(i.a)(s,2),f=l[0],d=l[1],h=Object(a.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Uw(o.shape,f,d,u,c):new Ww(o.shape,f,d,u,c);return n.runWebGLProgram(h,[o],"float32")}},qw=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Object(i.a)(n,3),o=a[1],u=a[2],c=Object(i.a)(t,3),s=c[1],l=c[2],f=[r&&s>1?o-1:o,r&&l>1?u-1:u],d=[r&&s>1?s-1:s,r&&l>1?l-1:l],h=f[0]/d[0],p=f[1]/d[1],v=1/h,m=1/p,b=2*Math.ceil(v)+2,g=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(h,");\n        const float widthScale = float(").concat(p,");\n\n        const float invHeightScale = float(").concat(v,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(b,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(o-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(u-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};var Hw={kernelName:a.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,u=new qw(i.shape,a.shape,o);return n.runWebGLProgram(u,[i],i.dtype)}},Gw=function e(t,n,r,a,o){Object(_n.a)(this,e),this.variableNames=["A"],this.outputShape=[];var u=Object(i.a)(t,4),c=u[0],s=u[1],l=u[2],f=u[3];this.outputShape=[c,n,r,f];var d,h=[a&&n>1?s-1:s,a&&r>1?l-1:l],p=[a&&n>1?n-1:n,a&&r>1?r-1:r],v=a?"0.5":"0.0";d=o?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(h[0]/p[0],",\n          ").concat(h[1]/p[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(v,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")};var Kw={kernelName:a.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,o=r.alignCorners,u=r.halfPixelCenters,c=r.size,s=Object(i.a)(c,2),l=s[0],f=s[1],d=new Gw(a.shape,l,f,o,u);return n.runWebGLProgram(d,[a],a.dtype)}},Xw=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Object(i.a)(n,3),o=a[1],u=a[2],c=Object(i.a)(t,3),s=c[1],l=c[2],f=[r&&s>1?o-1:o,r&&l>1?u-1:u],d=[r&&s>1?s-1:s,r&&l>1?l-1:l],h=f[0]/d[0],p=f[1]/d[1],v=1/h,m=1/p,b=2*Math.ceil(v)+2,g=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(h,");\n        const float widthScale = float(").concat(p,");\n\n        const float invHeightScale = float(").concat(v,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(b,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(f[0],") *\n                (float(dyR) / float(").concat(d[0],"));\n\n            float sourceFracCol =\n                float(").concat(f[1],") *\n                  (float(dyC) / float(").concat(d[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(u,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};var Yw={kernelName:a.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,u=new Xw(i.shape,a.shape,o);return n.runWebGLProgram(u,[i],i.dtype)}},$w=function e(t,n){Object(_n.a)(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=Sb(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")},Jw=function e(t,n){Object(_n.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=lg("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),u=Sb(r);function c(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(u," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return c(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",c(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",c(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",c(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")};var Qw={kernelName:a.Reverse,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.dims,u=i.shape.length,c=a.util.parseAxisParam(o,i.shape);if(0===u)return Lg({inputs:{x:i},backend:n});var s=Object(a.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Jw(i.shape,c):new $w(i.shape,c);return n.runWebGLProgram(s,[i],i.dtype)}},Zw=function(){function e(t,n){Object(_n.a)(this,e),this.variableNames=["Image"],this.outputShape=[];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        uniform vec4 params;\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}return Object(Sn.a)(e,[{key:"getCustomSetupFunc",value:function(e,t,n,r){var a=this;return function(i,o){null==a.paramsLoc&&(a.paramsLoc=i.getUniformLocationNoThrow(o,"params")),i.gl.uniform4f(a.paramsLoc,e,t,n,r)}}}]),e}(),ej={kernelName:a.RotateWithOffset,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,o=t.image,u=n.radians,c=n.fillValue,s=n.center,l=r,f=new Zw(o.shape,c),d=a.backend_util.getImageCenter(s,o.shape[1],o.shape[2]),h=Object(i.a)(d,2),p=h[0],v=h[1],m=f.getCustomSetupFunc(p,v,Math.sin(u),Math.cos(u));return l.runWebGLProgram(f,[o],o.dtype,m)}},tj=Xg({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),nj={kernelName:a.Round,backendName:"webgl",kernelFunc:tj},rj=Xg({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Zb}),aj={kernelName:a.Rsqrt,backendName:"webgl",kernelFunc:rj},ij=function e(t,n,r,a,i,o){Object(_n.a)(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var u=Sb(i.length),c=Sb(o.length),s="";1===r?s="i":2===r&&(s="i, j");var l="getIndices(".concat(s,")"),f="";1===a?f="i":2===a&&(f="i, coords[1]");var d="getUpdates(".concat(f,")"),h=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(h,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(d,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")};var oj={kernelName:a.ScatterNd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.indices,o=t.updates,u=r.shape,c=a.backend_util.calculateShapes(o,i,u),s=c.sliceRank,l=c.numUpdates,f=c.sliceSize,d=c.strides,h=c.outputSize,p=[h/f,f];if(0===h)return n.makeTensorInfo(u,i.dtype);var v=ay({inputs:{x:i},backend:n,attrs:{shape:[l,s]}}),m=ay({inputs:{x:o},backend:n,attrs:{shape:[l,f]}}),b=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new ij(l,s,v.shape.length,m.shape.length,d,p),y=n.runWebGLProgram(g,[m,v,b],m.dtype),x=ay({inputs:{x:y},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),x}},uj=function e(t,n,r){var a,i;if(Object(_n.a)(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],c=[],s=0;s<n.length;s++)c.push("".concat(o[s])),s<t&&u.push("".concat(o[s]));a=u.join(),i=c.join()}var l=Sb(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")};var cj={kernelName:a.Select,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,i=t.t,o=t.e,u=new uj(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(u,[r,i,o],Object(a.upcastType)(i.dtype,o.dtype))}},sj=Xg({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(a.backend_util.SELU_SCALEALPHA,";\n  float scale = ").concat(a.backend_util.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),lj={kernelName:a.Selu,backendName:"webgl",kernelFunc:sj},fj=Xg({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),dj={kernelName:a.Sigmoid,backendName:"webgl",kernelFunc:fj},hj=Xg({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),pj={kernelName:a.Sign,backendName:"webgl",kernelFunc:hj},vj=Xg({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),mj={kernelName:a.Sin,backendName:"webgl",kernelFunc:vj},bj=Xg({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),gj={kernelName:a.Sinh,backendName:"webgl",kernelFunc:bj},yj=Xg({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),xj={kernelName:a.Softplus,backendName:"webgl",kernelFunc:yj},Oj={kernelName:a.SpaceToBatchND,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.blockShape,u=r.paddings;a.util.assert(i.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var c=o.reduce((function(e,t){return e*t})),s=[[0,0]];s.push.apply(s,Object(Nn.a)(u));for(var l=1+o.length;l<i.shape.length;++l)s.push([0,0]);var f=[],d=Cw({inputs:{x:i},backend:n,attrs:{paddings:s,constantValue:0}}),h=a.backend_util.getReshaped(d.shape,o,c,!1),p=a.backend_util.getPermuted(h.length,o.length,!1),v=a.backend_util.getReshapedPermuted(d.shape,o,c,!1),m=ay({inputs:{x:d},backend:n,attrs:{shape:h}}),b=py({inputs:{x:m},backend:n,attrs:{perm:p}}),g=ay({inputs:{x:b},backend:n,attrs:{shape:v}});return f.push(d),f.push(m),f.push(b),f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var kj={kernelName:a.SparseReshape,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,o=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));var u=Array.from(n.readSync(a.dataId)),c=n.readSync(r.dataId),s=Array.from(n.readSync(o.dataId)),l=ng(c,r.shape,r.dtype,u,s),f=Object(i.a)(l,3),d=f[0],h=f[1],p=f[2];return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([p.length],o.dtype,new Int32Array(p))]}};var wj={kernelName:a.SparseToDense,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.sparseIndices,o=t.sparseValues,u=t.defaultValue,c=r.outputShape,s=a.backend_util.calculateShapes(o,i,c),l=s.sliceRank,f=s.numUpdates,d=s.strides,h=s.outputSize,p=new ij(f,l,i.shape.length,o.shape.length,d,[h,1],!1),v=n.runWebGLProgram(p,[o,i,u],o.dtype),m=ay({inputs:{x:v},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(v),m}};var jj={kernelName:a.SplitV,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.numOrSizeSplits,u=r.axis,c=a.util.parseAxisParam(u,i.shape)[0],s=a.backend_util.prepareSplitSize(i,o,c),l=i.shape.length,f=new Array(l).fill(0),d=i.shape.slice();return s.map((function(e){var t=Object(Nn.a)(d);t[c]=e;var r=lx({inputs:{x:i},backend:n,attrs:{begin:f,size:t}});return f[c]+=e,r}))}},_j=Xg({opSnippet:"return sqrt(x);"}),Sj={kernelName:a.Sqrt,backendName:"webgl",kernelFunc:_j},Ej=Xg({opSnippet:"return x * x;"}),Cj={kernelName:a.Square,backendName:"webgl",kernelFunc:Ej},Aj="return (a - b) * (a - b);",Nj=Yg({opSnippet:Aj,packedOpSnippet:Aj}),Tj={kernelName:a.SquaredDifference,backendName:"webgl",kernelFunc:Nj};var Ij={kernelName:a.Step,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=gg+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new bg(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},Dj=function e(t,n,r){Object(_n.a)(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=Sb(r.length),o=Sb(r.length),u="";if(1===a)u="coords * strides + begin";else{var c=0;u=r.map((function(e,t){return c++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(c-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(u,"));\n      }\n    ")};var Fj={kernelName:a.StridedSlice,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,i=e.attrs,o=n.x,u=i.begin,c=i.end,s=i.strides,l=i.beginMask,f=i.endMask,d=i.ellipsisMask,h=i.newAxisMask,p=i.shrinkAxisMask,v=a.slice_util.sliceInfo(o.shape,u,c,s,l,f,d,h,p),m=v.nonStrided,b=v.$begin,g=v.$strides,y=v.size,x=v.newShape,O=v.outShape,k=ay({inputs:{x:o},backend:r,attrs:{shape:x}});if(m){var w=lx({inputs:{x:k},backend:r,attrs:{begin:b,size:y}});t=ay({inputs:{x:w},backend:r,attrs:{shape:O}}),r.disposeIntermediateTensorInfo(w)}else if(O.some((function(e){return 0===e})))t=r.makeTensorInfo(O,o.dtype,[]);else{if(r.shouldExecuteOnCPU([k])){var j=r.texData.get(k.dataId).values,_=Object(a.buffer)(k.shape,k.dtype,j),S=rg(O,_,g,b);t=r.makeTensorInfo(O,k.dtype,S.values)}else{var E=new Dj(b,g,O);t=r.runWebGLProgram(E,[k],k.dtype)}}var C=ay({inputs:{x:t},backend:r,attrs:{shape:O}});return r.disposeIntermediateTensorInfo(k),r.disposeIntermediateTensorInfo(t),C}},Mj=Xg({opSnippet:"return tan(x);"}),Rj={kernelName:a.Tan,backendName:"webgl",kernelFunc:Mj},zj=Xg({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Lj={kernelName:a.Tanh,backendName:"webgl",kernelFunc:zj},Pj=function e(t,n){Object(_n.a)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=Sb(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")};function Bj(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=r.reps;if("string"===i.dtype||i.shape.length>5){var u=n.readSync(i.dataId).map((function(e){return a.util.decodeString(e)})),c=Object(a.buffer)(i.shape,i.dtype,u),s=ig(c,o);return n.makeTensorInfo(s.shape,s.dtype,s.values)}var l=new Pj(i.shape,o);return n.runWebGLProgram(l,[i],i.dtype)}var Wj={kernelName:a.Tile,backendName:"webgl",kernelFunc:Bj};var Uj={kernelName:a.TopK,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.k,u=r.sorted,c=n.readSync(a.dataId),s=og(c,a.shape,a.dtype,o,u),l=Object(i.a)(s,2),f=l[0],d=l[1];return[n.makeTensorInfo(f.shape,f.dtype,f.values),n.makeTensorInfo(d.shape,d.dtype,d.values)]}},Vj=function e(t,n,r,a,i,o){Object(_n.a)(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var u,c="nearest"===r?1:2;switch(a){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(u," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(u," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(u," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(c," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")};var qj={kernelName:a.Transform,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,o=t.transforms,u=r.interpolation,c=r.fillMode,s=r.fillValue,l=r.outputShape,f=Object(i.a)(a.shape,4),d=f[0],h=f[1],p=f[2],v=f[3],m=null!=l?l:[h,p],b=Object(i.a)(m,2),g=b[0],y=b[1],x=new Vj(h,p,u,c,s,[d,g,y,v]);return n.runWebGLProgram(x,[a,o],"float32")}};var Hj={kernelName:a.Unique,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;Hm(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),u=cg(o,a,i.shape,i.dtype),c=u.outputValues,s=u.outputShape,l=u.indices;return[r.makeTensorInfo(s,i.dtype,c),r.makeTensorInfo([l.length],"int32",l)]}};var Gj={kernelName:a.Unpack,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,u=o.shape.length,c=a.shape[i],s=new Array(u-1),l=0,f=0;f<u;f++)f!==i&&(s[l++]=o.shape[f]);var d=[],h=new Array(u).fill(0),p=o.shape.slice();p[i]=1;for(var v=new Array(c),m=0;m<v.length;m++){h[i]=m;var b=lx({inputs:{x:o},backend:n,attrs:{begin:h,size:p}}),g=ay({inputs:{x:b},backend:n,attrs:{shape:s}});v[m]=g,d.push(b)}return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}},Kj=function e(t,n){Object(_n.a)(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,u=o*Math.ceil(i/r);this.outputShape=[a,u];var c=4*Math.floor(r/4),s=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")};for(var Xj=0,Yj=[Fk,Rk,by,yy,Oy,wy,Sy,Ay,Ny,Ty,zy,Ly,By,Uy,Gy,qy,Xy,Qy,Jy,tx,nx,rx,ox,dx,hx,gx,Ox,jx,Ex,Wg,Mx,Gx,Kx,Wx,Yx,$x,Xx,Qx,eO,nO,oO,uO,sO,vO,mO,dO,gO,xO,OO,wO,jO,SO,CO,TO,DO,RO,PO,VO,HO,XO,$O,ZO,ek,tk,rk,ik,uk,sk,Pg,lk,Ix,dk,pk,mk,qg,gk,xk,Ok,_k,wk,Ek,Ak,Tk,Lk,Uk,Wk,Hk,Gk,Kk,Bk,Xk,Yk,Jk,ew,nw,fw,ry,hw,vw,bw,yw,vx,Ow,jw,_w,Aw,Tw,Kg,Iw,Fw,bx,iw,Rw,Bw,Lw,iy,Vw,Hw,Kw,Yw,Qw,ej,nj,aj,oj,cj,lj,dj,pj,mj,gj,fx,lw,xj,Oj,kj,wj,jj,Sj,Cj,Tj,Ij,Fj,cw,hy,Rj,Lj,Wj,Uj,qj,vy,Hj,Gj,{kernelName:a.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.x,o=t.segmentIds,u=r.numSegments,c=i.shape.length,s=[],l=0,f=a.backend_util.getAxesPermutation([l],c),d=i;null!=f&&(d=py({inputs:{x:i},backend:n,attrs:{perm:f}}),s.push(d),l=a.backend_util.getInnerMostAxes(1,c)[0]);var h=a.backend_util.segment_util.computeOutShape(d.shape,l,u),p=a.util.sizeFromShape([d.shape[l]]),v=ay({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});s.push(v);var m=ay({inputs:{x:function e(t,r,i,o,u){var c=t.shape[0],l=t.shape[1],f=a.backend_util.segment_util.segOpComputeOptimalWindowSize(l,u),d=new Kj({windowSize:f,inSize:l,batchSize:c,numSegments:u},r),h=n.compileAndRun(d,[t,i],o);if(s.push(h),h.shape[1]===u)return h;var p=Dw({backend:n,attrs:{start:0,stop:u,step:1,dtype:"float32"}}),v=Bj({inputs:{x:p},backend:n,attrs:{reps:[l/f]}});return s.push(p),s.push(v),e(h,r,v,o,u)}(v,"unsortedSegmentSum",o,Object(a.sumOutType)(i.dtype),u)},backend:n,attrs:{shape:h}}),b=m;if(null!=f){s.push(m);var g=a.backend_util.getUndoAxesPermutation(f);b=py({inputs:{x:b},backend:n,attrs:{perm:g}})}return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),b}},ww];Xj<Yj.length;Xj++){var $j=Yj[Xj];Object(a.registerKernel)($j)}a.version_core,ll.b},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(163),a=n(82),i={prepend:!1};t.subSurface=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.getDrawArea(e),u=r.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),c=r.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),s=Object.assign({},i,n),l=o.querySelector("div[data-name=".concat(t,"]"));if(!l){if((l=document.createElement("div")).setAttribute("class","".concat(u)),l.dataset.name=t,s.title){var f=document.createElement("div");f.setAttribute("class","subsurface-title ".concat(c)),f.innerText=s.title,l.appendChild(f)}s.prepend?o.insertBefore(l,o.firstChild):o.appendChild(l)}return l},t.getDefaultWidth=function(e){for(var t=0,n=e;n&&0===n.clientWidth;)n=n.parentElement,t=50;return n.clientWidth-t},t.getDefaultHeight=function(e){return 0===e.clientHeight?200:e.clientHeight}},function(e,t,n){"use strict";var r,a,i,o,u;n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(a||(a={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(i||(i={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(o||(o={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(u||(u={}));var c={float32:o,int32:a,bool:i,complex64:u};function s(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return c[e][t]}function l(e){return s(e,"int32")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(24),l=n(11);var f=Object(l.b)({maximum_:function(e,t){var n=Object(u.a)(e,"a","maximum"),l=Object(u.a)(t,"b","maximum"),f=Object(o.makeTypesMatch)(n,l),d=Object(r.a)(f,2);n=d[0],l=d[1],"bool"===n.dtype&&(n=Object(s.a)(n,"int32"),l=Object(s.a)(l,"int32")),Object(c.a)(n.shape,l.shape);var h={a:n,b:l};return a.a.runKernel(i.Ob,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({batchToSpaceND_:function(e,t,n){var u=Object(i.a)(e,"x","batchToSpaceND"),c=t.reduce((function(e,t){return e*t}));o.b(u.rank>=1+t.length,(function(){return"input rank is ".concat(u.rank," but should be > than blockShape.length ").concat(t.length)})),o.b(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),o.b(u.shape[0]%c===0,(function(){return"input tensor batch is ".concat(u.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(c)}));var s={x:u},l={blockShape:t,crops:n};return r.a.runKernel(a.t,s,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11),c=n(18);var s=Object(u.b)({depthwiseConv2d_:function(e,t,n,u){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],f=arguments.length>6?arguments[6]:void 0,d=Object(i.a)(e,"x","depthwiseConv2d"),h=Object(i.a)(t,"filter","depthwiseConv2d"),p=d,v=!1;3===d.rank&&(v=!0,p=Object(c.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.b(4===p.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,".")})),o.b(4===h.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(h.rank,".")})),o.b(p.shape[3]===h.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(p.shape[3],") must match the inChannels dimension in ")+"filter ".concat(h.shape[2],".")})),null!=f&&o.b(o.v(u),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(u,".")}));var m={x:p,filter:h},b={strides:n,pad:u,dataFormat:s,dilations:l,dimRoundingMode:f},g=r.a.runKernel(a.O,m,b);return v?Object(c.a)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(11);var l=Object(s.b)({equal_:function(e,t){var n=Object(u.a)(e,"a","equal"),s=Object(u.a)(t,"b","equal"),l=Object(o.makeTypesMatch)(n,s),f=Object(r.a)(l,2);n=f[0],s=f[1],Object(c.a)(n.shape,s.shape);var d={a:n,b:s};return a.a.runKernel(i.Y,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=Object(i.a)(e,"x","gather"),c=Object(i.a)(t,"indices","gather","int32"),s={x:u,indices:c},l={axis:n,batchDims:o};return r.a.runKernel(a.nb,s,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({logicalNot_:function(e){var t={x:Object(i.a)(e,"x","logicalNot","bool")};return r.a.runKernel(a.Gb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({spaceToBatchND_:function(e,t,n){var u=Object(i.a)(e,"x","spaceToBatchND");o.b(u.rank>=1+t.length,(function(){return"input rank ".concat(u.rank," should be > than [blockShape] ").concat(t.length)})),o.b(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),o.b(u.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(u.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var c={x:u},s={blockShape:t,paddings:n};return r.a.runKernel(a.Ic,c,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(6),a=n(19),i=n(11),o=n(18);var u=Object(i.b)({squeeze_:function(e,t){var n=Object(r.a)(e,"x","squeeze");return Object(o.a)(n,Object(a.Q)(n.shape,t).newShape)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(169);function a(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6),a=n(60);function i(e,t,n){var i=Object(r.c)(e,n);return Object(a.a)(e,t,i,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(76),u=n(11),c=n(18);var s=Object(u.b)({broadcastTo_:function(e,t){var n=Object(i.a)(e,"broadcastTo","x"),u=n.shape;if(t.some((function(e){return!(e>0)||e%1!==0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var s=n.shape.slice();s.length<t.length;)s.unshift(1);n=Object(c.a)(n,s)}for(var l=n.shape,f=Array.from(t),d=t.length-1;d>=0;d--)if(l[d]===t[d])f[d]=1;else if(1!==n.shape[d])throw new Error("broadcastTo(): [".concat(u,"] cannot be broadcast to [").concat(t,"]."));if(0===f.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length)return Object(o.a)(n);var h={x:n},p={reps:f};return r.a.runKernel(a.Vc,h,p)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c}));var r=n(3),a=n(10),i=n(94),o=(n(157),function(){function e(t,n,a,o,u){Object(r.a)(this,e),this.mean=t,this.stdDev=n,this.dtype=a,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var c=u||Math.random();this.random=i.alea(c.toString())}return Object(a.a)(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var u=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*u,n=this.mean+this.stdDev*i*u,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}()),u=function(){function e(t,n,a,u){Object(r.a)(this,e),this.alpha=t,this.beta=1/n,this.dtype=a;var c=u||Math.random();this.randu=i.alea(c.toString()),this.randn=new o(0,1,a,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return Object(a.a)(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),c=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0;if(Object(r.a)(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=a-n,this.dtype=o,null==u&&(u=Math.random()),"number"===typeof u&&(u=u.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(a," <= 1 and dtype is not float"));this.random=i.alea(u)}return Object(a.a)(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(0);function a(e){return Object(r.a)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M17 2h3a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h3V0h2v2h6V0h2v2zm0 2v2h-2V4H9v2H7V4H5v16h14V4h-2zM7 8h10v2H7V8zm0 4h10v2H7v-2z"}}]}]})(e)}function i(e){return Object(r.a)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm0-9.414l2.828-2.829 1.415 1.415L13.414 12l2.829 2.828-1.415 1.415L12 13.414l-2.828 2.829-1.415-1.415L10.586 12 7.757 9.172l1.415-1.415L12 10.586z"}}]}]})(e)}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r={};function a(e){return r[e]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","min"),u={x:o},c={axis:t,keepDims:n};return r.a.runKernel(a.Qb,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var u=Object(i.a)(e,"indices","oneHot","int32"),c={indices:u},s={depth:t,onValue:n,offValue:o};return r.a.runKernel(a.bc,c,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({real_:function(e){var t={input:Object(i.a)(e,"input","real")};return r.a.runKernel(a.kc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(19),o=n(11);var u=Object(o.b)({ifft_:function(e){Object(i.b)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.a.runKernel(a.qb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return kn})),n.d(t,"b",(function(){return jn}));var r={};n.r(r),n.d(r,"abs",(function(){return Ae.b})),n.d(r,"acos",(function(){return Ae.c})),n.d(r,"acosh",(function(){return Ae.d})),n.d(r,"add",(function(){return Ae.e})),n.d(r,"addN",(function(){return Ae.f})),n.d(r,"all",(function(){return Ae.g})),n.d(r,"any",(function(){return Ae.h})),n.d(r,"argMax",(function(){return Ae.i})),n.d(r,"argMin",(function(){return Ae.j})),n.d(r,"asin",(function(){return Ae.k})),n.d(r,"asinh",(function(){return Ae.l})),n.d(r,"atan",(function(){return Ae.m})),n.d(r,"atan2",(function(){return Ae.n})),n.d(r,"atanh",(function(){return Ae.o})),n.d(r,"avgPool",(function(){return Ae.p})),n.d(r,"avgPool3d",(function(){return Ae.q})),n.d(r,"basicLSTMCell",(function(){return Ae.r})),n.d(r,"batchToSpaceND",(function(){return Ae.w})),n.d(r,"batchNorm",(function(){return Ae.s})),n.d(r,"batchNorm2d",(function(){return Ae.t})),n.d(r,"batchNorm3d",(function(){return Ae.u})),n.d(r,"batchNorm4d",(function(){return Ae.v})),n.d(r,"bincount",(function(){return Ae.x})),n.d(r,"broadcastTo",(function(){return Ae.z})),n.d(r,"buffer",(function(){return Ae.A})),n.d(r,"cast",(function(){return Ae.B})),n.d(r,"ceil",(function(){return Ae.C})),n.d(r,"clipByValue",(function(){return Ae.D})),n.d(r,"clone",(function(){return Ae.E})),n.d(r,"complex",(function(){return Ae.F})),n.d(r,"concat",(function(){return Ae.G})),n.d(r,"concat1d",(function(){return Ae.H})),n.d(r,"concat2d",(function(){return Ae.I})),n.d(r,"concat3d",(function(){return Ae.J})),n.d(r,"concat4d",(function(){return Ae.K})),n.d(r,"conv1d",(function(){return Ae.L})),n.d(r,"conv2d",(function(){return Ae.M})),n.d(r,"conv2dTranspose",(function(){return Ae.N})),n.d(r,"conv3d",(function(){return Ae.O})),n.d(r,"conv3dTranspose",(function(){return Ae.P})),n.d(r,"cos",(function(){return Ae.Q})),n.d(r,"cosh",(function(){return Ae.R})),n.d(r,"cumsum",(function(){return Ae.T})),n.d(r,"denseBincount",(function(){return Ae.U})),n.d(r,"depthToSpace",(function(){return Ae.V})),n.d(r,"depthwiseConv2d",(function(){return Ae.W})),n.d(r,"diag",(function(){return Ae.X})),n.d(r,"dilation2d",(function(){return Ae.Y})),n.d(r,"div",(function(){return Ae.Z})),n.d(r,"divNoNan",(function(){return Ae.ab})),n.d(r,"dot",(function(){return Ae.bb})),n.d(r,"einsum",(function(){return Ae.db})),n.d(r,"elu",(function(){return Ae.eb})),n.d(r,"equal",(function(){return Ae.gb})),n.d(r,"erf",(function(){return Ae.hb})),n.d(r,"exp",(function(){return Ae.ib})),n.d(r,"expandDims",(function(){return Ae.jb})),n.d(r,"expm1",(function(){return Ae.kb})),n.d(r,"eye",(function(){return Ae.lb})),n.d(r,"fill",(function(){return Ae.nb})),n.d(r,"floor",(function(){return Ae.ob})),n.d(r,"floorDiv",(function(){return Ae.pb})),n.d(r,"gather",(function(){return Ae.rb})),n.d(r,"greater",(function(){return Ae.tb})),n.d(r,"greaterEqual",(function(){return Ae.ub})),n.d(r,"imag",(function(){return Ae.wb})),n.d(r,"isFinite",(function(){return Ae.Ab})),n.d(r,"isInf",(function(){return Ae.Bb})),n.d(r,"isNaN",(function(){return Ae.Cb})),n.d(r,"leakyRelu",(function(){return Ae.Db})),n.d(r,"less",(function(){return Ae.Eb})),n.d(r,"lessEqual",(function(){return Ae.Fb})),n.d(r,"linspace",(function(){return Ae.Hb})),n.d(r,"localResponseNormalization",(function(){return Ae.Ib})),n.d(r,"log",(function(){return Ae.Jb})),n.d(r,"log1p",(function(){return Ae.Kb})),n.d(r,"logSigmoid",(function(){return Ae.Lb})),n.d(r,"logSoftmax",(function(){return Ae.Mb})),n.d(r,"logSumExp",(function(){return Ae.Nb})),n.d(r,"logicalAnd",(function(){return Ae.Ob})),n.d(r,"logicalNot",(function(){return Ae.Pb})),n.d(r,"logicalOr",(function(){return Ae.Qb})),n.d(r,"logicalXor",(function(){return Ae.Rb})),n.d(r,"matMul",(function(){return Ae.Tb})),n.d(r,"max",(function(){return Ae.Ub})),n.d(r,"maxPool",(function(){return Ae.Vb})),n.d(r,"maxPool3d",(function(){return Ae.Wb})),n.d(r,"maxPoolWithArgmax",(function(){return Ae.Xb})),n.d(r,"maximum",(function(){return Ae.Yb})),n.d(r,"mean",(function(){return Ae.Zb})),n.d(r,"meshgrid",(function(){return Ae.ac})),n.d(r,"min",(function(){return Ae.bc})),n.d(r,"minimum",(function(){return Ae.cc})),n.d(r,"mirrorPad",(function(){return Ae.dc})),n.d(r,"mod",(function(){return Ae.ec})),n.d(r,"moments",(function(){return Ae.fc})),n.d(r,"mul",(function(){return Ae.hc})),n.d(r,"multiRNNCell",(function(){return Ae.ic})),n.d(r,"multinomial",(function(){return Ae.jc})),n.d(r,"neg",(function(){return Ae.kc})),n.d(r,"notEqual",(function(){return Ae.mc})),n.d(r,"oneHot",(function(){return Ae.nc})),n.d(r,"ones",(function(){return Ae.oc})),n.d(r,"onesLike",(function(){return Ae.pc})),n.d(r,"outerProduct",(function(){return Ae.rc})),n.d(r,"pad",(function(){return Ae.sc})),n.d(r,"pad1d",(function(){return Ae.tc})),n.d(r,"pad2d",(function(){return Ae.uc})),n.d(r,"pad3d",(function(){return Ae.vc})),n.d(r,"pad4d",(function(){return Ae.wc})),n.d(r,"pool",(function(){return Ae.xc})),n.d(r,"pow",(function(){return Ae.yc})),n.d(r,"prelu",(function(){return Ae.zc})),n.d(r,"print",(function(){return Ae.Ac})),n.d(r,"prod",(function(){return Ae.Bc})),n.d(r,"rand",(function(){return Ae.Cc})),n.d(r,"randomGamma",(function(){return Ae.Dc})),n.d(r,"randomNormal",(function(){return Ae.Ec})),n.d(r,"randomUniform",(function(){return Ae.Fc})),n.d(r,"range",(function(){return Ae.Gc})),n.d(r,"real",(function(){return Ae.Hc})),n.d(r,"reciprocal",(function(){return Ae.Ic})),n.d(r,"relu",(function(){return Ae.Jc})),n.d(r,"relu6",(function(){return Ae.Kc})),n.d(r,"reshape",(function(){return Ae.Lc})),n.d(r,"reverse",(function(){return Ae.Mc})),n.d(r,"reverse1d",(function(){return Ae.Nc})),n.d(r,"reverse2d",(function(){return Ae.Oc})),n.d(r,"reverse3d",(function(){return Ae.Pc})),n.d(r,"reverse4d",(function(){return Ae.Qc})),n.d(r,"round",(function(){return Ae.Sc})),n.d(r,"rsqrt",(function(){return Ae.Tc})),n.d(r,"scalar",(function(){return Ae.Uc})),n.d(r,"selu",(function(){return Ae.Wc})),n.d(r,"separableConv2d",(function(){return Ae.Xc})),n.d(r,"setdiff1dAsync",(function(){return Ae.Yc})),n.d(r,"sigmoid",(function(){return Ae.Zc})),n.d(r,"sign",(function(){return Ae.ad})),n.d(r,"sin",(function(){return Ae.cd})),n.d(r,"sinh",(function(){return Ae.dd})),n.d(r,"slice",(function(){return Ae.ed})),n.d(r,"slice1d",(function(){return Ae.fd})),n.d(r,"slice2d",(function(){return Ae.gd})),n.d(r,"slice3d",(function(){return Ae.hd})),n.d(r,"slice4d",(function(){return Ae.id})),n.d(r,"softmax",(function(){return Ae.jd})),n.d(r,"softplus",(function(){return Ae.kd})),n.d(r,"spaceToBatchND",(function(){return Ae.ld})),n.d(r,"fft",(function(){return Ae.mb})),n.d(r,"ifft",(function(){return Ae.vb})),n.d(r,"irfft",(function(){return Ae.zb})),n.d(r,"rfft",(function(){return Ae.Rc})),n.d(r,"split",(function(){return Ae.pd})),n.d(r,"sqrt",(function(){return Ae.qd})),n.d(r,"square",(function(){return Ae.rd})),n.d(r,"squaredDifference",(function(){return Ae.sd})),n.d(r,"squeeze",(function(){return Ae.td})),n.d(r,"stack",(function(){return Ae.ud})),n.d(r,"step",(function(){return Ae.vd})),n.d(r,"stridedSlice",(function(){return Ae.wd})),n.d(r,"sub",(function(){return Ae.xd})),n.d(r,"sum",(function(){return Ae.yd})),n.d(r,"tan",(function(){return Ae.zd})),n.d(r,"tanh",(function(){return Ae.Ad})),n.d(r,"tensor",(function(){return Ae.Bd})),n.d(r,"tensor1d",(function(){return Ae.Cd})),n.d(r,"tensor2d",(function(){return Ae.Dd})),n.d(r,"tensor3d",(function(){return Ae.Ed})),n.d(r,"tensor4d",(function(){return Ae.Fd})),n.d(r,"tensor5d",(function(){return Ae.Gd})),n.d(r,"tensor6d",(function(){return Ae.Hd})),n.d(r,"tile",(function(){return Ae.Id})),n.d(r,"topk",(function(){return Ae.Jd})),n.d(r,"truncatedNormal",(function(){return Ae.Ld})),n.d(r,"unique",(function(){return Ae.Md})),n.d(r,"unsortedSegmentSum",(function(){return Ae.Nd})),n.d(r,"unstack",(function(){return Ae.Od})),n.d(r,"variable",(function(){return Ae.Pd})),n.d(r,"where",(function(){return Ae.Qd})),n.d(r,"whereAsync",(function(){return Ae.Rd})),n.d(r,"zeros",(function(){return Ae.Sd})),n.d(r,"zerosLike",(function(){return Ae.Td})),n.d(r,"booleanMaskAsync",(function(){return Ae.y})),n.d(r,"transpose",(function(){return Ae.Kd})),n.d(r,"norm",(function(){return Ae.lc})),n.d(r,"movingAverage",(function(){return Ae.gc})),n.d(r,"scatterND",(function(){return Ae.Vc})),n.d(r,"sparseToDense",(function(){return Ae.nd})),n.d(r,"gatherND",(function(){return Ae.sb})),n.d(r,"dropout",(function(){return Ae.cb})),n.d(r,"enclosingPowerOfTwo",(function(){return Ae.fb})),n.d(r,"cosineWindow",(function(){return Ae.S})),n.d(r,"inTopKAsync",(function(){return Ae.yb})),n.d(r,"op",(function(){return Ae.qc})),n.d(r,"OP_SCOPE_SUFFIX",(function(){return Ae.a})),n.d(r,"image",(function(){return Ae.xb})),n.d(r,"linalg",(function(){return Ae.Gb})),n.d(r,"losses",(function(){return Ae.Sb})),n.d(r,"spectral",(function(){return Ae.od})),n.d(r,"fused",(function(){return Ae.qb})),n.d(r,"signal",(function(){return Ae.bd})),n.d(r,"sparse",(function(){return Ae.md}));var a=n(4),i=n.n(a),o=n(17),u=n(3),c=n(10),s=n(1),l=n(66),f=n(8),d=n(13),h=n(5),p=function(){function e(t,n,r){var a=this;Object(u.a)(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return Object(c.a)(e,[{key:"getInput",value:function(e){return Object(h.e)(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return Object(h.e)(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Object(l.f)(this.node.rawAttrs,e,t);if(null!=n.s)return Object(l.i)(this.node.rawAttrs,e,t);if(null!=n.b)return Object(l.c)(this.node.rawAttrs,e,t);if(null!=n.shape)return Object(l.k)(this.node.rawAttrs,e,t);if(null!=n.type)return Object(l.e)(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Object(l.g)(this.node.rawAttrs,e,t);if(null!=n.list.s)return Object(l.h)(this.node.rawAttrs,e,t);if(null!=n.list.shape)return Object(l.j)(this.node.rawAttrs,e,t);if(null!=n.list.b)return Object(l.b)(this.node.rawAttrs,e,t);if(null!=n.list.type)return Object(l.d)(this.node.rawAttrs,e,t)}return t}}]),e}(),v=n(116),m=n(26),b=n(254),g=n(201),y=n(20),x=n(28),O=n(194),k=n(133),w=n(27),j=n(146),_=n(102),S=n(63),E=n(152),C=n(54),A=n(252),N=n(253),T=n(255),I=n(256),D=n(257),F=n(188),M=n(258),R=n(261),z=n(67),L=n(136),P=n(191),B=n(138),W=n(266),U=n(53),V=n(267),q=n(139),H=n(83),G=n(197),K=n(140),X=n(41),Y=n(278),$=n(119),J=n(89),Q=n(279),Z=n(206),ee=n(77),te=n(208),ne=n(281),re=n(209),ae=n(198),ie=n(50),oe=n(37),ue=n(166),ce=n(284),se=n(262),le=n(149),fe=n(205),de=n(203),he=n(141),pe=n(148),ve=n(270);function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){s.util.assert(e.length===t.length,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}));for(var r=0;r<e.length;r++){var a=e[r],i=t[r];s.util.assert(a<0||i<0||a===i,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}}}function be(e){return"number"!==typeof e&&!e.some((function(e){return e<0}))}function ge(e,t,n){var r=ye(e,n),a=!be(r);if(a&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach((function(e){r=ye(e.shape,r)})),!be(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function ye(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));for(var n=[],r=0;r<e.length;++r){var a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:i}return n}var xe=function(){function e(t,n,r,a,i,o,c){Object(u.a)(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=c,this.tensors=[],this.closed_=!1,this.idTensor=Object(s.scalar)(0),Object(s.keep)(this.idTensor)}return Object(c.a)(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),me(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,Object(s.keep)(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return Object(s.tensor)([],[0].concat(this.elementShape));var r=this.readMany(e);return me(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Object(s.stack)(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return Object(s.tensor)([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return me(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),Object(s.concat)(r,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,Object(d.a)(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,Object(s.unstack)(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];Object(s.tidy)((function(){t=Object(s.reshape)(t,[1,r,i]);for(var u=0;u<e.length;++u){var c=[0,0===u?0:a[u-1],0],l=[1,e[u],i];o[u]=Object(s.reshape)(Object(s.slice)(t,c,l),n.elementShape)}return o}));for(var u=[],c=0;c<e.length;c++)u[c]=c;this.writeMany(u,o)}}]),e}(),Oe=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;Object(u.a)(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=r,null!=t&&t.forEach((function(e){if(r!==e.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(e.dtype));me(n,e.shape,"TensorList shape mismatch: "),Object(s.keep)(e)})),this.idTensor=Object(s.scalar)(0),this.maxNumElements=a,Object(s.keep)(this.idTensor)}return Object(c.a)(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e(Object(d.a)(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));me(e,this.elementShape,"TensorList shape mismatch: ");var a=ge(this.elementShape,this.tensors,e);return Object(s.tidy)((function(){var e=n.tensors.map((function(e){return Object(s.reshape)(e,a)}));return Object(s.stack)(e,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=ge(this.elementShape,this.tensors,e),r=this.tensors.pop();return me(r.shape,e,"TensorList shape mismatch: "),Object(s.reshape)(r,n)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(me(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Object(s.keep)(e),this.tensors.push(e)}},{key:"resize",value:function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));this.tensors.length=e}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));me(this.tensors[e].shape,t,"TensorList shape mismatch: ");var r=ge(this.elementShape,this.tensors,t);return Object(s.reshape)(this.tensors[e],r)}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));me(this.elementShape,t.shape,"TensorList shape mismatch: "),Object(s.keep)(t),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));me(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());var a=ge(this.elementShape,this.tensors,n);return 0===e.length?Object(s.tensor)([],[0].concat(a)):Object(s.tidy)((function(){var t=e.map((function(e){return Object(s.reshape)(r.tensors[e],a)}));return Object(s.stack)(t,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));me(this.elementShape,t,"TensorList shape mismatch: ");var r=ge(this.elementShape,this.tensors,t);return 0===this.size()?Object(s.tensor)([],[0].concat(r)):Object(s.tidy)((function(){var e=n.tensors.map((function(e){return Object(s.reshape)(e,r)}));return Object(s.concat)(e,0)}))}}]),e}();function ke(e,t,n){var r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));me(e.shape.slice(1),t,"TensorList shape mismatch: ");var a=Object(s.unstack)(e);return new Oe(a,t,r)}function we(e,t,n){return new Oe([],e,t,n)}function je(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var a=Math.max.apply(Math,Object(d.a)(t));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var i=new Oe([],n,e.dtype,r),o=Object(s.unstack)(e,0);return t.forEach((function(e,t){i.setItem(e,o[t])})),i}function _e(e,t,n){var r=0,a=t.map((function(e){return r+=e}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));for(var i=ye(e.shape.slice(1),n),o=0===r?0:e.size/r,u=Object(s.tidy)((function(){var n=[];e=Object(s.reshape)(e,[1,r,o]);for(var u=0;u<t.length;++u){var c=[0,0===u?0:a[u-1],0],l=[1,t[u],o];n[u]=Object(s.reshape)(Object(s.slice)(e,c,l),i)}return e.dispose(),n})),c=new Oe([],n,e.dtype,t.length),l=0;l<u.length;l++)c.setItem(l,u[l]);return c}var Se=function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,o,u,c,l,f,d,p,v,m,b,g,y,x,O,k,w,j,_,S,E,C,A,N,T,I,D,F,M,R,z,L,P,B,W,U,V,q,H,G,K,X,Y,$,J,Q,Z,ee,te,ne,re,ae,ie,oe,ue,ce,se,le,fe,de,he,pe,ve,me,be,ge,ye,Oe,Se,Ee,Ce,Ae,Ne,Te,Ie,De,Fe,Me,Re,ze,Le,Pe,Be,We,Ue,Ve,qe,He,Ge,Ke,Xe,Ye,$e,Je,Qe,Ze;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0||"StatelessIf"===e.t0?3:"While"===e.t0||"StatelessWhile"===e.t0?15:"LoopCond"===e.t0?19:"Switch"===e.t0?21:"Merge"===e.t0?32:"Enter"===e.t0?37:"Exit"===e.t0?41:"NextIteration"===e.t0?44:"TensorArrayV3"===e.t0?47:"TensorArrayWriteV3"===e.t0?57:"TensorArrayReadV3"===e.t0?63:"TensorArrayGatherV3"===e.t0?67:"TensorArrayScatterV3"===e.t0?72:"TensorArrayConcatV3"===e.t0?78:"TensorArraySplitV3"===e.t0?82:"TensorArraySizeV3"===e.t0?88:"TensorArrayCloseV3"===e.t0?91:"TensorListSetItem"===e.t0?95:"TensorListGetItem"===e.t0?101:"TensorListScatterV2"===e.t0||"TensorListScatter"===e.t0?107:"TensorListReserve"===e.t0||"EmptyTensorList"===e.t0?114:"TensorListGather"===e.t0?121:"TensorListStack"===e.t0?127:"TensorListFromTensor"===e.t0?133:"TensorListConcat"===e.t0?139:"TensorListPushBack"===e.t0?144:"TensorListPopBack"===e.t0?149:"TensorListSplit"===e.t0?154:160;break;case 3:return a=Object(h.d)("thenBranch",t,n,r),o=Object(h.d)("elseBranch",t,n,r),u=Object(h.d)("cond",t,n,r),c=Object(h.d)("args",t,n,r),e.next=9,u.data();case 9:if(!e.sent[0]){e.next=14;break}return e.abrupt("return",r.functionMap[a].executeFunctionAsync(c,r.tensorArrayMap,r.tensorListMap));case 14:return e.abrupt("return",r.functionMap[o].executeFunctionAsync(c,r.tensorArrayMap,r.tensorListMap));case 15:return e.delegateYield(i.a.mark((function e(){var a,o,u,c,s,l,f,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(h.d)("body",t,n,r),o=Object(h.d)("cond",t,n,r),u=Object(h.d)("args",t,n,r),e.next=5,r.functionMap[o].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap);case 5:return c=e.sent,s=u.map((function(e){return e.id})),e.next=9,c[0].data();case 9:l=e.sent,c.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||e.dispose()})),f=u,d=i.a.mark((function e(){var t,n,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f,e.next=3,r.functionMap[a].executeFunctionAsync(f,r.tensorArrayMap,r.tensorListMap);case 3:return f=e.sent,n=f.map((function(e){return e.id})),t.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()})),e.next=8,r.functionMap[o].executeFunctionAsync(f,r.tensorArrayMap,r.tensorListMap);case 8:return u=e.sent,e.next=11,u[0].data();case 11:l=e.sent,u.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()}));case 13:case"end":return e.stop()}}),e)}));case 13:if(!l[0]){e.next=17;break}return e.delegateYield(d(),"t0",15);case 15:e.next=13;break;case 17:return e.abrupt("return",{v:f});case 18:case"end":return e.stop()}}),e)}))(),"t1",16);case 16:if("object"!==typeof(l=e.t1)){e.next=19;break}return e.abrupt("return",l.v);case 19:return f=Object(h.d)("pred",t,n,r),e.abrupt("return",[Object(h.a)(f)]);case 21:return d=Object(h.d)("pred",t,n,r),(p=Object(h.d)("data",t,n,r)).kept||(p=Object(h.a)(p)),e.next=26,d.data();case 26:if(!e.sent[0]){e.next=30;break}e.t2=[void 0,p],e.next=31;break;case 30:e.t2=[p,void 0];case 31:return e.abrupt("return",e.t2);case 32:if(!(v=t.inputNames.find((function(e){return void 0!==Object(h.e)(e,n,r)})))){e.next=36;break}return m=Object(h.e)(v,n,r),e.abrupt("return",[Object(h.a)(m)]);case 36:return e.abrupt("return",void 0);case 37:return b=Object(h.d)("frameName",t,n,r),g=Object(h.d)("tensor",t,n,r),r.enterFrame(b),e.abrupt("return",[Object(h.a)(g)]);case 41:return y=Object(h.d)("tensor",t,n,r),r.exitFrame(),e.abrupt("return",[Object(h.a)(y)]);case 44:return x=Object(h.d)("tensor",t,n,r),r.nextIteration(),e.abrupt("return",[Object(h.a)(x)]);case 47:return O=Object(h.d)("size",t,n,r),k=Object(h.d)("dtype",t,n,r),w=Object(h.d)("elementShape",t,n,r),j=Object(h.d)("dynamicSize",t,n,r),_=Object(h.d)("clearAfterRead",t,n,r),S=Object(h.d)("identicalElementShapes",t,n,r),E=Object(h.d)("name",t,n,r),C=new xe(E,k,O,w,S,j,_),r.addTensorArray(C),e.abrupt("return",[C.idTensor,Object(s.scalar)(1)]);case 57:return A=Object(h.d)("tensorArrayId",t,n,r),N=Object(h.d)("index",t,n,r),T=Object(h.d)("tensor",t,n,r),(I=r.getTensorArray(A.id)).write(N,T),e.abrupt("return",[I.idTensor]);case 63:return D=Object(h.d)("tensorArrayId",t,n,r),F=Object(h.d)("index",t,n,r),M=r.getTensorArray(D.id),e.abrupt("return",[M.read(F)]);case 67:return R=Object(h.d)("tensorArrayId",t,n,r),z=Object(h.d)("indices",t,n,r),L=Object(h.d)("dtype",t,n,r),P=r.getTensorArray(R.id),e.abrupt("return",[P.gather(z,L)]);case 72:return B=Object(h.d)("tensorArrayId",t,n,r),W=Object(h.d)("indices",t,n,r),U=Object(h.d)("tensor",t,n,r),(V=r.getTensorArray(B.id)).scatter(W,U),e.abrupt("return",[V.idTensor]);case 78:return q=Object(h.d)("tensorArrayId",t,n,r),H=r.getTensorArray(q.id),G=Object(h.d)("dtype",t,n,r),e.abrupt("return",[H.concat(G)]);case 82:return K=Object(h.d)("tensorArrayId",t,n,r),X=Object(h.d)("tensor",t,n,r),Y=Object(h.d)("lengths",t,n,r),($=r.getTensorArray(K.id)).split(Y,X),e.abrupt("return",[$.idTensor]);case 88:return J=Object(h.d)("tensorArrayId",t,n,r),Q=r.getTensorArray(J.id),e.abrupt("return",[Object(s.scalar)(Q.size(),"int32")]);case 91:return Z=Object(h.d)("tensorArrayId",t,n,r),(ee=r.getTensorArray(Z.id)).clearAndClose(),e.abrupt("return",[ee.idTensor]);case 95:return te=Object(h.d)("tensorListId",t,n,r),ne=Object(h.d)("index",t,n,r),re=Object(h.d)("tensor",t,n,r),(ae=r.getTensorList(te.id)).setItem(ne,re),e.abrupt("return",[ae.idTensor]);case 101:return ie=Object(h.d)("tensorListId",t,n,r),oe=Object(h.d)("index",t,n,r),ue=Object(h.d)("elementShape",t,n,r),ce=Object(h.d)("elementDType",t,n,r),se=r.getTensorList(ie.id),e.abrupt("return",[se.getItem(oe,ue,ce)]);case 107:return le=Object(h.d)("indices",t,n,r),fe=Object(h.d)("tensor",t,n,r),de=Object(h.d)("elementShape",t,n,r),he=Object(h.d)("numElements",t,n,r),pe=je(fe,le,de,he),r.addTensorList(pe),e.abrupt("return",[pe.idTensor]);case 114:return ve=Object(h.d)("elementShape",t,n,r),me=Object(h.d)("elementDType",t,n,r),be="TensorListReserve"===t.op?"numElements":"maxNumElements",ge=Object(h.d)(be,t,n,r),ye=we(ve,me,ge),r.addTensorList(ye),e.abrupt("return",[ye.idTensor]);case 121:return Oe=Object(h.d)("tensorListId",t,n,r),Se=Object(h.d)("indices",t,n,r),Ee=Object(h.d)("elementShape",t,n,r),Ce=Object(h.d)("elementDType",t,n,r),Ae=r.getTensorList(Oe.id),e.abrupt("return",[Ae.gather(Se,Ce,Ee)]);case 127:return Ne=Object(h.d)("tensorListId",t,n,r),Te=Object(h.d)("elementShape",t,n,r),Ie=Object(h.d)("elementDType",t,n,r),De=Object(h.d)("numElements",t,n,r),Fe=r.getTensorList(Ne.id),e.abrupt("return",[Fe.stack(Te,Ie,De)]);case 133:return Me=Object(h.d)("tensor",t,n,r),Re=Object(h.d)("elementShape",t,n,r),ze=Object(h.d)("elementDType",t,n,r),Le=ke(Me,Re,ze),r.addTensorList(Le),e.abrupt("return",[Le.idTensor]);case 139:return Pe=Object(h.d)("tensorListId",t,n,r),Be=r.getTensorList(Pe.id),We=Object(h.d)("dtype",t,n,r),Ue=Object(h.d)("elementShape",t,n,r),e.abrupt("return",[Be.concat(We,Ue)]);case 144:return Ve=Object(h.d)("tensorListId",t,n,r),qe=Object(h.d)("tensor",t,n,r),(He=r.getTensorList(Ve.id)).pushBack(qe),e.abrupt("return",[He.idTensor]);case 149:return Ge=Object(h.d)("tensorListId",t,n,r),Ke=Object(h.d)("elementShape",t,n,r),Xe=Object(h.d)("elementDType",t,n,r),Ye=r.getTensorList(Ge.id),e.abrupt("return",[Ye.popBack(Ke,Xe)]);case 154:return $e=Object(h.d)("tensor",t,n,r),Je=Object(h.d)("elementShape",t,n,r),Qe=Object(h.d)("lengths",t,n,r),Ze=_e($e,Qe,Je),r.addTensorList(Ze),e.abrupt("return",[Ze.idTensor]);case 160:throw TypeError("Node type ".concat(t.op," is not implemented"));case 161:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Ee=n(189),Ce=n(73),Ae=n(33),Ne=n(190),Te=n(104),Ie=n(263),De=n(135),Fe=n(145),Me=n(275),Re=n(259),ze=n(274),Le=n(193);function Pe(e,t,n){var r=Object(h.d)("fusedOps",e,t,n),a=Object(f.a)(r,2),i=a[0],o=a[1],u="biasadd"===i,c="prelu"===o,s="fusedbatchnorm"===i,l=Object(h.d)("numArgs",e,t,n);if(u){if(c&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(s)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");var d=Object(h.d)("strides",e,t,n),p=Object(h.c)(e,t,n),v=Object(h.d)("dataFormat",e,t,n).toUpperCase(),m=Object(h.d)("dilations",e,t,n),b=Object(h.d)("args",e,t,n),g=Object(f.a)(b,2);return{stride:d,pad:p,dataFormat:v,dilations:m,biasArg:g[0],preluArg:g[1],activationFunc:o,leakyreluAlpha:Object(h.d)("leakyreluAlpha",e,t,n)}}var Be=n(134),We=n(271),Ue=n(276),Ve=n(118),qe=n(64),He=n(277),Ge=n(204),Ke=n(167),Xe=n(285),Ye=n(88),$e=n(32),Je=n(24),Qe=n(214),Ze=n(280);function et(e,t,n){return{boxes:Object(h.d)("boxes",e,t,n),scores:Object(h.d)("scores",e,t,n),maxOutputSize:Object(h.d)("maxOutputSize",e,t,n),iouThreshold:Object(h.d)("iouThreshold",e,t,n),scoreThreshold:Object(h.d)("scoreThreshold",e,t,n),softNmsSigma:Object(h.d)("softNmsSigma",e,t,n)}}var tt=function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,o,u,c,s,l,f,d,p,v,m,b,g,y,x,O,k,w,j,_,S,E,C,A;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?3:"NonMaxSuppressionV4"===e.t0?8:"NonMaxSuppressionV3"===e.t0||"NonMaxSuppressionV2"===e.t0?14:"Where"===e.t0?19:"ListDiff"===e.t0?26:27;break;case 3:return a=et(t,n,r),o=a.boxes,u=a.scores,c=a.maxOutputSize,s=a.iouThreshold,l=a.scoreThreshold,f=a.softNmsSigma,e.next=6,Ae.xb.nonMaxSuppressionWithScoreAsync(o,u,c,s,l,f);case 6:return d=e.sent,e.abrupt("return",[d.selectedIndices,d.selectedScores]);case 8:return p=et(t,n,r),v=p.boxes,m=p.scores,b=p.maxOutputSize,g=p.iouThreshold,y=p.scoreThreshold,x=Object(h.d)("padToMaxOutputSize",t,n,r),e.next=12,Ae.xb.nonMaxSuppressionPaddedAsync(v,m,b,g,y,x);case 12:return O=e.sent,e.abrupt("return",[O.selectedIndices,O.validOutputs]);case 14:return k=et(t,n,r),w=k.boxes,j=k.scores,_=k.maxOutputSize,S=k.iouThreshold,E=k.scoreThreshold,e.next=17,Ae.xb.nonMaxSuppressionAsync(w,j,_,S,E);case 17:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 19:return C=Je.a(Object(h.d)("condition",t,n,r),"bool"),e.next=22,Qe.a(C);case 22:return e.t2=e.sent,A=[e.t2],C.dispose(),e.abrupt("return",A);case 26:return e.abrupt("return",Ze.a(Object(h.d)("x",t,n,r),Object(h.d)("y",t,n,r)));case 27:throw TypeError("Node type ".concat(t.op," is not implemented"));case 28:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),nt=n(212),rt=n(213),at=n(85),it=n(29),ot=function(){function e(t,n){Object(u.a)(this,e),this.keyDType=t,this.valueDType=n,this.handle=Object(s.scalar)(0),this.tensorMap=new Map,Object(s.keep)(this.handle)}return Object(c.a)(e,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"tensorSize",value:function(){return it.a(this.size(),"int32")}},{key:"import",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),e.abrupt("return",Object(s.tidy)((function(){var e=Object(s.unstack)(n),t=r.length,i=e.length;s.util.assert(t===i,(function(){return"The number of elements doesn't match, keys has "+"".concat(t," elements, the values has ").concat(i," ")+"elements."}));for(var o=0;o<t;o++){var u=r[o],c=e[o];Object(s.keep)(c),a.tensorMap.set(u,c)}return a.handle})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,e.abrupt("return",Object(s.tidy)((function(){for(var e=[],t=0;t<r.length;t++){var i=r[t],o=a.findWithDefault(i,n);e.push(o)}return Object(s.stack)(e)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"findWithDefault",value:function(e,t){var n=this.tensorMap.get(e);return null!=n?n:t}},{key:"checkKeyAndValueTensor",value:function(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}]),e}(),ut=function(){var e=Object(o.a)(i.a.mark((function e(t,n,r,a){var o,u,c,s,l,f,d,p,v,m,b,g,y;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="HashTable"===e.t0||"HashTableV2"===e.t0?3:"LookupTableImport"===e.t0||"LookupTableImportV2"===e.t0?8:"LookupTableFind"===e.t0||"LookupTableFindV2"===e.t0?16:"LookupTableSize"===e.t0||"LookupTableSizeV2"===e.t0?24:27;break;case 3:return o=Object(h.d)("keyDType",t,n,r),u=Object(h.d)("valueDType",t,n,r),c=new ot(o,u),a.addHashTable(t.name,c),e.abrupt("return",[c.handle]);case 8:return s=Object(h.d)("tableHandle",t,n,r,a),l=Object(h.d)("keys",t,n,r),f=Object(h.d)("values",t,n,r),d=a.getHashTableById(s.id),e.next=14,d.import(l,f);case 14:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 16:return p=Object(h.d)("tableHandle",t,n,r,a),v=Object(h.d)("keys",t,n,r),m=Object(h.d)("defaultValue",t,n,r),b=a.getHashTableById(p.id),e.next=22,b.find(v,m);case 22:return e.t2=e.sent,e.abrupt("return",[e.t2]);case 24:return g=Object(h.d)("tableHandle",t,n,r,a),y=a.getHashTableById(g.id),e.abrupt("return",[y.tensorSize()]);case 27:throw TypeError("Node type ".concat(t.op," is not implemented"));case 28:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),ct=n(105),st=n(147),lt=n(59),ft=n(74),dt=n(142),ht=n(75),pt=n(68),vt=n(107),mt=n(144),bt=n(49),gt=n(36),yt=n(265),xt=n(61),Ot=n(92),kt=n(196),wt=n(282),jt=n(273),_t=n(299),St=n(78),Et=n(96),Ct=n(117),At=n(31),Nt=n(184),Tt=n(185),It=n(186),Dt=n(187),Ft=n(137),Mt=n(260),Rt=n(264),zt=n(45),Lt=n(106),Pt=n(58),Bt=n(40),Wt=n(283),Ut=n(109),Vt=n(18),qt=n(69),Ht=n(91),Gt=n(93),Kt=n(84),Xt=n(286),Yt=n(287),$t=n(150),Jt=n(120),Qt=n(151),Zt=n(210),en=n(71),tn=n(200),nn=n(65),rn=n(108),an=n(103),on=n(192),un=n(112);function cn(e,t,n,a){var i=function(e,t,n){switch(e.category){case"arithmetic":return s.tidy((function(){return function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[m.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"AddN":return[b.a(Object(h.d)("tensors",e,t,n))];case"FloorMod":case"Mod":return[g.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Mul":return[y.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"RealDiv":case"Div":return[x.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"DivNoNan":return[O.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"FloorDiv":return[k.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Sub":return[w.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Minimum":return[j.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Maximum":return[_.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Pow":return[S.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"SquaredDifference":return[E.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"basic_math":return s.tidy((function(){return function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[C.a(Object(h.d)("x",e,t,n))];case"Acos":return[A.a(Object(h.d)("x",e,t,n))];case"Acosh":return[N.a(Object(h.d)("x",e,t,n))];case"Asin":return[T.a(Object(h.d)("x",e,t,n))];case"Asinh":return[I.a(Object(h.d)("x",e,t,n))];case"Atan":return[D.a(Object(h.d)("x",e,t,n))];case"Atan2":return[F.a(Object(h.d)("x",e,t,n),Object(h.d)("y",e,t,n))];case"Atanh":return[M.a(Object(h.d)("x",e,t,n))];case"Ceil":return[R.a(Object(h.d)("x",e,t,n))];case"Complex":return[z.a(Object(h.d)("real",e,t,n),Object(h.d)("imag",e,t,n))];case"Cos":return[L.a(Object(h.d)("x",e,t,n))];case"Cosh":return[P.a(Object(h.d)("x",e,t,n))];case"Elu":return[B.a(Object(h.d)("x",e,t,n))];case"Erf":return[W.a(Object(h.d)("x",e,t,n))];case"Exp":return[U.a(Object(h.d)("x",e,t,n))];case"Expm1":return[V.a(Object(h.d)("x",e,t,n))];case"Floor":return[q.a(Object(h.d)("x",e,t,n))];case"Log":return[H.a(Object(h.d)("x",e,t,n))];case"Log1p":return[G.a(Object(h.d)("x",e,t,n))];case"Imag":return[K.a(Object(h.d)("x",e,t,n))];case"Neg":return[X.a(Object(h.d)("x",e,t,n))];case"Reciprocal":return[Y.a(Object(h.d)("x",e,t,n))];case"Real":return[$.a(Object(h.d)("x",e,t,n))];case"Relu":return[J.a(Object(h.d)("x",e,t,n))];case"Round":return[Q.a(Object(h.d)("x",e,t,n))];case"Selu":return[Z.a(Object(h.d)("x",e,t,n))];case"Sigmoid":return[ee.a(Object(h.d)("x",e,t,n))];case"Sin":return[te.a(Object(h.d)("x",e,t,n))];case"Sign":return[ne.a(Object(h.d)("x",e,t,n))];case"Sinh":return[re.a(Object(h.d)("x",e,t,n))];case"Softplus":return[ae.a(Object(h.d)("x",e,t,n))];case"Sqrt":return[ie.a(Object(h.d)("x",e,t,n))];case"Square":return[oe.a(Object(h.d)("x",e,t,n))];case"Tanh":return[ue.a(Object(h.d)("x",e,t,n))];case"Tan":return[ce.a(Object(h.d)("x",e,t,n))];case"ClipByValue":return[se.a(Object(h.d)("x",e,t,n),Object(h.d)("clipValueMin",e,t,n),Object(h.d)("clipValueMax",e,t,n))];case"Relu6":return[le.a(Object(h.d)("x",e,t,n))];case"Rsqrt":return[fe.a(Object(h.e)(e.inputNames[0],t,n))];case"Prod":return[de.a(Object(h.d)("x",e,t,n),Object(h.d)("axes",e,t,n))];case"LeakyRelu":return[he.a(Object(h.d)("x",e,t,n),Object(h.d)("alpha",e,t,n))];case"Prelu":return[pe.a(Object(h.d)("x",e,t,n),Object(h.d)("alpha",e,t,n))];case"IsNan":return[ve.a(Object(h.e)(e.inputNames[0],t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"control":return Se(e,t,n);case"convolution":return s.tidy((function(){return function(e,t,n){switch(e.op){case"Conv1D":var r=Object(h.d)("stride",e,t,n),a=Object(h.d)("pad",e,t,n),i=Object(h.d)("dataFormat",e,t,n).toUpperCase(),o=Object(h.d)("dilation",e,t,n);return[Ee.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),r,a,i,o)];case"Conv2D":var u=Object(h.d)("strides",e,t,n),c=Object(h.c)(e,t,n),s=Object(h.d)("dataFormat",e,t,n).toUpperCase(),l=Object(h.d)("dilations",e,t,n);return[Ce.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),[u[1],u[2]],c,s,[l[1],l[2]])];case"_FusedConv2D":var f=Pe(e,t,n),d=f.stride,p=f.pad,v=f.dataFormat,m=f.dilations,b=f.biasArg,g=f.preluArg,y=f.activationFunc,x=f.leakyreluAlpha;return[Ae.qb.conv2d({x:Object(h.d)("x",e,t,n),filter:Object(h.d)("filter",e,t,n),strides:[d[1],d[2]],pad:p,dataFormat:v,dilations:[m[1],m[2]],bias:b,activation:y,preluActivationWeights:g,leakyreluAlpha:x})];case"FusedDepthwiseConv2dNative":var O=Pe(e,t,n),k=O.stride,w=O.pad,j=O.dataFormat,_=O.dilations,S=O.biasArg,E=O.preluArg,C=O.activationFunc,A=O.leakyreluAlpha;return[Ae.qb.depthwiseConv2d({x:Object(h.d)("x",e,t,n),filter:Object(h.d)("filter",e,t,n),strides:[k[1],k[2]],pad:w,dataFormat:j,dilations:[_[1],_[2]],bias:S,activation:C,preluActivationWeights:E,leakyreluAlpha:A})];case"Conv2DBackpropInput":case"Conv2dTranspose":var N=Object(h.d)("outputShape",e,t,n),T=Object(h.d)("strides",e,t,n),I=Object(h.c)(e,t,n);return[Ne.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),N,[T[1],T[2]],I)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var D=Object(h.d)("strides",e,t,n),F=Object(h.c)(e,t,n),M=Object(h.d)("dilations",e,t,n),R=Object(h.d)("dataFormat",e,t,n).toUpperCase();return[Te.a(Object(h.d)("input",e,t,n),Object(h.d)("filter",e,t,n),[D[1],D[2]],F,R,[M[1],M[2]])];case"Conv3D":var z=Object(h.d)("strides",e,t,n),L=Object(h.d)("pad",e,t,n),P=Object(h.d)("dataFormat",e,t,n).toUpperCase(),B=Object(h.d)("dilations",e,t,n);return[Ie.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),[z[1],z[2],z[3]],L,P,[B[1],B[2],B[3]])];case"AvgPool":var W=Object(h.d)("strides",e,t,n),U=Object(h.d)("pad",e,t,n),V=Object(h.d)("kernelSize",e,t,n);return[De.a(Object(h.d)("x",e,t,n),[V[1],V[2]],[W[1],W[2]],U)];case"MaxPool":var q=Object(h.d)("strides",e,t,n),H=Object(h.d)("pad",e,t,n),G=Object(h.d)("kernelSize",e,t,n);return[Fe.a(Object(h.d)("x",e,t,n),[G[1],G[2]],[q[1],q[2]],H)];case"MaxPoolWithArgmax":var K=Object(h.d)("strides",e,t,n),X=Object(h.d)("pad",e,t,n),Y=Object(h.d)("kernelSize",e,t,n),$=Object(h.d)("includeBatchInIndex",e,t,n),J=Me.a(Object(h.d)("x",e,t,n),[Y[1],Y[2]],[K[1],K[2]],X,$);return[J.result,J.indexes];case"AvgPool3D":var Q=Object(h.d)("strides",e,t,n),Z=Object(h.d)("pad",e,t,n),ee=Object(h.d)("kernelSize",e,t,n);return[Re.a(Object(h.d)("x",e,t,n),[ee[1],ee[2],ee[3]],[Q[1],Q[2],Q[3]],Z)];case"MaxPool3D":var te=Object(h.d)("strides",e,t,n),ne=Object(h.d)("pad",e,t,n),re=Object(h.d)("kernelSize",e,t,n);return[ze.a(Object(h.d)("x",e,t,n),[re[1],re[2],re[3]],[te[1],te[2],te[3]],ne)];case"Dilation2D":var ae=Object(h.d)("strides",e,t,n),ie=Object(h.d)("pad",e,t,n),oe=Object(h.d)("dilations",e,t,n),ue=ae[1],ce=ae[2],se=oe[1],le=oe[2];return[Le.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),[ue,ce],ie,[se,le],"NHWC")];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"creation":return s.tidy((function(){return function(e,t,n){switch(e.op){case"Fill":var r=Object(h.d)("shape",e,t,n),a=Object(h.d)("dtype",e,t,n),i=Object(h.d)("value",e,t,n);return[Be.a(r,i,a)];case"LinSpace":var o=Object(h.d)("start",e,t,n),u=Object(h.d)("stop",e,t,n),c=Object(h.d)("num",e,t,n);return[We.a(o,u,c)];case"Multinomial":var s=Object(h.d)("logits",e,t,n),l=Object(h.d)("numSamples",e,t,n),f=Object(h.d)("seed",e,t,n);return[Ue.a(s,l,f)];case"OneHot":var d=Object(h.d)("indices",e,t,n),p=Object(h.d)("depth",e,t,n),v=Object(h.d)("onValue",e,t,n),m=Object(h.d)("offValue",e,t,n);return[Ve.a(d,p,v,m)];case"Ones":return[qe.a(Object(h.d)("shape",e,t,n),Object(h.d)("dtype",e,t,n))];case"OnesLike":return[He.a(Object(h.d)("x",e,t,n))];case"RandomUniform":return[Ge.a(Object(h.d)("shape",e,t,n),Object(h.d)("minval",e,t,n),Object(h.d)("maxval",e,t,n),Object(h.d)("dtype",e,t,n))];case"Range":var b=Object(h.d)("start",e,t,n),g=Object(h.d)("stop",e,t,n),y=Object(h.d)("step",e,t,n);return[Ke.a(b,g,y,Object(h.d)("dtype",e,t,n))];case"TruncatedNormal":var x=Object(h.d)("shape",e,t,n),O=Object(h.d)("mean",e,t,n),k=Object(h.d)("stdDev",e,t,n),w=Object(h.d)("seed",e,t,n);return[Xe.a(x,O,k,Object(h.d)("dtype",e,t,n),w)];case"Zeros":return[Ye.a(Object(h.d)("shape",e,t,n),Object(h.d)("dtype",e,t,n))];case"ZerosLike":return[$e.a(Object(h.d)("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"dynamic":return tt(e,t,n);case"evaluation":return s.tidy((function(){return function(e,t,n){switch(e.op){case"TopKV2":var r=Object(h.d)("x",e,t,n),a=Object(h.d)("k",e,t,n),i=Object(h.d)("sorted",e,t,n),o=nt.a(r,a,i);return[o.values,o.indices];case"Unique":var u=Object(h.d)("x",e,t,n),c=rt.a(u);return[c.values,c.indices];case"UniqueV2":var s=Object(h.d)("x",e,t,n),l=Object(h.d)("axis",e,t,n),f=rt.a(s,l);return[f.values,f.indices];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"image":return s.tidy((function(){return function(e,t,n){switch(e.op){case"ResizeBilinear":var r=Object(h.d)("images",e,t,n),a=Object(h.d)("size",e,t,n),i=Object(h.d)("alignCorners",e,t,n),o=Object(h.d)("halfPixelCenters",e,t,n);return[Ae.xb.resizeBilinear(r,[a[0],a[1]],i,o)];case"ResizeNearestNeighbor":var u=Object(h.d)("images",e,t,n),c=Object(h.d)("size",e,t,n),s=Object(h.d)("alignCorners",e,t,n),l=Object(h.d)("halfPixelCenters",e,t,n);return[Ae.xb.resizeNearestNeighbor(u,[c[0],c[1]],s,l)];case"CropAndResize":var f=Object(h.d)("image",e,t,n),d=Object(h.d)("boxes",e,t,n),p=Object(h.d)("boxInd",e,t,n),v=Object(h.d)("cropSize",e,t,n),m=Object(h.d)("method",e,t,n),b=Object(h.d)("extrapolationValue",e,t,n);return[Ae.xb.cropAndResize(f,d,p,v,m,b)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"graph":return s.tidy((function(){return function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=Object(h.d)("default",e,t,n);return[Object(h.e)(e.name,t,n)||r];case"Placeholder":return[Object(h.e)(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":var a=Object(h.d)("x",e,t,n);return[Object(h.a)(a)];case"IdentityN":return Object(h.d)("x",e,t,n).map((function(e){return Object(h.a)(e)}));case"Snapshot":var i=Object(h.d)("x",e,t,n);return[Object(h.a)(i)];case"Shape":return[at.a(Object(h.d)("x",e,t,n).shape,"int32")];case"ShapeN":return Object(h.d)("x",e,t,n).map((function(e){return at.a(e.shape)}));case"Size":return[it.a(Object(h.d)("x",e,t,n).size,"int32")];case"Rank":return[it.a(Object(h.d)("x",e,t,n).rank,"int32")];case"NoOp":return[it.a(1)];case"Print":var o=Object(h.d)("x",e,t,n),u=Object(h.d)("data",e,t,n),c=Object(h.d)("message",e,t,n),s=Object(h.d)("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(var l=0;l<u.length;l++)console.log(Array.prototype.slice.call(u[l].dataSync()).slice(0,s));return[o];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"logical":return s.tidy((function(){return function(e,t,n){switch(e.op){case"Equal":return[ct.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"NotEqual":return[st.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Greater":return[lt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"GreaterEqual":return[ft.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Less":return[dt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"LessEqual":return[ht.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"LogicalAnd":return[pt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"LogicalNot":return[vt.a(Object(h.d)("a",e,t,n))];case"LogicalOr":return[mt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Select":case"SelectV2":return[bt.a(Object(h.d)("condition",e,t,n),Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"matrices":return s.tidy((function(){return function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[gt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n),Object(h.d)("transposeA",e,t,n),Object(h.d)("transposeB",e,t,n))];case"Einsum":return[yt.a.apply(r,[Object(h.d)("equation",e,t,n)].concat(Object(d.a)(Object(h.d)("tensors",e,t,n))))];case"Transpose":return[xt.a(Object(h.d)("x",e,t,n),Object(h.d)("perm",e,t,n))];case"_FusedMatMul":var a=Object(h.d)("fusedOps",e,t,n),i=Object(f.a)(a,2),o=i[0],u=i[1],c="biasadd"===o,s="prelu"===u,l=Object(h.d)("numArgs",e,t,n),p=Object(h.d)("leakyreluAlpha",e,t,n);if(c){if(s&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var v=Object(h.d)("args",e,t,n),m=Object(f.a)(v,2),b=m[0],g=m[1];return[Ae.qb.matMul({a:Object(h.d)("a",e,t,n),b:Object(h.d)("b",e,t,n),transposeA:Object(h.d)("transposeA",e,t,n),transposeB:Object(h.d)("transposeB",e,t,n),bias:b,activation:u,preluActivationWeights:g,leakyreluAlpha:p})];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"normalization":return s.tidy((function(){return function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Ot.a(Object(h.d)("x",e,t,n),Object(h.d)("mean",e,t,n),Object(h.d)("variance",e,t,n),Object(h.d)("offset",e,t,n),Object(h.d)("scale",e,t,n),Object(h.d)("epsilon",e,t,n))];case"LRN":return[kt.a(Object(h.d)("x",e,t,n),Object(h.d)("radius",e,t,n),Object(h.d)("bias",e,t,n),Object(h.d)("alpha",e,t,n),Object(h.d)("beta",e,t,n))];case"Softmax":return[wt.a(Object(h.d)("x",e,t,n))];case"LogSoftmax":return[jt.a(Object(h.d)("x",e,t,n))];case"SparseToDense":return[_t.a(Object(h.d)("sparseIndices",e,t,n),Object(h.d)("outputShape",e,t,n),Object(h.d)("sparseValues",e,t,n),Object(h.d)("defaultValue",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"reduction":return s.tidy((function(){return function(e,t,n){switch(e.op){case"Max":var r=Object(h.d)("axis",e,t,n),a=Object(h.d)("keepDims",e,t,n);return[St.a(Object(h.d)("x",e,t,n),r,a)];case"Mean":var i=Object(h.d)("axis",e,t,n),o=Object(h.d)("keepDims",e,t,n);return[Et.a(Object(h.d)("x",e,t,n),i,o)];case"Min":var u=Object(h.d)("axis",e,t,n),c=Object(h.d)("keepDims",e,t,n);return[Ct.a(Object(h.d)("x",e,t,n),u,c)];case"Sum":var s=Object(h.d)("axis",e,t,n),l=Object(h.d)("keepDims",e,t,n);return[At.a(Object(h.d)("x",e,t,n),s,l)];case"All":var f=Object(h.d)("axis",e,t,n),d=Object(h.d)("keepDims",e,t,n);return[Nt.a(Object(h.d)("x",e,t,n),f,d)];case"Any":var p=Object(h.d)("axis",e,t,n),v=Object(h.d)("keepDims",e,t,n);return[Tt.a(Object(h.d)("x",e,t,n),p,v)];case"ArgMax":var m=Object(h.d)("axis",e,t,n);return[It.a(Object(h.d)("x",e,t,n),m)];case"ArgMin":var b=Object(h.d)("axis",e,t,n);return[Dt.a(Object(h.d)("x",e,t,n),b)];case"Prod":var g=Object(h.d)("axis",e,t,n),y=Object(h.d)("keepDims",e,t,n);return[de.a(Object(h.d)("x",e,t,n),g,y)];case"Cumsum":var x=Object(h.d)("axis",e,t,n),O=Object(h.d)("exclusive",e,t,n),k=Object(h.d)("reverse",e,t,n);return[Ft.a(Object(h.d)("x",e,t,n),x,O,k)];case"Bincount":var w=Object(h.d)("x",e,t,n),j=Object(h.d)("weights",e,t,n),_=Object(h.d)("size",e,t,n);return[Mt.a(w,j,_)];case"DenseBincount":var S=Object(h.d)("x",e,t,n),E=Object(h.d)("weights",e,t,n),C=Object(h.d)("size",e,t,n),A=Object(h.d)("binaryOutput",e,t,n);return[Rt.a(S,E,C,A)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"slice_join":return s.tidy((function(){return function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=Object(h.d)("n",e,t,n),a=Object(h.d)("axis",e,t,n),i=Object(h.d)("tensors",e,t,n);return i=i.slice(0,r),[zt.a(i,a)];case"Gather":var o=Object(h.d)("x",e,t,n),u=Object(h.d)("indices",e,t,n);return[Lt.a(o,Je.a(u,"int32"),0)];case"GatherV2":var c=Object(h.d)("axis",e,t,n),l=Object(h.d)("batchDims",e,t,n),f=Object(h.d)("x",e,t,n),d=Object(h.d)("indices",e,t,n);return[Lt.a(f,Je.a(d,"int32"),c,l)];case"Reverse":for(var p=Object(h.d)("dims",e,t,n),v=[],m=0;m<p.length;m++)p[m]&&v.push(m);var b=Object(h.d)("x",e,t,n);return[Pt.a(b,v)];case"ReverseV2":var g=Object(h.d)("axis",e,t,n),y=Object(h.d)("x",e,t,n);return[Pt.a(y,g)];case"Slice":var x=Object(h.d)("begin",e,t,n),O=Object(h.d)("size",e,t,n);return[Bt.a(Object(h.d)("x",e,t,n),x,O)];case"StridedSlice":var k=Object(h.d)("begin",e,t,n),w=Object(h.d)("end",e,t,n),j=Object(h.d)("strides",e,t,n),_=Object(h.d)("beginMask",e,t,n),S=Object(h.d)("endMask",e,t,n),E=Object(h.d)("ellipsisMask",e,t,n),C=Object(h.d)("newAxisMask",e,t,n),A=Object(h.d)("shrinkAxisMask",e,t,n),N=Object(h.d)("x",e,t,n);return[Wt.a(N,k,w,j,_,S,E,C,A)];case"Pack":return Object(s.tidy)((function(){var r=Object(h.d)("axis",e,t,n),a=Object(h.d)("tensors",e,t,n),i=a[0].shape,o=Ut.a(a[0]).shape,u=a.map((function(e){var t=s.util.arraysEqual(e.shape,i);if(!t&&!s.util.arraysEqual(Ut.a(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:Vt.a(e,i)}));return[qt.a(u,r)]}));case"Unpack":var T=Object(h.d)("axis",e,t,n),I=Object(h.d)("tensor",e,t,n);return Ht.a(I,T);case"Tile":var D=Object(h.d)("reps",e,t,n);return[Gt.a(Object(h.d)("x",e,t,n),D)];case"Split":case"SplitV":var F=Object(h.d)("axis",e,t,n),M=Object(h.d)("numOrSizeSplits",e,t,n),R=Object(h.d)("x",e,t,n);return Kt.a(R,M,F);case"ScatterNd":var z=Object(h.d)("indices",e,t,n),L=Object(h.d)("values",e,t,n),P=Object(h.d)("shape",e,t,n);return[Xt.a(z,L,P)];case"GatherNd":var B=Object(h.d)("x",e,t,n),W=Object(h.d)("indices",e,t,n);return[Yt.a(B,W)];case"SparseToDense":var U=Object(h.d)("sparseIndices",e,t,n),V=Object(h.d)("outputShape",e,t,n),q=Object(h.d)("sparseValues",e,t,n),H=Object(h.d)("defaultValue",e,t,n);return[_t.a(U,q,V,q.dtype===H.dtype?H:Je.a(H,q.dtype))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"sparse":return s.tidy((function(){return function(e,t,n){switch(e.op){case"SparseReshape":var r=Ae.md.sparseReshape(Object(h.d)("inputIndices",e,t,n),Object(h.d)("inputShape",e,t,n),Object(h.d)("newShape",e,t,n));return[r.outputIndices,r.outputShape];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"spectral":return s.tidy((function(){return function(e,t,n){switch(e.op){case"FFT":return[$t.a(Object(h.d)("x",e,t,n))];case"IFFT":return[Jt.a(Object(h.d)("x",e,t,n))];case"RFFT":return[Qt.a(Object(h.d)("x",e,t,n))];case"IRFFT":return[Zt.a(Object(h.d)("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"transformation":return s.tidy((function(){return function(e,t,n){switch(e.op){case"Cast":return[Je.a(Object(h.d)("x",e,t,n),Object(h.d)("dtype",e,t,n))];case"ExpandDims":var r=Object(h.d)("axis",e,t,n);return[en.a(Object(h.d)("x",e,t,n),r)];case"Squeeze":var a=Object(h.d)("axis",e,t,n);return[Ut.a(Object(h.d)("x",e,t,n),a)];case"Reshape":return[Vt.a(Object(h.d)("x",e,t,n),Object(h.d)("shape",e,t,n))];case"MirrorPad":return[tn.a(Object(h.d)("x",e,t,n),Object(h.d)("padding",e,t,n),Object(h.d)("mode",e,t,n))];case"PadV2":case"Pad":return[nn.a(Object(h.d)("x",e,t,n),Object(h.d)("padding",e,t,n),Object(h.d)("constantValue",e,t,n))];case"SpaceToBatchND":var i=Object(h.d)("blockShape",e,t,n),o=Object(h.d)("paddings",e,t,n);return[rn.a(Object(h.d)("x",e,t,n),i,o)];case"BatchToSpaceND":var u=Object(h.d)("blockShape",e,t,n),c=Object(h.d)("crops",e,t,n);return[an.a(Object(h.d)("x",e,t,n),u,c)];case"DepthToSpace":var s=Object(h.d)("blockSize",e,t,n),l=Object(h.d)("dataFormat",e,t,n).toUpperCase();return[on.a(Object(h.d)("x",e,t,n),s,l)];case"BroadcastTo":return[un.a(Object(h.d)("x",e,t,n),Object(h.d)("shape",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"hash_table":return ut(e,t,n,a);case"custom":var i=Object(v.a)(e.op);if(i&&i.customExecutor)return i.customExecutor(new p(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return s.util.isPromise(i)?i.then((function(e){return[].concat(e)})):[].concat(i)}var sn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(u.a)(this,e),this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return Object(c.a)(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"addTensorList",value:function(e){this.tensorListMap[e.id]=e}},{key:"getTensorList",value:function(e){return this.tensorListMap[e]}},{key:"dispose",value:function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}]),e}();function ln(e,t,n,r){var a=new Set,i=[],o=null,u=null,c=new Set,s=Object.keys(e).map((function(e){return Object(h.g)(e)[0]})),l=[];null!=r&&(l=r.map((function(e){return Object(h.g)(e.name)[0]})));for(var f=Object(d.a)(t);f.length>0;){var p=f.pop();(pn(p)||vn(p)||mn(p))&&null==o&&(u=(o=p).children.map((function(e){return e.name})).filter((function(e){return a.has(e)}))),a.add(p.name),null==n[p.name]&&(-1===s.indexOf(p.name)&&-1===l.indexOf(p.name)&&(0!==p.inputs.length?p.inputs.forEach((function(e){c.has(e.name)||(c.add(e.name),f.push(e))})):i.push(p.name)))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:u}}var fn=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],dn=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],hn=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function pn(e){return fn.indexOf(e.op)>=0}function vn(e){return dn.indexOf(e.op)>=0}function mn(e){return hn.indexOf(e.op)>=0}var bn=function(){function e(t,n){var r=this;Object(u.a)(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}return Object(c.a)(e,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,Object(d.a)(n)),this._weightMap=e}},{key:"resourceManager",set:function(e){this._resourceManager=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}},{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(e,t){var n=ln(e,t,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){var o=t.map((function(e){return e.name})),u=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(u,"]. Missing the following inputs: [").concat(r,"]"))}return function(e,t,n){var r=n.usedNodes,a=n.inputs,i=[],o=Object.keys(a).map((function(e){return Object(h.g)(e)[0]})).map((function(t){return e.nodes[t]})),u=e.initNodes;o.forEach((function(e){r.has(e.name)&&i.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&i.push(e)})),null!=u&&u.forEach((function(e){r.has(e.name)&&i.push(e)}));for(var c=new Set,s=[];i.length>0;){var l=i.pop();c.add(l.name),t[l.name]||s.push(l),l.children.forEach((function(e){!c.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return c.has(e.name)}))&&i.push(e)}))}return s}(this.graph,this.weightMap,n)}},{key:"execute",value:function(e,t){var n=this;e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[Object(h.g)(e)[0]]})),i=t.map((function(e){return Object(h.g)(e)[0]})),o=i.map((function(e){return n.graph.nodes[e]}));0===o.length&&(o=this._outputs);var u=this.getCompilationKey(a,o),c=this.compiledMap.get(u);null==c&&(c=this.compile(e,o),this.compiledMap.set(u,c));var l={},d={};return Object(s.tidy)((function(){var r=new sn(n.weightMap,l,d,n.functionExecutorMap),a=Object.assign({},n.weightMap);Object.keys(e).forEach((function(t){var n=Object(h.g)(t),r=Object(f.a)(n,2),i=r[0],o=[];o[r[1]]=e[t],a[i]=o}));for(var o=n.getFrozenTensorIds(a),u={},p=0;p<c.length;p++){var v=c[p];if(!a[v.name]){var m=cn(v,a,r,n._resourceManager);if(s.util.isPromise(m))throw new Error("The execution of the op '".concat(v.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[v.name]=m,n.checkTensorForDisposal(v.name,v,a,r,o,i,u)}}return null==n.parent&&r.dispose(o),t.map((function(e){return Object(h.e)(e,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,i,o){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=Object(h.f)(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!e.kept&&!a.has(e.id)){var t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))}},{key:"executeAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._executeAsync(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_executeAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r,a,o,u,c,s,l,f,p,v=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=v.length>2&&void 0!==v[2]&&v[2],a=v.length>3&&void 0!==v[3]?v[3]:{},o=v.length>4&&void 0!==v[4]?v[4]:{},r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n)),u=new sn(this.weightMap,a,o,this.functionExecutorMap),e.next=7,this.executeWithControlFlow(t,u,n,r);case 7:return c=e.sent,s=n.map((function(e){return Object(h.e)(e,c,u)})),l=s.map((function(e){return e.id})),f=Object.keys(t).map((function(e){return t[e].id})),p=new Set([].concat(Object(d.a)(l),Object(d.a)(f),Object(d.a)(this.weightIds))),Object.keys(c).forEach((function(e){c[e].forEach((function(e){!e||e.kept||e.isDisposed||p.has(e.id)||e.dispose()}))})),null==this.parent&&u.dispose(p),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,o=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.reduce((function(e,t,n){return e[o.inputs[n].name]=t,e}),{}),e.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n,r,a){var o,u,c,s,l,p,v,m,b,g,y,x,O,k,w,j,_,S=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Object.keys(t),u=o.map((function(e){return S.graph.nodes[Object(h.g)(e)[0]]})),c=r.map((function(e){return Object(h.g)(e)[0]})),0===(s=c.map((function(e){return S.graph.nodes[e]}))).length&&(s=this._outputs),l=ln(t,s,this.weightMap,this._initNodes),p=l.usedNodes,v=l.missingInputs,m=l.dynamicNode,b=l.syncInputs,g=[].concat(Object(d.a)(u),Object(d.a)(this.graph.weights),Object(d.a)(this._initNodes||[])).map((function(e){return{node:e,contexts:n.currentContext}})),y=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=Object(h.g)(e),r=Object(f.a)(n,2),a=r[0],i=[];i[r[1]]=t[e],y[a]=i})),x={},O=this.getFrozenTensorIds(y),k={};case 12:if(!(g.length>0)){e.next=18;break}return w=this.processStack(u,g,n,y,k,O,c,x,p),e.next=16,Promise.all(w);case 16:e.next=12;break;case 18:if(null!=m||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((j=s.filter((function(e){return!pn(e)&&!Object(h.e)(e.name,y,n)})).map((function(e){return e.name}))).length>0)){e.next=24;break}throw _="",null!=m&&(_="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(b,"]")),new Error("Cannot compute the outputs [".concat(j,"] from the provided ")+"inputs [".concat(o,"]. Consider providing the following inputs: ")+"[".concat(v,"]. ").concat(_));case 24:return e.abrupt("return",y);case 25:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"processStack",value:function(e,t,n,r,a,i,o,u,c){for(var l=this,d=[],p=function(){var e=t.pop();n.currentContext=e.contexts;var p="";if("Enter"===e.node.op&&Object(h.d)("isConstant",e.node,r,n)){var v=Object(h.b)(e.node.name,n),m=Object(f.a)(v,1);p=m[0]}if(null==r[e.node.name]){var b=cn(e.node,r,n,l._resourceManager);if(!p){var g=Object(h.b)(e.node.name,n),y=Object(f.a)(g,1);p=y[0]}var x=n.currentContext;s.util.isPromise(b)?d.push(b.then((function(s){return r[p]=s,n.currentContext=x,l.checkTensorForDisposal(p,e.node,r,n,i,o,u),l.processChildNodes(e.node,t,n,r,a,c),s}))):(r[p]=b,l.checkTensorForDisposal(p,e.node,r,n,i,o,u),l.processChildNodes(e.node,t,n,r,a,c))}else l.processChildNodes(e.node,t,n,r,a,c)};t.length>0;)p();return d}},{key:"processChildNodes",value:function(e,t,n,r,a,i){e.children.forEach((function(e){var o=Object(h.b)(e.name,n),u=Object(f.a)(o,1)[0];!a[u]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!Object(h.e)(e,r,n)}))&&(a[u]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!Object(h.e)(e,r,n)}))&&(a[u]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=Object(h.g)(n),i=Object(f.a)(a,1)[0],o=t.graph.nodes[i];if(o.attrParams.shape&&o.attrParams.shape.value){var u=o.attrParams.shape.value,c=u.length===r.shape.length&&r.shape.every((function(e,t){return-1===u[t]||u[t]===e}));s.util.assert(c,(function(){return"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(u,"], but was ")+"[".concat(r.shape,"]")}))}o.attrParams.dtype&&o.attrParams.dtype.value&&s.util.assert(r.dtype===o.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(e){var t={};for(var n in e){if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n])t[this._signature.inputs[n].name]=e[n];else t[n]=e[n]}return t}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=Object(h.g)(e),r=Object(f.a)(n,1)[0];return null==t.graph.nodes[r]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){return null!=t._signature&&null!=t._signature.outputs&&null!=t._signature.outputs[e]?t._signature.outputs[e].name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=Object(h.g)(e),r=Object(f.a)(n,1)[0];if(!t.graph.nodes[r])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}]),e}(),gn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(u.a)(this,e),this.hashTableNameToHandle=t,this.hashTableMap=n}return Object(c.a)(e,[{key:"addHashTable",value:function(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}},{key:"getHashTableHandleByName",value:function(e){return this.hashTableNameToHandle[e]}},{key:"getHashTableById",value:function(e){return this.hashTableMap[e]}},{key:"dispose",value:function(){for(var e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(var t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}]),e}(),yn="?tfjs-format=file",xn="model.json",On=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(u.a)(this,e),this.modelUrl=t,this.loadOptions=n,this.version="n/a",null==n&&(this.loadOptions={}),this.resourceManager=new gn}return Object(c.a)(e,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"findIOHandler",value:function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=s.io.browserHTTPRequest(e,this.loadOptions);else{var t=s.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(s.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}},{key:"load",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.findIOHandler(),null!=this.handler.load){e.next=3;break}throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 3:return e.next=5,this.handler.load();case 5:return t=e.sent,e.abrupt("return",this.loadSync(t));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadSync",value:function(e){this.artifacts=e;var t,n=this.artifacts.modelTopology;t=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=t,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer);var r=s.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new bn(l.a.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){var a=l.a.Instance.transformGraph(e.modelInitializer);this.initializer=new bn(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}},{key:"save",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=s.io.getSaveHandlers(t)).length){e.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.abrupt("return",t.save(this.artifacts));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e,t){return this.execute(e,this.outputNodes)}},{key:"normalizeInputs",value:function(e){if(!(e instanceof s.Tensor)&&!Array.isArray(e))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(e.length," input tensors."));return this.inputNodes.reduce((function(t,n,r){return t[n]=e[r],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"execute",value:function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=4,this.executor.executeAsync(t,n);case 4:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}]),e}();function kn(e){return wn.apply(this,arguments)}function wn(){return(wn=Object(o.a)(i.a.mark((function e(t){var n,r,a=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},null!=t){e.next=3;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 3:return null==n&&(n={}),n.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t="".concat(t).concat(xn).concat(yn)),r=new On(t,n),e.next=8,r.load();case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var jn="3.5.0"},function(e,t,n){"use strict";(function(e,r){var a;function i(){if(null==a){var t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof e)t=e;else if("undefined"!==typeof r)t=r;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}a=t}return a}function o(e,t){var n=function(){var e=i();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}))}).call(this,n(172),n(160))},function(e,t,n){"use strict";e.exports=function(e,t){t||(t={}),"function"===typeof t&&(t={cmp:t});var n,r="boolean"===typeof t.cycles&&t.cycles,a=t.cmp&&(n=t.cmp,function(e){return function(t,r){var a={key:t,value:e[t]},i={key:r,value:e[r]};return n(a,i)}}),i=[];return function e(t){if(t&&t.toJSON&&"function"===typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!==typeof t)return JSON.stringify(t);var n,o;if(Array.isArray(t)){for(o="[",n=0;n<t.length;n++)n&&(o+=","),o+=e(t[n])||"null";return o+"]"}if(null===t)return"null";if(-1!==i.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(t)-1,c=Object.keys(t).sort(a&&a(t));for(o="",n=0;n<c.length;n++){var s=c[n],l=e(t[s]);l&&(o&&(o+=","),o+=JSON.stringify(s)+":"+l)}return i.splice(u,1),"{"+o+"}"}}(e)}},function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function o(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,t){for(var n,u,c=o(e),s=1;s<arguments.length;s++){for(var l in n=Object(arguments[s]))a.call(n,l)&&(c[l]=n[l]);if(r){u=r(n);for(var f=0;f<u.length;f++)i.call(n,u[f])&&(c[u[f]]=n[u[f]])}}return c}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){var r=n(173).MAX_SAFE_COMPONENT_LENGTH,a=n(174),i=(t=e.exports={}).re=[],o=t.src=[],u=t.t={},c=0,s=function(e,t,n){var r=c++;a(r,t),u[e]=r,o[r]=t,i[r]=new RegExp(t,n?"g":void 0)};s("NUMERICIDENTIFIER","0|[1-9]\\d*"),s("NUMERICIDENTIFIERLOOSE","[0-9]+"),s("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),s("MAINVERSION","(".concat(o[u.NUMERICIDENTIFIER],")\\.")+"(".concat(o[u.NUMERICIDENTIFIER],")\\.")+"(".concat(o[u.NUMERICIDENTIFIER],")")),s("MAINVERSIONLOOSE","(".concat(o[u.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[u.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[u.NUMERICIDENTIFIERLOOSE],")")),s("PRERELEASEIDENTIFIER","(?:".concat(o[u.NUMERICIDENTIFIER],"|").concat(o[u.NONNUMERICIDENTIFIER],")")),s("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[u.NUMERICIDENTIFIERLOOSE],"|").concat(o[u.NONNUMERICIDENTIFIER],")")),s("PRERELEASE","(?:-(".concat(o[u.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[u.PRERELEASEIDENTIFIER],")*))")),s("PRERELEASELOOSE","(?:-?(".concat(o[u.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[u.PRERELEASEIDENTIFIERLOOSE],")*))")),s("BUILDIDENTIFIER","[0-9A-Za-z-]+"),s("BUILD","(?:\\+(".concat(o[u.BUILDIDENTIFIER],"(?:\\.").concat(o[u.BUILDIDENTIFIER],")*))")),s("FULLPLAIN","v?".concat(o[u.MAINVERSION]).concat(o[u.PRERELEASE],"?").concat(o[u.BUILD],"?")),s("FULL","^".concat(o[u.FULLPLAIN],"$")),s("LOOSEPLAIN","[v=\\s]*".concat(o[u.MAINVERSIONLOOSE]).concat(o[u.PRERELEASELOOSE],"?").concat(o[u.BUILD],"?")),s("LOOSE","^".concat(o[u.LOOSEPLAIN],"$")),s("GTLT","((?:<|>)?=?)"),s("XRANGEIDENTIFIERLOOSE","".concat(o[u.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),s("XRANGEIDENTIFIER","".concat(o[u.NUMERICIDENTIFIER],"|x|X|\\*")),s("XRANGEPLAIN","[v=\\s]*(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:".concat(o[u.PRERELEASE],")?").concat(o[u.BUILD],"?")+")?)?"),s("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(o[u.PRERELEASELOOSE],")?").concat(o[u.BUILD],"?")+")?)?"),s("XRANGE","^".concat(o[u.GTLT],"\\s*").concat(o[u.XRANGEPLAIN],"$")),s("XRANGELOOSE","^".concat(o[u.GTLT],"\\s*").concat(o[u.XRANGEPLAINLOOSE],"$")),s("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:$|[^\\d])"),s("COERCERTL",o[u.COERCE],!0),s("LONETILDE","(?:~>?)"),s("TILDETRIM","(\\s*)".concat(o[u.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",s("TILDE","^".concat(o[u.LONETILDE]).concat(o[u.XRANGEPLAIN],"$")),s("TILDELOOSE","^".concat(o[u.LONETILDE]).concat(o[u.XRANGEPLAINLOOSE],"$")),s("LONECARET","(?:\\^)"),s("CARETTRIM","(\\s*)".concat(o[u.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",s("CARET","^".concat(o[u.LONECARET]).concat(o[u.XRANGEPLAIN],"$")),s("CARETLOOSE","^".concat(o[u.LONECARET]).concat(o[u.XRANGEPLAINLOOSE],"$")),s("COMPARATORLOOSE","^".concat(o[u.GTLT],"\\s*(").concat(o[u.LOOSEPLAIN],")$|^$")),s("COMPARATOR","^".concat(o[u.GTLT],"\\s*(").concat(o[u.FULLPLAIN],")$|^$")),s("COMPARATORTRIM","(\\s*)".concat(o[u.GTLT],"\\s*(").concat(o[u.LOOSEPLAIN],"|").concat(o[u.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",s("HYPHENRANGE","^\\s*(".concat(o[u.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(o[u.XRANGEPLAIN],")")+"\\s*$"),s("HYPHENRANGELOOSE","^\\s*(".concat(o[u.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(o[u.XRANGEPLAINLOOSE],")")+"\\s*$"),s("STAR","(<|>)?=?\\s*\\*"),s("GTE0","^\\s*>=\\s*0.0.0\\s*$"),s("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,n){var r=n(173).MAX_LENGTH,a=n(127),i=a.re,o=a.t,u=n(62),c=n(175);e.exports=function(e,t){if(t=c(t),e instanceof u)return e;if("string"!==typeof e)return null;if(e.length>r)return null;if(!(t.loose?i[o.LOOSE]:i[o.FULL]).test(e))return null;try{return new u(e,t)}catch(n){return null}}},function(e,t,n){var r=n(240);e.exports=function(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw o}}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"DEFAULT_ACTIONS",(function(){return d1})),n.d(t,"guessMode",(function(){return O1})),n.d(t,"vega",(function(){return s1})),n.d(t,"vegaLite",(function(){return l1}));var r={};n.r(r),n.d(r,"JsonPatchError",(function(){return F})),n.d(r,"deepClone",(function(){return M})),n.d(r,"getValueByPointer",(function(){return L})),n.d(r,"applyOperation",(function(){return P})),n.d(r,"applyPatch",(function(){return B})),n.d(r,"applyReducer",(function(){return W})),n.d(r,"validator",(function(){return U})),n.d(r,"validate",(function(){return V})),n.d(r,"_areEquals",(function(){return q}));var a={};n.r(a),n.d(a,"unobserve",(function(){return X})),n.d(a,"observe",(function(){return Y})),n.d(a,"generate",(function(){return $})),n.d(a,"compare",(function(){return Q}));var i={};n.r(i),n.d(i,"aggregate",(function(){return Bu})),n.d(i,"bin",(function(){return Wu})),n.d(i,"collect",(function(){return Vu})),n.d(i,"compare",(function(){return qu})),n.d(i,"countpattern",(function(){return Gu})),n.d(i,"cross",(function(){return Ku})),n.d(i,"density",(function(){return Ju})),n.d(i,"dotbin",(function(){return nc})),n.d(i,"expression",(function(){return rc})),n.d(i,"extent",(function(){return ic})),n.d(i,"facet",(function(){return uc})),n.d(i,"field",(function(){return cc})),n.d(i,"filter",(function(){return lc})),n.d(i,"flatten",(function(){return fc})),n.d(i,"fold",(function(){return dc})),n.d(i,"formula",(function(){return hc})),n.d(i,"generate",(function(){return pc})),n.d(i,"impute",(function(){return bc})),n.d(i,"joinaggregate",(function(){return gc})),n.d(i,"kde",(function(){return yc})),n.d(i,"key",(function(){return xc})),n.d(i,"load",(function(){return kc})),n.d(i,"lookup",(function(){return jc})),n.d(i,"multiextent",(function(){return _c})),n.d(i,"multivalues",(function(){return Ec})),n.d(i,"params",(function(){return Ac})),n.d(i,"pivot",(function(){return Nc})),n.d(i,"prefacet",(function(){return Tc})),n.d(i,"project",(function(){return Ic})),n.d(i,"proxy",(function(){return Dc})),n.d(i,"quantile",(function(){return Fc})),n.d(i,"relay",(function(){return Mc})),n.d(i,"sample",(function(){return Rc})),n.d(i,"sequence",(function(){return zc})),n.d(i,"sieve",(function(){return Lc})),n.d(i,"subflow",(function(){return oc})),n.d(i,"timeunit",(function(){return Pc})),n.d(i,"tupleindex",(function(){return Wc})),n.d(i,"values",(function(){return Uc})),n.d(i,"window",(function(){return Kc}));var o={};n.r(o),n.d(o,"interpolate",(function(){return Sf})),n.d(o,"interpolateArray",(function(){return gf})),n.d(o,"interpolateBasis",(function(){return af})),n.d(o,"interpolateBasisClosed",(function(){return of})),n.d(o,"interpolateDate",(function(){return xf})),n.d(o,"interpolateDiscrete",(function(){return xd})),n.d(o,"interpolateHue",(function(){return Od})),n.d(o,"interpolateNumber",(function(){return Of})),n.d(o,"interpolateNumberArray",(function(){return mf})),n.d(o,"interpolateObject",(function(){return kf})),n.d(o,"interpolateRound",(function(){return Ef})),n.d(o,"interpolateString",(function(){return _f})),n.d(o,"interpolateTransformCss",(function(){return Sd})),n.d(o,"interpolateTransformSvg",(function(){return Ed})),n.d(o,"interpolateZoom",(function(){return Ad})),n.d(o,"interpolateRgb",(function(){return df})),n.d(o,"interpolateRgbBasis",(function(){return pf})),n.d(o,"interpolateRgbBasisClosed",(function(){return vf})),n.d(o,"interpolateHsl",(function(){return Td})),n.d(o,"interpolateHslLong",(function(){return Id})),n.d(o,"interpolateLab",(function(){return Jd})),n.d(o,"interpolateHcl",(function(){return Zd})),n.d(o,"interpolateHclLong",(function(){return eh})),n.d(o,"interpolateCubehelix",(function(){return vh})),n.d(o,"interpolateCubehelixLong",(function(){return mh})),n.d(o,"piecewise",(function(){return md})),n.d(o,"quantize",(function(){return bh}));var u={};n.r(u),n.d(u,"bound",(function(){return By})),n.d(u,"identifier",(function(){return Vy})),n.d(u,"mark",(function(){return qy})),n.d(u,"overlap",(function(){return Hy})),n.d(u,"render",(function(){return Qy})),n.d(u,"viewlayout",(function(){return xx}));var c={};n.r(c),n.d(c,"axisticks",(function(){return kx})),n.d(c,"datajoin",(function(){return wx})),n.d(c,"encode",(function(){return _x})),n.d(c,"legendentries",(function(){return Sx})),n.d(c,"linkpath",(function(){return Tx})),n.d(c,"pie",(function(){return Rx})),n.d(c,"scale",(function(){return Px})),n.d(c,"sortitems",(function(){return Vx})),n.d(c,"stack",(function(){return Xx}));var s={};n.r(s),n.d(s,"contour",(function(){return Ij})),n.d(s,"geojson",(function(){return Mj})),n.d(s,"geopath",(function(){return Rj})),n.d(s,"geopoint",(function(){return zj})),n.d(s,"geoshape",(function(){return Lj})),n.d(s,"graticule",(function(){return Pj})),n.d(s,"heatmap",(function(){return Bj})),n.d(s,"isocontour",(function(){return kj})),n.d(s,"kde2d",(function(){return Aj})),n.d(s,"projection",(function(){return Uj}));var l={};n.r(l),n.d(l,"force",(function(){return L_}));var f={};n.r(f),n.d(f,"nest",(function(){return WS})),n.d(f,"pack",(function(){return KS})),n.d(f,"partition",(function(){return YS})),n.d(f,"stratify",(function(){return $S})),n.d(f,"tree",(function(){return ZS})),n.d(f,"treelinks",(function(){return eE})),n.d(f,"treemap",(function(){return rE}));var d={};n.r(d),n.d(d,"label",(function(){return jE}));var h={};n.r(h),n.d(h,"loess",(function(){return SE})),n.d(h,"regression",(function(){return CE}));var p={};n.r(p),n.d(p,"voronoi",(function(){return eC}));var v={};n.r(v),n.d(v,"wordcloud",(function(){return pC}));var m={};n.r(m),n.d(m,"crossfilter",(function(){return OC})),n.d(m,"resolvefilter",(function(){return kC}));var b={};n.r(b),n.d(b,"Debug",(function(){return ne.a})),n.d(b,"Error",(function(){return ne.b})),n.d(b,"Info",(function(){return ne.c})),n.d(b,"None",(function(){return ne.d})),n.d(b,"Warn",(function(){return ne.e})),n.d(b,"accessor",(function(){return ne.f})),n.d(b,"accessorFields",(function(){return ne.g})),n.d(b,"accessorName",(function(){return ne.h})),n.d(b,"array",(function(){return ne.i})),n.d(b,"ascending",(function(){return ne.j})),n.d(b,"clampRange",(function(){return ne.k})),n.d(b,"compare",(function(){return ne.l})),n.d(b,"constant",(function(){return ne.m})),n.d(b,"debounce",(function(){return ne.n})),n.d(b,"error",(function(){return ne.o})),n.d(b,"extend",(function(){return ne.p})),n.d(b,"extent",(function(){return ne.q})),n.d(b,"extentIndex",(function(){return ne.r})),n.d(b,"falsy",(function(){return ne.s})),n.d(b,"fastmap",(function(){return ne.t})),n.d(b,"field",(function(){return ne.u})),n.d(b,"flush",(function(){return ne.v})),n.d(b,"hasOwnProperty",(function(){return ne.w})),n.d(b,"id",(function(){return ne.x})),n.d(b,"identity",(function(){return ne.y})),n.d(b,"inherits",(function(){return ne.z})),n.d(b,"inrange",(function(){return ne.A})),n.d(b,"isArray",(function(){return ne.B})),n.d(b,"isBoolean",(function(){return ne.C})),n.d(b,"isDate",(function(){return ne.D})),n.d(b,"isFunction",(function(){return ne.E})),n.d(b,"isIterable",(function(){return ne.F})),n.d(b,"isNumber",(function(){return ne.G})),n.d(b,"isObject",(function(){return ne.H})),n.d(b,"isRegExp",(function(){return ne.I})),n.d(b,"isString",(function(){return ne.J})),n.d(b,"key",(function(){return ne.K})),n.d(b,"lerp",(function(){return ne.L})),n.d(b,"logger",(function(){return ne.M})),n.d(b,"lruCache",(function(){return ne.N})),n.d(b,"merge",(function(){return ne.O})),n.d(b,"mergeConfig",(function(){return ne.P})),n.d(b,"one",(function(){return ne.Q})),n.d(b,"pad",(function(){return ne.R})),n.d(b,"panLinear",(function(){return ne.S})),n.d(b,"panLog",(function(){return ne.T})),n.d(b,"panPow",(function(){return ne.U})),n.d(b,"panSymlog",(function(){return ne.V})),n.d(b,"peek",(function(){return ne.W})),n.d(b,"quarter",(function(){return ne.X})),n.d(b,"repeat",(function(){return ne.Y})),n.d(b,"span",(function(){return ne.Z})),n.d(b,"splitAccessPath",(function(){return ne.ab})),n.d(b,"stringValue",(function(){return ne.bb})),n.d(b,"toBoolean",(function(){return ne.cb})),n.d(b,"toDate",(function(){return ne.db})),n.d(b,"toNumber",(function(){return ne.eb})),n.d(b,"toSet",(function(){return ne.fb})),n.d(b,"toString",(function(){return ne.gb})),n.d(b,"truncate",(function(){return ne.hb})),n.d(b,"truthy",(function(){return ne.ib})),n.d(b,"utcquarter",(function(){return ne.jb})),n.d(b,"visitArray",(function(){return ne.kb})),n.d(b,"writeConfig",(function(){return ne.lb})),n.d(b,"zero",(function(){return ne.mb})),n.d(b,"zoomLinear",(function(){return ne.nb})),n.d(b,"zoomLog",(function(){return ne.ob})),n.d(b,"zoomPow",(function(){return ne.pb})),n.d(b,"zoomSymlog",(function(){return ne.qb})),n.d(b,"Dataflow",(function(){return so})),n.d(b,"EventStream",(function(){return Vi})),n.d(b,"MultiPulse",(function(){return no})),n.d(b,"Operator",(function(){return Bi})),n.d(b,"Parameters",(function(){return zi})),n.d(b,"Pulse",(function(){return Qi})),n.d(b,"Transform",(function(){return fo})),n.d(b,"changeset",(function(){return Mi})),n.d(b,"definition",(function(){return po})),n.d(b,"ingest",(function(){return Ai})),n.d(b,"isTuple",(function(){return Si})),n.d(b,"transform",(function(){return vo})),n.d(b,"transforms",(function(){return ho})),n.d(b,"tupleid",(function(){return Ei})),n.d(b,"bandwidthNRD",(function(){return Do})),n.d(b,"bin",(function(){return Fo})),n.d(b,"bootstrapCI",(function(){return zo})),n.d(b,"cumulativeLogNormal",(function(){return Qo})),n.d(b,"cumulativeNormal",(function(){return Go})),n.d(b,"cumulativeUniform",(function(){return au})),n.d(b,"densityLogNormal",(function(){return Jo})),n.d(b,"densityNormal",(function(){return Ho})),n.d(b,"densityUniform",(function(){return ru})),n.d(b,"dotbin",(function(){return Lo})),n.d(b,"quantileLogNormal",(function(){return Zo})),n.d(b,"quantileNormal",(function(){return Ko})),n.d(b,"quantileUniform",(function(){return iu})),n.d(b,"quantiles",(function(){return To})),n.d(b,"quartiles",(function(){return Io})),n.d(b,"random",(function(){return Mo})),n.d(b,"randomInteger",(function(){return Bo})),n.d(b,"randomKDE",(function(){return Yo})),n.d(b,"randomLCG",(function(){return Po})),n.d(b,"randomLogNormal",(function(){return eu})),n.d(b,"randomMixture",(function(){return tu})),n.d(b,"randomNormal",(function(){return Xo})),n.d(b,"randomUniform",(function(){return ou})),n.d(b,"regressionExp",(function(){return hu})),n.d(b,"regressionLinear",(function(){return fu})),n.d(b,"regressionLoess",(function(){return gu})),n.d(b,"regressionLog",(function(){return du})),n.d(b,"regressionPoly",(function(){return mu})),n.d(b,"regressionPow",(function(){return pu})),n.d(b,"regressionQuad",(function(){return vu})),n.d(b,"sampleCurve",(function(){return ku})),n.d(b,"sampleLogNormal",(function(){return $o})),n.d(b,"sampleNormal",(function(){return qo})),n.d(b,"sampleUniform",(function(){return nu})),n.d(b,"setRandom",(function(){return Ro})),n.d(b,"DATE",(function(){return Sn})),n.d(b,"DAY",(function(){return En})),n.d(b,"DAYOFYEAR",(function(){return Cn})),n.d(b,"HOURS",(function(){return An})),n.d(b,"MILLISECONDS",(function(){return In})),n.d(b,"MINUTES",(function(){return Nn})),n.d(b,"MONTH",(function(){return jn})),n.d(b,"QUARTER",(function(){return wn})),n.d(b,"SECONDS",(function(){return Tn})),n.d(b,"TIME_UNITS",(function(){return Dn})),n.d(b,"WEEK",(function(){return _n})),n.d(b,"YEAR",(function(){return kn})),n.d(b,"dayofyear",(function(){return Bn})),n.d(b,"timeBin",(function(){return Nr})),n.d(b,"timeFloor",(function(){return nr})),n.d(b,"timeInterval",(function(){return cr})),n.d(b,"timeOffset",(function(){return fr})),n.d(b,"timeSequence",(function(){return pr})),n.d(b,"timeUnitSpecifier",(function(){return zn})),n.d(b,"timeUnits",(function(){return Mn})),n.d(b,"utcFloor",(function(){return ir})),n.d(b,"utcInterval",(function(){return sr})),n.d(b,"utcOffset",(function(){return dr})),n.d(b,"utcSequence",(function(){return vr})),n.d(b,"utcdayofyear",(function(){return Gn})),n.d(b,"utcweek",(function(){return Kn})),n.d(b,"week",(function(){return Wn})),n.d(b,"loader",(function(){return xi})),n.d(b,"read",(function(){return yi})),n.d(b,"inferType",(function(){return ke})),n.d(b,"inferTypes",(function(){return we})),n.d(b,"typeParsers",(function(){return ye})),n.d(b,"format",(function(){return He})),n.d(b,"formats",(function(){return Ge})),n.d(b,"responseType",(function(){return Ke})),n.d(b,"Bounds",(function(){return Nv})),n.d(b,"CanvasHandler",(function(){return ig})),n.d(b,"CanvasRenderer",(function(){return lg})),n.d(b,"Gradient",(function(){return zp})),n.d(b,"GroupItem",(function(){return Iv})),n.d(b,"Handler",(function(){return Bb})),n.d(b,"Item",(function(){return Tv})),n.d(b,"Marks",(function(){return jb})),n.d(b,"RenderType",(function(){return Zg})),n.d(b,"Renderer",(function(){return Ub})),n.d(b,"ResourceLoader",(function(){return Dv})),n.d(b,"SVGHandler",(function(){return dg})),n.d(b,"SVGRenderer",(function(){return Rg})),n.d(b,"SVGStringRenderer",(function(){return $g})),n.d(b,"Scenegraph",(function(){return Ib})),n.d(b,"boundClip",(function(){return uy})),n.d(b,"boundContext",(function(){return em})),n.d(b,"boundItem",(function(){return _b})),n.d(b,"boundMark",(function(){return Eb})),n.d(b,"boundStroke",(function(){return Rv})),n.d(b,"domChild",(function(){return Rb})),n.d(b,"domClear",(function(){return zb})),n.d(b,"domCreate",(function(){return Fb})),n.d(b,"domFind",(function(){return Mb})),n.d(b,"font",(function(){return gb})),n.d(b,"fontFamily",(function(){return bb})),n.d(b,"fontSize",(function(){return db})),n.d(b,"intersect",(function(){return ny})),n.d(b,"intersectBoxLine",(function(){return fm})),n.d(b,"intersectPath",(function(){return um})),n.d(b,"intersectPoint",(function(){return cm})),n.d(b,"intersectRule",(function(){return lm})),n.d(b,"lineHeight",(function(){return hb})),n.d(b,"markup",(function(){return Ag})),n.d(b,"multiLineOffset",(function(){return vb})),n.d(b,"pathCurves",(function(){return Pp})),n.d(b,"pathEqual",(function(){return sy})),n.d(b,"pathParse",(function(){return Up})),n.d(b,"pathRectangle",(function(){return dv})),n.d(b,"pathRender",(function(){return Zp})),n.d(b,"pathSymbols",(function(){return rv})),n.d(b,"pathTrail",(function(){return hv})),n.d(b,"point",(function(){return Pb})),n.d(b,"renderModule",(function(){return ty})),n.d(b,"resetSVGClipId",(function(){return Cv})),n.d(b,"resetSVGDefIds",(function(){return ly})),n.d(b,"sceneEqual",(function(){return cy})),n.d(b,"sceneFromJSON",(function(){return Nb})),n.d(b,"scenePickVisit",(function(){return km})),n.d(b,"sceneToJSON",(function(){return Ab})),n.d(b,"sceneVisit",(function(){return Om})),n.d(b,"sceneZOrder",(function(){return xm})),n.d(b,"serializeXML",(function(){return Ng})),n.d(b,"textMetrics",(function(){return ob})),n.d(b,"interpolate",(function(){return up})),n.d(b,"interpolateColors",(function(){return ap})),n.d(b,"interpolateRange",(function(){return rp})),n.d(b,"quantizeInterpolator",(function(){return ip})),n.d(b,"scale",(function(){return Kh})),n.d(b,"scheme",(function(){return fp})),n.d(b,"projection",(function(){return cj})),n.d(b,"View",(function(){return JI})),n.d(b,"defaultLocale",(function(){return bi})),n.d(b,"formatLocale",(function(){return si})),n.d(b,"locale",(function(){return mi})),n.d(b,"resetDefaultLocale",(function(){return gi})),n.d(b,"timeFormatLocale",(function(){return pi})),n.d(b,"expressionFunction",(function(){return qT})),n.d(b,"parse",(function(){return rz})),n.d(b,"runtimeContext",(function(){return eI})),n.d(b,"codegenExpression",(function(){return qA})),n.d(b,"parseExpression",(function(){return WA})),n.d(b,"parseSelector",(function(){return cD})),n.d(b,"version",(function(){return iz}));var g={};n.r(g),n.d(g,"invalidSpec",(function(){return LB})),n.d(g,"FIT_NON_SINGLE",(function(){return PB})),n.d(g,"containerSizeNonSingle",(function(){return BB})),n.d(g,"containerSizeNotCompatibleWithAutosize",(function(){return WB})),n.d(g,"droppingFit",(function(){return UB})),n.d(g,"cannotProjectOnChannelWithoutField",(function(){return VB})),n.d(g,"cannotProjectAggregate",(function(){return qB})),n.d(g,"nearestNotSupportForContinuous",(function(){return HB})),n.d(g,"selectionNotSupported",(function(){return GB})),n.d(g,"selectionNotFound",(function(){return KB})),n.d(g,"SCALE_BINDINGS_CONTINUOUS",(function(){return XB})),n.d(g,"LEGEND_BINDINGS_PROJECT_LENGTH",(function(){return YB})),n.d(g,"noSameUnitLookup",(function(){return $B})),n.d(g,"noSuchRepeatedValue",(function(){return JB})),n.d(g,"columnsNotSupportByRowCol",(function(){return QB})),n.d(g,"CONCAT_CANNOT_SHARE_AXIS",(function(){return ZB})),n.d(g,"unrecognizedParse",(function(){return eW})),n.d(g,"differentParse",(function(){return tW})),n.d(g,"invalidTransformIgnored",(function(){return nW})),n.d(g,"NO_FIELDS_NEEDS_AS",(function(){return rW})),n.d(g,"customFormatTypeNotAllowed",(function(){return aW})),n.d(g,"encodingOverridden",(function(){return iW})),n.d(g,"projectionOverridden",(function(){return oW})),n.d(g,"REPLACE_ANGLE_WITH_THETA",(function(){return uW})),n.d(g,"primitiveChannelDef",(function(){return cW})),n.d(g,"invalidFieldType",(function(){return sW})),n.d(g,"invalidFieldTypeForCountAggregate",(function(){return lW})),n.d(g,"invalidAggregate",(function(){return fW})),n.d(g,"missingFieldType",(function(){return dW})),n.d(g,"droppingColor",(function(){return hW})),n.d(g,"emptyFieldDef",(function(){return pW})),n.d(g,"latLongDeprecated",(function(){return vW})),n.d(g,"LINE_WITH_VARYING_SIZE",(function(){return mW})),n.d(g,"incompatibleChannel",(function(){return bW})),n.d(g,"invalidEncodingChannel",(function(){return gW})),n.d(g,"facetChannelShouldBeDiscrete",(function(){return yW})),n.d(g,"facetChannelDropped",(function(){return xW})),n.d(g,"discreteChannelCannotEncode",(function(){return OW})),n.d(g,"lineWithRange",(function(){return kW})),n.d(g,"orientOverridden",(function(){return wW})),n.d(g,"CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN",(function(){return jW})),n.d(g,"RANGE_STEP_DEPRECATED",(function(){return _W})),n.d(g,"cannotUseScalePropertyWithNonColor",(function(){return SW})),n.d(g,"unaggregateDomainHasNoEffectForRawField",(function(){return EW})),n.d(g,"unaggregateDomainWithNonSharedDomainOp",(function(){return CW})),n.d(g,"unaggregatedDomainWithLogScale",(function(){return AW})),n.d(g,"cannotApplySizeToNonOrientedMark",(function(){return NW})),n.d(g,"scaleTypeNotWorkWithChannel",(function(){return TW})),n.d(g,"scaleTypeNotWorkWithFieldDef",(function(){return IW})),n.d(g,"scalePropertyNotWorkWithScaleType",(function(){return DW})),n.d(g,"scaleTypeNotWorkWithMark",(function(){return FW})),n.d(g,"stepDropped",(function(){return MW})),n.d(g,"mergeConflictingProperty",(function(){return RW})),n.d(g,"mergeConflictingDomainProperty",(function(){return zW})),n.d(g,"independentScaleMeansIndependentGuide",(function(){return LW})),n.d(g,"domainSortDropped",(function(){return PW})),n.d(g,"MORE_THAN_ONE_SORT",(function(){return BW})),n.d(g,"FACETED_INDEPENDENT_DIFFERENT_SOURCES",(function(){return WW})),n.d(g,"FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES",(function(){return UW})),n.d(g,"FACETED_INDEPENDENT_SAME_SOURCE",(function(){return VW})),n.d(g,"INVALID_CHANNEL_FOR_AXIS",(function(){return qW})),n.d(g,"cannotStackRangedMark",(function(){return HW})),n.d(g,"cannotStackNonLinearScale",(function(){return GW})),n.d(g,"stackNonSummativeAggregate",(function(){return KW})),n.d(g,"invalidTimeUnit",(function(){return XW})),n.d(g,"droppedDay",(function(){return YW})),n.d(g,"errorBarCenterAndExtentAreNotNeeded",(function(){return $W})),n.d(g,"errorBarCenterIsUsedWithWrongExtent",(function(){return JW})),n.d(g,"errorBarContinuousAxisHasCustomizedAggregate",(function(){return QW})),n.d(g,"errorBarCenterIsNotNeeded",(function(){return ZW})),n.d(g,"errorBand1DNotSupport",(function(){return eU})),n.d(g,"channelRequiredForBinned",(function(){return tU})),n.d(g,"domainRequiredForThresholdScale",(function(){return nU}));var y={};n.r(y),n.d(y,"compile",(function(){return d0})),n.d(y,"extractTransforms",(function(){return m0})),n.d(y,"normalize",(function(){return $G})),n.d(y,"version",(function(){return b0}));var x={};n.r(x),n.d(x,"dark",(function(){return x0})),n.d(x,"excel",(function(){return k0})),n.d(x,"fivethirtyeight",(function(){return E0})),n.d(x,"ggplot2",(function(){return A0})),n.d(x,"googlecharts",(function(){return $0})),n.d(x,"latimes",(function(){return M0})),n.d(x,"quartz",(function(){return L0})),n.d(x,"urbaninstitute",(function(){return G0})),n.d(x,"version",(function(){return J0})),n.d(x,"vox",(function(){return B0}));var O=n(4),k=n.n(O),w=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=Object.prototype.hasOwnProperty;function _(e,t){return j.call(e,t)}function S(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);t=[];for(var r in e)_(e,r)&&t.push(r);return t}function E(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function C(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function A(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function N(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function T(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(T(e[t]))return!0}else if("object"===typeof e){var r=S(e),a=r.length;for(t=0;t<a;t++)if(T(e[r[t]]))return!0}return!1}function I(e,t){var n=[e];for(var r in t){var a="object"===typeof t[r]?JSON.stringify(t[r],null,2):t[r];"undefined"!==typeof a&&n.push(r+": "+a)}return n.join("\n")}var D=function(e){function t(t,n,r,a,i){var o=this.constructor,u=e.call(this,I(t,{name:n,index:r,operation:a,tree:i}))||this;return u.name=n,u.index=r,u.operation=a,u.tree=i,Object.setPrototypeOf(u,o.prototype),u.message=I(t,{name:n,index:r,operation:a,tree:i}),u}return w(t,e),t}(Error),F=D,M=E,R={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=L(n,this.path);r&&(r=E(r));var a=P(n,{op:"remove",path:this.from}).removed;return P(n,{op:"add",path:this.path,value:a}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=L(n,this.from);return P(n,{op:"add",path:this.path,value:E(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:q(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},z={add:function(e,t,n){return C(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:R.move,copy:R.copy,test:R.test,_get:R._get};function L(e,t){if(""==t)return e;var n={op:"_get",path:t};return P(e,n),n.value}function P(e,t,n,r,a,i){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===a&&(a=!0),void 0===i&&(i=0),n&&("function"==typeof n?n(t,0,e,t.path):U(t,0)),""===t.path){var o={newDocument:e};if("add"===t.op)return o.newDocument=t.value,o;if("replace"===t.op)return o.newDocument=t.value,o.removed=e,o;if("move"===t.op||"copy"===t.op)return o.newDocument=L(e,t.from),"move"===t.op&&(o.removed=e),o;if("test"===t.op){if(o.test=q(e,t.value),!1===o.test)throw new F("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o.newDocument=e,o}if("remove"===t.op)return o.removed=e,o.newDocument=null,o;if("_get"===t.op)return t.value=e,o;if(n)throw new F("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return o}r||(e=E(e));var u=(t.path||"").split("/"),c=e,s=1,l=u.length,f=void 0,d=void 0,h=void 0;for(h="function"==typeof n?n:U;;){if(d=u[s],a&&"__proto__"==d)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===c[d]?f=u.slice(0,s).join("/"):s==l-1&&(f=t.path),void 0!==f&&h(t,0,e,f)),s++,Array.isArray(c)){if("-"===d)d=c.length;else{if(n&&!C(d))throw new F("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);C(d)&&(d=~~d)}if(s>=l){if(n&&"add"===t.op&&d>c.length)throw new F("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);if(!1===(o=z[t.op].call(t,c,d,e)).test)throw new F("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o}}else if(d&&-1!=d.indexOf("~")&&(d=N(d)),s>=l){if(!1===(o=R[t.op].call(t,c,d,e)).test)throw new F("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o}c=c[d]}}function B(e,t,n,r,a){if(void 0===r&&(r=!0),void 0===a&&(a=!0),n&&!Array.isArray(t))throw new F("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=E(e));for(var i=new Array(t.length),o=0,u=t.length;o<u;o++)i[o]=P(e,t[o],n,!0,a,o),e=i[o].newDocument;return i.newDocument=e,i}function W(e,t,n){var r=P(e,t);if(!1===r.test)throw new F("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function U(e,t,n,r){if("object"!==typeof e||null===e||Array.isArray(e))throw new F("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!R[e.op])throw new F("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!==typeof e.path)throw new F("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new F('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!==typeof e.from)throw new F("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new F("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&T(e.value))throw new F("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var a=e.path.split("/").length,i=r.split("/").length;if(a!==i+1&&a!==i)throw new F("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new F("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var o=V([{op:"_get",path:e.from,value:void 0}],n);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new F("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function V(e,t,n){try{if(!Array.isArray(e))throw new F("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)B(E(t),E(e),n||!0);else{n=n||U;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(a){if(a instanceof F)return a;throw a}}function q(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,a,i=Array.isArray(e),o=Array.isArray(t);if(i&&o){if((r=e.length)!=t.length)return!1;for(n=r;0!==n--;)if(!q(e[n],t[n]))return!1;return!0}if(i!=o)return!1;var u=Object.keys(e);if((r=u.length)!==Object.keys(t).length)return!1;for(n=r;0!==n--;)if(!t.hasOwnProperty(u[n]))return!1;for(n=r;0!==n--;)if(!q(e[a=u[n]],t[a]))return!1;return!0}return e!==e&&t!==t}var H=new WeakMap,G=function(e){this.observers=new Map,this.obj=e},K=function(e,t){this.callback=e,this.observer=t};function X(e,t){t.unobserve()}function Y(e,t){var n,r=function(e){return H.get(e)}(e);if(r){var a=function(e,t){return e.observers.get(t)}(r,t);n=a&&a.observer}else r=new G(e),H.set(e,r);if(n)return n;if(n={},r.value=E(e),t){n.callback=t,n.next=null;var i=function(){$(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(i)};"undefined"!==typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=[],n.object=e,n.unobserve=function(){$(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(t,new K(t,n)),n}function $(e,t){void 0===t&&(t=!1);var n=H.get(e.object);J(n.value,e.object,e.patches,"",t),e.patches.length&&B(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function J(e,t,n,r,a){if(t!==e){"function"===typeof t.toJSON&&(t=t.toJSON());for(var i=S(t),o=S(e),u=!1,c=o.length-1;c>=0;c--){var s=e[f=o[c]];if(!_(t,f)||void 0===t[f]&&void 0!==s&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+A(f),value:E(s)}),n.push({op:"remove",path:r+"/"+A(f)}),u=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),!0);else{var l=t[f];"object"==typeof s&&null!=s&&"object"==typeof l&&null!=l?J(s,l,n,r+"/"+A(f),a):s!==l&&(!0,a&&n.push({op:"test",path:r+"/"+A(f),value:E(s)}),n.push({op:"replace",path:r+"/"+A(f),value:E(l)}))}}if(u||i.length!=o.length)for(c=0;c<i.length;c++){var f;_(e,f=i[c])||void 0===t[f]||n.push({op:"add",path:r+"/"+A(f),value:E(t[f])})}}}function Q(e,t,n){void 0===n&&(n=!1);var r=[];return J(e,t,r,"",n),r}Object.assign({},r,a,{JsonPatchError:D,deepClone:E,escapePathComponent:A,unescapePathComponent:N});var Z=n(230),ee=n.n(Z),te=n(249),ne=n(2),re=n(17),ae=/^([A-Za-z]+:)?\/\//,ie=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,oe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,ue="file://";function ce(e,t){return se.apply(this,arguments)}function se(){return(se=Object(re.a)(k.a.mark((function e(t,n){var r,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(t,n);case 2:return r=e.sent,a=r.href,e.abrupt("return",r.localFile?this.file(a):this.http(a,n));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function le(e,t){return fe.apply(this,arguments)}function fe(){return(fe=Object(re.a)(k.a.mark((function e(t,n){var r,a,i,o,u,c,s;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(ne.p)({},this.options,n),r=this.fileAccess,a={href:null},c=ie.test(t.replace(oe,"")),null!=t&&"string"===typeof t&&c||Object(ne.o)("Sanitize failure, invalid URI: "+Object(ne.bb)(t)),s=ae.test(t),(u=n.baseURL)&&!s&&(t.startsWith("/")||"/"===u[u.length-1]||(t="/"+t),t=u+t),o=(i=t.startsWith(ue))||"file"===n.mode||"http"!==n.mode&&!s&&r,i?t=t.slice(ue.length):t.startsWith("//")&&("file"===n.defaultProtocol?(t=t.slice(2),o=!0):t=(n.defaultProtocol||"http")+":"+t),Object.defineProperty(a,"localFile",{value:!!o}),a.href=t,n.target&&(a.target=n.target+""),n.rel&&(a.rel=n.rel+""),"image"===n.context&&n.crossOrigin&&(a.crossOrigin=n.crossOrigin+""),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function de(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){e?r(e):n(t)}))}))}:he}function he(){return pe.apply(this,arguments)}function pe(){return(pe=Object(re.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(ne.o)("No file system access.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e){return e?function(){var t=Object(re.a)(k.a.mark((function t(n,r){var a,i,o;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object(ne.p)({},this.options.http,r),i=r&&r.response,t.next=4,e(n,a);case 4:return o=t.sent,t.abrupt("return",o.ok?Object(ne.E)(o[i])?o[i]():o.text():Object(ne.o)(o.status+""+o.statusText));case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}():me}function me(){return be.apply(this,arguments)}function be(){return(be=Object(re.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(ne.o)("No HTTP fetch method available.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge=function(e){return!Number.isNaN(+e)&&!(e instanceof Date)},ye={boolean:ne.cb,integer:ne.eb,number:ne.eb,date:ne.db,string:ne.gb,unknown:ne.y},xe=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return ge(e)&&Number.isInteger(+e)},ge,function(e){return!Number.isNaN(Date.parse(e))}],Oe=["boolean","integer","number","date"];function ke(e,t){if(!e||!e.length)return"unknown";for(var n,r,a,i=e.length,o=xe.length,u=xe.map((function(e,t){return t+1})),c=0,s=0;c<i;++c)for(r=t?e[c][t]:e[c],n=0;n<o;++n)if(u[n]&&(null!=(a=r)&&a===a)&&!xe[n](r)&&(u[n]=0,++s===xe.length))return"string";return Oe[u.reduce((function(e,t){return 0===e?t:e}),0)-1]}function we(e,t){return t.reduce((function(t,n){return t[n]=ke(e,n),t}),{})}var je={},_e={};function Se(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Ee(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Ce(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Ae(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),a=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Ce(-t,6):t>9999?"+"+Ce(t,6):Ce(t,4))+"-"+Ce(e.getUTCMonth()+1,2)+"-"+Ce(e.getUTCDate(),2)+(i?"T"+Ce(n,2)+":"+Ce(r,2)+":"+Ce(a,2)+"."+Ce(i,3)+"Z":a?"T"+Ce(n,2)+":"+Ce(r,2)+":"+Ce(a,2)+"Z":r||n?"T"+Ce(n,2)+":"+Ce(r,2)+"Z":"")}var Ne=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],i=e.length,o=0,u=0,c=i<=0,s=!1;function l(){if(c)return _e;if(s)return s=!1,je;var t,r,a=o;if(34===e.charCodeAt(a)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?c=!0:10===(r=e.charCodeAt(o++))?s=!0:13===r&&(s=!0,10===e.charCodeAt(o)&&++o),e.slice(a+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))s=!0;else if(13===r)s=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(a,t)}return c=!0,e.slice(a,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=l())!==_e;){for(var f=[];r!==je&&r!==_e;)f.push(r),r=l();t&&null==(f=t(f,u++))||a.push(f)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?Ae(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,i=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=Se(e);return function(r,a){return t(n(r),a,e)}}(e,t):Se(e)}));return i.columns=a||[],i},parseRows:r,format:function(t,n){return null==n&&(n=Ee(t)),[n.map(o).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Ee(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}};function Te(e){var t=function(t,n){var r={delimiter:e};return Ie(t,n?Object(ne.p)(n,r):r)};return t.responseType="text",t}function Ie(e,t){return t.header&&(e=t.header.map(ne.bb).join(t.delimiter)+"\n"+e),Ne(t.delimiter).parse(e+"")}Ie.responseType="text";var De=n(226),Fe=function(e){return e},Me=function(e){if(null==e)return Fe;var t,n,r=e.scale[0],a=e.scale[1],i=e.translate[0],o=e.translate[1];return function(e,u){u||(t=n=0);var c=2,s=e.length,l=new Array(s);for(l[0]=(t+=e[0])*r+i,l[1]=(n+=e[1])*a+o;c<s;)l[c]=e[c],++c;return l}},Re=function(e,t){return"string"===typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return ze(e,t)}))}:ze(e,t)};function ze(e,t){var n=t.id,r=t.bbox,a=null==t.properties?{}:t.properties,i=Le(e,t);return null==n&&null==r?{type:"Feature",properties:a,geometry:i}:null==r?{type:"Feature",id:n,properties:a,geometry:i}:{type:"Feature",id:n,bbox:r,properties:a,geometry:i}}function Le(e,t){var n=Me(e.transform),r=e.arcs;function a(e,t){t.length&&t.pop();for(var a=r[e<0?~e:e],i=0,o=a.length;i<o;++i)t.push(n(a[i],i));e<0&&function(e,t){for(var n,r=e.length,a=r-t;a<--r;)n=e[a],e[a++]=e[r],e[r]=n}(t,o)}function i(e){return n(e)}function o(e){for(var t=[],n=0,r=e.length;n<r;++n)a(e[n],t);return t.length<2&&t.push(t[0]),t}function u(e){for(var t=o(e);t.length<4;)t.push(t[0]);return t}function c(e){return e.map(u)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=i(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(i);break;case"LineString":n=o(t.arcs);break;case"MultiLineString":n=t.arcs.map(o);break;case"Polygon":n=c(t.arcs);break;case"MultiPolygon":n=t.arcs.map(c);break;default:return null}return{type:r,coordinates:n}}(t)}var Pe=function(e,t){var n={},r={},a={},i=[],o=-1;function u(e,t){for(var r in e){var a=e[r];delete t[a.start],delete a.start,delete a.end,a.forEach((function(e){n[e<0?~e:e]=1})),i.push(a)}}return t.forEach((function(n,r){var a,i=e.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(a=t[++o],t[o]=n,t[r]=a)})),t.forEach((function(t){var n,i,o=function(t){var n,r=e.arcs[t<0?~t:t],a=r[0];e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1];return t<0?[n,a]:[a,n]}(t),u=o[0],c=o[1];if(n=a[u])if(delete a[n.end],n.push(t),n.end=c,i=r[c]){delete r[i.start];var s=i===n?n:n.concat(i);r[s.start=n.start]=a[s.end=i.end]=s}else r[n.start]=a[n.end]=n;else if(n=r[c])if(delete r[n.start],n.unshift(t),n.start=u,i=a[u]){delete a[i.end];var l=i===n?n:i.concat(n);r[l.start=i.start]=a[l.end=n.end]=l}else r[n.start]=a[n.end]=n;else r[(n=[t]).start=u]=a[n.end=c]=n})),u(a,r),u(r,a),t.forEach((function(e){n[e<0?~e:e]||i.push([e])})),i},Be=function(e){return Le(e,We.apply(this,arguments))};function We(e,t,n){var r,a,i;if(arguments.length>1)r=Ue(e,t,n);else for(a=0,r=new Array(i=e.arcs.length);a<i;++a)r[a]=a;return{type:"MultiLineString",arcs:Pe(e,r)}}function Ue(e,t,n){var r,a=[],i=[];function o(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:r})}function u(e){e.forEach(o)}function c(e){e.forEach(u)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":u(t.arcs);break;case"MultiLineString":case"Polygon":c(t.arcs);break;case"MultiPolygon":!function(e){e.forEach(c)}(t.arcs)}}(t),i.forEach(null==n?function(e){a.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&a.push(e[0].i)}),a}var Ve={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function qe(e,t){var n,r,a,i;return e=Object(De.a)(e,t),t&&t.feature?(n=Re,a=t.feature):t&&t.mesh?(n=Be,a=t.mesh,i=Ve[t.filter]):Object(ne.o)("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[a])?n(e,r,i):Object(ne.o)("Invalid TopoJSON object: "+a))&&r.features||[r]}qe.responseType="json";var He={dsv:Ie,csv:Te(","),tsv:Te("\t"),json:De.a,topojson:qe};function Ge(e,t){return arguments.length>1?(He[e]=t,this):Object(ne.w)(He,e)?He[e]:null}function Ke(e){var t=Ge(e);return t&&t.responseType||"text"}var Xe=Math.sqrt(50),Ye=Math.sqrt(10),$e=Math.sqrt(2),Je=function(e,t,n){var r,a,i,o,u=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),0===(o=Qe(e,t,n))||!isFinite(o))return[];if(o>0){var c=Math.round(e/o),s=Math.round(t/o);for(c*o<e&&++c,s*o>t&&--s,i=new Array(a=s-c+1);++u<a;)i[u]=(c+u)*o}else{o=-o;var l=Math.round(e*o),f=Math.round(t*o);for(l/o<e&&++l,f/o>t&&--f,i=new Array(a=f-l+1);++u<a;)i[u]=(l+u)/o}return r&&i.reverse(),i};function Qe(e,t,n){var r=(t-e)/Math.max(0,n),a=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,a);return a>=0?(i>=Xe?10:i>=Ye?5:i>=$e?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=Xe?10:i>=Ye?5:i>=$e?2:1)}function Ze(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=Xe?a*=10:i>=Ye?a*=5:i>=$e&&(a*=2),t<e?-a:a}var et=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tt(e){if(!(t=et.exec(e)))throw new Error("invalid format: "+e);var t;return new nt({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function nt(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}tt.prototype=nt.prototype,nt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};function rt(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}var at,it,ot,ut,ct=function(e){return(e=rt(Math.abs(e)))?e[1]:NaN},st=function(e,t){var n=rt(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")},lt={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return st(100*e,t)},r:st,s:function(e,t){var n=rt(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(at=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+rt(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},ft=function(e){return e},dt=Array.prototype.map,ht=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],pt=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?ft:(t=dt.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,u=t[0],c=0;a>0&&u>0&&(c+u+1>r&&(u=Math.max(1,r-c)),i.push(e.substring(a-=u,a+u)),!((c+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?ft:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(dt.call(e.numerals,String)),c=void 0===e.percent?"%":e.percent+"",s=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=tt(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,m=e.precision,b=e.trim,g=e.type;"n"===g?(v=!0,g="g"):lt[g]||(void 0===m&&(m=12),b=!0,g="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var y="$"===d?a:"#"===d&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",x="$"===d?i:/[%p]/.test(g)?c:"",O=lt[g],k=/[defgprs%]/.test(g);function w(e){var a,i,c,d=y,w=x;if("c"===g)w=O(e)+w,e="";else{var j=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:O(Math.abs(e),m),b&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),j&&0===+e&&"+"!==f&&(j=!1),d=(j?"("===f?f:s:"-"===f||"("===f?"":f)+d,w=("s"===g?ht[8+at/3]:"")+w+(j&&"("===f?")":""),k)for(a=-1,i=e.length;++a<i;)if(48>(c=e.charCodeAt(a))||c>57){w=(46===c?o+e.slice(a+1):e.slice(a))+w,e=e.slice(0,a);break}}v&&!h&&(e=r(e,1/0));var _=d.length+e.length+w.length,S=_<p?new Array(p-_+1).join(t):"";switch(v&&h&&(e=r(S+e,S.length?p-w.length:1/0),S=""),n){case"<":e=d+e+w+S;break;case"=":e=d+S+e+w;break;case"^":e=S.slice(0,_=S.length>>1)+d+e+w+S.slice(_);break;default:e=S+d+e+w}return u(e)}return m=void 0===m?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),w.toString=function(){return e+""},w}return{format:f,formatPrefix:function(e,t){var n=f(((e=tt(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(ct(t)/3))),a=Math.pow(10,-r),i=ht[8+r/3];return function(e){return n(a*e)+i}}}};it=pt({thousands:",",grouping:[3],currency:["$",""]}),ot=it.format,ut=it.formatPrefix;var vt=n(21),mt=new Date,bt=new Date;function gt(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return gt((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return mt.setTime(+t),bt.setTime(+r),e(mt),e(bt),Math.floor(n(mt,bt))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var yt=1e3,xt=6e4,Ot=36e5,kt=864e5,wt=6048e5,jt=2592e6,_t=31536e6,St=gt((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*xt)/kt}),(function(e){return e.getDate()-1})),Et=St;St.range;function Ct(e){return gt((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*xt)/wt}))}var At=Ct(0),Nt=Ct(1),Tt=Ct(2),It=Ct(3),Dt=Ct(4),Ft=Ct(5),Mt=Ct(6),Rt=(At.range,Nt.range,Tt.range,It.range,Dt.range,Ft.range,Mt.range,gt((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/kt}),(function(e){return e.getUTCDate()-1}))),zt=Rt;Rt.range;function Lt(e){return gt((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/wt}))}var Pt=Lt(0),Bt=Lt(1),Wt=Lt(2),Ut=Lt(3),Vt=Lt(4),qt=Lt(5),Ht=Lt(6),Gt=(Pt.range,Bt.range,Wt.range,Ut.range,Vt.range,qt.range,Ht.range,gt((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));Gt.every=function(e){return isFinite(e=Math.floor(e))&&e>0?gt((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var Kt=Gt,Xt=(Gt.range,gt((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),Yt=Xt,$t=(Xt.range,gt((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*yt-e.getMinutes()*xt)}),(function(e,t){e.setTime(+e+t*Ot)}),(function(e,t){return(t-e)/Ot}),(function(e){return e.getHours()}))),Jt=$t,Qt=($t.range,gt((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*yt)}),(function(e,t){e.setTime(+e+t*xt)}),(function(e,t){return(t-e)/xt}),(function(e){return e.getMinutes()}))),Zt=Qt,en=(Qt.range,gt((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*yt)}),(function(e,t){return(t-e)/yt}),(function(e){return e.getUTCSeconds()}))),tn=en,nn=(en.range,gt((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e})));nn.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?gt((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):nn:null};var rn=nn,an=(nn.range,gt((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));an.every=function(e){return isFinite(e=Math.floor(e))&&e>0?gt((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var on,un,cn,sn,ln,fn,dn,hn=an,pn=(an.range,gt((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),vn=pn,mn=(pn.range,gt((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Ot)}),(function(e,t){return(t-e)/Ot}),(function(e){return e.getUTCHours()}))),bn=mn,gn=(mn.range,gt((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*xt)}),(function(e,t){return(t-e)/xt}),(function(e){return e.getUTCMinutes()}))),yn=gn,xn=(gn.range,function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}),On=function(e){var t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return xn(e(t),n)}}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);var o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}};var kn="year",wn="quarter",jn="month",_n="week",Sn="date",En="day",Cn="dayofyear",An="hours",Nn="minutes",Tn="seconds",In="milliseconds",Dn=[kn,wn,jn,_n,Sn,En,Cn,An,Nn,Tn,In],Fn=Dn.reduce((function(e,t,n){return e[t]=1+n,e}),{});function Mn(e){var t=Object(ne.i)(e).slice(),n={};return t.length||Object(ne.o)("Missing time unit."),t.forEach((function(e){Object(ne.w)(Fn,e)?n[e]=1:Object(ne.o)("Invalid time unit: ".concat(e,"."))})),(n[_n]||n[En]?1:0)+(n[wn]||n[jn]||n[Sn]?1:0)+(n[Cn]?1:0)>1&&Object(ne.o)("Incompatible time units: ".concat(e)),t.sort((function(e,t){return Fn[e]-Fn[t]})),t}var Rn=(on={},Object(vt.a)(on,kn,"%Y "),Object(vt.a)(on,wn,"Q%q "),Object(vt.a)(on,jn,"%b "),Object(vt.a)(on,Sn,"%d "),Object(vt.a)(on,_n,"W%U "),Object(vt.a)(on,En,"%a "),Object(vt.a)(on,Cn,"%j "),Object(vt.a)(on,An,"%H:00"),Object(vt.a)(on,Nn,"00:%M"),Object(vt.a)(on,Tn,":%S"),Object(vt.a)(on,In,".%L"),Object(vt.a)(on,"".concat(kn,"-").concat(jn),"%Y-%m "),Object(vt.a)(on,"".concat(kn,"-").concat(jn,"-").concat(Sn),"%Y-%m-%d "),Object(vt.a)(on,"".concat(An,"-").concat(Nn),"%H:%M"),on);function zn(e,t){var n,r,a=Object(ne.p)({},Rn,t),i=Mn(e),o=i.length,u="",c=0;for(c=0;c<o;)for(n=i.length;n>c;--n)if(null!=a[r=i.slice(c,n).join("-")]){u+=a[r],c=n;break}return u.trim()}var Ln=new Date;function Pn(e){return Ln.setFullYear(e),Ln.setMonth(0),Ln.setDate(1),Ln.setHours(0,0,0,0),Ln}function Bn(e){return Un(new Date(e))}function Wn(e){return Vn(new Date(e))}function Un(e){return Et.count(Pn(e.getFullYear())-1,e)}function Vn(e){return At.count(Pn(e.getFullYear())-1,e)}function qn(e){return Pn(e).getDay()}function Hn(e,t,n,r,a,i,o){if(0<=e&&e<100){var u=new Date(-1,t,n,r,a,i,o);return u.setFullYear(e),u}return new Date(e,t,n,r,a,i,o)}function Gn(e){return Xn(new Date(e))}function Kn(e){return Yn(new Date(e))}function Xn(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return zt.count(t-1,e)}function Yn(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return Pt.count(t-1,e)}function $n(e){return Ln.setTime(Date.UTC(e,0,1)),Ln.getUTCDay()}function Jn(e,t,n,r,a,i,o){if(0<=e&&e<100){var u=new Date(Date.UTC(-1,t,n,r,a,i,o));return u.setUTCFullYear(n.y),u}return new Date(Date.UTC(e,t,n,r,a,i,o))}function Qn(e,t,n,r,a){var i=t||1,o=Object(ne.W)(e),u=function(e,t,a){return function(e,t,n,r){var a=n<=1?e:r?function(t,a){return r+n*Math.floor((e(t,a)-r)/n)}:function(t,r){return n*Math.floor(e(t,r)/n)};return t?function(e,n){return t(a(e,n),n)}:a}(n[a=a||e],r[a],e===o&&i,t)},c=new Date,s=Object(ne.fb)(e),l=s[kn]?u(kn):Object(ne.m)(2012),f=s[jn]?u(jn):s[wn]?u(wn):ne.mb,d=s[_n]&&s[En]?u(En,1,_n+En):s[_n]?u(_n,1):s[En]?u(En,1):s[Sn]?u(Sn,1):s[Cn]?u(Cn,1):ne.Q,h=s[An]?u(An):ne.mb,p=s[Nn]?u(Nn):ne.mb,v=s[Tn]?u(Tn):ne.mb,m=s[In]?u(In):ne.mb;return function(e){c.setTime(+e);var t=l(c);return a(t,f(c),d(c,t),h(c),p(c),v(c),m(c))}}function Zn(e,t,n){return t+7*e-(n+6)%7}var er=(un={},Object(vt.a)(un,kn,(function(e){return e.getFullYear()})),Object(vt.a)(un,wn,(function(e){return Math.floor(e.getMonth()/3)})),Object(vt.a)(un,jn,(function(e){return e.getMonth()})),Object(vt.a)(un,Sn,(function(e){return e.getDate()})),Object(vt.a)(un,An,(function(e){return e.getHours()})),Object(vt.a)(un,Nn,(function(e){return e.getMinutes()})),Object(vt.a)(un,Tn,(function(e){return e.getSeconds()})),Object(vt.a)(un,In,(function(e){return e.getMilliseconds()})),Object(vt.a)(un,Cn,(function(e){return Un(e)})),Object(vt.a)(un,_n,(function(e){return Vn(e)})),Object(vt.a)(un,_n+En,(function(e,t){return Zn(Vn(e),e.getDay(),qn(t))})),Object(vt.a)(un,En,(function(e,t){return Zn(1,e.getDay(),qn(t))})),un),tr=(cn={},Object(vt.a)(cn,wn,(function(e){return 3*e})),Object(vt.a)(cn,_n,(function(e,t){return Zn(e,0,qn(t))})),cn);function nr(e,t){return Qn(e,t||1,er,tr,Hn)}var rr=(sn={},Object(vt.a)(sn,kn,(function(e){return e.getUTCFullYear()})),Object(vt.a)(sn,wn,(function(e){return Math.floor(e.getUTCMonth()/3)})),Object(vt.a)(sn,jn,(function(e){return e.getUTCMonth()})),Object(vt.a)(sn,Sn,(function(e){return e.getUTCDate()})),Object(vt.a)(sn,An,(function(e){return e.getUTCHours()})),Object(vt.a)(sn,Nn,(function(e){return e.getUTCMinutes()})),Object(vt.a)(sn,Tn,(function(e){return e.getUTCSeconds()})),Object(vt.a)(sn,In,(function(e){return e.getUTCMilliseconds()})),Object(vt.a)(sn,Cn,(function(e){return Xn(e)})),Object(vt.a)(sn,_n,(function(e){return Yn(e)})),Object(vt.a)(sn,En,(function(e,t){return Zn(1,e.getUTCDay(),$n(t))})),Object(vt.a)(sn,_n+En,(function(e,t){return Zn(Yn(e),e.getUTCDay(),$n(t))})),sn),ar=(ln={},Object(vt.a)(ln,wn,(function(e){return 3*e})),Object(vt.a)(ln,_n,(function(e,t){return Zn(e,0,$n(t))})),ln);function ir(e,t){return Qn(e,t||1,rr,ar,Jn)}var or=(fn={},Object(vt.a)(fn,kn,Kt),Object(vt.a)(fn,wn,Yt.every(3)),Object(vt.a)(fn,jn,Yt),Object(vt.a)(fn,_n,At),Object(vt.a)(fn,Sn,Et),Object(vt.a)(fn,En,Et),Object(vt.a)(fn,Cn,Et),Object(vt.a)(fn,An,Jt),Object(vt.a)(fn,Nn,Zt),Object(vt.a)(fn,Tn,tn),Object(vt.a)(fn,In,rn),fn),ur=(dn={},Object(vt.a)(dn,kn,hn),Object(vt.a)(dn,wn,vn.every(3)),Object(vt.a)(dn,jn,vn),Object(vt.a)(dn,_n,Pt),Object(vt.a)(dn,Sn,zt),Object(vt.a)(dn,En,zt),Object(vt.a)(dn,Cn,zt),Object(vt.a)(dn,An,bn),Object(vt.a)(dn,Nn,yn),Object(vt.a)(dn,Tn,tn),Object(vt.a)(dn,In,rn),dn);function cr(e){return or[e]}function sr(e){return ur[e]}function lr(e,t,n){return e?e.offset(t,n):void 0}function fr(e,t,n){return lr(cr(e),t,n)}function dr(e,t,n){return lr(sr(e),t,n)}function hr(e,t,n,r){return e?e.range(t,n,r):void 0}function pr(e,t,n,r){return hr(cr(e),t,n,r)}function vr(e,t,n,r){return hr(sr(e),t,n,r)}var mr=1e3,br=6e4,gr=36e5,yr=864e5,xr=2592e6,Or=31536e6,kr=[kn,jn,Sn,An,Nn,Tn,In],wr=kr.slice(0,-1),jr=wr.slice(0,-1),_r=jr.slice(0,-1),Sr=_r.slice(0,-1),Er=[kn,jn],Cr=[kn],Ar=[[wr,1,mr],[wr,5,5e3],[wr,15,15e3],[wr,30,3e4],[jr,1,br],[jr,5,3e5],[jr,15,9e5],[jr,30,18e5],[_r,1,gr],[_r,3,108e5],[_r,6,216e5],[_r,12,432e5],[Sr,1,yr],[[kn,_n],1,6048e5],[Er,1,xr],[Er,3,7776e6],[Cr,1,Or]];function Nr(e){var t,n,r=e.extent,a=e.maxbins||40,i=Math.abs(Object(ne.Z)(r))/a,o=On((function(e){return e[2]})).right(Ar,i);return o===Ar.length?(t=Cr,n=Ze(r[0]/Or,r[1]/Or,a)):o?(t=(o=Ar[i/Ar[o-1][2]<Ar[o][2]/i?o-1:o])[0],n=o[1]):(t=kr,n=Math.max(Ze(r[0],r[1],a),1)),{units:t,step:n}}function Tr(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ir(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Dr(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Fr(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,c=e.shortMonths,s=Xr(a),l=Yr(a),f=Xr(i),d=Yr(i),h=Xr(o),p=Yr(o),v=Xr(u),m=Yr(u),b=Xr(c),g=Yr(c),y={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return c[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:ma,e:ma,f:Oa,g:Ia,G:Fa,H:ba,I:ga,j:ya,L:xa,m:ka,M:wa,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ri,s:ai,S:ja,u:_a,U:Sa,V:Ca,w:Aa,W:Na,x:null,X:null,y:Ta,Y:Da,Z:Ma,"%":ni},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return c[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:Ra,e:Ra,f:Wa,g:Qa,G:ei,H:za,I:La,j:Pa,L:Ba,m:Ua,M:Va,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ri,s:ai,S:qa,u:Ha,U:Ga,V:Xa,w:Ya,W:$a,x:null,X:null,y:Ja,Y:Za,Z:ti,"%":ni},O={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=b.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return j(e,t,n,r)},d:oa,e:oa,f:da,g:na,G:ta,H:ca,I:ca,j:ua,L:fa,m:ia,M:sa,p:function(e,t,n){var r=s.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:aa,Q:pa,s:va,S:la,u:Jr,U:Qr,V:Zr,w:$r,W:ea,x:function(e,t,r){return j(e,n,t,r)},X:function(e,t,n){return j(e,r,t,n)},y:na,Y:ta,Z:ra,"%":ha};function k(e,t){return function(n){var r,a,i,o=[],u=-1,c=0,s=e.length;for(n instanceof Date||(n=new Date(+n));++u<s;)37===e.charCodeAt(u)&&(o.push(e.slice(c,u)),null!=(a=Ur[r=e.charAt(++u)])?r=e.charAt(++u):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),c=u+1);return o.push(e.slice(c,u)),o.join("")}}function w(e,t){return function(n){var r,a,i=Dr(1900,void 0,1);if(j(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=Ir(Dr(i.y,0,1))).getUTCDay(),r=a>4||0===a?Bt.ceil(r):Bt(r),r=zt.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=Tr(Dr(i.y,0,1))).getDay(),r=a>4||0===a?Nt.ceil(r):Nt(r),r=Et.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?Ir(Dr(i.y,0,1)).getUTCDay():Tr(Dr(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Ir(i)):Tr(i)}}function j(e,t,n,r){for(var a,i,o=0,u=t.length,c=n.length;o<u;){if(r>=c)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=O[a in Ur?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return y.x=k(n,y),y.X=k(r,y),y.c=k(t,y),x.x=k(n,x),x.X=k(r,x),x.c=k(t,x),{format:function(e){var t=k(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=w(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=w(e+="",!0);return t.toString=function(){return e},t}}}var Mr,Rr,zr,Lr,Pr,Br,Wr,Ur={"-":"",_:" ",0:"0"},Vr=/^\s*\d+/,qr=/^%/,Hr=/[\\^$*+?|[\]().{}]/g;function Gr(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function Kr(e){return e.replace(Hr,"\\$&")}function Xr(e){return new RegExp("^(?:"+e.map(Kr).join("|")+")","i")}function Yr(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function $r(e,t,n){var r=Vr.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Jr(e,t,n){var r=Vr.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Qr(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Zr(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function ea(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function ta(e,t,n){var r=Vr.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function na(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ra(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function aa(e,t,n){var r=Vr.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function ia(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function oa(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function ua(e,t,n){var r=Vr.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function ca(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function sa(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function la(e,t,n){var r=Vr.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function fa(e,t,n){var r=Vr.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function da(e,t,n){var r=Vr.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function ha(e,t,n){var r=qr.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function pa(e,t,n){var r=Vr.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function va(e,t,n){var r=Vr.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function ma(e,t){return Gr(e.getDate(),t,2)}function ba(e,t){return Gr(e.getHours(),t,2)}function ga(e,t){return Gr(e.getHours()%12||12,t,2)}function ya(e,t){return Gr(1+Et.count(Kt(e),e),t,3)}function xa(e,t){return Gr(e.getMilliseconds(),t,3)}function Oa(e,t){return xa(e,t)+"000"}function ka(e,t){return Gr(e.getMonth()+1,t,2)}function wa(e,t){return Gr(e.getMinutes(),t,2)}function ja(e,t){return Gr(e.getSeconds(),t,2)}function _a(e){var t=e.getDay();return 0===t?7:t}function Sa(e,t){return Gr(At.count(Kt(e)-1,e),t,2)}function Ea(e){var t=e.getDay();return t>=4||0===t?Dt(e):Dt.ceil(e)}function Ca(e,t){return e=Ea(e),Gr(Dt.count(Kt(e),e)+(4===Kt(e).getDay()),t,2)}function Aa(e){return e.getDay()}function Na(e,t){return Gr(Nt.count(Kt(e)-1,e),t,2)}function Ta(e,t){return Gr(e.getFullYear()%100,t,2)}function Ia(e,t){return Gr((e=Ea(e)).getFullYear()%100,t,2)}function Da(e,t){return Gr(e.getFullYear()%1e4,t,4)}function Fa(e,t){var n=e.getDay();return Gr((e=n>=4||0===n?Dt(e):Dt.ceil(e)).getFullYear()%1e4,t,4)}function Ma(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Gr(t/60|0,"0",2)+Gr(t%60,"0",2)}function Ra(e,t){return Gr(e.getUTCDate(),t,2)}function za(e,t){return Gr(e.getUTCHours(),t,2)}function La(e,t){return Gr(e.getUTCHours()%12||12,t,2)}function Pa(e,t){return Gr(1+zt.count(hn(e),e),t,3)}function Ba(e,t){return Gr(e.getUTCMilliseconds(),t,3)}function Wa(e,t){return Ba(e,t)+"000"}function Ua(e,t){return Gr(e.getUTCMonth()+1,t,2)}function Va(e,t){return Gr(e.getUTCMinutes(),t,2)}function qa(e,t){return Gr(e.getUTCSeconds(),t,2)}function Ha(e){var t=e.getUTCDay();return 0===t?7:t}function Ga(e,t){return Gr(Pt.count(hn(e)-1,e),t,2)}function Ka(e){var t=e.getUTCDay();return t>=4||0===t?Vt(e):Vt.ceil(e)}function Xa(e,t){return e=Ka(e),Gr(Vt.count(hn(e),e)+(4===hn(e).getUTCDay()),t,2)}function Ya(e){return e.getUTCDay()}function $a(e,t){return Gr(Bt.count(hn(e)-1,e),t,2)}function Ja(e,t){return Gr(e.getUTCFullYear()%100,t,2)}function Qa(e,t){return Gr((e=Ka(e)).getUTCFullYear()%100,t,2)}function Za(e,t){return Gr(e.getUTCFullYear()%1e4,t,4)}function ei(e,t){var n=e.getUTCDay();return Gr((e=n>=4||0===n?Vt(e):Vt.ceil(e)).getUTCFullYear()%1e4,t,4)}function ti(){return"+0000"}function ni(){return"%"}function ri(e){return+e}function ai(e){return Math.floor(+e/1e3)}function ii(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function oi(e){var t=ii(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n=tt(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return function(n){var r=e(n),a=r.indexOf(t);if(a<0)return r;for(var i=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(r,a),o=i<r.length?r.slice(i):"";--i>a;)if("0"!==r[i]){++i;break}return r.slice(0,i)+o}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan:function(e,r,a,i){i=tt(null==i?",f":i);var o,u=Ze(e,r,a),c=Math.max(Math.abs(e),Math.abs(r));if(null==i.precision)switch(i.type){case"s":return isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ct(t)/3)))-ct(Math.abs(e)))}(u,c))||(i.precision=o),n(i,c);case"":case"e":case"g":case"p":case"r":isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ct(t)-ct(e))+1}(u,c))||(i.precision=o-("e"===i.type));break;case"f":case"%":isNaN(o=function(e){return Math.max(0,-ct(Math.abs(e)))}(u))||(i.precision=o-2*("%"===i.type))}return t(i)}}}function ui(){return Br=oi({format:ot,formatPrefix:ut})}function ci(e){return oi(pt(e))}function si(e){return arguments.length?Br=ci(e):Br}function li(e,t,n){n=n||{},Object(ne.H)(n)||Object(ne.o)("Invalid time multi-format specifier: ".concat(n));var r=t(Tn),a=t(Nn),i=t(An),o=t(Sn),u=t(_n),c=t(jn),s=t(wn),l=t(kn),f=e(n[In]||".%L"),d=e(n[Tn]||":%S"),h=e(n[Nn]||"%I:%M"),p=e(n[An]||"%I %p"),v=e(n[Sn]||n[En]||"%a %d"),m=e(n[_n]||"%b %d"),b=e(n[jn]||"%B"),g=e(n[wn]||"%B"),y=e(n[kn]||"%Y");return function(e){return(r(e)<e?f:a(e)<e?d:i(e)<e?h:o(e)<e?p:c(e)<e?u(e)<e?v:m:l(e)<e?s(e)<e?b:g:y)(e)}}function fi(e){var t=ii(e.format),n=ii(e.utcFormat);return{timeFormat:function(e){return Object(ne.J)(e)?t(e):li(t,cr,e)},utcFormat:function(e){return Object(ne.J)(e)?n(e):li(n,sr,e)},timeParse:ii(e.parse),utcParse:ii(e.utcParse)}}function di(){return Wr=fi({format:Rr,parse:zr,utcFormat:Lr,utcParse:Pr})}function hi(e){return fi(Fr(e))}function pi(e){return arguments.length?Wr=hi(e):Wr}!function(e){Mr=Fr(e),Rr=Mr.format,zr=Mr.parse,Lr=Mr.utcFormat,Pr=Mr.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),ui(),di();var vi=function(e,t){return Object(ne.p)({},e,t)};function mi(e,t){var n=e?ci(e):si(),r=t?hi(t):pi();return vi(n,r)}function bi(e,t){var n=arguments.length;return n&&2!==n&&Object(ne.o)("defaultLocale expects either zero or two arguments."),n?vi(si(e),pi(t)):vi(si(),pi())}function gi(){return ui(),di(),bi()}var yi=function(e,t,n,r){var a=Ge((t=t||{}).type||"json");return a||Object(ne.o)("Unknown data format type: "+t.type),e=a(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;var a=pi();n=n||a.timeParse,r=r||a.utcParse;var i,o,u,c,s,l,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=we(e,f));var d=(f=Object.keys(t)).map((function(e){var a,i,o=t[e];if(o&&(o.startsWith("date:")||o.startsWith("utc:")))return("'"===(i=(a=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),("utc"===a[0]?r:n)(i);if(!ye[o])throw Error("Illegal format pattern: "+e+":"+o);return ye[o]}));for(u=0,s=e.length,l=f.length;u<s;++u)for(i=e[u],c=0;c<l;++c)i[o=f[c]]=d[c](i[o])}(e,t.parse,n,r),Object(ne.w)(e,"columns")&&delete e.columns,e};var xi=function(e,t){return function(n){return{options:n||{},sanitize:le,load:ce,fileAccess:!!t,file:de(t),http:ve(e)}}}("undefined"!==typeof fetch&&fetch,null);function Oi(e){var t=e||ne.y,n=[],r={};return n.add=function(e){var a=t(e);return r[a]||(r[a]=1,n.push(e)),n},n.remove=function(e){var a=t(e);if(r[a]){r[a]=0;var i=n.indexOf(e);i>=0&&n.splice(i,1)}return n},n}function ki(e,t){return wi.apply(this,arguments)}function wi(){return(wi=Object(re.a)(k.a.mark((function e(t,n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}var ji=Symbol("vega_id"),_i=1;function Si(e){return!(!e||!Ei(e))}function Ei(e){return e[ji]}function Ci(e,t){return e[ji]=t,e}function Ai(e){var t=e===Object(e)?e:{data:e};return Ei(t)?t:Ci(t,_i++)}function Ni(e){return Ti(e,Ai({}))}function Ti(e,t){for(var n in e)t[n]=e[n];return t}function Ii(e,t){return Ci(t,Ei(e))}function Di(e,t){return e?t?function(n,r){return e(n,r)||Ei(t(n))-Ei(t(r))}:function(t,n){return e(t,n)||Ei(t)-Ei(n)}:null}function Fi(e){return e&&e.constructor===Mi}function Mi(){var e=[],t=[],n=[],r=[],a=[],i=null,o=!1;return{constructor:Mi,insert:function(t){for(var n=Object(ne.i)(t),r=n.length,a=0;a<r;++a)e.push(n[a]);return this},remove:function(e){for(var n=Object(ne.E)(e)?r:t,a=Object(ne.i)(e),i=a.length,o=0;o<i;++o)n.push(a[o]);return this},modify:function(e,t,r){var i={field:t,value:Object(ne.m)(r)};return Object(ne.E)(e)?(i.filter=e,a.push(i)):(i.tuple=e,n.push(i)),this},encode:function(e,t){return Object(ne.E)(e)?a.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean:function(e){return i=e,this},reflow:function(){return o=!0,this},pulse:function(u,c){var s,l,f,d,h,p,v={},m={};for(s=0,l=c.length;s<l;++s)v[Ei(c[s])]=1;for(s=0,l=t.length;s<l;++s)v[Ei(h=t[s])]=-1;for(s=0,l=r.length;s<l;++s)d=r[s],c.forEach((function(e){d(e)&&(v[Ei(e)]=-1)}));for(s=0,l=e.length;s<l;++s)p=Ei(h=e[s]),v[p]?v[p]=1:u.add.push(Ai(e[s]));for(s=0,l=c.length;s<l;++s)h=c[s],v[Ei(h)]<0&&u.rem.push(h);function b(e,t,n){n?e[t]=n(e):u.encode=t,o||(m[Ei(e)]=e)}for(s=0,l=n.length;s<l;++s)h=(f=n[s]).tuple,d=f.field,(p=v[Ei(h)])>0&&(b(h,d,f.value),u.modifies(d));for(s=0,l=a.length;s<l;++s)f=a[s],d=f.filter,c.forEach((function(e){d(e)&&v[Ei(e)]>0&&b(e,f.field,f.value)})),u.modifies(f.field);if(o)u.mod=t.length||r.length?c.filter((function(e){return v[Ei(e)]>0})):c.slice();else for(p in m)u.mod.push(m[p]);return(i||null==i&&(t.length||r.length))&&u.clean(!0),u}}}var Ri="_:mod:_";function zi(){Object.defineProperty(this,Ri,{writable:!0,value:{}})}zi.prototype={set:function(e,t,n,r){var a=this,i=a[e],o=a[Ri];return null!=t&&t>=0?(i[t]!==n||r)&&(i[t]=n,o[t+":"+e]=-1,o[e]=-1):(i!==n||r)&&(a[e]=n,o[e]=Object(ne.B)(n)?1+n.length:-1),a},modified:function(e,t){var n=this[Ri];if(!arguments.length){for(var r in n)if(n[r])return!0;return!1}if(Object(ne.B)(e)){for(var a=0;a<e.length;++a)if(n[e[a]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear:function(){return this[Ri]={},this}};var Li=0,Pi=new zi;function Bi(e,t,n,r){this.id=++Li,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Wi(e){return function(t){var n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Bi.prototype={targets:function(){return this._targets||(this._targets=Oi(ne.x))},set:function(e){return this.value!==e?(this.value=e,1):0},skip:Wi(1),modified:Wi(2),parameters:function(e,t,n){var r=this;t=!1!==t;var a,i,o,u,c=this._argval=this._argval||new zi,s=this._argops=this._argops||[],l=[],f=function(e,n,a){a instanceof Bi?(a!==r&&(t&&a.targets().add(r),l.push(a)),s.push({op:a,name:e,index:n})):c.set(e,n,a)};for(a in e)if(i=e[a],"pulse"===a)Object(ne.i)(i).forEach((function(e){e instanceof Bi?e!==r&&(e.targets().add(r),l.push(e)):Object(ne.o)("Pulse parameters must be operator instances.")})),this.source=i;else if(Object(ne.B)(i))for(c.set(a,-1,Array(o=i.length)),u=0;u<o;++u)f(a,u,i[u]);else f(a,-1,i);return this.marshall().clear(),n&&(s.initonly=!0),l},marshall:function(e){var t,n,r,a,i=this._argval||Pi,o=this._argops;if(o){var u=o.length;for(n=0;n<u;++n)a=(r=(t=o[n]).op).modified()&&r.stamp===e,i.set(t.name,t.index,r.value,a);if(o.initonly){for(n=0;n<u;++n)(t=o[n]).op.targets().remove(this);this._argops=null,this._update=null}}return i},detach:function(){var e,t,n,r=this._argops;if(r)for(e=0,t=r.length;e<t;++e)(n=r[e].op)._targets&&n._targets.remove(this);this.pulse=null,this.source=null},evaluate:function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run:function(e){return e.stamp<this.stamp?e.StopPropagation:(this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e);var t}};var Ui=0;function Vi(e,t,n){this.id=++Ui,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function qi(e,t,n){return new Vi(e,t,n)}function Hi(){return(Hi=Object(re.a)(k.a.mark((function e(t,n){var r,a,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,a=0,e.prev=2,e.next=5,r.loader().load(t,{context:"dataflow",response:Ke(n&&n.type)});case 5:i=e.sent;try{i=r.parse(i,n)}catch(o){a=-2,r.warn("Data ingestion failed",t,o)}e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),a=-1,r.warn("Loading failed",t,e.t0);case 13:return e.abrupt("return",{data:i,status:a});case 14:case"end":return e.stop()}}),e,this,[[2,9]])})))).apply(this,arguments)}function Gi(){return(Gi=Object(re.a)(k.a.mark((function e(t,n,r){var a,i,o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=(a=this)._pending||Ki(a)).requests+=1,e.next=4,a.request(n,r);case 4:return o=e.sent,a.pulse(t,a.changeset().remove(ne.ib).insert(o.data||[])),i.done(),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Ki(e){var t,n=new Promise((function(e){return t=e}));return n.requests=0,n.done=function(){0===--n.requests&&(e._pending=null,t(e))},e._pending=n}Vi.prototype={_filter:ne.ib,_apply:ne.y,targets:function(){return this._targets||(this._targets=Oi(ne.x))},consume:function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive:function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,a=0;a<r;++a)n[a].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter:function(e){var t=qi(e);return this.targets().add(t),t},apply:function(e){var t=qi(null,e);return this.targets().add(t),t},merge:function(){var e=qi();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle:function(e){var t=-1;return this.filter((function(){var n=Date.now();return n-t>e?(t=n,1):0}))},debounce:function(e){var t=qi();return this.targets().add(qi(null,null,Object(ne.n)(e,(function(e){var n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},between:function(e,t){var n=!1;return e.targets().add(qi(null,null,(function(){return n=!0}))),t.targets().add(qi(null,null,(function(){return n=!1}))),this.filter((function(){return n}))},detach:function(){this._filter=ne.ib,this._targets=null}};var Xi={skip:!0};function Yi(e,t,n,r,a,i){var o,u,c=Object(ne.p)({},i,Xi);Object(ne.E)(n)||(n=Object(ne.m)(n)),void 0===r?o=function(t){return e.touch(n(t))}:Object(ne.E)(r)?(u=new Bi(null,r,a,!1),o=function(t){u.evaluate(t);var r=n(t),a=u.value;Fi(a)?e.pulse(r,a,i):e.update(r,a,c)}):o=function(t){return e.update(n(t),r,c)},t.apply(o)}function $i(e,t,n,r,a,i){if(void 0===r)t.targets().add(n);else{var o=i||{},u=new Bi(null,function(e,t){return t=Object(ne.E)(t)?t:Object(ne.m)(t),e?function(n,r){var a=t(n,r);return e.skip()||(e.skip(a!==this.value).value=a),a}:t}(n,r),a,!1);u.modified(o.force),u.rank=t.rank,t.targets().add(u),n&&(u.skip(!0),u.value=n.value,u.targets().add(n),e.connect(n,[u]))}}var Ji={};function Qi(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Zi(e,t){var n=[];return Object(ne.kb)(e,t,(function(e){return n.push(e)})),n}function eo(e,t){var n={};return e.visit(t,(function(e){n[Ei(e)]=1})),function(e){return n[Ei(e)]?null:e}}function to(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}function no(e,t,n,r){var a=this,i=n.length,o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(var u=0;u<i;++u){var c=n[u];if(c.stamp===t){if(c.fields){var s=a.fields||(a.fields={});for(var l in c.fields)s[l]=1}c.changed(a.ADD)&&(o|=a.ADD),c.changed(a.REM)&&(o|=a.REM),c.changed(a.MOD)&&(o|=a.MOD)}}this.changes=o}function ro(){return(ro=Object(re.a)(k.a.mark((function e(t,n,r){var a,i,o,u,c,s,l,f,d;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[],!(a=this)._pulse){e.next=3;break}return e.abrupt("return",io(a));case 3:if(!a._pending){e.next=6;break}return e.next=6,a._pending;case 6:if(!n){e.next=9;break}return e.next=9,ki(a,n);case 9:if(a._touched.length){e.next=12;break}return a.debug("Dataflow invoked, but nothing to do."),e.abrupt("return",a);case 12:o=++a._clock,a._pulse=new Qi(a,o,t),a._touched.forEach((function(e){return a._enqueue(e,!0)})),a._touched=Oi(ne.x),u=0,e.prev=17;case 18:if(!(a._heap.size()>0)){e.next=35;break}if((c=a._heap.pop()).rank===c.qrank){e.next=23;break}return a._enqueue(c,!0),e.abrupt("continue",18);case 23:if(!(s=c.run(a._getPulse(c,t))).then){e.next=30;break}return e.next=27,s;case 27:s=e.sent,e.next=31;break;case 30:s.async&&(i.push(s.async),s=Ji);case 31:s!==Ji&&c._targets&&c._targets.forEach((function(e){return a._enqueue(e)})),++u,e.next=18;break;case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(17),a._heap.clear(),l=e.t0;case 41:if(a._input={},a._pulse=null,a.debug("Pulse ".concat(o,": ").concat(u," operators")),l&&(a._postrun=[],a.error(l)),!a._postrun.length){e.next=55;break}f=a._postrun.sort((function(e,t){return t.priority-e.priority})),a._postrun=[],d=0;case 49:if(!(d<f.length)){e.next=55;break}return e.next=52,ki(a,f[d].callback);case 52:++d,e.next=49;break;case 55:if(!r){e.next=58;break}return e.next=58,ki(a,r);case 58:return i.length&&Promise.all(i).then((function(e){return a.runAsync(null,(function(){e.forEach((function(e){try{e(a)}catch(t){a.error(t)}}))}))})),e.abrupt("return",a);case 60:case"end":return e.stop()}}),e,this,[[17,37]])})))).apply(this,arguments)}function ao(){return(ao=Object(re.a)(k.a.mark((function e(t,n,r){var a,i=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._running){e.next=5;break}return e.next=3,this._running;case 3:e.next=0;break;case 5:return a=function(){return i._running=null},(this._running=this.evaluate(t,n,r)).then(a,a),e.abrupt("return",this._running);case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function io(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}Qi.prototype={StopPropagation:Ji,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork:function(e){return new Qi(this.dataflow).init(this,e)},clone:function(){var e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll:function(){var e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||((e=new Qi(this.dataflow).init(this)).add=e.source,e.rem=[]),e},init:function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter:function(e){this.dataflow.runAfter(e)},changed:function(e){var t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow:function(e){if(e)return this.fork(7).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,eo(this,1))),this},clean:function(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies:function(e){var t=this.fields||(this.fields={});return Object(ne.B)(e)?e.forEach((function(e){return t[e]=!0})):t[e]=!0,this},modified:function(e,t){var n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?Object(ne.B)(e)?e.some((function(e){return n[e]})):n[e]:!!n)},filter:function(e,t){var n=this;return 1&e&&(n.addF=to(n.addF,t)),2&e&&(n.remF=to(n.remF,t)),4&e&&(n.modF=to(n.modF,t)),16&e&&(n.srcF=to(n.srcF,t)),n},materialize:function(e){var t=this;return 1&(e=e||7)&&t.addF&&(t.add=Zi(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Zi(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Zi(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit:function(e,t){var n=this,r=t;if(16&e)return Object(ne.kb)(n.source,n.srcF,r),n;1&e&&Object(ne.kb)(n.add,n.addF,r),2&e&&Object(ne.kb)(n.rem,n.remF,r),4&e&&Object(ne.kb)(n.mod,n.modF,r);var a=n.source;if(8&e&&a){var i=n.add.length+n.mod.length;i===a.length||(i?Object(ne.kb)(a,eo(n,5),r):Object(ne.kb)(a,n.srcF,r))}return n}},Object(ne.z)(no,Qi,{fork:function(e){var t=new Qi(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(function(e){return t.add.push(e)})),e&t.REM&&this.visit(t.REM,(function(e){return t.rem.push(e)})),e&t.MOD&&this.visit(t.MOD,(function(e){return t.mod.push(e)}))),t},changed:function(e){return this.changes&e},modified:function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?Object(ne.B)(e)?e.some((function(e){return n[e]})):n[e]:0},filter:function(){Object(ne.o)("MultiPulse does not support filtering.")},materialize:function(){Object(ne.o)("MultiPulse does not support materialization.")},visit:function(e,t){var n=this,r=n.pulses,a=r.length,i=0;if(e&n.SOURCE)for(;i<a;++i)r[i].visit(e,t);else for(;i<a;++i)r[i].stamp===n.stamp&&r[i].visit(e,t);return n}});var oo={skip:!1,force:!1};function uo(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){return t.push(n),co(t,0,t.length-1,e)},pop:function(){var n,r=t.pop();return t.length?(n=t[0],t[0]=r,function(e,t,n){var r,a=t,i=e.length,o=e[t],u=1+(t<<1);for(;u<i;)(r=u+1)<i&&n(e[u],e[r])>=0&&(u=r),e[t]=e[u],u=1+((t=u)<<1);e[t]=o,co(e,a,t,n)}(t,0,e)):n=r,n}}}function co(e,t,n,r){for(var a,i,o=e[n];n>t&&r(o,a=e[i=n-1>>1])<0;)e[n]=a,n=i;return e[n]=o}function so(){this.logger(Object(ne.M)()),this.logLevel(ne.b),this._clock=0,this._rank=0,this._locale=bi();try{this._loader=xi()}catch(e){}this._touched=Oi(ne.x),this._input={},this._pulse=null,this._heap=uo((function(e,t){return e.qrank-t.qrank})),this._postrun=[]}function lo(e){return function(){return this._log[e].apply(this,arguments)}}function fo(e,t){Bi.call(this,e,null,t)}so.prototype={stamp:function(){return this._clock},loader:function(e){return arguments.length?(this._loader=e,this):this._loader},locale:function(e){return arguments.length?(this._locale=e,this):this._locale},logger:function(e){return arguments.length?(this._log=e,this):this._log},error:lo("error"),warn:lo("warn"),info:lo("info"),debug:lo("debug"),logLevel:lo("level"),cleanThreshold:1e4,add:function(e,t,n,r){var a,i=1;return e instanceof Bi?a=e:e&&e.prototype instanceof Bi?a=new e:Object(ne.E)(e)?a=new Bi(null,e):(i=0,a=new Bi(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a},connect:function(e,t){for(var n=e.rank,r=t.length,a=0;a<r;++a)if(n<t[a].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){for(var t,n,r,a=[e];a.length;)if(this.rank(t=a.pop()),n=t._targets)for(r=n.length;--r>=0;)a.push(t=n[r]),t===e&&Object(ne.o)("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||oo);var r=new Qi(this,this._clock+(this._pulse?0:1)),a=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,a),this},touch:function(e,t){var n=t||oo;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){var r=n||oo;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:Mi,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){var n=this.locale();return yi(e,t,n.timeParse,n.utcParse)},preload:function(e,t,n){return Gi.apply(this,arguments)},request:function(e,t){return Hi.apply(this,arguments)},events:function(e,t,n,r){for(var a,i=this,o=qi(n,r),u=function(e){e.dataflow=i;try{o.receive(e)}catch(t){i.error(t)}finally{i.run()}},c=(a="string"===typeof e&&"undefined"!==typeof document?document.querySelectorAll(e):Object(ne.i)(e)).length,s=0;s<c;++s)a[s].addEventListener(t,u);return o},on:function(e,t,n,r,a){return(e instanceof Bi?$i:Yi)(this,e,t,n,r,a),this},evaluate:function(e,t,n){return ro.apply(this,arguments)},run:function(e,t,n){return this._pulse?io(this):(this.evaluate(e,t,n),this)},runAsync:function(e,t,n){return ao.apply(this,arguments)},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}},_enqueue:function(e,t){var n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){var n=e.source,r=this._clock;return n&&Object(ne.B)(n)?new no(this,r,n.map((function(e){return e.pulse})),t):this._input[e.id]||function(e,t){if(t&&t.stamp===e.stamp)return t;e=e.fork(),t&&t!==Ji&&(e.source=t.source);return e}(this._pulse,n&&n.pulse)}},Object(ne.z)(fo,Bi,{run:function(e){var t,n=this;return e.stamp<this.stamp?e.StopPropagation:(this.skip()?this.skip(!1):t=this.evaluate(e),(t=t||e).then?t=t.then((function(e){return n.pulse=e})):t!==e.StopPropagation&&(this.pulse=t),t)},evaluate:function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform:function(){}});var ho={};function po(e){var t=vo(e);return t&&t.Definition||null}function vo(e){return e=e&&e.toLowerCase(),Object(ne.w)(ho,e)?ho[e]:null}var mo=n(9),bo=n(8);function go(e,t){var n;if(void 0===t){var r,a=Object(mo.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n<i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,c=Object(mo.a)(e);try{for(c.s();!(o=c.n()).done;){var s=o.value;null!=(s=t(s,++u,e))&&(n<s||void 0===n&&s>=s)&&(n=s)}}catch(l){c.e(l)}finally{c.f()}}return n}function yo(e,t){var n;if(void 0===t){var r,a=Object(mo.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n>i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,c=Object(mo.a)(e);try{for(c.s();!(o=c.n()).done;){var s=o.value;null!=(s=t(s,++u,e))&&(n>s||void 0===n&&s>=s)&&(n=s)}}catch(l){c.e(l)}finally{c.f()}}return n}function xo(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:xn;r>n;){if(r-n>600){var i=r-n+1,o=t-n+1,u=Math.log(i),c=.5*Math.exp(2*u/3),s=.5*Math.sqrt(u*c*(i-c)/i)*(o-i/2<0?-1:1),l=Math.max(n,Math.floor(t-o*c/i+s)),f=Math.min(r,Math.floor(t+(i-o)*c/i+s));xo(e,t,l,f,a)}var d=e[t],h=n,p=r;for(Oo(e,n,t),a(e[r],d)>0&&Oo(e,n,r);h<p;){for(Oo(e,h,p),++h,--p;a(e[h],d)<0;)++h;for(;a(e[p],d)>0;)--p}0===a(e[n],d)?Oo(e,n,p):Oo(e,++p,r),p<=t&&(n=p+1),t<=p&&(r=p-1)}return e}function Oo(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}var ko=k.a.mark(jo),wo=function(e){return null===e?NaN:+e};function jo(e,t){var n,r,a,i,o,u,c;return k.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(void 0!==t){s.next=21;break}n=Object(mo.a)(e),s.prev=2,n.s();case 4:if((r=n.n()).done){s.next=11;break}if(!(null!=(a=r.value)&&(a=+a)>=a)){s.next=9;break}return s.next=9,a;case 9:s.next=4;break;case 11:s.next=16;break;case 13:s.prev=13,s.t0=s.catch(2),n.e(s.t0);case 16:return s.prev=16,n.f(),s.finish(16);case 19:s.next=40;break;case 21:i=-1,o=Object(mo.a)(e),s.prev=23,o.s();case 25:if((u=o.n()).done){s.next=32;break}if(c=u.value,!(null!=(c=t(c,++i,e))&&(c=+c)>=c)){s.next=30;break}return s.next=30,c;case 30:s.next=25;break;case 32:s.next=37;break;case 34:s.prev=34,s.t1=s.catch(23),o.e(s.t1);case 37:return s.prev=37,o.f(),s.finish(37);case 40:case"end":return s.stop()}}),ko,null,[[2,13,16,19],[23,34,37,40]])}function _o(e,t,n){if(r=(e=Float64Array.from(jo(e,n))).length){if((t=+t)<=0||r<2)return yo(e);if(t>=1)return go(e);var r,a=(r-1)*t,i=Math.floor(a),o=go(xo(e,i).subarray(0,i+1));return o+(yo(e.subarray(i+1))-o)*(a-i)}}function So(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wo;if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e),u=+n(e[i+1],i+1,e);return o+(u-o)*(a-i)}}function Eo(e,t){var n=function(e,t){var n,r=0,a=0,i=0;if(void 0===t){var o,u=Object(mo.a)(e);try{for(u.s();!(o=u.n()).done;){var c=o.value;null!=c&&(c=+c)>=c&&(i+=(n=c-a)*(c-(a+=n/++r)))}}catch(h){u.e(h)}finally{u.f()}}else{var s,l=-1,f=Object(mo.a)(e);try{for(f.s();!(s=f.n()).done;){var d=s.value;null!=(d=t(d,++l,e))&&(d=+d)>=d&&(i+=(n=d-a)*(d-(a+=n/++r)))}}catch(h){f.e(h)}finally{f.f()}}if(r>1)return i/(r-1)}(e,t);return n?Math.sqrt(n):n}var Co=function(e,t){return _o(e,.5,t)},Ao=k.a.mark(No);function No(e,t){var n,r,a,i,o,u,c;return k.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(null!=t){s.next=21;break}n=Object(mo.a)(e),s.prev=2,n.s();case 4:if((r=n.n()).done){s.next=11;break}if(!(null!=(a=r.value)&&""!==a&&(a=+a)>=a)){s.next=9;break}return s.next=9,a;case 9:s.next=4;break;case 11:s.next=16;break;case 13:s.prev=13,s.t0=s.catch(2),n.e(s.t0);case 16:return s.prev=16,n.f(),s.finish(16);case 19:s.next=41;break;case 21:i=-1,o=Object(mo.a)(e),s.prev=23,o.s();case 25:if((u=o.n()).done){s.next=33;break}if(c=u.value,!(null!=(c=t(c,++i,e))&&""!==c&&(c=+c)>=c)){s.next=31;break}return s.next=31,c;case 31:s.next=25;break;case 33:s.next=38;break;case 35:s.prev=35,s.t1=s.catch(23),o.e(s.t1);case 38:return s.prev=38,o.f(),s.finish(38);case 41:case"end":return s.stop()}}),Ao,null,[[2,13,16,19],[23,35,38,41]])}function To(e,t,n){var r=Float64Array.from(No(e,n));return r.sort(xn),t.map((function(e){return So(r,e)}))}function Io(e,t){return To(e,[.25,.5,.75],t)}function Do(e,t){var n=e.length,r=Eo(e,t),a=Io(e,t),i=(a[2]-a[0])/1.34;return 1.06*(Math.min(r,i)||r||Math.abs(a[0])||1)*Math.pow(n,-.2)}function Fo(e){var t,n,r,a,i,o,u=e.maxbins||20,c=e.base||10,s=Math.log(c),l=e.divide||[5,2],f=e.extent[0],d=e.extent[1],h=e.span||d-f||Math.abs(f)||1;if(e.step)t=e.step;else if(e.steps){for(a=h/u,i=0,o=e.steps.length;i<o&&e.steps[i]<a;++i);t=e.steps[Math.max(0,i-1)]}else{for(n=Math.ceil(Math.log(u)/s),r=e.minstep||0,t=Math.max(r,Math.pow(c,Math.round(Math.log(h)/s)-n));Math.ceil(h/t)>u;)t*=c;for(i=0,o=l.length;i<o;++i)(a=t/l[i])>=r&&h/a<=u&&(t=a)}var p=(a=Math.log(t))>=0?0:1+~~(-a/s),v=Math.pow(c,-p-1);return(e.nice||void 0===e.nice)&&(f=f<(a=Math.floor(f/t+v)*t)?a-t:a,d=Math.ceil(d/t)*t),{start:f,stop:d===f?f+t:d,step:t}}var Mo=Math.random;function Ro(e){Mo=e}function zo(e,t,n,r){if(!e.length)return[void 0,void 0];var a,i,o,u,c=Float64Array.from(No(e,r)),s=c.length,l=t;for(o=0,u=Array(l);o<l;++o){for(a=0,i=0;i<s;++i)a+=c[~~(Mo()*s)];u[o]=a/s}return u.sort(xn),[_o(u,n/2),_o(u,1-n/2)]}function Lo(e,t,n,r){r=r||function(e){return e};for(var a,i=e.length,o=new Float64Array(i),u=0,c=1,s=r(e[0]),l=s,f=s+t;c<i;++c){if((a=r(e[c]))>=f){for(l=(s+l)/2;u<c;++u)o[u]=l;f=a+t,s=a}l=a}for(l=(s+l)/2;u<c;++u)o[u]=l;return n?function(e,t){var n,r,a=e.length,i=0,o=1;for(;e[i]===e[o];)++o;for(;o<a;){for(n=o+1;e[o]===e[n];)++n;if(e[o]-e[o-1]<t){for(r=o+(i+n-o-o>>1);r<o;)e[r++]=e[o];for(;r>o;)e[r--]=e[i]}i=o,o=n}return e}(o,t+t/4):o}function Po(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function Bo(e,t){var n,r,a;null==t&&(t=e,e=0);var i={min:function(e){return arguments.length?(a=r-(n=e||0),i):n},max:function(e){return arguments.length?(a=(r=e||0)-n,i):r},sample:function(){return n+Math.floor(a*Mo())},pdf:function(e){return e===Math.floor(e)&&e>=n&&e<r?1/a:0},cdf:function(e){var t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/a},icdf:function(e){return e>=0&&e<=1?n-1+Math.floor(e*a):NaN}};return i.min(e).max(t)}var Wo=Math.sqrt(2*Math.PI),Uo=Math.SQRT2,Vo=NaN;function qo(e,t){e=e||0,t=null==t?1:t;var n,r,a=0,i=0;if(Vo===Vo)a=Vo,Vo=NaN;else{do{n=(a=2*Mo()-1)*a+(i=2*Mo()-1)*i}while(0===n||n>1);a*=r=Math.sqrt(-2*Math.log(n)/n),Vo=i*r}return e+a*t}function Ho(e,t,n){var r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*Wo)}function Go(e,t,n){var r,a=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(a);if(i>37)r=0;else{var o=Math.exp(-i*i/2);i<7.07106781186547?(r=o*((((((.0352624965998911*i+.700383064443688)*i+6.37396220353165)*i+33.912866078383)*i+112.079291497871)*i+221.213596169931)*i+220.206867912376),r/=((((((.0883883476483184*i+1.75566716318264)*i+16.064177579207)*i+86.7807322029461)*i+296.564248779674)*i+637.333633378831)*i+793.826512519948)*i+440.413735824752):r=o/(i+1/(i+2/(i+3/(i+4/(i+.65)))))/2.506628274631}return a>0?1-r:r}function Ko(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*Uo*function(e){var t,n=-Math.log((1-e)*(1+e));t=n<6.25?1.6536545626831027+(t=.24015818242558962+(t=(t=(t=.00018673420803405714+(t=(t=(t=4.2347877827932404e-7+(t=(t=(t=1.0512122733215323e-9+(t=(t=(t=26335093153082323e-28+(t=(t=(t=6637638134358324e-30+(t=20972767875968562e-33+(t=(t=11157877678025181e-33+(t=128584807152564e-32+(t=(t=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?3.0838856104922208+(t=1.0052589676941592+(t=.005370914553590064+(t=(t=.002491442096107851+(t=(t=.0009532893797373805+(t=(t=24031110387097894e-21+(t=6828485145957318e-20+(t=(t=12475304481671779e-21+(t=29234449089955446e-22+(t=(t=15027403968909828e-22+(t=1.8239629214389228e-8+(t=(t=9.075656193888539e-8+(t=2.2137376921775787e-9)*(n=Math.sqrt(n)-3.25))*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n:Number.isFinite(n)?4.849906401408584+(t=1.0103004648645344+(t=(t=(t=7599527703001776e-20+(t=(t=4526062597223154e-21+(t=(t=2.2900482228026655e-7+(t=(t=2.914795345090108e-8+(t=(t=7.61570120807834e-9+(t=(t=1.5076572693500548e-9+(t=(t=-27109920616438573e-27)*(n=Math.sqrt(n)-5)-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n:1/0;return t*e}(2*e-1)}function Xo(e,t){var n,r,a={mean:function(e){return arguments.length?(n=e||0,a):n},stdev:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return qo(n,r)},pdf:function(e){return Ho(e,n,r)},cdf:function(e){return Go(e,n,r)},icdf:function(e){return Ko(e,n,r)}};return a.mean(e).stdev(t)}function Yo(e,t){var n=Xo(),r=0,a={data:function(n){return arguments.length?(e=n,r=n?n.length:0,a.bandwidth(t)):e},bandwidth:function(n){return arguments.length?(!(t=n)&&e&&(t=Do(e)),a):t},sample:function(){return e[~~(Mo()*r)]+t*n.sample()},pdf:function(a){for(var i=0,o=0;o<r;++o)i+=n.pdf((a-e[o])/t);return i/t/r},cdf:function(a){for(var i=0,o=0;o<r;++o)i+=n.cdf((a-e[o])/t);return i/r},icdf:function(){throw Error("KDE icdf not supported.")}};return a.data(e)}function $o(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+qo()*t)}function Jo(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Wo*e)}function Qo(e,t,n){return Go(Math.log(e),t,n)}function Zo(e,t,n){return Math.exp(Ko(e,t,n))}function eu(e,t){var n,r,a={mean:function(e){return arguments.length?(n=e||0,a):n},stdev:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return $o(n,r)},pdf:function(e){return Jo(e,n,r)},cdf:function(e){return Qo(e,n,r)},icdf:function(e){return Zo(e,n,r)}};return a.mean(e).stdev(t)}function tu(e,t){var n,r=0;function a(e){var t,n=[],a=0;for(t=0;t<r;++t)a+=n[t]=null==e[t]?1:+e[t];for(t=0;t<r;++t)n[t]/=a;return n}var i={weights:function(e){return arguments.length?(n=a(t=e||[]),i):t},distributions:function(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},sample:function(){for(var t=Mo(),a=e[r-1],i=n[0],o=0;o<r-1;i+=n[++o])if(t<i){a=e[o];break}return a.sample()},pdf:function(t){for(var a=0,i=0;i<r;++i)a+=n[i]*e[i].pdf(t);return a},cdf:function(t){for(var a=0,i=0;i<r;++i)a+=n[i]*e[i].cdf(t);return a},icdf:function(){throw Error("Mixture icdf not supported.")}};return i.distributions(e).weights(t)}function nu(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*Mo()}function ru(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function au(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function iu(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function ou(e,t){var n,r,a={min:function(e){return arguments.length?(n=e||0,a):n},max:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return nu(n,r)},pdf:function(e){return ru(e,n,r)},cdf:function(e){return au(e,n,r)},icdf:function(e){return iu(e,n,r)}};return null==t&&(t=null==e?1:e,e=0),a.min(e).max(t)}function uu(e,t,n,r){var a=r-e*e,i=Math.abs(a)<1e-24?0:(n-e*t)/a;return[t-i*e,i]}function cu(e,t,n,r){e=e.filter((function(e){var r=t(e),a=n(e);return null!=r&&(r=+r)>=r&&null!=a&&(a=+a)>=a})),r&&e.sort((function(e,n){return t(e)-t(n)}));var a,i,o,u,c=e.length,s=new Float64Array(c),l=new Float64Array(c),f=0,d=0,h=0,p=Object(mo.a)(e);try{for(p.s();!(u=p.n()).done;)o=u.value,s[f]=a=+t(o),l[f]=i=+n(o),d+=(a-d)/++f,h+=(i-h)/f}catch(v){p.e(v)}finally{p.f()}for(f=0;f<c;++f)s[f]-=d,l[f]-=h;return[s,l,d,h]}function su(e,t,n,r){var a,i,o,u=-1,c=Object(mo.a)(e);try{for(c.s();!(o=c.n()).done;){var s=o.value;a=t(s),i=n(s),null!=a&&(a=+a)>=a&&null!=i&&(i=+i)>=i&&r(a,i,++u)}}catch(l){c.e(l)}finally{c.f()}}function lu(e,t,n,r,a){var i=0,o=0;return su(e,t,n,(function(e,t){var n=t-a(e),u=t-r;i+=n*n,o+=u*u})),1-i/o}function fu(e,t,n){var r=0,a=0,i=0,o=0,u=0;su(e,t,n,(function(e,t){++u,r+=(e-r)/u,a+=(t-a)/u,i+=(e*t-i)/u,o+=(e*e-o)/u}));var c=uu(r,a,i,o),s=function(e){return c[0]+c[1]*e};return{coef:c,predict:s,rSquared:lu(e,t,n,a,s)}}function du(e,t,n){var r=0,a=0,i=0,o=0,u=0;su(e,t,n,(function(e,t){++u,e=Math.log(e),r+=(e-r)/u,a+=(t-a)/u,i+=(e*t-i)/u,o+=(e*e-o)/u}));var c=uu(r,a,i,o),s=function(e){return c[0]+c[1]*Math.log(e)};return{coef:c,predict:s,rSquared:lu(e,t,n,a,s)}}function hu(e,t,n){var r,a,i,o=cu(e,t,n),u=Object(bo.a)(o,4),c=u[0],s=(u[1],u[2]),l=u[3],f=0,d=0,h=0,p=0,v=0;su(e,t,n,(function(e,t){r=c[v++],a=Math.log(t),f+=(t*a-f)/v,d+=((i=r*t)-d)/v,h+=(i*a-h)/v,p+=(r*i-p)/v}));var m=uu(d/l,f/l,h/l,p/l),b=Object(bo.a)(m,2),g=b[0],y=b[1],x=function(e){return Math.exp(g+y*(e-s))};return{coef:[Math.exp(g-y*s),y],predict:x,rSquared:lu(e,t,n,l,x)}}function pu(e,t,n){var r=0,a=0,i=0,o=0,u=0,c=0;su(e,t,n,(function(e,t){var n=Math.log(e),s=Math.log(t);++c,r+=(n-r)/c,a+=(s-a)/c,i+=(n*s-i)/c,o+=(n*n-o)/c,u+=(t-u)/c}));var s=uu(r,a,i,o),l=function(e){return s[0]*Math.pow(e,s[1])};return s[0]=Math.exp(s[0]),{coef:s,predict:l,rSquared:lu(e,t,n,u,l)}}function vu(e,t,n){var r,a,i,o,u=cu(e,t,n),c=Object(bo.a)(u,4),s=c[0],l=c[1],f=c[2],d=c[3],h=s.length,p=0,v=0,m=0,b=0,g=0;for(r=0;r<h;)a=s[r],i=l[r++],p+=((o=a*a)-p)/r,v+=(o*a-v)/r,m+=(o*o-m)/r,b+=(a*i-b)/r,g+=(o*i-g)/r;var y=m-p*p,x=p*y-v*v,O=(g*p-b*v)/x,k=(b*y-g*v)/x,w=-O*p,j=function(e){return O*(e-=f)*e+k*e+w+d};return{coef:[w-k*f+O*f*f+d,k-2*O*f,O],predict:j,rSquared:lu(e,t,n,d,j)}}function mu(e,t,n,r){if(1===r)return fu(e,t,n);if(2===r)return vu(e,t,n);var a,i,o,u,c,s=cu(e,t,n),l=Object(bo.a)(s,4),f=l[0],d=l[1],h=l[2],p=l[3],v=f.length,m=[],b=[],g=r+1;for(a=0;a<g;++a){for(o=0,u=0;o<v;++o)u+=Math.pow(f[o],a)*d[o];for(m.push(u),c=new Float64Array(g),i=0;i<g;++i){for(o=0,u=0;o<v;++o)u+=Math.pow(f[o],a+i);c[i]=u}b.push(c)}b.push(m);var y=function(e){var t,n,r,a,i,o=e.length-1,u=[];for(t=0;t<o;++t){for(a=t,n=t+1;n<o;++n)Math.abs(e[t][n])>Math.abs(e[t][a])&&(a=n);for(r=t;r<o+1;++r)i=e[r][t],e[r][t]=e[r][a],e[r][a]=i;for(n=t+1;n<o;++n)for(r=o;r>=t;r--)e[r][n]-=e[r][t]*e[t][n]/e[t][t]}for(n=o-1;n>=0;--n){for(i=0,r=n+1;r<o;++r)i+=e[r][n]*u[r];u[n]=(e[o][n]-i)/e[n][n]}return u}(b),x=function(e){e-=h;var t=p+y[0]+y[1]*e+y[2]*e*e;for(a=3;a<g;++a)t+=y[a]*Math.pow(e,a);return t};return{coef:bu(g,y,-h,p),predict:x,rSquared:lu(e,t,n,p,x)}}function bu(e,t,n,r){var a,i,o,u,c=Array(e);for(a=0;a<e;++a)c[a]=0;for(a=e-1;a>=0;--a)for(o=t[a],u=1,c[a]+=o,i=1;i<=a;++i)u*=(a+1-i)/i,c[a-i]+=o*Math.pow(n,i)*u;return c[0]+=r,c}function gu(e,t,n,r){for(var a=cu(e,t,n,!0),i=Object(bo.a)(a,4),o=i[0],u=i[1],c=i[2],s=i[3],l=o.length,f=Math.max(2,~~(r*l)),d=new Float64Array(l),h=new Float64Array(l),p=new Float64Array(l).fill(1),v=-1;++v<=2;){for(var m=[0,f-1],b=0;b<l;++b){for(var g=o[b],y=m[0],x=m[1],O=g-o[y]>o[x]-g?y:x,k=0,w=0,j=0,_=0,S=0,E=1/Math.abs(o[O]-g||1),C=y;C<=x;++C){var A=o[C],N=u[C],T=yu(Math.abs(g-A)*E)*p[C],I=A*T;k+=T,w+=I,j+=N*T,_+=N*I,S+=A*I}var D=uu(w/k,j/k,_/k,S/k),F=Object(bo.a)(D,2),M=F[0],R=F[1];d[b]=M+R*g,h[b]=Math.abs(u[b]-d[b]),xu(o,b+1,m)}if(2===v)break;var z=Co(h);if(Math.abs(z)<1e-12)break;for(var L,P,B=0;B<l;++B)L=h[B]/(6*z),p[B]=L>=1?1e-12:(P=1-L*L)*P}return function(e,t,n,r){for(var a,i=e.length,o=[],u=0,c=0,s=[];u<i;++u)a=e[u]+n,s[0]===a?s[1]+=(t[u]-s[1])/++c:(c=0,s[1]+=r,s=[a,t[u]],o.push(s));return s[1]+=r,o}(o,d,c,s)}function yu(e){return(e=1-e*e*e)*e*e}function xu(e,t,n){var r=e[t],a=n[0],i=n[1]+1;if(!(i>=e.length))for(;t>a&&e[i]-r<=r-e[a];)n[0]=++a,n[1]=i,++i}var Ou=.1*Math.PI/180;function ku(e,t,n,r){n=n||25,r=Math.max(n,r||200);var a=function(t){return[t,e(t)]},i=t[0],o=t[1],u=o-i,c=u/r,s=[a(i)],l=[];if(n===r){for(var f=1;f<r;++f)s.push(a(i+f/n*u));return s.push(a(o)),s}l.push(a(o));for(var d=n;--d>0;)l.push(a(i+d/n*u));for(var h=s[0],p=l[l.length-1];p;){var v=a((h[0]+p[0])/2);v[0]-h[0]>=c&&wu(h,v,p)>Ou?l.push(v):(h=p,s.push(p),l.pop()),p=l[l.length-1]}return s}function wu(e,t,n){var r=Math.atan2(n[1]-e[1],n[0]-e[0]),a=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-a)}var ju=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i};function _u(e){return e&&e.length?1===e.length?e[0]:(t=e,function(e){for(var n=t.length,r=1,a=String(t[0](e));r<n;++r)a+="|"+t[r](e);return a}):function(){return""};var t}function Su(e,t,n){return n||e+(t?"_"+t:"")}var Eu=function(){},Cu={init:Eu,add:Eu,rem:Eu,idx:0},Au={values:{init:function(e){return e.cell.store=!0},value:function(e){return e.cell.data.values()},idx:-1},count:{value:function(e){return e.cell.num}},__count__:{value:function(e){return e.missing+e.valid}},missing:{value:function(e){return e.missing}},valid:{value:function(e){return e.valid}},sum:{init:function(e){return e.sum=0},value:function(e){return e.sum},add:function(e,t){return e.sum+=+t},rem:function(e,t){return e.sum-=t}},product:{init:function(e){return e.product=1},value:function(e){return e.valid?e.product:void 0},add:function(e,t){return e.product*=t},rem:function(e,t){return e.product/=t}},mean:{init:function(e){return e.mean=0},value:function(e){return e.valid?e.mean:void 0},add:function(e,t){return e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:function(e,t){return e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}},average:{value:function(e){return e.valid?e.mean:void 0},req:["mean"],idx:1},variance:{init:function(e){return e.dev=0},value:function(e){return e.valid>1?e.dev/(e.valid-1):void 0},add:function(e,t){return e.dev+=e.mean_d*(t-e.mean)},rem:function(e,t){return e.dev-=e.mean_d*(t-e.mean)},req:["mean"],idx:1},variancep:{value:function(e){return e.valid>1?e.dev/e.valid:void 0},req:["variance"],idx:2},stdev:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0},req:["variance"],idx:2},stdevp:{value:function(e){return e.valid>1?Math.sqrt(e.dev/e.valid):void 0},req:["variance"],idx:2},stderr:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0},req:["variance"],idx:2},distinct:{value:function(e){return e.cell.data.distinct(e.get)},req:["values"],idx:3},ci0:{value:function(e){return e.cell.data.ci0(e.get)},req:["values"],idx:3},ci1:{value:function(e){return e.cell.data.ci1(e.get)},req:["values"],idx:3},median:{value:function(e){return e.cell.data.q2(e.get)},req:["values"],idx:3},q1:{value:function(e){return e.cell.data.q1(e.get)},req:["values"],idx:3},q3:{value:function(e){return e.cell.data.q3(e.get)},req:["values"],idx:3},min:{init:function(e){return e.min=void 0},value:function(e){return e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min},add:function(e,t){(t<e.min||void 0===e.min)&&(e.min=t)},rem:function(e,t){t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:function(e){return e.max=void 0},value:function(e){return e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max},add:function(e,t){(t>e.max||void 0===e.max)&&(e.max=t)},rem:function(e,t){t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:function(e){return e.argmin=void 0},value:function(e){return e.argmin||e.cell.data.argmin(e.get)},add:function(e,t,n){t<e.min&&(e.argmin=n)},rem:function(e,t){t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:function(e){return e.argmax=void 0},value:function(e){return e.argmax||e.cell.data.argmax(e.get)},add:function(e,t,n){t>e.max&&(e.argmax=n)},rem:function(e,t){t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Nu=Object.keys(Au);function Tu(e,t){return Au[e](t)}function Iu(e,t){return e.idx-t.idx}function Du(){var e=this;this.valid=0,this.missing=0,this._ops.forEach((function(t){return t.init(e)}))}function Fu(e,t){var n=this;null!=e&&""!==e?e===e&&(++this.valid,this._ops.forEach((function(r){return r.add(n,e,t)}))):++this.missing}function Mu(e,t){var n=this;null!=e&&""!==e?e===e&&(--this.valid,this._ops.forEach((function(r){return r.rem(n,e,t)}))):--this.missing}function Ru(e){var t=this;return this._out.forEach((function(n){return e[n.out]=n.value(t)})),e}function zu(e,t){var n=t||ne.y,r=function(e){var t={};return e.forEach((function(e){return t[e.name]=e})),e.forEach((function e(n){n.req&&n.req.forEach((function(n){t[n]||e(t[n]=Au[n]())}))})),Object.values(t).sort(Iu)}(e),a=e.slice().sort(Iu);function i(e){this._ops=r,this._out=a,this.cell=e,this.init()}return i.prototype.init=Du,i.prototype.add=Fu,i.prototype.rem=Mu,i.prototype.set=Ru,i.prototype.get=n,i.fields=e.map((function(e){return e.out})),i}function Lu(e){this._key=e?Object(ne.u)(e):Ei,this.reset()}Nu.forEach((function(e){Au[e]=function(e,t){return function(n){return Object(ne.p)({name:e,out:n||e},Cu,t)}}(e,Au[e])}));var Pu=Lu.prototype;function Bu(e){fo.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Pu.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Pu.add=function(e){this._add.push(e)},Pu.rem=function(e){this._rem.push(e)},Pu.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e,t,n,r=this._add,a=this._rem,i=this._key,o=r.length,u=a.length,c=Array(o-u),s={};for(e=0;e<u;++e)s[i(a[e])]=1;for(e=0,t=0;e<o;++e)s[i(n=r[e])]?s[i(n)]=0:c[t++]=n;return this._rem=[],this._add=c},Pu.distinct=function(e){for(var t,n=this.values(),r={},a=n.length,i=0;--a>=0;)t=e(n[a])+"",Object(ne.w)(r,t)||(r[t]=1,++i);return i},Pu.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=Object(ne.r)(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Pu.argmin=function(e){return this.extent(e)[0]||{}},Pu.argmax=function(e){return this.extent(e)[1]||{}},Pu.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},Pu.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},Pu.quartile=function(e){return this._get===e&&this._q||(this._q=Io(this.values(),e),this._get=e),this._q},Pu.q1=function(e){return this.quartile(e)[0]},Pu.q2=function(e){return this.quartile(e)[1]},Pu.q3=function(e){return this.quartile(e)[2]},Pu.ci=function(e){return this._get===e&&this._ci||(this._ci=zo(this.values(),1e3,.05,e),this._get=e),this._ci},Pu.ci0=function(e){return this.ci(e)[0]},Pu.ci1=function(e){return this.ci(e)[1]},Bu.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Nu},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},Object(ne.z)(Bu,fo,{transform:function(e,t){var n=this,r=this,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return r.stamp=a.stamp,r.value&&(i||t.modified(r._inputs,!0))?(r._prev=r.value,r.value=i?r.init(e):{},t.visit(t.SOURCE,(function(e){return r.add(e)}))):(r.value=r.value||r.init(e),t.visit(t.REM,(function(e){return r.rem(e)})),t.visit(t.ADD,(function(e){return r.add(e)}))),a.modifies(r._outputs),r._drop=!1!==e.drop,e.cross&&r._dims.length>1&&(r._drop=!1,r.cross()),t.clean()&&r._drop&&a.clean(!0).runAfter((function(){return n.clean()})),r.changes(a)},cross:function(){var e=this,t=e.value,n=e._dnames,r=n.map((function(){return{}})),a=n.length;function i(e){var t,i,o,u;for(t in e)for(o=e[t].tuple,i=0;i<a;++i)r[i][u=o[n[i]]]=u}i(e._prev),i(t),function i(o,u,c){var s=n[c],l=r[c++];for(var f in l){var d=o?o+"|"+f:f;u[s]=l[f],c<a?i(d,u,c):t[d]||e.cell(d,u)}}("",{},0)},init:function(e){var t=this._inputs=[],n=this._outputs=[],r={};function a(e){for(var n,a=Object(ne.i)(Object(ne.g)(e)),i=a.length,o=0;o<i;++o)r[n=a[o]]||(r[n]=1,t.push(n))}this._dims=Object(ne.i)(e.groupby),this._dnames=this._dims.map((function(e){var t=Object(ne.h)(e);return a(e),n.push(t),t})),this.cellkey=e.key?e.key:_u(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var i,o,u,c,s,l,f=e.fields||[null],d=e.ops||["count"],h=e.as||[],p=f.length,v={};for(p!==d.length&&Object(ne.o)("Unmatched number of fields and aggregate ops."),l=0;l<p;++l)i=f[l],o=d[l],null==i&&"count"!==o&&Object(ne.o)("Null aggregate field specified."),s=Su(o,c=Object(ne.h)(i),h[l]),n.push(s),"count"!==o?((u=v[c])||(a(i),(u=v[c]=[]).field=i,this._measures.push(u)),"count"!==o&&(this._countOnly=!1),u.push(Tu(o,s))):this._counts.push(s);return this._measures=this._measures.map((function(e){return zu(e,e.field)})),{}},cellkey:_u(),cell:function(e,t){var n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell:function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var r=this._measures,a=r.length;n.agg=Array(a);for(var i=0;i<a;++i)n.agg[i]=new r[i](n)}return n.store&&(n.data=new Lu),n},newtuple:function(e,t){for(var n=this._dnames,r=this._dims,a=r.length,i={},o=0;o<a;++o)i[n[o]]=r[o](e);return t?Ii(t.tuple,i):Ai(i)},clean:function(){var e=this.value;for(var t in e)0===e[t].num&&delete e[t]},add:function(e){var t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,!this._countOnly){n.store&&n.data.add(e);for(var r=n.agg,a=0,i=r.length;a<i;++a)r[a].add(r[a].get(e),e)}},rem:function(e){var t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,!this._countOnly){n.store&&n.data.rem(e);for(var r=n.agg,a=0,i=r.length;a<i;++a)r[a].rem(r[a].get(e),e)}},celltuple:function(e){var t=e.tuple,n=this._counts;e.store&&e.data.values();for(var r=0,a=n.length;r<a;++r)t[n[r]]=e.num;if(!this._countOnly)for(var i=e.agg,o=0,u=i.length;o<u;++o)i[o].set(t);return t},changes:function(e){var t,n,r,a,i=this._adds,o=this._mods,u=this._prev,c=this._drop,s=e.add,l=e.rem,f=e.mod;if(u)for(n in u)t=u[n],c&&!t.num||l.push(t.tuple);for(r=0,a=this._alen;r<a;++r)s.push(this.celltuple(i[r])),i[r]=null;for(r=0,a=this._mlen;r<a;++r)(0===(t=o[r]).num&&c?l:f).push(this.celltuple(t)),o[r]=null;return this._alen=this._mlen=0,this._prev=null,e}});function Wu(e){fo.call(this,null,e)}function Uu(e,t,n){var r=e,a=t||[],i=n||[],o={},u=0;return{add:function(e){return i.push(e)},remove:function(e){return o[r(e)]=++u},size:function(){return a.length},data:function(e,t){return u&&(a=a.filter((function(e){return!o[r(e)]})),o={},u=0),t&&e&&a.sort(e),i.length&&(a=e?Object(ne.O)(e,a,i.sort(e)):a.concat(i),i=[]),a}}}function Vu(e){fo.call(this,[],e)}function qu(e){Bi.call(this,null,Hu,e)}function Hu(e){return this.value&&!e.modified()?this.value:Object(ne.l)(e.fields,e.orders)}function Gu(e){fo.call(this,null,e)}function Ku(e){fo.call(this,null,e)}Wu.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},Object(ne.z)(Wu,fo,{transform:function(e,t){var n,r=!1!==e.interval,a=this._bins(e),i=a.start,o=a.step,u=e.as||["bin0","bin1"],c=u[0],s=u[1];return n=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(Object(ne.g)(e.field))?t.ADD_MOD:t.ADD,t.visit(n,r?function(e){var t=a(e);e[c]=t,e[s]=null==t?null:i+o*(1+(t-i)/o)}:function(e){return e[c]=a(e)}),t.modifies(r?u:c)},_bins:function(e){if(this.value&&!e.modified())return this.value;var t,n,r=e.field,a=Fo(e),i=a.step,o=a.start,u=o+Math.ceil((a.stop-o)/i)*i;null!=(t=e.anchor)&&(n=t-(o+i*Math.floor((t-o)/i)),o+=n,u+=n);var c=function(e){var t=Object(ne.eb)(r(e));return null==t?null:t<o?-1/0:t>u?1/0:(t=Math.max(o,Math.min(t,u-i)),o+i*Math.floor(1e-14+(t-o)/i))};return c.start=o,c.stop=a.stop,c.step=i,this.value=Object(ne.f)(c,Object(ne.g)(r),e.name||"bin_"+Object(ne.h)(r))}}),Vu.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Object(ne.z)(Vu,fo,{transform:function(e,t){var n=t.fork(t.ALL),r=Uu(Ei,this.value,n.materialize(n.ADD).add),a=e.sort,i=t.changed()||a&&(e.modified("sort")||t.modified(a.fields));return n.visit(n.REM,r.remove),this.modified(i),this.value=n.source=r.data(Di(a),i),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),Object(ne.z)(qu,Bi),Gu.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},Object(ne.z)(Gu,fo,{transform:function(e,t){var n=function(t){return function(n){for(var r,a=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(u(n),e.case,i)||[],c=0,s=a.length;c<s;++c)o.test(r=a[c])||t(r)}},r=this._parameterCheck(e,t),a=this._counts,i=this._match,o=this._stop,u=e.field,c=e.as||["text","count"],s=n((function(e){return a[e]=1+(a[e]||0)})),l=n((function(e){return a[e]-=1}));return r?t.visit(t.SOURCE,s):(t.visit(t.ADD,s),t.visit(t.REM,l)),this._finish(t,c)},_parameterCheck:function(e,t){var n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish:function(e,t){var n,r,a,i=this._counts,o=this._tuples||(this._tuples={}),u=t[0],c=t[1],s=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(n in i)r=o[n],a=i[n]||0,!r&&a?(o[n]=r=Ai({}),r[u]=n,r[c]=a,s.add.push(r)):0===a?(r&&s.rem.push(r),i[n]=null,o[n]=null):r[c]!==a&&(r[c]=a,s.mod.push(r));return s.modifies(t)}}),Ku.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Object(ne.z)(Ku,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],a=r[0],i=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter"),u=this.value;return o?(u&&(n.rem=u),u=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var a,i,o=[],u={},c=e.length,s=0;s<c;++s)for(u[t]=i=e[s],a=0;a<c;++a)u[n]=e[a],r(u)&&(o.push(Ai(u)),(u={})[t]=i);return o}(u,a,i,e.filter||ne.ib)):n.mod=u,n.source=this.value,n.modifies(r)}});var Xu={kde:Yo,mixture:tu,normal:Xo,lognormal:eu,uniform:ou},Yu="function";function $u(e,t){var n=e.function;Object(ne.w)(Xu,n)||Object(ne.o)("Unknown distribution function: "+n);var r=Xu[n]();for(var a in e)"field"===a?r.data((e.from||t()).map(e[a])):"distributions"===a?r[a](e[a].map((function(e){return $u(e,t)}))):typeof r[a]===Yu&&r[a](e[a]);return r}function Ju(e){fo.call(this,null,e)}var Qu=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Zu={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Qu},{name:"weights",type:"number",array:!0}]};function ec(e,t){return e?e.map((function(e,n){return t[n]||Object(ne.h)(e)})):null}function tc(e,t,n){var r,a,i,o,u,c,s=[],l=function(e){return e(o)};if(null==t)s.push(e.map(n));else for(r={},a=0,i=e.length;a<i;++a)o=e[a],(c=r[u=t.map(l)])||(r[u]=c=[],c.dims=u,s.push(c)),c.push(n(o));return s}Ju.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Qu.concat(Zu)},{name:"as",type:"string",array:!0,default:["value","density"]}]},Object(ne.z)(Ju,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=$u(e.distribution,function(e){return function(){return e.materialize(e.SOURCE).source}}(t)),a=e.steps||e.minsteps||25,i=e.steps||e.maxsteps||200,o=e.method||"pdf";"pdf"!==o&&"cdf"!==o&&Object(ne.o)("Invalid density method: "+o),e.extent||r.data||Object(ne.o)("Missing density extent parameter."),o=r[o];var u=e.as||["value","density"],c=ku(o,e.extent||Object(ne.q)(r.data()),a,i).map((function(e){var t={};return t[u[0]]=e[0],t[u[1]]=e[1],Ai(t)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});function nc(e){fo.call(this,null,e)}nc.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function rc(e){Bi.call(this,null,ac,e),this.modified(!0)}function ac(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:Object(ne.f)((function(n){return t(n,e)}),Object(ne.g)(t),Object(ne.h)(t))}function ic(e){fo.call(this,[void 0,void 0],e)}function oc(e,t){Bi.call(this,e),this.parent=t,this.count=0}function uc(e){fo.call(this,{},e),this._keys=Object(ne.t)();var t=this._targets=[];t.active=0,t.forEach=function(e){for(var n=0,r=t.active;n<r;++n)e(t[n],n,t)}}function cc(e){Bi.call(this,null,sc,e)}function sc(e){return this.value&&!e.modified()?this.value:Object(ne.B)(e.name)?Object(ne.i)(e.name).map((function(e){return Object(ne.u)(e)})):Object(ne.u)(e.name,e.as)}function lc(e){fo.call(this,Object(ne.t)(),e)}function fc(e){fo.call(this,[],e)}function dc(e){fo.call(this,[],e)}function hc(e){fo.call(this,null,e)}function pc(e){fo.call(this,[],e)}Object(ne.z)(nc,fo,{transform:function(e,t){if(this.value&&!e.modified()&&!t.changed())return t;for(var n,r=t.materialize(t.SOURCE).source,a=tc(t.source,e.groupby,ne.y),i=e.smooth||!1,o=e.field,u=e.step||function(e,t){return Object(ne.Z)(Object(ne.q)(e,t))/30}(r,o),c=Di((function(e,t){return o(e)-o(t)})),s=e.as||"bin",l=a.length,f=1/0,d=-1/0,h=0;h<l;++h){var p=a[h].sort(c);n=-1;var v,m=Object(mo.a)(Lo(p,u,i,o));try{for(m.s();!(v=m.n()).done;){var b=v.value;b<f&&(f=b),b>d&&(d=b),p[++n][s]=b}}catch(g){m.e(g)}finally{m.f()}}return this.value={start:f,stop:d,step:u},t.reflow(!0).modifies(s)}}),Object(ne.z)(rc,Bi),ic.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Object(ne.z)(ic,fo,{transform:function(e,t){var n=this.value,r=e.field,a=t.changed()||t.modified(r.fields)||e.modified("field"),i=n[0],o=n[1];if((a||null==i)&&(i=1/0,o=-1/0),t.visit(a?t.SOURCE:t.ADD,(function(e){var t=Object(ne.eb)(r(e));null!=t&&(t<i&&(i=t),t>o&&(o=t))})),!Number.isFinite(i)||!Number.isFinite(o)){var u=Object(ne.h)(r);u&&(u=' for field "'.concat(u,'"')),t.dataflow.warn("Infinite extent".concat(u,": [").concat(i,", ").concat(o,"]")),i=o=void 0}this.value=[i,o]}}),Object(ne.z)(oc,Bi,{connect:function(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add:function(e){this.count+=1,this.value.add.push(e)},rem:function(e){this.count-=1,this.value.rem.push(e)},mod:function(e){this.value.mod.push(e)},init:function(e){this.value.init(e,e.NO_SOURCE)},evaluate:function(){return this.value}}),Object(ne.z)(uc,fo,{activate:function(e){this._targets[this._targets.active++]=e},subflow:function(e,t,n,r){var a,i,o=this.value,u=Object(ne.w)(o,e)&&o[e];return u?u.value.stamp<n.stamp&&(u.init(n),this.activate(u)):(i=r||(i=this._group[e])&&i.tuple,a=n.dataflow,u=new oc(n.fork(n.NO_SOURCE),this),a.add(u).connect(t(a,e,i)),o[e]=u,this.activate(u)),u},clean:function(){var e=this.value,t=0;for(var n in e)if(0===e[n].count){var r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){var a=this._targets.filter((function(e){return e&&e.count>0}));this.initTargets(a)}},initTargets:function(e){for(var t=this._targets,n=t.length,r=e?e.length:0,a=0;a<r;++a)t[a]=e[a];for(;a<n&&null!=t[a];++a)t[a]=null;t.active=r},transform:function(e,t){var n=this,r=t.dataflow,a=e.key,i=e.subflow,o=this._keys,u=e.modified("key"),c=function(e){return n.subflow(e,i,t)};return this._group=e.group||{},this.initTargets(),t.visit(t.REM,(function(e){var t=Ei(e),n=o.get(t);void 0!==n&&(o.delete(t),c(n).rem(e))})),t.visit(t.ADD,(function(e){var t=a(e);o.set(Ei(e),t),c(t).add(e)})),u||t.modified(a.fields)?t.visit(t.MOD,(function(e){var t=Ei(e),n=o.get(t),r=a(e);n===r?c(r).mod(e):(o.set(t,r),c(n).rem(e),c(r).add(e))})):t.changed(t.MOD)&&t.visit(t.MOD,(function(e){c(o.get(Ei(e))).mod(e)})),u&&t.visit(t.REFLOW,(function(e){var t=Ei(e),n=o.get(t),r=a(e);n!==r&&(o.set(t,r),c(n).rem(e),c(r).add(e))})),t.clean()?r.runAfter((function(){n.clean(),o.clean()})):o.empty>r.cleanThreshold&&r.runAfter(o.clean),t}}),Object(ne.z)(cc,Bi),lc.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Object(ne.z)(lc,fo,{transform:function(e,t){var n=t.dataflow,r=this.value,a=t.fork(),i=a.add,o=a.rem,u=a.mod,c=e.expr,s=!0;function l(t){var n=Ei(t),a=c(t,e),l=r.get(n);a&&l?(r.delete(n),i.push(t)):a||l?s&&a&&!l&&u.push(t):(r.set(n,1),o.push(t))}return t.visit(t.REM,(function(e){var t=Ei(e);r.has(t)?r.delete(t):o.push(e)})),t.visit(t.ADD,(function(t){c(t,e)?i.push(t):r.set(Ei(t),1)})),t.visit(t.MOD,l),e.modified()&&(s=!1,t.visit(t.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),a}}),fc.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},Object(ne.z)(fc,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,a=ec(r,e.as||[]),i=e.index||null,o=a.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,u,c,s=r.map((function(t){return t(e)})),l=s.reduce((function(e,t){return Math.max(e,t.length)}),0),f=0;f<l;++f){for(u=Ni(e),t=0;t<o;++t)u[a[t]]=null==(c=s[t][f])?null:c;i&&(u[i]=f),n.add.push(u)}})),this.value=n.source=n.add,i&&n.modifies(i),n.modifies(a)}}),dc.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Object(ne.z)(dc,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,a=r.map(ne.h),i=e.as||["key","value"],o=i[0],u=i[1],c=r.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,i=0;i<c;++i)(t=Ni(e))[o]=a[i],t[u]=r[i](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(i)}}),hc.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Object(ne.z)(hc,fo,{transform:function(e,t){var n=e.expr,r=e.as,a=e.modified(),i=e.initonly?t.ADD:a?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return a&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(i,(function(t){return t[r]=n(t,e)}))}}),Object(ne.z)(pc,fo,{transform:function(e,t){var n,r,a,i=t.fork(t.ALL),o=e.generator,u=this.value,c=e.size-u.length;if(c>0){for(n=[];--c>=0;)n.push(a=Ai(o(e))),u.push(a);i.add=i.add.length?i.materialize(i.ADD).add.concat(n):n}else r=u.slice(0,-c),i.rem=i.rem.length?i.materialize(i.REM).rem.concat(r):r,u=u.slice(-c);return i.source=this.value=u,i}});var vc={value:"value",median:Co,mean:function(e,t){var n=0,r=0;if(void 0===t){var a,i=Object(mo.a)(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;null!=o&&(o=+o)>=o&&(++n,r+=o)}}catch(f){i.e(f)}finally{i.f()}}else{var u,c=-1,s=Object(mo.a)(e);try{for(s.s();!(u=s.n()).done;){var l=u.value;null!=(l=t(l,++c,e))&&(l=+l)>=l&&(++n,r+=l)}}catch(f){s.e(f)}finally{s.f()}}if(n)return r/n},min:yo,max:go},mc=[];function bc(e){fo.call(this,[],e)}function gc(e){Bu.call(this,e)}function yc(e){fo.call(this,null,e)}function xc(e){Bi.call(this,null,Oc,e)}function Oc(e){return this.value&&!e.modified()?this.value:Object(ne.K)(e.fields,e.flat)}function kc(e){fo.call(this,[],e),this._pending=null}function wc(e,t,n){n.forEach(Ai);var r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function jc(e){fo.call(this,{},e)}function _c(e){Bi.call(this,null,Sc,e)}function Sc(e){if(this.value&&!e.modified())return this.value;var t,n,r=e.extents,a=r.length,i=1/0,o=-1/0;for(t=0;t<a;++t)(n=r[t])[0]<i&&(i=n[0]),n[1]>o&&(o=n[1]);return[i,o]}function Ec(e){Bi.call(this,null,Cc,e)}function Cc(e){return this.value&&!e.modified()?this.value:e.values.reduce((function(e,t){return e.concat(t)}),[])}function Ac(e){fo.call(this,null,e)}function Nc(e){Bu.call(this,e)}function Tc(e){uc.call(this,e)}function Ic(e){fo.call(this,null,e)}function Dc(e){fo.call(this,null,e)}function Fc(e){fo.call(this,null,e)}bc.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},Object(ne.z)(bc,fo,{transform:function(e,t){var n,r,a,i,o,u,c,s,l,f,d=t.fork(t.ALL),h=function(e){var t,n=e.method||vc.value;if(null!=vc[n])return n===vc.value?(t=void 0!==e.value?e.value:0,function(){return t}):vc[n];Object(ne.o)("Unrecognized imputation method: "+n)}(e),p=function(e){var t=e.field;return function(e){return e?t(e):NaN}}(e),v=Object(ne.h)(e.field),m=Object(ne.h)(e.key),b=(e.groupby||[]).map(ne.h),g=function(e,t,n,r){var a,i,o,u,c,s,l,f,d=function(e){return e(f)},h=[],p=r?r.slice():[],v={},m={};for(p.forEach((function(e,t){return v[e]=t+1})),u=0,l=e.length;u<l;++u)s=n(f=e[u]),c=v[s]||(v[s]=p.push(s)),(o=m[i=(a=t?t.map(d):mc)+""])||(o=m[i]=[],h.push(o),o.values=a),o[c-1]=f;return h.domain=p,h}(t.source,e.groupby,e.key,e.keyvals),y=[],x=this.value,O=g.domain.length;for(o=0,s=g.length;o<s;++o)for(a=(n=g[o]).values,r=NaN,c=0;c<O;++c)if(null==n[c]){for(i=g.domain[c],f={_impute:!0},u=0,l=a.length;u<l;++u)f[b[u]]=a[u];f[m]=i,f[v]=Number.isNaN(r)?r=h(n,p):r,y.push(Ai(f))}return y.length&&(d.add=d.materialize(d.ADD).add.concat(y)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=y,d}}),gc.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Nu},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},Object(ne.z)(gc,Bu,{transform:function(e,t){var n,r=this,a=e.modified();return r.value&&(a||t.modified(r._inputs,!0))?(n=r.value=a?r.init(e):{},t.visit(t.SOURCE,(function(e){return r.add(e)}))):(n=r.value=r.value||this.init(e),t.visit(t.REM,(function(e){return r.rem(e)})),t.visit(t.ADD,(function(e){return r.add(e)}))),r.changes(),t.visit(t.SOURCE,(function(e){Object(ne.p)(e,n[r.cellkey(e)].tuple)})),t.reflow(a).modifies(this._outputs)},changes:function(){var e,t,n=this._adds,r=this._mods;for(e=0,t=this._alen;e<t;++e)this.celltuple(n[e]),n[e]=null;for(e=0,t=this._mlen;e<t;++e)this.celltuple(r[e]),r[e]=null;this._alen=this._mlen=0}}),yc.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},Object(ne.z)(yc,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,a=tc(r,e.groupby,e.field),i=(e.groupby||[]).map(ne.h),o=e.bandwidth,u=e.cumulative?"cdf":"pdf",c=e.as||["value","density"],s=[],l=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==u&&"cdf"!==u&&Object(ne.o)("Invalid density method: "+u),"shared"===e.resolve&&(l||(l=Object(ne.q)(r,e.field)),f=d=e.steps||d),a.forEach((function(t){var n=Yo(t,o)[u],r=e.counts?t.length:1;ku(n,l||Object(ne.q)(t),f,d).forEach((function(e){for(var n={},a=0;a<i.length;++a)n[i[a]]=t.dims[a];n[c[0]]=e[0],n[c[1]]=e[1]*r,s.push(Ai(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}}),Object(ne.z)(xc,Bi),Object(ne.z)(kc,fo,{transform:function(e,t){var n=this,r=t.dataflow;return this._pending?wc(this,t,this._pending):function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e)?t.StopPropagation:e.values?wc(this,t,r.parse(e.values,e.format)):e.async?{async:r.request(e.url,e.format).then((function(e){return n._pending=Object(ne.i)(e.data),function(e){return e.touch(n)}}))}:r.request(e.url,e.format).then((function(e){return wc(n,t,Object(ne.i)(e.data))}))}}),jc.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Object(ne.z)(jc,fo,{transform:function(e,t){var n,r,a=e.fields,i=e.index,o=e.values,u=null==e.default?null:e.default,c=e.modified(),s=a.length,l=c?t.SOURCE:t.ADD,f=t,d=e.as;return o?(r=o.length,s>1&&!d&&Object(ne.o)('Multi-field lookup requires explicit "as" parameter.'),d&&d.length!==s*r&&Object(ne.o)('The "as" parameter has too few output field names.'),d=d||o.map(ne.h),n=function(e){for(var t,n,c=0,l=0;c<s;++c)if(null==(n=i.get(a[c](e))))for(t=0;t<r;++t,++l)e[d[l]]=u;else for(t=0;t<r;++t,++l)e[d[l]]=o[t](n)}):(d||Object(ne.o)("Missing output field names."),n=function(e){for(var t,n=0;n<s;++n)t=i.get(a[n](e)),e[d[n]]=null==t?u:t}),c?f=t.reflow(!0):l|=a.some((function(e){return t.modified(e.fields)}))?t.MOD:0,t.visit(l,n),f.modifies(d)}}),Object(ne.z)(_c,Bi),Object(ne.z)(Ec,Bi),Object(ne.z)(Ac,fo,{transform:function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),Nc.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Nu,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},Object(ne.z)(Nc,Bu,{_transform:Bu.prototype.transform,transform:function(e,t){return this._transform(function(e,t){var n=e.field,r=e.value,a=("count"===e.op?"__count__":e.op)||"sum",i=Object(ne.g)(n).concat(Object(ne.g)(r)),o=function(e,t,n){var r={},a=[];return n.visit(n.SOURCE,(function(t){var n=e(t);r[n]||(r[n]=1,a.push(n))})),a.sort(ne.j),t?a.slice(0,t):a}(n,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:o.map((function(){return a})),fields:o.map((function(e){return function(e,t,n,r){return Object(ne.f)((function(r){return t(r)===e?n(r):NaN}),r,e+"")}(e,n,r,i)})),as:o.map((function(e){return e+""})),modified:e.modified.bind(e)}}(e,t),t)}}),Object(ne.z)(Tc,uc,{transform:function(e,t){var n=this,r=e.subflow,a=e.field,i=function(e){return n.subflow(Ei(e),r,t,e)};return(e.modified("field")||a&&t.modified(Object(ne.g)(a)))&&Object(ne.o)("PreFacet does not support field modification."),this.initTargets(),a?(t.visit(t.MOD,(function(e){var t=i(e);a(e).forEach((function(e){return t.mod(e)}))})),t.visit(t.ADD,(function(e){var t=i(e);a(e).forEach((function(e){return t.add(Ai(e))}))})),t.visit(t.REM,(function(e){var t=i(e);a(e).forEach((function(e){return t.rem(e)}))}))):(t.visit(t.MOD,(function(e){return i(e).mod(e)})),t.visit(t.ADD,(function(e){return i(e).add(e)})),t.visit(t.REM,(function(e){return i(e).rem(e)}))),t.clean()&&t.runAfter((function(){return n.clean()})),t}}),Ic.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Object(ne.z)(Ic,fo,{transform:function(e,t){var n,r=t.fork(t.NO_SOURCE),a=e.fields,i=ec(e.fields,e.as||[]),o=a?function(e,t){return function(e,t,n,r){for(var a=0,i=n.length;a<i;++a)t[r[a]]=n[a](e);return t}(e,t,a,i)}:Ti;return this.value?n=this.value:(t=t.addAll(),n=this.value={}),t.visit(t.REM,(function(e){var t=Ei(e);r.rem.push(n[t]),n[t]=null})),t.visit(t.ADD,(function(e){var t=o(e,Ai({}));n[Ei(e)]=t,r.add.push(t)})),t.visit(t.MOD,(function(e){r.mod.push(o(e,n[Ei(e)]))})),r}}),Object(ne.z)(Dc,fo,{transform:function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),Fc.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function Mc(e){fo.call(this,null,e)}function Rc(e){fo.call(this,[],e),this.count=0}function zc(e){fo.call(this,null,e)}function Lc(e){fo.call(this,null,e),this.modified(!0)}function Pc(e){fo.call(this,null,e)}Object(ne.z)(Fc,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;var a=tc(t.materialize(t.SOURCE).source,e.groupby,e.field),i=(e.groupby||[]).map(ne.h),o=[],u=e.step||.01,c=e.probs||ju(u/2,1-1e-14,u),s=c.length;return a.forEach((function(e){for(var t=To(e,c),n=0;n<s;++n){for(var a={},u=0;u<i.length;++u)a[i[u]]=e.dims[u];a[r[0]]=c[n],a[r[1]]=t[n],o.push(Ai(a))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}}),Object(ne.z)(Mc,fo,{transform:function(e,t){var n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,(function(e){var t=Ei(e);n.rem.push(r[t]),r[t]=null})),t.visit(t.ADD,(function(e){var t=Ni(e);r[Ei(e)]=t,n.add.push(t)})),t.visit(t.MOD,(function(e){var t=r[Ei(e)];for(var a in e)t[a]=e[a],n.modifies(a);n.mod.push(t)}))),n}}),Rc.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Object(ne.z)(Rc,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),a=e.size,i=this.value.reduce((function(e,t){return e[Ei(t)]=1,e}),{}),o=this.value,u=this.count,c=0;function s(e){var t,r;o.length<a?o.push(e):(r=~~((u+1)*Mo()))<o.length&&r>=c&&(t=o[r],i[Ei(t)]&&n.rem.push(t),o[r]=e),++u}if(t.rem.length&&(t.visit(t.REM,(function(e){var t=Ei(e);i[t]&&(i[t]=-1,n.rem.push(e)),--u})),o=o.filter((function(e){return-1!==i[Ei(e)]}))),(t.rem.length||r)&&o.length<a&&t.source&&(c=u=o.length,t.visit(t.SOURCE,(function(e){i[Ei(e)]||s(e)})),c=-1),r&&o.length>a){for(var l=o.length-a,f=0;f<l;++f)i[Ei(o[f])]=-1,n.rem.push(o[f]);o=o.slice(l)}return t.mod.length&&t.visit(t.MOD,(function(e){i[Ei(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,s),(t.add.length||c<0)&&(n.add=o.filter((function(e){return!i[Ei(e)]}))),this.count=u,this.value=n.source=o,n}}),zc.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},Object(ne.z)(zc,fo,{transform:function(e,t){if(!this.value||e.modified()){var n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=ju(e.start,e.stop,e.step||1).map((function(e){var t={};return t[r]=e,Ai(t)})),n.add=t.add.concat(this.value),n}}}),Object(ne.z)(Lc,fo,{transform:function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});var Bc=["unit0","unit1"];function Wc(e){fo.call(this,Object(ne.t)(),e)}function Uc(e){fo.call(this,null,e)}Pc.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Dn,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Bc}]},Object(ne.z)(Pc,fo,{transform:function(e,t){var n=e.field,r=!1!==e.interval,a="utc"===e.timezone,i=this._floor(e,t),o=(a?sr:cr)(i.unit).offset,u=e.as||Bc,c=u[0],s=u[1],l=i.step,f=i.start||1/0,d=i.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Object(ne.g)(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,d=-1/0),t.visit(h,(function(e){var t,a,u=n(e);null==u?(e[c]=null,r&&(e[s]=null)):(e[c]=t=a=i(u),r&&(e[s]=a=o(t,l)),t<f&&(f=t),a>d&&(d=a))})),i.start=f,i.stop=d,t.modifies(r?u:c)},_floor:function(e,t){var n="utc"===e.timezone,r=e.units?{units:e.units,step:e.step||1}:Nr({extent:e.extent||Object(ne.q)(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=r.units,i=r.step,o=Mn(a),u=this.value||{},c=(n?ir:nr)(o,i);return c.unit=Object(ne.W)(o),c.units=o,c.step=i,c.start=u.start,c.stop=u.stop,this.value=c}}),Object(ne.z)(Wc,fo,{transform:function(e,t){var n=t.dataflow,r=e.field,a=this.value,i=function(e){return a.set(r(e),e)},o=!0;return e.modified("field")||t.modified(r.fields)?(a.clear(),t.visit(t.SOURCE,i)):t.changed()?(t.visit(t.REM,(function(e){return a.delete(r(e))})),t.visit(t.ADD,i)):o=!1,this.modified(o),a.empty>n.cleanThreshold&&n.runAfter(a.clean),t.fork()}}),Object(ne.z)(Uc,fo,{transform:function(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Di(e.sort)):t.source).map(e.field))}});var Vc={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=Vc.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){return e=0},next:function(t){var n=t.data,r=t.compare,a=t.index;if(e<a){for(;a+1<n.length&&!r(n[a],n[a+1]);)++a;e=a}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||Object(ne.o)("ntile num must be greater than zero.");var n=Vc.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){return t=+t||1,{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:function(n){var r=n.index+t,a=n.data;return r<a.length?e(a[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){return(t=+t)>0||Object(ne.o)("nth_value nth must be greater than zero."),{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){var t;return{init:function(){return t=null},next:function(n){var r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){var t,n;return{init:function(){return t=null,n=-1},next:function(r){var a=r.data;return r.index<=n?t:(n=function(e,t,n){for(var r=t.length;n<r;++n){if(null!=e(t[n]))return n}return-1}(e,a,r.index))<0?(n=a.length,t=null):t=e(a[n])}}}};var qc=Object.keys(Vc);function Hc(e){var t=Object(ne.i)(e.ops),n=Object(ne.i)(e.fields),r=Object(ne.i)(e.params),a=Object(ne.i)(e.as),i=this.outputs=[],o=this.windows=[],u={},c={},s=[],l=[],f=!0;function d(e){Object(ne.i)(Object(ne.g)(e)).forEach((function(e){return u[e]=1}))}d(e.sort),t.forEach((function(e,t){var u=n[t],h=Object(ne.h)(u),p=Su(e,h,a[t]);if(d(u),i.push(p),Object(ne.w)(Vc,e))o.push(function(e,t,n,r){var a=Vc[e](t,n);return{init:a.init||ne.mb,update:function(e,t){t[r]=a.next(e)}}}(e,n[t],r[t],p));else{if(null==u&&"count"!==e&&Object(ne.o)("Null aggregate field specified."),"count"===e)return void s.push(p);f=!1;var v=c[h];v||((v=c[h]=[]).field=u,l.push(v)),v.push(Tu(e,p))}})),(s.length||l.length)&&(this.cell=function(e,t,n){e=e.map((function(e){return zu(e,e.field)}));var r={num:0,agg:null,store:!1,count:t};if(!n)for(var a=e.length,i=r.agg=Array(a),o=0;o<a;++o)i[o]=new e[o](r);if(r.store)var u=r.data=new Lu;return r.add=function(e){if(r.num+=1,!n){u&&u.add(e);for(var t=0;t<a;++t)i[t].add(i[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){u&&u.rem(e);for(var t=0;t<a;++t)i[t].rem(i[t].get(e),e)}},r.set=function(e){var a,o;for(u&&u.values(),a=0,o=t.length;a<o;++a)e[t[a]]=r.num;if(!n)for(a=0,o=i.length;a<o;++a)i[a].set(e)},r.init=function(){r.num=0,u&&u.reset();for(var e=0;e<a;++e)i[e].init()},r}(l,s,f)),this.inputs=Object.keys(u)}var Gc=Hc.prototype;function Kc(e){fo.call(this,{},e),this._mlen=0,this._mods=[]}function Xc(e,t,n,r){var a=r.sort,i=a&&!r.ignorePeers,o=r.frame||[null,0],u=e.data(n),c=u.length,s=i?On(a):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:a||Object(ne.m)(-1)};t.init();for(var f=0;f<c;++f)Yc(l,o,f,c),i&&$c(l,s),t.update(l,u[f])}function Yc(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function $c(e,t){var n=e.i0,r=e.i1-1,a=e.compare,i=e.data,o=i.length-1;n>0&&!a(i[n],i[n-1])&&(e.i0=t.left(i,i[n])),r<o&&!a(i[r],i[r+1])&&(e.i1=t.right(i,i[r]))}Gc.init=function(){this.windows.forEach((function(e){return e.init()})),this.cell&&this.cell.init()},Gc.update=function(e,t){var n,r=this.cell,a=this.windows,i=e.data,o=a&&a.length;if(r){for(n=e.p0;n<e.i0;++n)r.rem(i[n]);for(n=e.p1;n<e.i1;++n)r.add(i[n]);r.set(t)}for(n=0;n<o;++n)a[n].update(e,t)},Kc.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:qc.concat(Nu)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},Object(ne.z)(Kc,fo,{transform:function(e,t){var n=this;this.stamp=t.stamp;var r=e.modified(),a=Di(e.sort),i=_u(e.groupby),o=function(e){return n.group(i(e))},u=this.state;u&&!r||(u=this.state=new Hc(e)),r||t.modified(u.inputs)?(this.value={},t.visit(t.SOURCE,(function(e){return o(e).add(e)}))):(t.visit(t.REM,(function(e){return o(e).remove(e)})),t.visit(t.ADD,(function(e){return o(e).add(e)})));for(var c=0,s=this._mlen;c<s;++c)Xc(this._mods[c],u,a,e);return this._mlen=0,this._mods=[],t.reflow(r).modifies(u.outputs)},group:function(e){var t=this.value[e];return t||(t=this.value[e]=Uu(Ei),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});var Jc=n(13);function Qc(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Zc(e){this._context=e}Zc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Qc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Qc(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var es=function(){};function ts(e){this._context=e}ts.prototype={areaStart:es,areaEnd:es,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Qc(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ns(e){this._context=e}ns.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Qc(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rs(e,t){this._basis=new Zc(e),this._beta=t}rs.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,a=e[0],i=t[0],o=e[n]-a,u=t[n]-i,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(a+r*o),this._beta*t[c]+(1-this._beta)*(i+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var as=function e(t){function n(e){return 1===t?new Zc(e):new rs(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function is(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function os(e,t){this._context=e,this._k=(1-t)/6}os.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:is(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:is(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var us=function e(t){function n(e){return new os(e,t)}return n.tension=function(t){return e(+t)},n}(0);function cs(e,t){this._context=e,this._k=(1-t)/6}cs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:is(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ss=function e(t){function n(e){return new cs(e,t)}return n.tension=function(t){return e(+t)},n}(0);function ls(e,t){this._context=e,this._k=(1-t)/6}ls.prototype={areaStart:es,areaEnd:es,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:is(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var fs=function e(t){function n(e){return new ls(e,t)}return n.tension=function(t){return e(+t)},n}(0),ds=Math.abs,hs=Math.atan2,ps=Math.cos,vs=Math.max,ms=Math.min,bs=Math.sin,gs=Math.sqrt,ys=1e-12,xs=Math.PI,Os=xs/2,ks=2*xs;function ws(e){return e>1?0:e<-1?xs:Math.acos(e)}function js(e){return e>=1?Os:e<=-1?-Os:Math.asin(e)}function _s(e,t,n){var r=e._x1,a=e._y1,i=e._x2,o=e._y2;if(e._l01_a>ys){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,a=(a*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>ys){var s=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*s+e._x1*e._l23_2a-t*e._l12_2a)/l,o=(o*s+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,a,i,o,e._x2,e._y2)}function Ss(e,t){this._context=e,this._alpha=t}Ss.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:_s(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Es=function e(t){function n(e){return t?new Ss(e,t):new os(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Cs(e,t){this._context=e,this._alpha=t}Cs.prototype={areaStart:es,areaEnd:es,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:_s(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var As=function e(t){function n(e){return t?new Cs(e,t):new ls(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Ns(e,t){this._context=e,this._alpha=t}Ns.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_s(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ts=function e(t){function n(e){return t?new Ns(e,t):new cs(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Is(e){this._context=e}Is.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var Ds=function(e){return new Is(e)};function Fs(e){this._context=e}Fs.prototype={areaStart:es,areaEnd:es,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Ms(e){return e<0?-1:1}function Rs(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),u=(i*a+o*r)/(r+a);return(Ms(i)+Ms(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(u))||0}function zs(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Ls(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,u=(i-r)/3;e._context.bezierCurveTo(r+u,a+u*t,i-u,o-u*n,i,o)}function Ps(e){this._context=e}function Bs(e){this._context=new Ws(e)}function Ws(e){this._context=e}function Us(e){this._context=e}function Vs(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}Ps.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ls(this,this._t0,zs(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ls(this,zs(this,n=Rs(this,e,t)),n);break;default:Ls(this,this._t0,n=Rs(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Bs.prototype=Object.create(Ps.prototype)).point=function(e,t){Ps.prototype.point.call(this,t,e)},Ws.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},Us.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Vs(e),a=Vs(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function qs(e,t){this._context=e,this._t=t}qs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var Hs=Math.PI,Gs=2*Hs,Ks=1e-6,Xs=Gs-Ks;function Ys(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function $s(){return new Ys}Ys.prototype=$s.prototype={constructor:Ys,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,a,i){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+a)+","+(this._y1=+i)},arcTo:function(e,t,n,r,a){e=+e,t=+t,n=+n,r=+r,a=+a;var i=this._x1,o=this._y1,u=n-e,c=r-t,s=i-e,l=o-t,f=s*s+l*l;if(a<0)throw new Error("negative radius: "+a);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Ks)if(Math.abs(l*u-c*s)>Ks&&a){var d=n-i,h=r-o,p=u*u+c*c,v=d*d+h*h,m=Math.sqrt(p),b=Math.sqrt(f),g=a*Math.tan((Hs-Math.acos((p+f-v)/(2*m*b)))/2),y=g/b,x=g/m;Math.abs(y-1)>Ks&&(this._+="L"+(e+y*s)+","+(t+y*l)),this._+="A"+a+","+a+",0,0,"+ +(l*d>s*h)+","+(this._x1=e+x*u)+","+(this._y1=t+x*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,a,i){e=+e,t=+t,i=!!i;var o=(n=+n)*Math.cos(r),u=n*Math.sin(r),c=e+o,s=t+u,l=1^i,f=i?r-a:a-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+s:(Math.abs(this._x1-c)>Ks||Math.abs(this._y1-s)>Ks)&&(this._+="L"+c+","+s),n&&(f<0&&(f=f%Gs+Gs),f>Xs?this._+="A"+n+","+n+",0,1,"+l+","+(e-o)+","+(t-u)+"A"+n+","+n+",0,1,"+l+","+(this._x1=c)+","+(this._y1=s):f>Ks&&(this._+="A"+n+","+n+",0,"+ +(f>=Hs)+","+l+","+(this._x1=e+n*Math.cos(a))+","+(this._y1=t+n*Math.sin(a))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Js=$s,Qs=function(e){return function(){return e}};function Zs(e){return e.innerRadius}function el(e){return e.outerRadius}function tl(e){return e.startAngle}function nl(e){return e.endAngle}function rl(e){return e&&e.padAngle}function al(e,t,n,r,a,i,o,u){var c=n-e,s=r-t,l=o-a,f=u-i,d=f*c-l*s;if(!(d*d<ys))return[e+(d=(l*(t-i)-f*(e-a))/d)*c,t+d*s]}function il(e,t,n,r,a,i,o){var u=e-n,c=t-r,s=(o?i:-i)/gs(u*u+c*c),l=s*c,f=-s*u,d=e+l,h=t+f,p=n+l,v=r+f,m=(d+p)/2,b=(h+v)/2,g=p-d,y=v-h,x=g*g+y*y,O=a-i,k=d*v-p*h,w=(y<0?-1:1)*gs(vs(0,O*O*x-k*k)),j=(k*y-g*w)/x,_=(-k*g-y*w)/x,S=(k*y+g*w)/x,E=(-k*g+y*w)/x,C=j-m,A=_-b,N=S-m,T=E-b;return C*C+A*A>N*N+T*T&&(j=S,_=E),{cx:j,cy:_,x01:-l,y01:-f,x11:j*(a/O-1),y11:_*(a/O-1)}}Array.prototype.slice;var ol=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)};function ul(e){return e[0]}function cl(e){return e[1]}var sl=function(e,t){var n=Qs(!0),r=null,a=Ds,i=null;function o(o){var u,c,s,l=(o=ol(o)).length,f=!1;for(null==r&&(i=a(s=Js())),u=0;u<=l;++u)!(u<l&&n(c=o[u],u,o))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(c,u,o),+t(c,u,o));if(s)return i=null,s+""||null}return e="function"===typeof e?e:void 0===e?ul:Qs(e),t="function"===typeof t?t:void 0===t?cl:Qs(t),o.x=function(t){return arguments.length?(e="function"===typeof t?t:Qs(+t),o):e},o.y=function(e){return arguments.length?(t="function"===typeof e?e:Qs(+e),o):t},o.defined=function(e){return arguments.length?(n="function"===typeof e?e:Qs(!!e),o):n},o.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),o):a},o.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),o):r},o},ll=function(e,t,n){var r=null,a=Qs(!0),i=null,o=Ds,u=null;function c(c){var s,l,f,d,h,p=(c=ol(c)).length,v=!1,m=new Array(p),b=new Array(p);for(null==i&&(u=o(h=Js())),s=0;s<=p;++s){if(!(s<p&&a(d=c[s],s,c))===v)if(v=!v)l=s,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),f=s-1;f>=l;--f)u.point(m[f],b[f]);u.lineEnd(),u.areaEnd()}v&&(m[s]=+e(d,s,c),b[s]=+t(d,s,c),u.point(r?+r(d,s,c):m[s],n?+n(d,s,c):b[s]))}if(h)return u=null,h+""||null}function s(){return sl().defined(a).curve(o).context(i)}return e="function"===typeof e?e:void 0===e?ul:Qs(+e),t="function"===typeof t?t:Qs(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?cl:Qs(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:Qs(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:Qs(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:Qs(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:Qs(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:Qs(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:Qs(+e),c):n},c.lineX0=c.lineY0=function(){return s().x(e).y(t)},c.lineY1=function(){return s().x(e).y(n)},c.lineX1=function(){return s().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"===typeof e?e:Qs(!!e),c):a},c.curve=function(e){return arguments.length?(o=e,null!=i&&(u=o(i)),c):o},c.context=function(e){return arguments.length?(null==e?i=u=null:u=o(i=e),c):i},c},fl={draw:function(e,t){var n=Math.sqrt(t/xs);e.moveTo(n,0),e.arc(0,0,n,0,ks)}},dl=(Math.sqrt(1/3),Math.sin(xs/10)/Math.sin(7*xs/10));Math.sin(ks/10),Math.cos(ks/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12);function hl(e,t){if("undefined"!==typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}var pl=function(){return"undefined"!==typeof Image?Image:null},vl=On(xn),ml=vl.right,bl=vl.left,gl=(On(wo).center,ml);function yl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function xl(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}var Ol=Symbol("implicit");function kl(){var e=new Map,t=[],n=[],r=Ol;function a(a){var i=a+"",o=e.get(i);if(!o){if(r!==Ol)return r;e.set(i,o=t.push(a))}return n[(o-1)%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;var r,i=Object(mo.a)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,u=o+"";e.has(u)||e.set(u,t.push(o))}}catch(c){i.e(c)}finally{i.f()}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return kl(t,n).unknown(r)},yl.apply(a,arguments),a}var wl=n(86);function jl(e,t,n,r){var a,i=Ze(e,t,n);switch((r=Object(wl.formatSpecifier)(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=Object(wl.precisionPrefix)(i,o))||(r.precision=a),Object(wl.formatPrefix)(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=Object(wl.precisionRound)(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=Object(wl.precisionFixed)(i))||(r.precision=a-2*("%"===r.type))}return Object(wl.format)(r)}var _l=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function Sl(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function El(){}var Cl=.7,Al=1/Cl,Nl="\\s*([+-]?\\d+)\\s*",Tl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Il="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Dl=/^#([0-9a-f]{3,8})$/,Fl=new RegExp("^rgb\\("+[Nl,Nl,Nl]+"\\)$"),Ml=new RegExp("^rgb\\("+[Il,Il,Il]+"\\)$"),Rl=new RegExp("^rgba\\("+[Nl,Nl,Nl,Tl]+"\\)$"),zl=new RegExp("^rgba\\("+[Il,Il,Il,Tl]+"\\)$"),Ll=new RegExp("^hsl\\("+[Tl,Il,Il]+"\\)$"),Pl=new RegExp("^hsla\\("+[Tl,Il,Il,Tl]+"\\)$"),Bl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Wl(){return this.rgb().formatHex()}function Ul(){return this.rgb().formatRgb()}function Vl(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Dl.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?ql(t):3===n?new Xl(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Hl(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Hl(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Fl.exec(e))?new Xl(t[1],t[2],t[3],1):(t=Ml.exec(e))?new Xl(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Rl.exec(e))?Hl(t[1],t[2],t[3],t[4]):(t=zl.exec(e))?Hl(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ll.exec(e))?Ql(t[1],t[2]/100,t[3]/100,1):(t=Pl.exec(e))?Ql(t[1],t[2]/100,t[3]/100,t[4]):Bl.hasOwnProperty(e)?ql(Bl[e]):"transparent"===e?new Xl(NaN,NaN,NaN,0):null}function ql(e){return new Xl(e>>16&255,e>>8&255,255&e,1)}function Hl(e,t,n,r){return r<=0&&(e=t=n=NaN),new Xl(e,t,n,r)}function Gl(e){return e instanceof El||(e=Vl(e)),e?new Xl((e=e.rgb()).r,e.g,e.b,e.opacity):new Xl}function Kl(e,t,n,r){return 1===arguments.length?Gl(e):new Xl(e,t,n,null==r?1:r)}function Xl(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Yl(){return"#"+Jl(this.r)+Jl(this.g)+Jl(this.b)}function $l(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function Jl(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Ql(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new tf(e,t,n,r)}function Zl(e){if(e instanceof tf)return new tf(e.h,e.s,e.l,e.opacity);if(e instanceof El||(e=Vl(e)),!e)return new tf;if(e instanceof tf)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,u=i-a,c=(i+a)/2;return u?(o=t===i?(n-r)/u+6*(n<r):n===i?(r-t)/u+2:(t-n)/u+4,u/=c<.5?i+a:2-i-a,o*=60):u=c>0&&c<1?0:o,new tf(o,u,c,e.opacity)}function ef(e,t,n,r){return 1===arguments.length?Zl(e):new tf(e,t,n,null==r?1:r)}function tf(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function nf(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function rf(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}_l(El,Vl,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Wl,formatHex:Wl,formatHsl:function(){return Zl(this).formatHsl()},formatRgb:Ul,toString:Ul}),_l(Xl,Kl,Sl(El,{brighter:function(e){return e=null==e?Al:Math.pow(Al,e),new Xl(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?Cl:Math.pow(Cl,e),new Xl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Yl,formatHex:Yl,formatRgb:$l,toString:$l})),_l(tf,ef,Sl(El,{brighter:function(e){return e=null==e?Al:Math.pow(Al,e),new tf(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Cl:Math.pow(Cl,e),new tf(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Xl(nf(e>=240?e-240:e+120,a,r),nf(e,a,r),nf(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var af=function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,u=r<t-1?e[r+2]:2*i-a;return rf((n-r/t)*t,o,a,i,u)}},of=function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return rf((n-r/t)*t,a,i,o,u)}},uf=function(e){return function(){return e}};function cf(e,t){return function(n){return e+n*t}}function sf(e,t){var n=t-e;return n?cf(e,n>180||n<-180?n-360*Math.round(n/360):n):uf(isNaN(e)?t:e)}function lf(e){return 1===(e=+e)?ff:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):uf(isNaN(t)?n:t)}}function ff(e,t){var n=t-e;return n?cf(e,n):uf(isNaN(e)?t:e)}var df=function e(t){var n=lf(t);function r(e,t){var r=n((e=Kl(e)).r,(t=Kl(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=ff(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function hf(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),u=new Array(a);for(n=0;n<a;++n)r=Kl(t[n]),i[n]=r.r||0,o[n]=r.g||0,u[n]=r.b||0;return i=e(i),o=e(o),u=e(u),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=u(e),r+""}}}var pf=hf(af),vf=hf(of),mf=function(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}};function bf(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var gf=function(e,t){return(bf(t)?mf:yf)(e,t)};function yf(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=Sf(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}var xf=function(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}},Of=function(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}},kf=function(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Sf(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}},wf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jf=new RegExp(wf.source,"g");var _f=function(e,t){var n,r,a,i=wf.lastIndex=jf.lastIndex=0,o=-1,u=[],c=[];for(e+="",t+="";(n=wf.exec(e))&&(r=jf.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),u[o]?u[o]+=a:u[++o]=a),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,c.push({i:o,x:Of(n,r)})),i=jf.lastIndex;return i<t.length&&(a=t.slice(i),u[o]?u[o]+=a:u[++o]=a),u.length<2?c[0]?function(e){return function(t){return e(t)+""}}(c[0].x):function(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,r=0;r<t;++r)u[(n=c[r]).i]=n.x(e);return u.join("")})},Sf=function(e,t){var n,r=typeof t;return null==t||"boolean"===r?uf(t):("number"===r?Of:"string"===r?(n=Vl(t))?(t=n,df):_f:t instanceof Vl?df:t instanceof Date?xf:bf(t)?mf:Array.isArray(t)?yf:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?kf:Of)(e,t)},Ef=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}};function Cf(e){return+e}var Af=[0,1];function Nf(e){return e}function Tf(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function If(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=Tf(a,r),i=n(o,i)):(r=Tf(r,a),i=n(i,o)),function(e){return i(r(e))}}function Df(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=Tf(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=gl(e,t,1,r)-1;return i[n](a[n](t))}}function Ff(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Mf(){var e,t,n,r,a,i,o=Af,u=Af,c=Sf,s=Nf;function l(){var e=Math.min(o.length,u.length);return s!==Nf&&(s=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?Df:If,a=i=null,f}function f(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),u,c)))(e(s(t)))}return f.invert=function(n){return s(t((i||(i=r(u,o.map(e),Of)))(n)))},f.domain=function(e){return arguments.length?(o=Array.from(e,Cf),l()):o.slice()},f.range=function(e){return arguments.length?(u=Array.from(e),l()):u.slice()},f.rangeRound=function(e){return u=Array.from(e),c=Ef,l()},f.clamp=function(e){return arguments.length?(s=!!e||Nf,l()):s!==Nf},f.interpolate=function(e){return arguments.length?(c=e,l()):c},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,l()}}function Rf(){return Mf()(Nf,Nf)}function zf(e){var t=e.domain;return e.ticks=function(e){var n=t();return Je(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return jl(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,u=i.length-1,c=i[o],s=i[u],l=10;for(s<c&&(a=c,c=s,s=a,a=o,o=u,u=a);l-- >0;){if((a=Qe(c,s,n))===r)return i[o]=c,i[u]=s,t(i);if(a>0)c=Math.floor(c/a)*a,s=Math.ceil(s/a)*a;else{if(!(a<0))break;c=Math.ceil(c*a)/a,s=Math.floor(s*a)/a}r=a}return e},e}function Lf(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function Pf(e){return Math.log(e)}function Bf(e){return Math.exp(e)}function Wf(e){return-Math.log(-e)}function Uf(e){return-Math.exp(-e)}function Vf(e){return isFinite(e)?+("1e"+e):e<0?0:e}function qf(e){return function(t){return-e(-t)}}function Hf(e){var t,n,r=e(Pf,Bf),a=r.domain,i=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(i),n=function(e){return 10===e?Vf:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(i),a()[0]<0?(t=qf(t),n=qf(n),e(Wf,Uf)):e(Pf,Bf),r}return r.base=function(e){return arguments.length?(i=+e,o()):i},r.domain=function(e){return arguments.length?(a(e),o()):a()},r.ticks=function(e){var r,o=a(),u=o[0],c=o[o.length-1];(r=c<u)&&(d=u,u=c,c=d);var s,l,f,d=t(u),h=t(c),p=null==e?10:+e,v=[];if(!(i%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),u>0){for(;d<=h;++d)for(l=1,s=n(d);l<i;++l)if(!((f=s*l)<u)){if(f>c)break;v.push(f)}}else for(;d<=h;++d)for(l=i-1,s=n(d);l>=1;--l)if(!((f=s*l)<u)){if(f>c)break;v.push(f)}2*v.length<p&&(v=Je(u,c,p))}else v=Je(d,h,Math.min(h-d,p)).map(n);return r?v.reverse():v},r.tickFormat=function(e,a){if(null==a&&(a=10===i?".0e":","),"function"!==typeof a&&(a=Object(wl.format)(a)),e===1/0)return a;null==e&&(e=10);var o=Math.max(1,i*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=o?a(e):""}},r.nice=function(){return a(Lf(a(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function Gf(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Kf(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Xf(e){return e<0?-e*e:e*e}function Yf(e){var t=e(Nf,Nf),n=1;function r(){return 1===n?e(Nf,Nf):.5===n?e(Kf,Xf):e(Gf(n),Gf(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},zf(t)}function $f(){var e=Yf(Mf());return e.copy=function(){return Ff(e,$f()).exponent(e.exponent())},yl.apply(e,arguments),e}function Jf(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Qf(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Zf(e){var t=1,n=e(Jf(t),Qf(t));return n.constant=function(n){return arguments.length?e(Jf(t=+n),Qf(t)):t},zf(n)}function ed(e,t,n,r,a,i){var o=[[tn,1,yt],[tn,5,5e3],[tn,15,15e3],[tn,30,3e4],[i,1,xt],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,Ot],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,kt],[r,2,1728e5],[n,1,wt],[t,1,jt],[t,3,7776e6],[e,1,_t]];function u(t,n,r){var a=Math.abs(n-t)/r,i=On((function(e){return Object(bo.a)(e,3)[2]})).right(o,a);if(i===o.length)return e.every(Ze(t/_t,n/_t,r));if(0===i)return rn.every(Math.max(Ze(t,n,r),1));var u=Object(bo.a)(o[a/o[i-1][2]<o[i][2]/a?i-1:i],2),c=u[0],s=u[1];return c.every(s)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:u(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},u]}var td=ed(hn,vn,Pt,zt,bn,yn),nd=Object(bo.a)(td,2),rd=nd[0],ad=nd[1],id=ed(Kt,Yt,At,Et,Jt,Zt),od=Object(bo.a)(id,2),ud=od[0],cd=od[1];function sd(e){return new Date(e)}function ld(e){return e instanceof Date?+e:+new Date(+e)}function fd(e,t,n,r,a,i,o,u,c,s){var l=Rf(),f=l.invert,d=l.domain,h=s(".%L"),p=s(":%S"),v=s("%I:%M"),m=s("%I %p"),b=s("%a %d"),g=s("%b %d"),y=s("%B"),x=s("%Y");function O(e){return(c(e)<e?h:u(e)<e?p:o(e)<e?v:i(e)<e?m:r(e)<e?a(e)<e?b:g:n(e)<e?y:x)(e)}return l.invert=function(e){return new Date(f(e))},l.domain=function(e){return arguments.length?d(Array.from(e,ld)):d().map(sd)},l.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?O:s(t)},l.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(Lf(n,e)):l},l.copy=function(){return Ff(l,fd(e,t,n,r,a,i,o,u,c,s))},l}function dd(){var e,t,n,r,a,i=0,o=1,u=Nf,c=!1;function s(t){return null==t||isNaN(t=+t)?a:u(0===n?.5:(t=(r(t)-e)*n,c?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,r,a,i;return arguments.length?(n=t,a=(r=Object(bo.a)(n,2))[0],i=r[1],u=e(a,i),s):[u(0),u(1)]}}return s.domain=function(a){var u,c;return arguments.length?(u=a,c=Object(bo.a)(u,2),i=c[0],o=c[1],e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),s):[i,o]},s.clamp=function(e){return arguments.length?(c=!!e,s):c},s.interpolator=function(e){return arguments.length?(u=e,s):u},s.range=l(Sf),s.rangeRound=l(Ef),s.unknown=function(e){return arguments.length?(a=e,s):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),s}}function hd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function pd(){var e=zf(dd()(Nf));return e.copy=function(){return hd(e,pd())},xl.apply(e,arguments)}function vd(){var e=Yf(dd());return e.copy=function(){return hd(e,vd()).exponent(e.exponent())},xl.apply(e,arguments)}function md(e,t){void 0===t&&(t=e,e=Sf);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}function bd(){var e,t,n,r,a,i,o,u=0,c=.5,s=1,l=1,f=Nf,d=!1;function h(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(l*e<l*t?r:a),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a,i,o;return arguments.length?(n=t,a=(r=Object(bo.a)(n,3))[0],i=r[1],o=r[2],f=md(e,[a,i,o]),h):[f(0),f(.5),f(1)]}}return h.domain=function(o){var f,d;return arguments.length?(f=o,d=Object(bo.a)(f,3),u=d[0],c=d[1],s=d[2],e=i(u=+u),t=i(c=+c),n=i(s=+s),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h):[u,c,s]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(Sf),h.rangeRound=p(Ef),h.unknown=function(e){return arguments.length?(o=e,h):o},function(o){return i=o,e=o(u),t=o(c),n=o(s),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h}}function gd(){var e=Yf(bd());return e.copy=function(){return hd(e,gd()).exponent(e.exponent())},xl.apply(e,arguments)}var yd,xd=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},Od=function(e,t){var n=sf(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},kd=180/Math.PI,wd={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},jd=function(e,t,n,r,a,i){var o,u,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,c/=u),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*kd,skewX:Math.atan(c)*kd,scaleX:o,scaleY:u}};function _d(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(i,o){var u=[],c=[];return i=e(i),o=e(o),function(e,r,a,i,o,u){if(e!==a||r!==i){var c=o.push("translate(",null,t,null,n);u.push({i:c-4,x:Of(e,a)},{i:c-2,x:Of(r,i)})}else(a||i)&&o.push("translate("+a+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,u,c),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:Of(e,t)})):t&&n.push(a(n)+"rotate("+t+r)}(i.rotate,o.rotate,u,c),function(e,t,n,i){e!==t?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:Of(e,t)}):t&&n.push(a(n)+"skewX("+t+r)}(i.skewX,o.skewX,u,c),function(e,t,n,r,i,o){if(e!==n||t!==r){var u=i.push(a(i)+"scale(",null,",",null,")");o.push({i:u-4,x:Of(e,n)},{i:u-2,x:Of(t,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,u,c),i=o=null,function(e){for(var t,n=-1,r=c.length;++n<r;)u[(t=c[n]).i]=t.x(e);return u.join("")}}}var Sd=_d((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?wd:jd(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Ed=_d((function(e){return null==e?wd:(yd||(yd=document.createElementNS("http://www.w3.org/2000/svg","g")),yd.setAttribute("transform",e),(e=yd.transform.baseVal.consolidate())?(e=e.matrix,jd(e.a,e.b,e.c,e.d,e.e,e.f)):wd)}),", ",")",")");function Cd(e){return((e=Math.exp(e))+1/e)/2}var Ad=function e(t,n,r){function a(e,a){var i,o,u=e[0],c=e[1],s=e[2],l=a[0],f=a[1],d=a[2],h=l-u,p=f-c,v=h*h+p*p;if(v<1e-12)o=Math.log(d/s)/t,i=function(e){return[u+e*h,c+e*p,s*Math.exp(t*e*o)]};else{var m=Math.sqrt(v),b=(d*d-s*s+r*v)/(2*s*n*m),g=(d*d-s*s-r*v)/(2*d*n*m),y=Math.log(Math.sqrt(b*b+1)-b),x=Math.log(Math.sqrt(g*g+1)-g);o=(x-y)/t,i=function(e){var r,a=e*o,i=Cd(y),l=s/(n*m)*(i*(r=t*a+y,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(y));return[u+l*h,c+l*p,s*i/Cd(t*a+y)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4);function Nd(e){return function(t,n){var r=e((t=ef(t)).h,(n=ef(n)).h),a=ff(t.s,n.s),i=ff(t.l,n.l),o=ff(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var Td=Nd(sf),Id=Nd(ff),Dd=Math.PI/180,Fd=180/Math.PI,Md=.96422,Rd=.82521,zd=4/29,Ld=6/29,Pd=3*Ld*Ld;function Bd(e){if(e instanceof Ud)return new Ud(e.l,e.a,e.b,e.opacity);if(e instanceof Yd)return $d(e);e instanceof Xl||(e=Gl(e));var t,n,r=Gd(e.r),a=Gd(e.g),i=Gd(e.b),o=Vd((.2225045*r+.7168786*a+.0606169*i)/1);return r===a&&a===i?t=n=o:(t=Vd((.4360747*r+.3850649*a+.1430804*i)/Md),n=Vd((.0139322*r+.0971045*a+.7141733*i)/Rd)),new Ud(116*o-16,500*(t-o),200*(o-n),e.opacity)}function Wd(e,t,n,r){return 1===arguments.length?Bd(e):new Ud(e,t,n,null==r?1:r)}function Ud(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Vd(e){return e>.008856451679035631?Math.pow(e,1/3):e/Pd+zd}function qd(e){return e>Ld?e*e*e:Pd*(e-zd)}function Hd(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Gd(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Kd(e){if(e instanceof Yd)return new Yd(e.h,e.c,e.l,e.opacity);if(e instanceof Ud||(e=Bd(e)),0===e.a&&0===e.b)return new Yd(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Fd;return new Yd(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Xd(e,t,n,r){return 1===arguments.length?Kd(e):new Yd(e,t,n,null==r?1:r)}function Yd(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function $d(e){if(isNaN(e.h))return new Ud(e.l,0,0,e.opacity);var t=e.h*Dd;return new Ud(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function Jd(e,t){var n=ff((e=Wd(e)).l,(t=Wd(t)).l),r=ff(e.a,t.a),a=ff(e.b,t.b),i=ff(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=a(t),e.opacity=i(t),e+""}}function Qd(e){return function(t,n){var r=e((t=Xd(t)).h,(n=Xd(n)).h),a=ff(t.c,n.c),i=ff(t.l,n.l),o=ff(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=a(e),t.l=i(e),t.opacity=o(e),t+""}}}_l(Ud,Wd,Sl(El,{brighter:function(e){return new Ud(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Ud(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Xl(Hd(3.1338561*(t=Md*qd(t))-1.6168667*(e=1*qd(e))-.4906146*(n=Rd*qd(n))),Hd(-.9787684*t+1.9161415*e+.033454*n),Hd(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),_l(Yd,Xd,Sl(El,{brighter:function(e){return new Yd(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Yd(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return $d(this).rgb()}}));var Zd=Qd(sf),eh=Qd(ff),th=-.14861,nh=1.78277,rh=-.29227,ah=-.90649,ih=1.97294,oh=-1.7884503806,uh=3.5172982438,ch=-.6557636667999999;function sh(e){if(e instanceof fh)return new fh(e.h,e.s,e.l,e.opacity);e instanceof Xl||(e=Gl(e));var t=e.r/255,n=e.g/255,r=e.b/255,a=(ch*r+oh*t-uh*n)/(ch+oh-uh),i=r-a,o=(ih*(n-a)-rh*i)/ah,u=Math.sqrt(o*o+i*i)/(ih*a*(1-a)),c=u?Math.atan2(o,i)*Fd-120:NaN;return new fh(c<0?c+360:c,u,a,e.opacity)}function lh(e,t,n,r){return 1===arguments.length?sh(e):new fh(e,t,n,null==r?1:r)}function fh(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function dh(e){return function t(n){function r(t,r){var a=e((t=lh(t)).h,(r=lh(r)).h),i=ff(t.s,r.s),o=ff(t.l,r.l),u=ff(t.opacity,r.opacity);return function(e){return t.h=a(e),t.s=i(e),t.l=o(Math.pow(e,n)),t.opacity=u(e),t+""}}return n=+n,r.gamma=t,r}(1)}_l(fh,lh,Sl(El,{brighter:function(e){return e=null==e?Al:Math.pow(Al,e),new fh(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Cl:Math.pow(Cl,e),new fh(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Dd,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),a=Math.sin(e);return new Xl(255*(t+n*(th*r+nh*a)),255*(t+n*(rh*r+ah*a)),255*(t+n*(ih*r)),this.opacity)}}));var hh,ph,vh=dh(sf),mh=dh(ff),bh=function(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n};function gh(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}var yh="linear",xh="log",Oh="pow",kh="sqrt",wh="symlog",jh="time",_h="utc",Sh="sequential",Eh="diverging",Ch="quantile",Ah="quantize",Nh="threshold",Th="ordinal",Ih="point",Dh="band",Fh="bin-ordinal",Mh="continuous",Rh="discrete",zh="discretizing",Lh="interpolating",Ph="temporal";function Bh(){var e,t,n=kl().unknown(void 0),r=n.domain,a=n.range,i=[0,1],o=!1,u=0,c=0,s=.5;function l(){var n=r().length,l=i[1]<i[0],f=i[1-l],d=gh(n,u,c),h=i[l-0];e=(f-h)/(d||1),o&&(e=Math.floor(e)),h+=(f-h-e*(n-u))*s,t=e*(1-u),o&&(h=Math.round(h),t=Math.round(t));var p=ju(n).map((function(t){return h+e*t}));return a(l?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),l()):r()},n.range=function(e){return arguments.length?(i=[+e[0],+e[1]],l()):i.slice()},n.rangeRound=function(e){return i=[+e[0],+e[1]],o=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,l()):o},n.padding=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),u=c,l()):u},n.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.paddingOuter=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c},n.align=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),l()):s},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,o,u,c=i[1]<i[0],s=c?a().reverse():a(),l=s.length-1,f=+e[0],d=+e[1];if(f===f&&d===d&&(d<f&&(u=f,f=d,d=u),!(d<s[0]||f>i[1-c])))return n=Math.max(0,ml(s,f)-1),o=f===d?n:ml(s,d)-1,f-s[n]>t+1e-10&&++n,c&&(u=n,n=l-o,o=l-u),n>o?void 0:r().slice(n,o+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return Bh().domain(r()).range(i).round(o).paddingInner(u).paddingOuter(c).align(s)},l()}function Wh(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return Wh(t())},e}var Uh=Array.prototype.map;function Vh(e){return Uh.call(e,ne.eb)}var qh=Array.prototype.slice;var Hh={};function Gh(e,t,n){var r=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],a=t[1];return a<r&&(n=r,r=a,a=n),[e.invert(r),e.invert(a)]}}(n):n.invertExtent?function(e){return function(t){var n,r,a,i,o=e.range(),u=t[0],c=t[1],s=-1;for(c<u&&(r=u,u=c,c=r),a=0,i=o.length;a<i;++a)o[a]>=u&&o[a]<=c&&(s<0&&(s=a),n=a);if(!(s<0))return u=e.invertExtent(o[s]),c=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===c[1]?c[0]:c[1]]}}(n):void 0),n.type=e,n};return r.metadata=Object(ne.fb)(Object(ne.i)(n)),r}function Kh(e,t,n){return arguments.length>1?(Hh[e]=Gh(e,t,n),this):Xh(e)?Hh[e]:void 0}function Xh(e){return Object(ne.w)(Hh,e)}function Yh(e,t){var n=Hh[e];return n&&n.metadata[t]}function $h(e){return Yh(e,Mh)}function Jh(e){return Yh(e,Rh)}function Qh(e){return Yh(e,zh)}function Zh(e){return Yh(e,xh)}function ep(e){return Yh(e,Lh)}function tp(e){return Yh(e,Ch)}Kh("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,Cf),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,Cf):[0,1],zf(r)})),Kh(yh,(function e(){var t=Rf();return t.copy=function(){return Ff(t,e())},yl.apply(t,arguments),zf(t)}),Mh),Kh(xh,(function e(){var t=Hf(Mf()).domain([1,10]);return t.copy=function(){return Ff(t,e()).base(t.base())},yl.apply(t,arguments),t}),[Mh,xh]),Kh(Oh,$f,Mh),Kh(kh,(function(){return $f.apply(null,arguments).exponent(.5)}),Mh),Kh(wh,(function e(){var t=Zf(Mf());return t.copy=function(){return Ff(t,e()).constant(t.constant())},yl.apply(t,arguments)}),Mh),Kh(jh,(function(){return yl.apply(fd(ud,cd,Kt,Yt,At,Et,Jt,Zt,tn,Rr).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[Mh,Ph]),Kh(_h,(function(){return yl.apply(fd(rd,ad,hn,vn,Pt,zt,bn,yn,tn,Lr).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[Mh,Ph]),Kh(Sh,pd,[Mh,Lh]),Kh("".concat(Sh,"-").concat(yh),pd,[Mh,Lh]),Kh("".concat(Sh,"-").concat(xh),(function e(){var t=Hf(dd()).domain([1,10]);return t.copy=function(){return hd(t,e()).base(t.base())},xl.apply(t,arguments)}),[Mh,Lh,xh]),Kh("".concat(Sh,"-").concat(Oh),vd,[Mh,Lh]),Kh("".concat(Sh,"-").concat(kh),(function(){return vd.apply(null,arguments).exponent(.5)}),[Mh,Lh]),Kh("".concat(Sh,"-").concat(wh),(function e(){var t=Zf(dd());return t.copy=function(){return hd(t,e()).constant(t.constant())},xl.apply(t,arguments)}),[Mh,Lh]),Kh("".concat(Eh,"-").concat(yh),(function e(){var t=zf(bd()(Nf));return t.copy=function(){return hd(t,e())},xl.apply(t,arguments)}),[Mh,Lh]),Kh("".concat(Eh,"-").concat(xh),(function e(){var t=Hf(bd()).domain([.1,1,10]);return t.copy=function(){return hd(t,e()).base(t.base())},xl.apply(t,arguments)}),[Mh,Lh,xh]),Kh("".concat(Eh,"-").concat(Oh),gd,[Mh,Lh]),Kh("".concat(Eh,"-").concat(kh),(function(){return gd.apply(null,arguments).exponent(.5)}),[Mh,Lh]),Kh("".concat(Eh,"-").concat(wh),(function e(){var t=Zf(bd());return t.copy=function(){return hd(t,e()).constant(t.constant())},xl.apply(t,arguments)}),[Mh,Lh]),Kh(Ch,(function e(){var t,n=[],r=[],a=[];function i(){var e=0,t=Math.max(1,r.length);for(a=new Array(t-1);++e<t;)a[e-1]=So(n,e/t);return o}function o(e){return null==e||isNaN(e=+e)?t:r[gl(a,e)]}return o.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?a[t-1]:n[0],t<a.length?a[t]:n[n.length-1]]},o.domain=function(e){if(!arguments.length)return n.slice();n=[];var t,r=Object(mo.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null==a||isNaN(a=+a)||n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n.sort(xn),i()},o.range=function(e){return arguments.length?(r=Array.from(e),i()):r.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return a.slice()},o.copy=function(){return e().domain(n).range(r).unknown(t)},yl.apply(o,arguments)}),[zh,Ch]),Kh(Ah,(function e(){var t,n=0,r=1,a=1,i=[.5],o=[0,1];function u(e){return null!=e&&e<=e?o[gl(i,e,0,a)]:t}function c(){var e=-1;for(i=new Array(a);++e<a;)i[e]=((e+1)*r-(e-a)*n)/(a+1);return u}return u.domain=function(e){var t,a;return arguments.length?(t=e,a=Object(bo.a)(t,2),n=a[0],r=a[1],n=+n,r=+r,c()):[n,r]},u.range=function(e){return arguments.length?(a=(o=Array.from(e)).length-1,c()):o.slice()},u.invertExtent=function(e){var t=o.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,i[0]]:t>=a?[i[a-1],r]:[i[t-1],i[t]]},u.unknown=function(e){return arguments.length?(t=e,u):u},u.thresholds=function(){return i.slice()},u.copy=function(){return e().domain([n,r]).range(o).unknown(t)},yl.apply(zf(u),arguments)}),zh),Kh(Nh,(function e(){var t,n=[.5],r=[0,1],a=1;function i(e){return null!=e&&e<=e?r[gl(n,e,0,a)]:t}return i.domain=function(e){return arguments.length?(n=Array.from(e),a=Math.min(n.length,r.length-1),i):n.slice()},i.range=function(e){return arguments.length?(r=Array.from(e),a=Math.min(n.length,r.length-1),i):r.slice()},i.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e().domain(n).range(r).unknown(t)},yl.apply(i,arguments)}),zh),Kh(Fh,(function e(){var t=[],n=[];function r(e){return null==e||e!==e?void 0:n[(gl(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=Vh(e),r):t.slice()},r.range=function(e){return arguments.length?(n=qh.call(e),r):n.slice()},r.tickFormat=function(e,n){return jl(t[0],Object(ne.W)(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[Rh,zh]),Kh(Th,kl,Rh),Kh(Dh,Bh,Rh),Kh(Ih,(function(){return Wh(Bh().paddingInner(1))}),Rh);var np=["clamp","base","constant","exponent"];function rp(e,t){var n=t[0],r=Object(ne.W)(t)-n;return function(t){return e(n+t*r)}}function ap(e,t,n){return md(up(t||"rgb",n),e)}function ip(e,t){for(var n=new Array(t),r=t+1,a=0;a<t;)n[a]=e(++a/r);return n}function op(e,t,n){var r,a,i,o=n-t;return o&&Number.isFinite(o)?(r=(a=e.type).indexOf("-"),a=r<0?a:a.slice(r+1),i=Kh(a)().domain([t,n]).range([0,1]),np.forEach((function(t){return e[t]?i[t](e[t]()):0})),i):Object(ne.m)(.5)}function up(e,t){var n=o[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function cp(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function sp(e,t){for(var n in e)fp(n,t(e[n]))}var lp={};function fp(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(lp[e]=t,this):lp[e]}sp({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},cp),sp({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(function(e){return ap(cp(e))}));var dp="symbol",hp=function(e){return Object(ne.B)(e)?e.map((function(e){return String(e)})):String(e)},pp=function(e,t){return e[1]-t[1]},vp=function(e,t){return t[1]-e[1]};function mp(e,t,n){var r;return Object(ne.G)(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Object(ne.Z)(e.domain())/n||1)))),Object(ne.H)(t)&&(r=t.step,t=t.interval),Object(ne.J)(t)&&(t=e.type===jh?cr(t):e.type==_h?sr(t):Object(ne.o)("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function bp(e,t,n){var r=e.range(),a=r[0],i=Object(ne.W)(r),o=pp;if(a>i&&(r=i,i=a,a=r,o=vp),a=Math.floor(a),i=Math.ceil(i),t=t.map((function(t){return[t,e(t)]})).filter((function(e){return a<=e[1]&&e[1]<=i})).sort(o).map((function(e){return e[0]})),n>0&&t.length>1){for(var u=[t[0],Object(ne.W)(t)];t.length>n&&t.length>=3;)t=t.filter((function(e,t){return!(t%2)}));t.length<3&&(t=u)}return t}function gp(e,t){return e.bins?bp(e,e.bins):e.ticks?e.ticks(t):e.domain()}function yp(e,t,n,r,a,i){var o=t.type,u=hp;if(o===jh||a===jh)u=e.timeFormat(r);else if(o===_h||a===_h)u=e.utcFormat(r);else if(Zh(o)){var c=e.formatFloat(r);if(i||t.bins)u=c;else{var s=xp(t,n,!1);u=function(e){return s(e)?c(e):""}}}else if(t.tickFormat){var l=t.domain();u=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(u=e.format(r));return u}function xp(e,t,n){var r=gp(e,t),a=e.base(),i=Math.log(a),o=Math.max(1,a*t/r.length),u=function(e){var t=e/Math.pow(a,Math.round(Math.log(e)/i));return t*a<a-.5&&(t*=a),t<=o};return n?r.filter(u):u}var Op=(hh={},Object(vt.a)(hh,Ch,"quantiles"),Object(vt.a)(hh,Ah,"thresholds"),Object(vt.a)(hh,Nh,"domain"),hh),kp=(ph={},Object(vt.a)(ph,Ch,"quantiles"),Object(vt.a)(ph,Ah,"domain"),ph);function wp(e,t){return e.bins?function(e){var t=e.slice(0,-1);return t.max=Object(ne.W)(e),t}(e.bins):e.type===xh?xp(e,t,!0):Op[e.type]?function(e){var t=[-1/0].concat(e);return t.max=1/0,t}(e[Op[e.type]]()):gp(e,t)}function jp(e,t,n,r,a,i,o){var u=kp[t.type]&&i!==jh&&i!==_h?function(e,t,n){var r,a=t[kp[t.type]](),i=a.length,o=i>1?a[1]-a[0]:a[0];for(r=1;r<i;++r)o=Math.min(o,a[r]-a[r-1]);return e.formatSpan(0,o,30,n)}(e,t,a):yp(e,t,n,a,i,o);return r===dp&&function(e){return Op[e.type]||e.bins}(t)?_p(u):"discrete"===r?Ep(u):Cp(u)}var _p=function(e){return function(t,n,r){var a=Sp(r[n+1],Sp(r.max,1/0)),i=Ap(t,e),o=Ap(a,e);return i&&o?i+" \u2013 "+o:o?"< "+o:"\u2265 "+i}},Sp=function(e,t){return null!=e?e:t},Ep=function(e){return function(t,n){return n?e(t):null}},Cp=function(e){return function(t){return e(t)}},Ap=function(e,t){return Number.isFinite(e)?t(e):null};function Np(e,t,n,r){var a=r||t.type;return Object(ne.J)(n)&&Yh(a,Ph)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||a!==jh?n||a!==_h?jp(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function Tp(e,t,n){n=n||{};var r=Math.max(3,n.maxlen||7),a=Np(e,t,n.format,n.formatType);if(Qh(t.type)){var i=wp(t).slice(1).map(a),o=i.length;return"".concat(o," boundar").concat(1===o?"y":"ies",": ").concat(i.join(", "))}if(Jh(t.type)){var u=t.domain(),c=u.length,s=c>r?u.slice(0,r-2).map(a).join(", ")+", ending with "+u.slice(-1).map(a):u.map(a).join(", ");return"".concat(c," value").concat(1===c?"":"s",": ").concat(s)}var l=t.domain();return"values from ".concat(a(l[0])," to ").concat(a(Object(ne.W)(l)))}var Ip=0;var Dp="p_";function Fp(e){return e&&e.gradient}function Mp(e,t,n){var r=e.gradient,a=e.id,i="radial"===r?Dp:"";return a||(a=e.id="gradient_"+Ip++,"radial"===r?(e.x1=Rp(e.x1,.5),e.y1=Rp(e.y1,.5),e.r1=Rp(e.r1,0),e.x2=Rp(e.x2,.5),e.y2=Rp(e.y2,.5),e.r2=Rp(e.r2,.5),i=Dp):(e.x1=Rp(e.x1,0),e.y1=Rp(e.y1,0),e.x2=Rp(e.x2,1),e.y2=Rp(e.y2,0))),t[a]=e,"url("+(n||"")+"#"+i+a+")"}function Rp(e,t){return null!=e?e:t}function zp(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}var Lp={basis:{curve:function(e){return new Zc(e)}},"basis-closed":{curve:function(e){return new ts(e)}},"basis-open":{curve:function(e){return new ns(e)}},bundle:{curve:as,tension:"beta",value:.85},cardinal:{curve:us,tension:"tension",value:0},"cardinal-open":{curve:ss,tension:"tension",value:0},"cardinal-closed":{curve:fs,tension:"tension",value:0},"catmull-rom":{curve:Es,tension:"alpha",value:.5},"catmull-rom-closed":{curve:As,tension:"alpha",value:.5},"catmull-rom-open":{curve:Ts,tension:"alpha",value:.5},linear:{curve:Ds},"linear-closed":{curve:function(e){return new Fs(e)}},monotone:{horizontal:function(e){return new Bs(e)},vertical:function(e){return new Ps(e)}},natural:{curve:function(e){return new Us(e)}},step:{curve:function(e){return new qs(e,.5)}},"step-after":{curve:function(e){return new qs(e,1)}},"step-before":{curve:function(e){return new qs(e,0)}}};function Pp(e,t,n){var r=Object(ne.w)(Lp,e)&&Lp[e],a=null;return r&&(a=r.curve||r[t||"vertical"],r.tension&&null!=n&&(a=a[r.tension](n))),a}var Bp={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Wp=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Up(e){var t,n,r,a,i,o,u,c,s,l,f=[],d=e.slice().replace(Wp[0],"###$1").split(Wp[1]).slice(1);for(u=0,s=d.length;u<s;++u){for(n=(t=d[u]).slice(1).trim().replace(Wp[2],"$1###$2").replace(Wp[3],"$1###$2").split(Wp[4]),r=[i=t.charAt(0)],c=0,l=n.length;c<l;++c)(a=+n[c])===a&&r.push(a);if(o=Bp[i.toLowerCase()],r.length-1>o){var h=r.length;for(c=1,f.push([i].concat(r.slice(c,c+=o))),i="M"===i?"L":"m"===i?"l":i;c<h;c+=o)f.push([i].concat(r.slice(c,c+o)))}else f.push(r)}return f}var Vp=Math.PI/180,qp=Math.PI/2,Hp=2*Math.PI,Gp=Math.sqrt(3)/2,Kp={},Xp={},Yp=[].join;function $p(e){var t=Yp.call(e);if(Xp[t])return Xp[t];var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],c=e[6],s=e[7],l=s*o,f=-c*u,d=c*o,h=s*u,p=Math.cos(a),v=Math.sin(a),m=Math.cos(i),b=Math.sin(i),g=.5*(i-a),y=Math.sin(.5*g),x=8/3*y*y/Math.sin(g),O=n+p-x*v,k=r+v+x*p,w=n+m,j=r+b,_=w+x*b,S=j-x*m;return Xp[t]=[l*O+f*k,d*O+h*k,l*_+f*S,d*_+h*S,l*w+f*j,d*w+h*j]}var Jp=["l",0,0,0,0,0,0,0];function Qp(e,t,n){var r=Jp[0]=e[0];if("a"===r||"A"===r)Jp[1]=t*e[1],Jp[2]=n*e[2],Jp[3]=e[3],Jp[4]=e[4],Jp[5]=e[5],Jp[6]=t*e[6],Jp[7]=n*e[7];else if("h"===r||"H"===r)Jp[1]=t*e[1];else if("v"===r||"V"===r)Jp[1]=n*e[1];else for(var a=1,i=e.length;a<i;++a)Jp[a]=(a%2==1?t:n)*e[a];return Jp}function Zp(e,t,n,r,a,i){var o,u,c,s,l,f=null,d=0,h=0,p=0,v=0;null==n&&(n=0),null==r&&(r=0),null==a&&(a=1),null==i&&(i=a),e.beginPath&&e.beginPath();for(var m=0,b=t.length;m<b;++m){switch(o=t[m],1===a&&1===i||(o=Qp(o,a,i)),o[0]){case"l":d+=o[1],h+=o[2],e.lineTo(d+n,h+r);break;case"L":d=o[1],h=o[2],e.lineTo(d+n,h+r);break;case"h":d+=o[1],e.lineTo(d+n,h+r);break;case"H":d=o[1],e.lineTo(d+n,h+r);break;case"v":h+=o[1],e.lineTo(d+n,h+r);break;case"V":h=o[1],e.lineTo(d+n,h+r);break;case"m":d+=o[1],h+=o[2],e.moveTo(d+n,h+r);break;case"M":d=o[1],h=o[2],e.moveTo(d+n,h+r);break;case"c":u=d+o[5],c=h+o[6],p=d+o[3],v=h+o[4],e.bezierCurveTo(d+o[1]+n,h+o[2]+r,p+n,v+r,u+n,c+r),d=u,h=c;break;case"C":d=o[5],h=o[6],p=o[3],v=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,p+n,v+r,d+n,h+r);break;case"s":u=d+o[3],c=h+o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,d+o[1]+n,h+o[2]+r,u+n,c+r),p=d+o[1],v=h+o[2],d=u,h=c;break;case"S":u=o[3],c=o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,o[1]+n,o[2]+r,u+n,c+r),d=u,h=c,p=o[1],v=o[2];break;case"q":u=d+o[3],c=h+o[4],p=d+o[1],v=h+o[2],e.quadraticCurveTo(p+n,v+r,u+n,c+r),d=u,h=c;break;case"Q":u=o[3],c=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,u+n,c+r),d=u,h=c,p=o[1],v=o[2];break;case"t":u=d+o[1],c=h+o[2],null===f[0].match(/[QqTt]/)?(p=d,v=h):"t"===f[0]?(p=2*d-s,v=2*h-l):"q"===f[0]&&(p=2*d-p,v=2*h-v),s=p,l=v,e.quadraticCurveTo(p+n,v+r,u+n,c+r),h=c,p=(d=u)+o[1],v=h+o[2];break;case"T":u=o[1],c=o[2],p=2*d-p,v=2*h-v,e.quadraticCurveTo(p+n,v+r,u+n,c+r),d=u,h=c;break;case"a":ev(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+h+r]),d+=o[6],h+=o[7];break;case"A":ev(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],h=o[7];break;case"z":case"Z":e.closePath()}f=o}}function ev(e,t,n,r){for(var a=function(e,t,n,r,a,i,o,u,c){var s=Yp.call(arguments);if(Kp[s])return Kp[s];var l=o*Vp,f=Math.sin(l),d=Math.cos(l),h=d*(u-e)*.5+f*(c-t)*.5,p=d*(c-t)*.5-f*(u-e)*.5,v=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var m=d/n,b=f/n,g=-f/r,y=d/r,x=m*u+b*c,O=g*u+y*c,k=m*e+b*t,w=g*e+y*t,j=1/((k-x)*(k-x)+(w-O)*(w-O))-.25;j<0&&(j=0);var _=Math.sqrt(j);i==a&&(_=-_);var S=.5*(x+k)-_*(w-O),E=.5*(O+w)+_*(k-x),C=Math.atan2(O-E,x-S),A=Math.atan2(w-E,k-S)-C;A<0&&1===i?A+=Hp:A>0&&0===i&&(A-=Hp);for(var N=Math.ceil(Math.abs(A/(qp+.001))),T=[],I=0;I<N;++I){var D=C+I*A/N,F=C+(I+1)*A/N;T[I]=[S,E,D,F,n,r,f,d]}return Kp[s]=T}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n),i=0;i<a.length;++i){var o=$p(a[i]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var tv=.5773502691896257,nv={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Hp)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,a=n/2.5,i=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-i),e.lineTo(a,-i),e.lineTo(0,-n),e.lineTo(-a,-i),e.lineTo(-r,-i),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Gp*n,a=r-n*tv,i=n/4;e.moveTo(0,-r-a),e.lineTo(-i,r-a),e.lineTo(i,r-a),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Gp*n,a=r-n*tv;e.moveTo(0,-r-a),e.lineTo(-n,r-a),e.lineTo(n,r-a),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Gp*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Gp*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Gp*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Gp*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function rv(e){return Object(ne.w)(nv,e)?nv[e]:function(e){if(!Object(ne.w)(av,e)){var t=Up(e);av[e]={draw:function(e,n){Zp(e,t,0,0,Math.sqrt(n)/2)}}}return av[e]}(e)}var av={};var iv=.448084975506;function ov(e){return e.x}function uv(e){return e.y}function cv(e){return e.width}function sv(e){return e.height}function lv(e){return"function"===typeof e?e:function(){return+e}}function fv(e,t,n){return Math.max(t,Math.min(e,n))}function dv(){var e=ov,t=uv,n=cv,r=sv,a=lv(0),i=a,o=a,u=a,c=null;function s(s,l,f){var d,h=null!=l?l:+e.call(this,s),p=null!=f?f:+t.call(this,s),v=+n.call(this,s),m=+r.call(this,s),b=Math.min(v,m)/2,g=fv(+a.call(this,s),0,b),y=fv(+i.call(this,s),0,b),x=fv(+o.call(this,s),0,b),O=fv(+u.call(this,s),0,b);if(c||(c=d=Js()),g<=0&&y<=0&&x<=0&&O<=0)c.rect(h,p,v,m);else{var k=h+v,w=p+m;c.moveTo(h+g,p),c.lineTo(k-y,p),c.bezierCurveTo(k-iv*y,p,k,p+iv*y,k,p+y),c.lineTo(k,w-O),c.bezierCurveTo(k,w-iv*O,k-iv*O,w,k-O,w),c.lineTo(h+x,w),c.bezierCurveTo(h+iv*x,w,h,w-iv*x,h,w-x),c.lineTo(h,p+g),c.bezierCurveTo(h,p+iv*g,h+iv*g,p,h+g,p),c.closePath()}if(d)return c=null,d+""||null}return s.x=function(t){return arguments.length?(e=lv(t),s):e},s.y=function(e){return arguments.length?(t=lv(e),s):t},s.width=function(e){return arguments.length?(n=lv(e),s):n},s.height=function(e){return arguments.length?(r=lv(e),s):r},s.cornerRadius=function(e,t,n,r){return arguments.length?(a=lv(e),i=null!=t?lv(t):a,u=null!=n?lv(n):a,o=null!=r?lv(r):i,s):a},s.context=function(e){return arguments.length?(c=null==e?null:e,s):c},s}function hv(){var e,t,n,r,a,i,o,u,c=null;function s(e,t,n){var r=n/2;if(a){var s=o-t,l=e-i;if(s||l){var f=Math.sqrt(s*s+l*l),d=(s/=f)*u,h=(l/=f)*u,p=Math.atan2(l,s);c.moveTo(i-d,o-h),c.lineTo(e-s*r,t-l*r),c.arc(e,t,r,p-Math.PI,p),c.lineTo(i+d,o+h),c.arc(i,o,u,p,p+Math.PI)}else c.arc(e,t,r,0,Hp);c.closePath()}else a=1;i=e,o=t,u=r}function l(i){var o,u,l,f=i.length,d=!1;for(null==c&&(c=l=Js()),o=0;o<=f;++o)!(o<f&&r(u=i[o],o,i))===d&&(d=!d)&&(a=0),d&&s(+e(u,o,i),+t(u,o,i),+n(u,o,i));if(l)return c=null,l+""||null}return l.x=function(t){return arguments.length?(e=t,l):e},l.y=function(e){return arguments.length?(t=e,l):t},l.size=function(e){return arguments.length?(n=e,l):n},l.defined=function(e){return arguments.length?(r=e,l):r},l.context=function(e){return arguments.length?(c=null==e?null:e,l):c},l}function pv(e,t){return null!=e?e:t}var vv=function(e){return e.x||0},mv=function(e){return e.y||0},bv=function(e){return!(!1===e.defined)},gv=function(){var e=Zs,t=el,n=Qs(0),r=null,a=tl,i=nl,o=rl,u=null;function c(){var c,s,l=+e.apply(this,arguments),f=+t.apply(this,arguments),d=a.apply(this,arguments)-Os,h=i.apply(this,arguments)-Os,p=ds(h-d),v=h>d;if(u||(u=c=Js()),f<l&&(s=f,f=l,l=s),f>ys)if(p>ks-ys)u.moveTo(f*ps(d),f*bs(d)),u.arc(0,0,f,d,h,!v),l>ys&&(u.moveTo(l*ps(h),l*bs(h)),u.arc(0,0,l,h,d,v));else{var m,b,g=d,y=h,x=d,O=h,k=p,w=p,j=o.apply(this,arguments)/2,_=j>ys&&(r?+r.apply(this,arguments):gs(l*l+f*f)),S=ms(ds(f-l)/2,+n.apply(this,arguments)),E=S,C=S;if(_>ys){var A=js(_/l*bs(j)),N=js(_/f*bs(j));(k-=2*A)>ys?(x+=A*=v?1:-1,O-=A):(k=0,x=O=(d+h)/2),(w-=2*N)>ys?(g+=N*=v?1:-1,y-=N):(w=0,g=y=(d+h)/2)}var T=f*ps(g),I=f*bs(g),D=l*ps(O),F=l*bs(O);if(S>ys){var M,R=f*ps(y),z=f*bs(y),L=l*ps(x),P=l*bs(x);if(p<xs&&(M=al(T,I,L,P,R,z,D,F))){var B=T-M[0],W=I-M[1],U=R-M[0],V=z-M[1],q=1/bs(ws((B*U+W*V)/(gs(B*B+W*W)*gs(U*U+V*V)))/2),H=gs(M[0]*M[0]+M[1]*M[1]);E=ms(S,(l-H)/(q-1)),C=ms(S,(f-H)/(q+1))}}w>ys?C>ys?(m=il(L,P,T,I,f,C,v),b=il(R,z,D,F,f,C,v),u.moveTo(m.cx+m.x01,m.cy+m.y01),C<S?u.arc(m.cx,m.cy,C,hs(m.y01,m.x01),hs(b.y01,b.x01),!v):(u.arc(m.cx,m.cy,C,hs(m.y01,m.x01),hs(m.y11,m.x11),!v),u.arc(0,0,f,hs(m.cy+m.y11,m.cx+m.x11),hs(b.cy+b.y11,b.cx+b.x11),!v),u.arc(b.cx,b.cy,C,hs(b.y11,b.x11),hs(b.y01,b.x01),!v))):(u.moveTo(T,I),u.arc(0,0,f,g,y,!v)):u.moveTo(T,I),l>ys&&k>ys?E>ys?(m=il(D,F,R,z,l,-E,v),b=il(T,I,L,P,l,-E,v),u.lineTo(m.cx+m.x01,m.cy+m.y01),E<S?u.arc(m.cx,m.cy,E,hs(m.y01,m.x01),hs(b.y01,b.x01),!v):(u.arc(m.cx,m.cy,E,hs(m.y01,m.x01),hs(m.y11,m.x11),!v),u.arc(0,0,l,hs(m.cy+m.y11,m.cx+m.x11),hs(b.cy+b.y11,b.cx+b.x11),v),u.arc(b.cx,b.cy,E,hs(b.y11,b.x11),hs(b.y01,b.x01),!v))):u.arc(0,0,l,O,x,v):u.lineTo(D,F)}else u.moveTo(0,0);if(u.closePath(),c)return u=null,c+""||null}return c.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-xs/2;return[ps(r)*n,bs(r)*n]},c.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:Qs(+t),c):e},c.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:Qs(+e),c):t},c.cornerRadius=function(e){return arguments.length?(n="function"===typeof e?e:Qs(+e),c):n},c.padRadius=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:Qs(+e),c):r},c.startAngle=function(e){return arguments.length?(a="function"===typeof e?e:Qs(+e),c):a},c.endAngle=function(e){return arguments.length?(i="function"===typeof e?e:Qs(+e),c):i},c.padAngle=function(e){return arguments.length?(o="function"===typeof e?e:Qs(+e),c):o},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c}().startAngle((function(e){return e.startAngle||0})).endAngle((function(e){return e.endAngle||0})).padAngle((function(e){return e.padAngle||0})).innerRadius((function(e){return e.innerRadius||0})).outerRadius((function(e){return e.outerRadius||0})).cornerRadius((function(e){return e.cornerRadius||0})),yv=ll().x(vv).y1(mv).y0((function(e){return(e.y||0)+(e.height||0)})).defined(bv),xv=ll().y(mv).x1(vv).x0((function(e){return(e.x||0)+(e.width||0)})).defined(bv),Ov=sl().x(vv).y(mv).defined(bv),kv=dv().x(vv).y(mv).width((function(e){return e.width||0})).height((function(e){return e.height||0})).cornerRadius((function(e){return pv(e.cornerRadiusTopLeft,e.cornerRadius)||0}),(function(e){return pv(e.cornerRadiusTopRight,e.cornerRadius)||0}),(function(e){return pv(e.cornerRadiusBottomRight,e.cornerRadius)||0}),(function(e){return pv(e.cornerRadiusBottomLeft,e.cornerRadius)||0})),wv=function(e,t){var n=null;function r(){var r;if(n||(n=r=Js()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"===typeof e?e:Qs(e||fl),t="function"===typeof t?t:Qs(void 0===t?64:+t),r.type=function(t){return arguments.length?(e="function"===typeof t?t:Qs(t),r):e},r.size=function(e){return arguments.length?(t="function"===typeof e?e:Qs(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r}().type((function(e){return rv(e.shape||"circle")})).size((function(e){return pv(e.size,64)})),jv=hv().x(vv).y(mv).defined(bv).size((function(e){return e.size||1}));function _v(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Sv(e,t,n,r){return kv.context(e)(t,n,r)}var Ev=1;function Cv(){Ev=1}function Av(e,t,n){var r=t.clip,a=e._defs,i=t.clip_id||(t.clip_id="clip"+Ev++),o=a.clipping[i]||(a.clipping[i]={id:i});return Object(ne.E)(r)?o.path=r(null):_v(n)?o.path=Sv(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+i+")"}function Nv(e){this.clear(),e&&this.union(e)}function Tv(e){this.mark=e,this.bounds=this.bounds||new Nv}function Iv(e){Tv.call(this,e),this.items=this.items||[]}function Dv(e){this._pending=0,this._loader=e||xi()}function Fv(e){e._pending+=1}function Mv(e){e._pending-=1}function Rv(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){var r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}Nv.prototype={clone:function(){return new Nv(this)},clear:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals:function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set:function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add:function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand:function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale:function(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate:function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate:function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints:function(e,t,n){var r=this.x1,a=this.y1,i=this.x2,o=this.y2,u=Math.cos(e),c=Math.sin(e),s=t-t*u+n*c,l=n-t*c-n*u;return[u*r-c*a+s,c*r+u*a+l,u*r-c*o+s,c*r+u*o+l,u*i-c*a+s,c*i+u*a+l,u*i-c*o+s,c*i+u*o+l]},union:function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect:function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses:function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith:function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects:function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains:function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1}},Object(ne.z)(Iv,Tv),Dv.prototype={pending:function(){return this._pending},sanitizeURL:function(e){var t=this;return Fv(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return Mv(t),e})).catch((function(){return Mv(t),null}))},loadImage:function(e){var t=this,n=pl();return Fv(t),t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var a=new n,i=Object(ne.w)(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=i&&(a.crossOrigin=i),a.onload=function(){return Mv(t)},a.onerror=function(){return Mv(t)},a.src=r,a})).catch((function(e){return Mv(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},ready:function(){var e=this;return new Promise((function(t){!function n(r){e.pending()?setTimeout((function(){n(!0)}),10):t(r)}(!1)}))}};var zv,Lv,Pv,Bv,Wv,Uv,Vv,qv,Hv=Hp-1e-8,Gv=function(e,t){return zv.add(e,t)},Kv=function(e,t){return Gv(Lv=e,Pv=t)},Xv=function(e){return Gv(e,zv.y1)},Yv=function(e){return Gv(zv.x1,e)},$v=function(e,t){return Wv*e+Vv*t},Jv=function(e,t){return Uv*e+qv*t},Qv=function(e,t){return Gv($v(e,t),Jv(e,t))},Zv=function(e,t){return Kv($v(e,t),Jv(e,t))};function em(e,t){return zv=e,t?(Bv=t*Vp,Wv=qv=Math.cos(Bv),Uv=Math.sin(Bv),Vv=-Uv):(Wv=qv=1,Bv=Uv=Vv=0),tm}var tm={beginPath:function(){},closePath:function(){},moveTo:Zv,lineTo:Zv,rect:function(e,t,n,r){Bv?(Qv(e+n,t),Qv(e+n,t+r),Qv(e,t+r),Zv(e,t)):(Gv(e+n,t+r),Kv(e,t))},quadraticCurveTo:function(e,t,n,r){var a=$v(e,t),i=Jv(e,t),o=$v(n,r),u=Jv(n,r);nm(Lv,a,o,Xv),nm(Pv,i,u,Yv),Kv(o,u)},bezierCurveTo:function(e,t,n,r,a,i){var o=$v(e,t),u=Jv(e,t),c=$v(n,r),s=Jv(n,r),l=$v(a,i),f=Jv(a,i);rm(Lv,o,c,l,Xv),rm(Pv,u,s,f,Yv),Kv(l,f)},arc:function(e,t,n,r,a,i){if(r+=Bv,a+=Bv,Lv=n*Math.cos(a)+e,Pv=n*Math.sin(a)+t,Math.abs(a-r)>Hv)Gv(e-n,t-n),Gv(e+n,t+n);else{var o,u,c=function(r){return Gv(n*Math.cos(r)+e,n*Math.sin(r)+t)};if(c(r),c(a),a!==r)if((r%=Hp)<0&&(r+=Hp),(a%=Hp)<0&&(a+=Hp),a<r&&(i=!i,o=r,r=a,a=o),i)for(a-=Hp,o=r-r%qp,u=0;u<4&&o>a;++u,o-=qp)c(o);else for(o=r-r%qp+qp,u=0;u<4&&o<a;++u,o+=qp)c(o)}}};function nm(e,t,n,r){var a=(e-t)/(e+n-2*t);0<a&&a<1&&r(e+(t-e)*a)}function rm(e,t,n,r,a){var i,o=r-e+3*t-3*n,u=e+n-2*t,c=e-t,s=0,l=0;Math.abs(o)>1e-14?(i=u*u+c*o)>=0&&(s=(-u+(i=Math.sqrt(i)))/o,l=(-u-i)/o):s=.5*c/u,0<s&&s<1&&a(am(s,e,t,n,r)),0<l&&l<1&&a(am(l,e,t,n,r))}function am(e,t,n,r,a){var i=1-e,o=i*i,u=e*e;return o*i*t+3*o*e*n+3*i*u*r+u*e*a}var im=(im=hl(1,1))?im.getContext("2d"):null,om=new Nv;function um(e){return function(t,n){if(!im)return!0;e(im,t),om.clear().union(t.bounds).intersect(n).round();for(var r=om.x1,a=om.y1,i=om.x2,o=om.y2,u=a;u<=o;++u)for(var c=r;c<=i;++c)if(im.isPointInPath(c,u))return!0;return!1}}function cm(e,t){return t.contains(e.x||0,e.y||0)}function sm(e,t){var n=e.x||0,r=e.y||0,a=e.width||0,i=e.height||0;return t.intersects(om.set(n,r,n+a,r+i))}function lm(e,t){var n=e.x||0,r=e.y||0;return fm(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function fm(e,t,n,r,a){var i,o,u,c,s=e.x1,l=e.y1,f=e.x2,d=e.y2,h=r-t,p=a-n,v=0,m=1;for(c=0;c<4;++c){if(0===c&&(i=-h,o=-(s-t)),1===c&&(i=h,o=f-t),2===c&&(i=-p,o=-(l-n)),3===c&&(i=p,o=d-n),Math.abs(i)<1e-10&&o<0)return!1;if(u=o/i,i<0){if(u>m)return!1;u>v&&(v=u)}else if(i>0){if(u<v)return!1;u<m&&(m=u)}}return!0}function dm(e,t){e.globalCompositeOperation=t.blend||"source-over"}function hm(e,t){return null==e?t:e}function pm(e,t){for(var n=t.length,r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function vm(e,t,n){return Fp(n)?function(e,t,n){var r,a=n.width(),i=n.height();if("radial"===t.gradient)r=e.createRadialGradient(n.x1+hm(t.x1,.5)*a,n.y1+hm(t.y1,.5)*i,Math.max(a,i)*hm(t.r1,0),n.x1+hm(t.x2,.5)*a,n.y1+hm(t.y2,.5)*i,Math.max(a,i)*hm(t.r2,.5));else{var o=hm(t.x1,0),u=hm(t.y1,0),c=hm(t.x2,1),s=hm(t.y2,0);if(o!==c&&u!==s&&a!==i){var l=hl(Math.ceil(a),Math.ceil(i)),f=l.getContext("2d");return f.scale(a,i),f.fillStyle=pm(f.createLinearGradient(o,u,c,s),t.stops),f.fillRect(0,0,a,i),e.createPattern(l,"no-repeat")}r=e.createLinearGradient(n.x1+o*a,n.y1+u*i,n.x1+c*a,n.y1+s*i)}return pm(r,t.stops)}(e,n,t.bounds):n}function mm(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=vm(e,t,t.fill),!0)}var bm=[];function gm(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=vm(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||bm),e.lineDashOffset=t.strokeDashOffset||0),!0))}function ym(e,t){return e.zindex-t.zindex||e.index-t.index}function xm(e){if(!e.zdirty)return e.zitems;var t,n,r,a=e.items,i=[];for(n=0,r=a.length;n<r;++n)(t=a[n]).index=n,t.zindex&&i.push(t);return e.zdirty=!1,e.zitems=i.sort(ym)}function Om(e,t){var n,r,a=e.items;if(a&&a.length){var i=xm(e);if(i&&i.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||t(a[n]);a=i}for(n=0,r=a.length;n<r;++n)t(a[n])}}function km(e,t){var n,r,a=e.items;if(!a||!a.length)return null;var i=xm(e);for(i&&i.length&&(a=i),r=a.length;--r>=0;)if(n=t(a[r]))return n;if(a===i)for(r=(a=e.items).length;--r>=0;)if(!a[r].zindex&&(n=t(a[r])))return n;return null}function wm(e){return function(t,n,r){Om(n,(function(n){r&&!r.intersects(n.bounds)||jm(e,t,n,n)}))}}function jm(e,t,n,r){var a=null==n.opacity?1:n.opacity;0!==a&&(e(t,r)||(dm(t,n),n.fill&&mm(t,n,a)&&t.fill(),n.stroke&&gm(t,n,a)&&t.stroke()))}function _m(e){return e=e||ne.ib,function(t,n,r,a,i,o){return r*=t.pixelRatio,a*=t.pixelRatio,km(n,(function(n){var u=n.bounds;if((!u||u.contains(i,o))&&u)return e(t,n,r,a,i,o)?n:void 0}))}}function Sm(e,t){return function(n,r,a,i){var o,u,c=Array.isArray(r)?r[0]:r,s=null==t?c.fill:t,l=c.stroke&&n.isPointInStroke;return l&&(o=c.strokeWidth,u=c.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!e(n,r)&&(s&&n.isPointInPath(a,i)||l&&n.isPointInStroke(a,i))}}function Em(e){return _m(Sm(e))}function Cm(e,t){return"translate("+e+","+t+")"}function Am(e){return"rotate("+e+")"}function Nm(e){return Cm(e.x||0,e.y||0)}function Tm(e,t,n){function r(e,n){var r=n.x||0,a=n.y||0,i=n.angle||0;e.translate(r,a),i&&e.rotate(i*=Vp),e.beginPath(),t(e,n),i&&e.rotate(-i),e.translate(-r,-a)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return Cm(e.x||0,e.y||0)+(e.angle?" "+Am(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(em(e,n.angle),n),Rv(e,n).translate(n.x||0,n.y||0)},draw:wm(r),pick:Em(r),isect:n||um(r)}}var Im=Tm("arc",(function(e,t){return gv.context(e)(t)}));function Dm(e,t,n){function r(e,n){e.beginPath(),t(e,n)}var a,i=Sm(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(em(e),r),Rv(e,r[0]))},draw:(a=r,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||jm(a,e,t.items[0],t.items)}),pick:function(e,t,n,r,a,o){var u=t.items,c=t.bounds;return!u||!u.length||c&&!c.contains(a,o)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,u,n,r)?u[0]:null)},isect:cm,tip:n}}var Fm=Dm("area",(function(e,t){var n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?xv:yv).curve(Pp(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",o=e.length,u=1/0;--o>=0;)!1!==e[o].defined&&(r=Math.abs(e[o][i]-a))<u&&(u=r,n=e[o]);return n}));function Mm(e,t){e.beginPath(),_v(t)?Sv(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Rm(e){var t=hm(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function zm(e,t){var n=Rm(t);e("d",Sv(null,t,n,n))}function Lm(e,t,n,r){var a=Rm(t);e.beginPath(),Sv(e,t,(n||0)+a,(r||0)+a)}var Pm=Sm(Lm),Bm=Sm(Lm,!1),Wm=Sm(Lm,!0);var Um={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",Nm(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,r=n.length,a=0;a<r;++a)e.union(n[a].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Rv(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){var r=this;Om(t,(function(t){var a=t.x||0,i=t.y||0,o=t.strokeForeground,u=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&u&&(Lm(e,t,a,i),dm(e,t),t.fill&&mm(e,t,u)&&e.fill(),t.stroke&&!o&&gm(e,t,u)&&e.stroke()),e.save(),e.translate(a,i),t.clip&&Mm(e,t),n&&n.translate(-a,-i),Om(t,(function(t){r.draw(e,t,n)})),n&&n.translate(a,i),e.restore(),o&&t.stroke&&u&&(Lm(e,t,a,i),dm(e,t),gm(e,t,u)&&e.stroke())}))},pick:function(e,t,n,r,a,i){var o=this;if(t.bounds&&!t.bounds.contains(a,i)||!t.items)return null;var u=n*e.pixelRatio,c=r*e.pixelRatio;return km(t,(function(s){var l,f,d,h=s.bounds;if(!h||h.contains(a,i)){f=s.x||0,d=s.y||0;var p=f+(s.width||0),v=d+(s.height||0),m=s.clip;if(!m||!(a<f||a>p||i<d||i>v)){if(e.save(),e.translate(f,d),f=a-f,d=i-d,m&&_v(s)&&!Wm(e,s,u,c))return e.restore(),null;var b=s.strokeForeground,g=!1!==t.interactive;return g&&b&&s.stroke&&Bm(e,s,u,c)?(e.restore(),s):(!(l=km(s,(function(e){return function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,f,d)?o.pick(e,n,r,f,d):null})))&&g&&(s.fill||!b&&s.stroke)&&Pm(e,s,u,c)&&(l=s),e.restore(),l||null)}}}))},isect:sm,content:function(e,t,n){e("clip-path",t.clip?Av(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),zm(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?zm(e,t):e("d","")}},Vm={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function qm(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((function(t){e.image=t,e.image.url=e.url}))),n}function Hm(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function Gm(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function Km(e,t){return"center"===e?t/2:"right"===e?t:0}function Xm(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var Ym={type:"image",tag:"image",nested:!1,attr:function(e,t,n){var r=qm(t,n),a=Hm(t,r),i=Gm(t,r),o=(t.x||0)-Km(t.align,a),u=(t.y||0)-Xm(t.baseline,i);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",Vm["xmlns:xlink"],"xlink:href"),e("transform",Cm(o,u)),e("width",a),e("height",i),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){var n=t.image,r=Hm(t,n),a=Gm(t,n),i=(t.x||0)-Km(t.align,r),o=(t.y||0)-Xm(t.baseline,a);return e.set(i,o,i+r,o+a)},draw:function(e,t,n){var r=this;Om(t,(function(t){if(!n||n.intersects(t.bounds)){var a=qm(t,r),i=Hm(t,a),o=Gm(t,a);if(0!==i&&0!==o){var u,c,s,l,f=(t.x||0)-Km(t.align,i),d=(t.y||0)-Xm(t.baseline,o);!1!==t.aspect&&(c=a.width/a.height,s=t.width/t.height,c===c&&s===s&&c!==s&&(s<c?(d+=(o-(l=i/c))/2,o=l):(f+=(i-(l=o*c))/2,i=l))),(a.complete||a.toDataURL)&&(dm(e,t),e.globalAlpha=null!=(u=t.opacity)?u:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(a,f,d,i,o))}}}))},pick:_m(),isect:ne.ib,get:qm,xOffset:Km,yOffset:Xm},$m=Dm("line",(function(e,t){var n=t[0],r=n.interpolate||"linear";return Ov.curve(Pp(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<a)return e[i];return null}));function Jm(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,a=t.y||0,i=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*Vp,c=t.pathCache;c&&c.path===n||((t.pathCache=c=Up(n)).path=n),u&&e.rotate&&e.translate?(e.translate(r,a),e.rotate(u),Zp(e,c,0,0,i,o),e.rotate(-u),e.translate(-r,-a)):Zp(e,c,r,a,i,o)}var Qm={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return Cm(e.x||0,e.y||0)+(e.angle?" "+Am(e.angle):"")+(e.scaleX||e.scaleY?" "+(t=e.scaleX||1,n=e.scaleY||1,"scale("+t+","+n+")"):"");var t,n}(t)),e("d",t.path)},bound:function(e,t){return Jm(em(e,t.angle),t)?e.set(0,0,0,0):Rv(e,t,!0)},draw:wm(Jm),pick:Em(Jm),isect:um(Jm)};function Zm(e,t){e.beginPath(),Sv(e,t)}var eb={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",Sv(null,t))},bound:function(e,t){var n,r;return Rv(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:wm(Zm),pick:Em(Zm),isect:sm};function tb(e,t,n){var r,a,i,o;return!(!t.stroke||!gm(e,t,n))&&(r=t.x||0,a=t.y||0,i=null!=t.x2?t.x2:r,o=null!=t.y2?t.y2:a,e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),!0)}var nb={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",Nm(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return Rv(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){Om(t,(function(t){if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&tb(e,t,r)&&(dm(e,t),e.stroke())}}))},pick:_m((function(e,t,n,r){return!!e.isPointInStroke&&(tb(e,t,1)&&e.isPointInStroke(n,r))})),isect:lm},rb=Tm("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),ab=Tm("symbol",(function(e,t){return wv.context(e)(t)}),cm),ib=Object(ne.N)(),ob={height:db,measureWidth:lb,estimateWidth:cb,width:cb,canvas:ub};function ub(e){ob.width=e&&im?lb:cb}function cb(e,t){return sb(mb(e,t),db(e))}function sb(e,t){return~~(.8*e.length*t)}function lb(e,t){return db(e)<=0||!(t=mb(e,t))?0:fb(t,gb(e))}function fb(e,t){var n="(".concat(t,") ").concat(e),r=ib.get(n);return void 0===r&&(im.font=t,r=im.measureText(e).width,ib.set(n,r)),r}function db(e){return null!=e.fontSize?+e.fontSize||0:11}function hb(e){return null!=e.lineHeight?e.lineHeight:db(e)+2}function pb(e){return t=e.lineBreak&&e.text&&!Object(ne.B)(e.text)?e.text.split(e.lineBreak):e.text,Object(ne.B)(t)?t.length>1?t:t[0]:t;var t}function vb(e){var t=pb(e);return(Object(ne.B)(t)?t.length-1:0)*hb(e)}function mb(e,t){var n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(ob.width===lb){var t=gb(e);return function(e){return fb(e,t)}}var n=db(e);return function(e){return sb(e,n)}}(e);if(r(t)<n)return t;var a,i=e.ellipsis||"\u2026",o="rtl"===e.dir,u=0,c=t.length;if(n-=r(i),o){for(;u<c;)a=u+c>>>1,r(t.slice(a))>n?u=a+1:c=a;return i+t.slice(u)}for(;u<c;)a=1+(u+c>>>1),r(t.slice(0,a))<n?u=a:c=a-1;return t.slice(0,u)+i}(e,n):n}function bb(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function gb(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+db(e)+"px "+bb(e,t)}function yb(e){var t=e.baseline,n=db(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*hb(e):"line-bottom"===t?.29*n-.5*hb(e):0)}ub(!0);var xb={left:"start",center:"middle",right:"end"},Ob=new Nv;function kb(e){var t,n=e.x||0,r=e.y||0,a=e.radius||0;return a&&(t=(e.theta||0)-qp,n+=a*Math.cos(t),r+=a*Math.sin(t)),Ob.x1=n,Ob.y1=r,Ob}function wb(e,t,n){var r,a=ob.height(t),i=t.align,o=kb(t),u=o.x1,c=o.y1,s=t.dx||0,l=(t.dy||0)+yb(t)-Math.round(.8*a),f=pb(t);if(Object(ne.B)(f)?(a+=hb(t)*(f.length-1),r=f.reduce((function(e,n){return Math.max(e,ob.width(t,n))}),0)):r=ob.width(t,f),"center"===i?s-=r/2:"right"===i&&(s-=r),e.set(s+=u,l+=c,s+r,l+a),t.angle&&!n)e.rotate(t.angle*Vp,u,c);else if(2===n)return e.rotatedPoints(t.angle*Vp,u,c);return e}var jb={arc:Im,area:Fm,group:Um,image:Ym,line:$m,path:Qm,rect:eb,rule:nb,shape:rb,symbol:ab,text:{type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,a=(t.dy||0)+yb(t),i=kb(t),o=i.x1,u=i.y1,c=t.angle||0;e("text-anchor",xb[t.align]||"start"),c?(n=Cm(o,u)+" "+Am(c),(r||a)&&(n+=" "+Cm(r,a))):n=Cm(o+r,u+a),e("transform",n)},bound:wb,draw:function(e,t,n){Om(t,(function(t){var r,a,i,o,u,c,s,l=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===l||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=gb(t),e.textAlign=t.align||"left",a=(r=kb(t)).x1,i=r.y1,t.angle&&(e.save(),e.translate(a,i),e.rotate(t.angle*Vp),a=i=0),a+=t.dx||0,i+=(t.dy||0)+yb(t),c=pb(t),dm(e,t),Object(ne.B)(c))for(u=hb(t),o=0;o<c.length;++o)s=mb(t,c[o]),t.fill&&mm(e,t,l)&&e.fillText(s,a,i),t.stroke&&gm(e,t,l)&&e.strokeText(s,a,i),i+=u;else s=mb(t,c),t.fill&&mm(e,t,l)&&e.fillText(s,a,i),t.stroke&&gm(e,t,l)&&e.strokeText(s,a,i);t.angle&&e.restore()}}))},pick:_m((function(e,t,n,r,a,i){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=kb(t),u=o.x1,c=o.y1,s=wb(Ob,t,1),l=-t.angle*Vp,f=Math.cos(l),d=Math.sin(l),h=f*a-d*i+(u-f*u+d*c),p=d*a+f*i+(c-d*u-f*c);return s.contains(h,p)})),isect:function(e,t){var n=wb(Ob,e,2);return fm(t,n[0],n[1],n[2],n[3])||fm(t,n[0],n[1],n[4],n[5])||fm(t,n[4],n[5],n[6],n[7])||fm(t,n[2],n[3],n[6],n[7])}},trail:Dm("trail",(function(e,t){return jv.context(e)(t)}),(function(e,t){for(var n,r,a=e.length;--a>=0;)if(!1!==e[a].defined&&(n=e[a].x-t[0])*n+(r=e[a].y-t[1])*r<(n=e[a].size||1)*n)return e[a];return null}))};function _b(e,t,n){var r=jb[e.mark.marktype],a=t||r.bound;return r.nested&&(e=e.mark),a(e.bounds||(e.bounds=new Nv),e,n)}var Sb={mark:null};function Eb(e,t,n){var r,a,i,o,u=jb[e.marktype],c=u.bound,s=e.items,l=s&&s.length;if(u.nested)return l?i=s[0]:(Sb.mark=e,i=Sb),o=_b(i,c,n),t=t&&t.union(o)||o;if(t=t||e.bounds&&e.bounds.clear()||new Nv,l)for(r=0,a=s.length;r<a;++r)t.union(_b(s[r],c,n));return e.bounds=t}var Cb=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Ab(e,t){return JSON.stringify(e,Cb,t)}function Nb(e){return Tb("string"===typeof e?JSON.parse(e):e)}function Tb(e){var t,n,r,a=e.marktype,i=e.items;if(i)for(n=0,r=i.length;n<r;++n)t=a?"mark":"group",i[n][t]=e,i[n].zindex&&(i[n][t].zdirty=!0),"group"===(a||t)&&Tb(i[n]);return a&&Eb(e),e}function Ib(e){arguments.length?this.root=Nb(e):(this.root=Db({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Iv(this.root)])}function Db(e,t){var n={bounds:new Nv,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Fb(e,t,n){return!e&&"undefined"!==typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Mb(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,a=n.length;r<a;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Rb(e,t,n,r){var a,i=e.childNodes[t];return i&&i.tagName.toLowerCase()===n.toLowerCase()||(a=i||null,i=Fb(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function zb(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function Lb(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Pb(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Bb(e,t){this._active=null,this._handlers={},this._loader=e||xi(),this._tooltip=t||Wb}function Wb(e,t,n,r){e.element().setAttribute("title",r||"")}function Ub(e){this._el=null,this._bgcolor=null,this._loader=new Dv(e)}Ib.prototype={toJSON:function(e){return Ab(this.root,e||0)},mark:function(e,t,n){var r=Db(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},Bb.prototype={initialize:function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},origin:function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene:function(e){return arguments.length?(this._scene=e,this):this._scene},on:function(){},off:function(){},_handlerIndex:function(e,t,n){for(var r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers:function(e){var t=this._handlers,n=[];if(e)n.push.apply(n,Object(Jc.a)(t[this.eventName(e)]));else for(var r in t)n.push.apply(n,Object(Jc.a)(t[r]));return n},eventName:function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref:function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=Fb(null,"a");for(var a in t)r.setAttribute(a,t[a]);r.dispatchEvent(n)})).catch((function(){}))},handleTooltip:function(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var a,i,o=e&&e.mark;if(o&&(a=jb[o.marktype]).tip){for((i=Pb(t,n))[0]-=r[0],i[1]-=r[1];e=e.mark.group;)i[0]-=e.x||0,i[1]-=e.y||0;e=a.tip(o.items,i)}return e}(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect:function(e){var t=this.canvas();if(t){for(var n=t.getBoundingClientRect(),r=this._origin,a=e.bounds,i=a.width(),o=a.height(),u=a.x1+r[0]+n.left,c=a.y1+r[1]+n.top;e.mark&&(e=e.mark.group);)u+=e.x||0,c+=e.y||0;return{x:u,y:c,width:i,height:o,left:u,top:c,right:u+i,bottom:c+o}}}},Ub.prototype={initialize:function(e,t,n,r,a){return this._el=e,this.resize(t,n,r,a)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},background:function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize:function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty:function(){},render:function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render:function(){},renderAsync:function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},_load:function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var a=n._call;n._ready=n._loader.ready().then((function(e){e&&a(),n._ready=null}))}return r},sanitizeURL:function(e){return this._load("sanitizeURL",e)},loadImage:function(e){return this._load("loadImage",e)}};var Vb="dragenter",qb="dragleave",Hb="dragover",Gb="mousedown",Kb="mousemove",Xb="mouseout",Yb="mouseover",$b="click",Jb="mousewheel",Qb="touchstart",Zb="touchmove",eg="touchend",tg=["keydown","keypress","keyup",Vb,qb,Hb,Gb,"mouseup",Kb,Xb,Yb,$b,"dblclick","wheel",Jb,Qb,Zb,eg],ng=Kb,rg=Xb,ag=$b;function ig(e,t){Bb.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function og(e,t){(function(e){return e===Qb||e===Zb||e===eg?[Qb,Zb,eg]:[e]})(t).forEach((function(t){return function(e,t){var n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?function(n){return e[t](n)}:function(n){return e.fire(t,n)}))}(e,t)}))}function ug(e,t,n){return function(r){var a=this._active,i=this.pickEvent(r);i===a||(a&&a.exit||this.fire(n,r),this._active=i,this.fire(t,r)),this.fire(e,r)}}function cg(e){return function(t){this.fire(e,t),this._active=null}}Object(ne.z)(ig,Bb,{initialize:function(e,t,n){var r=this;return this._canvas=e&&Mb(e,"canvas"),[$b,Gb,Kb,Xb,qb].forEach((function(e){return og(r,e)})),Bb.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._canvas},context:function(){return this._canvas.getContext("2d")},events:tg,DOMMouseScroll:function(e){this.fire(Jb,e)},mousemove:ug(Kb,Yb,Xb),dragover:ug(Hb,Vb,qb),mouseout:cg(Xb),dragleave:cg(qb),mousedown:function(e){this._down=this._active,this.fire(Gb,e)},click:function(e){this._down===this._active&&(this.fire($b,e),this._down=null)},touchstart:function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Qb,e,!0)},touchmove:function(e){this.fire(Zb,e,!0)},touchend:function(e){this.fire(eg,e,!0),this._touch=null},fire:function(e,t,n){var r=n?this._touch:this._active,a=this._handlers[e];if(t.vegaType=e,e===ag&&r&&r.href?this.handleHref(t,r,r.href):e!==ng&&e!==rg||this.handleTooltip(t,r,e!==rg),a)for(var i=0,o=a.length;i<o;++i)a[i].handler.call(this._obj,t,r)},on:function(e,t){var n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(og(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&r.splice(a,1),this},pickEvent:function(e){var t=Pb(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick:function(e,t,n,r,a){var i=this.context();return jb[e.marktype].pick.call(this,i,e,t,n,r,a)}});var sg="undefined"!==typeof window&&window.devicePixelRatio||1;function lg(e){Ub.call(this,e),this._options={},this._redraw=!1,this._dirty=new Nv,this._tempb=new Nv}var fg=Ub.prototype;function dg(e,t){Bb.call(this,e,t);var n=this;n._hrefHandler=hg(n,(function(e,t){t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=hg(n,(function(e,t){n.handleTooltip(e,t,e.type!==rg)}))}Object(ne.z)(lg,Ub,{initialize:function(e,t,n,r,a,i){return this._options=i||{},this._canvas=this._options.externalContext?null:hl(1,1,this._options.type),e&&this._canvas&&(zb(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),fg.initialize.call(this,e,t,n,r,a)},resize:function(e,t,n,r){if(fg.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,a,i){var o="undefined"!==typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,u=e.getContext("2d"),c=o?sg:a;for(var s in e.width=t*c,e.height=n*c,i)u[s]=i[s];o&&1!==c&&(e.style.width=t+"px",e.style.height=n+"px"),u.pixelRatio=c,u.setTransform(c,0,0,c,c*r[0],c*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{var a=this._options.externalContext;a||Object(ne.o)("CanvasRenderer is missing a valid canvas or context"),a.scale(this._scale,this._scale),a.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas:function(){return this._canvas},context:function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty:function(e){for(var t=this._tempb.clear().union(e.bounds),n=e.mark.group;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render:function(e){var t,n,r,a=this.context(),i=this._origin,o=this._width,u=this._height,c=this._dirty,s=(t=i,n=o,r=u,(new Nv).set(0,0,n,r).translate(-t[0],-t[1]));a.save();var l=this._redraw||c.empty()?(this._redraw=!1,s.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(a,s.intersect(c),i);return this.clear(-i[0],-i[1],o,u),this.draw(a,e,l),a.restore(),c.clear(),this},draw:function(e,t,n){var r=jb[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Object(ne.E)(n)?(e.beginPath(),n(e),e.clip()):Mm(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear:function(e,t,n,r){var a=this._options,i=this.context();"pdf"===a.type||a.externalContext||i.clearRect(e,t,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,r))}});var hg=function(e,t){return function(n){var r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)}};Object(ne.z)(dg,Bb,{initialize:function(e,t,n){var r=this._svg;return r&&(r.removeEventListener(ag,this._hrefHandler),r.removeEventListener(ng,this._tooltipHandler),r.removeEventListener(rg,this._tooltipHandler)),this._svg=r=e&&Mb(e,"svg"),r&&(r.addEventListener(ag,this._hrefHandler),r.addEventListener(ng,this._tooltipHandler),r.addEventListener(rg,this._tooltipHandler)),Bb.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._svg},on:function(e,t){var n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){var a={type:e,handler:t,listener:hg(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&(this._svg&&this._svg.removeEventListener(n,r[a].listener),r.splice(a,1)),this}});var pg="aria-hidden",vg="aria-label",mg="role",bg="aria-roledescription",gg="graphics-object",yg="graphics-symbol",xg=function(e,t,n){var r;return r={},Object(vt.a)(r,mg,e),Object(vt.a)(r,bg,t),Object(vt.a)(r,vg,n||void 0),r},Og=Object(ne.fb)(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),kg={axis:{desc:"axis",caption:function(e){var t=e.datum,n=e.orient,r=t.title?Eg(e):null,a=e.context,i=a.scales[t.scale].value,o=a.dataflow.locale(),u=i.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(Jh(u)?"discrete":u," scale")+" with ".concat(Tp(o,i,e))}},legend:{desc:"legend",caption:function(e){var t=e.datum,n=t.title?Eg(e):null,r="".concat(t.type||""," legend").trim(),a=t.scales,i=Object.keys(a),o=e.context,u=o.scales[a[i[0]]].value,c=o.dataflow.locale();return s=r,(s.length?s[0].toUpperCase()+s.slice(1):s)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(e){return(e=e.map((function(e){return e+("fill"===e||"stroke"===e?" color":"")}))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Object(ne.W)(e)}(i))+" with ".concat(Tp(c,u,e));var s}},"title-text":{desc:"title",caption:function(e){return"Title text '".concat(Sg(e),"'")}},"title-subtitle":{desc:"subtitle",caption:function(e){return"Subtitle text '".concat(Sg(e),"'")}}},wg={ariaRole:mg,ariaRoleDescription:bg,description:vg};function jg(e,t){var n=!1===t.aria;if(e(pg,n||void 0),n||null==t.description)for(var r in wg)e(wg[r],void 0);else{var a=t.mark.marktype;e(vg,t.description),e(mg,t.ariaRole||("group"===a?gg:yg)),e(bg,t.ariaRoleDescription||"".concat(a," mark"))}}function _g(e){return!1===e.aria?Object(vt.a)({},pg,!0):Og[e.role]?null:kg[e.role]?function(e,t){try{var n=e.items[0],r=t.caption||function(){return""};return xg(t.role||yg,t.desc,n.description||r(n))}catch(a){return null}}(e,kg[e.role]):function(e){var t=e.marktype,n="group"===t||"text"===t||e.items.some((function(e){return null!=e.description&&!1!==e.aria}));return xg(n?gg:yg,"".concat(t," mark container"),e.description)}(e)}function Sg(e){return Object(ne.i)(e.text).join(" ")}function Eg(e){try{return Object(ne.i)(Object(ne.W)(e.items).items[0].text).join(" ")}catch(t){return null}}var Cg=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};function Ag(){var e="",t="",n="",r=[],a=function(){return t=n=""},i=function(i){t&&(e+="".concat(t,">").concat(n),a()),r.push(i)},o=function(e,n){return null!=n&&(t+=" ".concat(e,'="').concat(Cg(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),u},u={open:function(e){i(e),t="<"+e;for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var c=0,s=r;c<s.length;c++){var l=s[c];for(var f in l)o(f,l[f])}return u},close:function(){var i=r.pop();return e+=t?t+(n?">".concat(n,"</").concat(i,">"):"/>"):"</".concat(i,">"),a(),u},attr:o,text:function(e){return n+=Cg(e),u},toString:function(){return e}};return u}var Ng=function(e){return Tg(Ag(),e)+""};function Tg(e,t){if(e.open(t.tagName),t.hasAttributes())for(var n=t.attributes,r=n.length,a=0;a<r;++a)e.attr(n[a].name,n[a].value);if(t.hasChildNodes())for(var i=t.childNodes,o=i.length,u=0;u<o;u++){var c=i[u];3===c.nodeType?e.text(c.nodeValue):Tg(e,c)}return e.close()}var Ig={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Dg={fill:"none","stroke-miterlimit":10},Fg="http://www.w3.org/2000/xmlns/",Mg=Vm.xmlns;function Rg(e){Ub.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var zg=Ub.prototype;function Lg(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function Pg(e,t,n){var r,a,i;if("radial"===t.gradient){var o=Rb(e,n++,"pattern",Mg);Kg(o,{id:Dp+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),Kg(o=Rb(o,0,"rect",Mg),{width:1,height:1,fill:"url(".concat(Yg(),"#").concat(t.id,")")}),Kg(e=Rb(e,n++,"radialGradient",Mg),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else Kg(e=Rb(e,n++,"linearGradient",Mg),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,a=t.stops.length;r<a;++r)(i=Rb(e,r,"stop",Mg)).setAttribute("offset",t.stops[r].offset),i.setAttribute("stop-color",t.stops[r].color);return zb(e,r),n}function Bg(e,t,n){return(e=Rb(e,n,"clipPath",Mg)).setAttribute("id",t.id),t.path?Rb(e,0,"path",Mg).setAttribute("d",t.path):Kg(Rb(e,0,"rect",Mg),{x:0,y:0,width:t.width,height:t.height}),zb(e,1),n+1}function Wg(e,t,n,r,a){var i,o=e._svg;if(!o&&(o=Fb(i=t.ownerDocument,r,Mg),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===r))){var u=Fb(i,"path",Mg);o.appendChild(u),u.__data__=e;var c=Fb(i,"g",Mg);o.appendChild(c),c.__data__=e;var s=Fb(i,"path",Mg);o.appendChild(s),s.__data__=e,s.__values__={fill:"default"}}return(o.ownerSVGElement!==a||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}Object(ne.z)(Rg,Ub,{initialize:function(e,t,n,r,a){return this._defs={},this._clearDefs(),e&&(this._svg=Rb(e,0,"svg",Mg),this._svg.setAttributeNS(Fg,"xmlns",Mg),this._svg.setAttributeNS(Fg,"xmlns:xlink",Vm["xmlns:xlink"]),this._svg.setAttribute("version",Vm.version),this._svg.setAttribute("class","marks"),zb(e,1),this._root=Rb(this._svg,0,"g",Mg),Kg(this._root,Dg),zb(this._svg,1)),this.background(this._bgcolor),zg.initialize.call(this,e,t,n,r,a)},background:function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),zg.background.apply(this,arguments)},resize:function(e,t,n,r){return zg.resize.call(this,e,t,n,r),this._svg&&(Kg(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas:function(){return this._svg},svg:function(){var e,t=this._svg,n=this._bgcolor;if(!t)return null;n&&(t.removeAttribute("style"),Kg(e=Rb(t,0,"rect",Mg),{width:this._width,height:this._height,fill:n}));var r=Ng(t);return n&&(t.removeChild(e),this._svg.style.setProperty("background-color",n)),r},_render:function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),zb(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty:function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty:function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck:function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;var t,n,r,a,i,o,u,c=++this._dirtyID;for(i=0,o=e.length;i<o;++i)(n=(t=e[i]).mark).marktype!==r&&(r=n.marktype,a=jb[r]),n.zdirty&&n.dirty!==c&&(this._dirtyAll=!1,Lg(t,c),n.items.forEach((function(e){e.dirty=c}))),n.zdirty||(t.exit?(a.nested&&n.items.length?(u=n.items[0])._svg&&this._update(a,u._svg,u):t._svg&&(u=t._svg.parentNode)&&u.removeChild(t._svg),t._svg=null):(t=a.nested?n.items[0]:t)._update!==c&&(t._svg&&t._svg.ownerSVGElement?this._update(a,t._svg,t):(this._dirtyAll=!1,Lg(t,c)),t._update=c));return!this._dirtyAll},mark:function(e,t,n){var r=this;if(!this.isDirty(t))return t._svg;var a=this._svg,i=jb[t.marktype],o=!1===t.interactive?"none":null,u="g"===i.tag,c=null,s=0,l=Wg(t,e,n,"g",a);l.setAttribute("class",Lb(t));var f=_g(t);for(var d in f)Xg(l,d,f[d]);u||Xg(l,"pointer-events",o),Xg(l,"clip-path",t.clip?Av(this,t,t.group):null);var h=function(e){var t=r.isDirty(e),n=Wg(e,l,c,i.tag,a);t&&(r._update(i,n,e),u&&function(e,t,n){t=t.lastChild.previousSibling;var r,a=0;Om(n,(function(n){r=e.mark(t,n,r),++a})),zb(t,1+a)}(r,n,e)),c=n,++s};return i.nested?t.items.length&&h(t.items[0]):Om(t,h),zb(l,s),l},_update:function(e,t,n){Ug=t,Vg=t.__values__,jg(Hg,n),e.attr(Hg,n,this);var r=qg[e.type];r&&r.call(this,e,t,n),Ug&&this.style(Ug,n)},style:function(e,t){if(null!=t)for(var n in Ig){var r="font"===n?bb(t):t[n];if(r!==Vg[n]){var a=Ig[n];null==r?e.removeAttribute(a):(Fp(r)&&(r=Mp(r,this._defs.gradient,Yg())),e.setAttribute(a,r+"")),Vg[n]=r}}},defs:function(){var e=this._svg,t=this._defs,n=t.el,r=0;for(var a in t.gradient)n||(t.el=n=Rb(e,1,"defs",Mg)),r=Pg(n,t.gradient[a],r);for(var i in t.clipping)n||(t.el=n=Rb(e,1,"defs",Mg)),r=Bg(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):zb(n,r))},_clearDefs:function(){var e=this._defs;e.gradient={},e.clipping={}}});var Ug=null,Vg=null,qg={group:function(e,t,n){var r=Ug=t.childNodes[2];Vg=r.__values__,e.foreground(Hg,n,this),Vg=t.__values__,Ug=t.childNodes[1],e.content(Hg,n,this);var a=Ug=t.childNodes[0];e.background(Hg,n,this);var i=!1===n.mark.interactive?"none":null;if(i!==Vg.events&&(Xg(r,"pointer-events",i),Xg(a,"pointer-events",i),Vg.events=i),n.strokeForeground&&n.stroke){var o=n.fill;Xg(r,"display",null),this.style(a,n),Xg(a,"stroke",null),o&&(n.fill=null),Vg=r.__values__,this.style(r,n),o&&(n.fill=o),Ug=null}else Xg(r,"display","none")},image:function(e,t,n){!1===n.smooth?(Gg(t,"image-rendering","optimizeSpeed"),Gg(t,"image-rendering","pixelated")):Gg(t,"image-rendering",null)},text:function(e,t,n){var r,a,i,o,u=pb(n);Object(ne.B)(u)?(r=(a=u.map((function(e){return mb(n,e)}))).join("\n"))!==Vg.text&&(zb(t,0),i=t.ownerDocument,o=hb(n),a.forEach((function(e,r){var a=Fb(i,"tspan",Mg);a.__data__=n,a.textContent=e,r&&(a.setAttribute("x",0),a.setAttribute("dy",o)),t.appendChild(a)})),Vg.text=r):(a=mb(n,u))!==Vg.text&&(t.textContent=a,Vg.text=a),Xg(t,"font-family",bb(n)),Xg(t,"font-size",db(n)+"px"),Xg(t,"font-style",n.fontStyle),Xg(t,"font-variant",n.fontVariant),Xg(t,"font-weight",n.fontWeight)}};function Hg(e,t,n){t!==Vg[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(Ug,e,t,n):Xg(Ug,e,t),Vg[e]=t)}function Gg(e,t,n){n!==Vg[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),Vg[t]=n)}function Kg(e,t){for(var n in t)Xg(e,n,t[n])}function Xg(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function Yg(){var e;return"undefined"===typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function $g(e){Ub.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Object(ne.z)($g,Ub,{svg:function(){return this._text},_render:function(e){var t=Ag();t.open("svg",Object(ne.p)({},Vm,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));var n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Dg,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark:function(e,t){var n=this,r=jb[t.marktype],a=r.tag,i=[jg,r.attr];e.open("g",{class:Lb(t),"clip-path":t.clip?Av(this,t,t.group):null},_g(t),{"pointer-events":"g"!==a&&!1===t.interactive?"none":null});var o=function(o){var u=n.href(o);if(u&&e.open("a",u),e.open(a,n.attr(t,o,i,"g"!==a?a:null)),"text"===a){var c=pb(o);if(Object(ne.B)(c))for(var s={x:0,dy:hb(o)},l=0;l<c.length;++l)e.open("tspan",l?s:null).text(mb(o,c[l])).close();else e.text(mb(o,c))}else if("g"===a){var f=o.strokeForeground,d=o.fill,h=o.stroke;f&&h&&(o.stroke=null),e.open("path",n.attr(t,o,r.background,"bgrect")).close(),e.open("g",n.attr(t,o,r.content)),Om(o,(function(t){return n.mark(e,t)})),e.close(),f&&h?(d&&(o.fill=null),o.stroke=h,e.open("path",n.attr(t,o,r.foreground,"bgrect")).close(),d&&(o.fill=d)):e.open("path",n.attr(t,o,r.foreground,"bgfore")).close()}e.close(),u&&e.close()};return r.nested?t.items&&t.items.length&&o(t.items[0]):Om(t,o),e.close()},href:function(e){var t,n=this,r=e.href;if(r){if(t=this._hrefs&&this._hrefs[r])return t;this.sanitizeURL(r).then((function(e){e["xlink:href"]=e.href,e.href=null,(n._hrefs||(n._hrefs={}))[r]=e}))}return null},attr:function(e,t,n,r){var a=this,i={},o=function(e,t,n,r){i[r||e]=t};return Array.isArray(n)?n.forEach((function(e){return e(o,t,a)})):n(o,t,this),r&&function(e,t,n,r,a){if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(e["font-family"]=bb(t),e["font-size"]=db(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(var i in Ig){var o=t[i],u=Ig[i];("transparent"!==o||"fill"!==u&&"stroke"!==u)&&null!=o&&(Fp(o)&&(o=Mp(o,a.gradient,"")),e[u]=o)}}(i,t,e,r,this._defs),i},defs:function(e){var t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){for(var r in e.open("defs"),t){var a=t[r],i=a.stops;"radial"===a.gradient?(e.open("pattern",{id:Dp+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(var o=0;o<i.length;++o)e.open("stop",{offset:i[o].offset,"stop-color":i[o].color}).close();e.close()}for(var u in n){var c=n[u];e.open("clipPath",{id:u}),c.path?e.open("path",{d:c.path}).close():e.open("rect",{x:0,y:0,width:c.width,height:c.height}).close(),e.close()}e.close()}}});var Jg="canvas",Qg="none",Zg={Canvas:Jg,PNG:"png",SVG:"svg",None:Qg},ey={};function ty(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(ey[e]=t,this):ey[e]}function ny(e,t,n){var r=[],a=(new Nv).union(t),i=e.marktype;return i?ry(e,a,n,r):"group"===i?ay(e,a,n,r):Object(ne.o)("Intersect scene must be mark node or group item.")}function ry(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){var a=e.items,i=e.marktype,o=a.length,u=0;if("group"===i)for(;u<o;++u)ay(a[u],t,n,r);else for(var c=jb[i].isect;u<o;++u){var s=a[u];iy(s,t,c)&&r.push(s)}}return r}function ay(e,t,n,r){n&&n(e.mark)&&iy(e,t,jb.group.isect)&&r.push(e);var a=e.items,i=a&&a.length;if(i){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var c=0;c<i;++c)ry(a[c],t,n,r);t.translate(o,u)}return r}function iy(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}ey.canvas=ey.png={renderer:lg,headless:lg,handler:ig},ey.svg={renderer:Rg,headless:$g,handler:dg},ey.none={};var oy=new Nv;function uy(e){var t=e.clip;if(Object(ne.E)(t))t(em(oy.clear()));else{if(!t)return;oy.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(oy)}function cy(e,t,n){return e===t||("path"===n?sy(e,t):e instanceof Date&&t instanceof Date?+e===+t:Object(ne.G)(e)&&Object(ne.G)(t)?Math.abs(e-t)<=1e-9:e&&t&&(Object(ne.H)(e)||Object(ne.H)(t))?function(e,t){var n,r,a=Object.keys(e),i=Object.keys(t);if(a.length!==i.length)return!1;for(a.sort(),i.sort(),r=a.length-1;r>=0;r--)if(a[r]!=i[r])return!1;for(r=a.length-1;r>=0;r--)if(!cy(e[n=a[r]],t[n],n))return!1;return typeof e===typeof t}(e,t):e==t)}function sy(e,t){return cy(Up(e),Up(t))}function ly(){Cv(),Ip=0}var fy="top",dy="left",hy="right",py="bottom",vy="start",my="middle",by="end",gy="group",yy="axis",xy="title",Oy="frame",ky="scope",wy="legend",jy="row-header",_y="row-footer",Sy="row-title",Ey="column-header",Cy="column-footer",Ay="column-title",Ny="padding",Ty="fit",Iy="fit-x",Dy="fit-y",Fy="none",My="all",Ry="each",zy="flush",Ly="column",Py="row";function By(e){fo.call(this,null,e)}function Wy(e,t,n){return t(e.bounds.clear(),e,n)}Object(ne.z)(By,fo,{transform:function(e,t){var n,r=t.dataflow,a=e.mark,i=a.marktype,o=jb[i],u=o.bound,c=a.bounds;if(o.nested)a.items.length&&r.dirty(a.items[0]),c=Wy(a,u),a.items.forEach((function(e){e.bounds.clear().union(c)}));else if(i===gy||e.modified())switch(t.visit(t.MOD,(function(e){return r.dirty(e)})),c.clear(),a.items.forEach((function(e){return c.union(Wy(e,u))})),a.role){case yy:case wy:case xy:t.reflow()}else n=t.changed(t.REM),t.visit(t.ADD,(function(e){c.union(Wy(e,u))})),t.visit(t.MOD,(function(e){n=n||c.alignsWith(e.bounds),r.dirty(e),c.union(Wy(e,u))})),n&&(c.clear(),a.items.forEach((function(e){return c.union(e.bounds)})));return uy(a),t.modifies("bounds")}});var Uy=":vega_identifier:";function Vy(e){fo.call(this,0,e)}function qy(e){fo.call(this,null,e)}function Hy(e){fo.call(this,null,e)}Vy.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Object(ne.z)(Vy,fo,{transform:function(e,t){var n,r=(n=t.dataflow)._signals[Uy]||(n._signals[Uy]=n.add(0)),a=e.as,i=r.value;return t.visit(t.ADD,(function(e){return e[a]=e[a]||++i})),r.set(this.value=i),t}}),Object(ne.z)(qy,fo,{transform:function(e,t){var n=this.value;n||((n=t.dataflow.scenegraph().mark(e.markdef,function(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index)).group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);var r=n.marktype===gy?Iv:Tv;return t.visit(t.ADD,(function(e){return r.call(e,n)})),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});var Gy={parity:function(e){return e.filter((function(e,t){return t%2?e.opacity=0:1}))},greedy:function(e,t){var n;return e.filter((function(e,r){return r&&Ky(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)}))}},Ky=function(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)},Xy=function(e,t){for(var n,r=1,a=e.length,i=e[0].bounds;r<a;i=n,++r)if(Ky(i,n=e[r].bounds,t))return!0},Yy=function(e){var t=e.bounds;return t.width()>1&&t.height()>1},$y=function(e){return e.forEach((function(e){return e.opacity=1})),e},Jy=function(e,t){return e.reflow(t.modified()).modifies("opacity")};function Qy(e){fo.call(this,null,e)}Object(ne.z)(Hy,fo,{transform:function(e,t){var n,r,a=Gy[e.method]||Gy.parity,i=e.separation||0,o=t.materialize(t.SOURCE).source;if(o&&o.length){if(!e.method)return e.modified("method")&&($y(o),t=Jy(t,e)),t;if((o=o.filter(Yy)).length){if(e.sort&&(o=o.slice().sort(e.sort)),n=$y(o),t=Jy(t,e),n.length>=3&&Xy(n,i)){do{n=a(n,i)}while(n.length>=3&&Xy(n,i));n.length<3&&!Object(ne.W)(o).opacity&&(n.length>1&&(Object(ne.W)(n).opacity=0),Object(ne.W)(o).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(r=function(e,t,n){var r=e.range(),a=new Nv;return t===fy||t===py?a.set(r[0],-1/0,r[1],1/0):a.set(-1/0,r[0],1/0,r[1]),a.expand(n||1),function(e){return a.encloses(e.bounds)}}(e.boundScale,e.boundOrient,+e.boundTolerance),o.forEach((function(e){r(e)||(e.opacity=0)})));var u=n[0].mark.bounds.clear();return o.forEach((function(e){e.opacity&&u.union(e.bounds)})),t}}}}),Object(ne.z)(Qy,fo,{transform:function(e,t){var n=t.dataflow;if(t.visit(t.ALL,(function(e){return n.dirty(e)})),t.fields&&t.fields.zindex){var r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});var Zy=new Nv;function ex(e,t,n){return e[t]===n?0:(e[t]=n,1)}function tx(e){var t=e.items[0].orient;return t===dy||t===hy}function nx(e,t,n,r){var a,i,o=t.items[0],u=o.datum,c=null!=o.translate?o.translate:.5,s=o.orient,l=function(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(u),f=o.range,d=o.offset,h=o.position,p=o.minExtent,v=o.maxExtent,m=u.title&&o.items[l[2]].items[0],b=o.titlePadding,g=o.bounds,y=m&&vb(m),x=0,O=0;switch(Zy.clear().union(g),g.clear(),(a=l[0])>-1&&g.union(o.items[a].bounds),(a=l[1])>-1&&g.union(o.items[a].bounds),s){case fy:x=h||0,O=-d,i=Math.max(p,Math.min(v,-g.y1)),g.add(0,-i).add(f,0),m&&rx(e,m,i,b,y,0,-1,g);break;case dy:x=-d,O=h||0,i=Math.max(p,Math.min(v,-g.x1)),g.add(-i,0).add(0,f),m&&rx(e,m,i,b,y,1,-1,g);break;case hy:x=n+d,O=h||0,i=Math.max(p,Math.min(v,g.x2)),g.add(0,0).add(i,f),m&&rx(e,m,i,b,y,1,1,g);break;case py:x=h||0,O=r+d,i=Math.max(p,Math.min(v,g.y2)),g.add(0,0).add(f,i),m&&rx(e,m,i,b,0,0,1,g);break;default:x=o.x,O=o.y}return Rv(g.translate(x,O),o),ex(o,"x",x+c)|ex(o,"y",O+c)&&(o.bounds=Zy,e.dirty(o),o.bounds=g,e.dirty(o)),o.mark.bounds.clear().union(g)}function rx(e,t,n,r,a,i,o,u){var c=t.bounds;if(t.auto){var s=o*(n+a+r),l=0,f=0;e.dirty(t),i?l=(t.x||0)-(t.x=s):f=(t.y||0)-(t.y=s),t.mark.bounds.clear().union(c.translate(-l,-f)),e.dirty(t)}u.union(c)}var ax=function(e,t){return Math.floor(Math.min(e,t))},ix=function(e,t){return Math.ceil(Math.max(e,t))};function ox(e){return(new Nv).set(0,0,e.width||0,e.height||0)}function ux(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function cx(e,t,n){var r=Object(ne.H)(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function sx(e){return e<0?Math.ceil(-e):0}function lx(e,t,n){var r,a,i,o,u,c,s,l,f,d,h,p=!n.nodirty,v=n.bounds===zy?ox:ux,m=Zy.set(0,0,0,0),b=cx(n.align,Ly),g=cx(n.align,Py),y=cx(n.padding,Ly),x=cx(n.padding,Py),O=n.columns||t.length,k=O<=0?1:Math.ceil(t.length/O),w=t.length,j=Array(w),_=Array(O),S=0,E=Array(w),C=Array(k),A=0,N=Array(w),T=Array(w),I=Array(w);for(a=0;a<O;++a)_[a]=0;for(a=0;a<k;++a)C[a]=0;for(a=0;a<w;++a)c=t[a],u=I[a]=v(c),c.x=c.x||0,N[a]=0,c.y=c.y||0,T[a]=0,i=a%O,o=~~(a/O),S=Math.max(S,s=Math.ceil(u.x2)),A=Math.max(A,l=Math.ceil(u.y2)),_[i]=Math.max(_[i],s),C[o]=Math.max(C[o],l),j[a]=y+sx(u.x1),E[a]=x+sx(u.y1),p&&e.dirty(t[a]);for(a=0;a<w;++a)a%O===0&&(j[a]=0),a<O&&(E[a]=0);if(b===Ry)for(i=1;i<O;++i){for(h=0,a=i;a<w;a+=O)h<j[a]&&(h=j[a]);for(a=i;a<w;a+=O)j[a]=h+_[i-1]}else if(b===My){for(h=0,a=0;a<w;++a)a%O&&h<j[a]&&(h=j[a]);for(a=0;a<w;++a)a%O&&(j[a]=h+S)}else for(b=!1,i=1;i<O;++i)for(a=i;a<w;a+=O)j[a]+=_[i-1];if(g===Ry)for(o=1;o<k;++o){for(h=0,r=(a=o*O)+O;a<r;++a)h<E[a]&&(h=E[a]);for(a=o*O;a<r;++a)E[a]=h+C[o-1]}else if(g===My){for(h=0,a=O;a<w;++a)h<E[a]&&(h=E[a]);for(a=O;a<w;++a)E[a]=h+A}else for(g=!1,o=1;o<k;++o)for(r=(a=o*O)+O;a<r;++a)E[a]+=C[o-1];for(f=0,a=0;a<w;++a)f=j[a]+(a%O?f:0),N[a]+=f-t[a].x;for(i=0;i<O;++i)for(d=0,a=i;a<w;a+=O)d+=E[a],T[a]+=d-t[a].y;if(b&&cx(n.center,Ly)&&k>1)for(a=0;a<w;++a)(f=(u=b===My?S:_[a%O])-I[a].x2-t[a].x-N[a])>0&&(N[a]+=f/2);if(g&&cx(n.center,Py)&&1!==O)for(a=0;a<w;++a)(d=(u=g===My?A:C[~~(a/O)])-I[a].y2-t[a].y-T[a])>0&&(T[a]+=d/2);for(a=0;a<w;++a)m.union(I[a].translate(N[a],T[a]));switch(f=cx(n.anchor,"x"),d=cx(n.anchor,"y"),cx(n.anchor,Ly)){case by:f-=m.width();break;case my:f-=m.width()/2}switch(cx(n.anchor,Py)){case by:d-=m.height();break;case my:d-=m.height()/2}for(f=Math.round(f),d=Math.round(d),m.clear(),a=0;a<w;++a)t[a].mark.bounds.clear();for(a=0;a<w;++a)(c=t[a]).x+=N[a]+=f,c.y+=T[a]+=d,m.union(c.mark.bounds.union(c.bounds.translate(N[a],T[a]))),p&&e.dirty(c);return m}function fx(e,t,n){var r,a,i,o,u,c,s,l=function(e){for(var t,n,r,a,i,o,u,c=e.items,s=c.length,l=0,f={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};l<s;++l)if(u=(o=c[l]).items,o.marktype===gy)switch(o.role){case yy:case wy:case xy:break;case jy:(t=f.rowheaders).push.apply(t,Object(Jc.a)(u));break;case _y:(n=f.rowfooters).push.apply(n,Object(Jc.a)(u));break;case Ey:(r=f.colheaders).push.apply(r,Object(Jc.a)(u));break;case Cy:(a=f.colfooters).push.apply(a,Object(Jc.a)(u));break;case Sy:f.rowtitle=u[0];break;case Ay:f.coltitle=u[0];break;default:(i=f.marks).push.apply(i,Object(Jc.a)(u))}return f}(t),f=l.marks,d=n.bounds===zy?dx:hx,h=n.offset,p=n.columns||f.length,v=p<=0?1:Math.ceil(f.length/p),m=v*p,b=lx(e,f,n);b.empty()&&b.set(0,0,0,0),l.rowheaders&&(c=cx(n.headerBand,Py,null),r=px(e,l.rowheaders,f,p,v,-cx(h,"rowHeader"),ax,0,d,"x1",0,p,1,c)),l.colheaders&&(c=cx(n.headerBand,Ly,null),a=px(e,l.colheaders,f,p,p,-cx(h,"columnHeader"),ax,1,d,"y1",0,1,p,c)),l.rowfooters&&(c=cx(n.footerBand,Py,null),i=px(e,l.rowfooters,f,p,v,cx(h,"rowFooter"),ix,0,d,"x2",p-1,p,1,c)),l.colfooters&&(c=cx(n.footerBand,Ly,null),o=px(e,l.colfooters,f,p,p,cx(h,"columnFooter"),ix,1,d,"y2",m-p,1,p,c)),l.rowtitle&&(u=cx(n.titleAnchor,Py),s=cx(h,"rowTitle"),s=u===by?i+s:r-s,c=cx(n.titleBand,Py,.5),vx(e,l.rowtitle,s,0,b,c)),l.coltitle&&(u=cx(n.titleAnchor,Ly),s=cx(h,"columnTitle"),s=u===by?o+s:a-s,c=cx(n.titleBand,Ly,.5),vx(e,l.coltitle,s,1,b,c))}function dx(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function hx(e,t){return e.bounds[t]}function px(e,t,n,r,a,i,o,u,c,s,l,f,d,h){var p,v,m,b,g,y,x,O,k,w=n.length,j=0,_=0;if(!w)return j;for(p=l;p<w;p+=f)n[p]&&(j=o(j,c(n[p],s)));if(!t.length)return j;for(t.length>a&&(e.warn("Grid headers exceed limit: "+a),t=t.slice(0,a)),j+=i,v=0,b=t.length;v<b;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(p=l,v=0,b=t.length;v<b;++v,p+=f){for(g=(y=t[v]).mark.bounds,m=p;m>=0&&null==(x=n[m]);m-=d);u?(O=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),k=j):(O=j,k=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),g.union(y.bounds.translate(O-(y.x||0),k-(y.y||0))),y.x=O,y.y=k,e.dirty(y),_=o(_,g[s])}return _}function vx(e,t,n,r,a,i){if(t){e.dirty(t);var o=n,u=n;r?o=Math.round(a.x1+i*a.width()):u=Math.round(a.y1+i*a.height()),t.bounds.translate(o-(t.x||0),u-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=u,e.dirty(t)}}function mx(e,t,n,r,a,i,o){var u=function(e,t){var n=e[t]||{};return function(t,r){return null!=n[t]?n[t]:null!=e[t]?e[t]:r}}(n,t),c=function(e,t){var n=-1/0;return e.forEach((function(e){null!=e.offset&&(n=Math.max(n,e.offset))})),n>-1/0?n:t}(e,u("offset",0)),s=u("anchor",vy),l=s===by?1:s===my?.5:0,f={align:Ry,bounds:u("bounds",zy),columns:"vertical"===u("direction")?1:e.length,padding:u("margin",8),center:u("center"),nodirty:!0};switch(t){case dy:f.anchor={x:Math.floor(r.x1)-c,column:by,y:l*(o||r.height()+2*r.y1),row:s};break;case hy:f.anchor={x:Math.ceil(r.x2)+c,y:l*(o||r.height()+2*r.y1),row:s};break;case fy:f.anchor={y:Math.floor(a.y1)-c,row:by,x:l*(i||a.width()+2*a.x1),column:s};break;case py:f.anchor={y:Math.ceil(a.y2)+c,x:l*(i||a.width()+2*a.x1),column:s};break;case"top-left":f.anchor={x:c,y:c};break;case"top-right":f.anchor={x:i-c,y:c,column:by};break;case"bottom-left":f.anchor={x:c,y:o-c,row:by};break;case"bottom-right":f.anchor={x:i-c,y:o-c,column:by,row:by}}return f}function bx(e,t){var n,r,a=t.items[0],i=a.datum,o=a.orient,u=a.bounds,c=a.x,s=a.y;return a._bounds?a._bounds.clear().union(u):a._bounds=u.clone(),u.clear(),function(e,t,n){var r=t.padding,a=r-n.x,i=r-n.y;if(t.datum.title){var o=t.items[1].items[0],u=o.anchor,c=t.titlePadding||0,s=r-o.x,l=r-o.y;switch(o.orient){case dy:a+=Math.ceil(o.bounds.width())+c;break;case hy:case py:break;default:i+=o.bounds.height()+c}switch((a||i)&&yx(e,n,a,i),o.orient){case dy:l+=gx(t,n,o,u,1,1);break;case hy:s+=gx(t,n,o,by,0,0)+c,l+=gx(t,n,o,u,1,1);break;case py:s+=gx(t,n,o,u,0,0),l+=gx(t,n,o,by,-1,0,1)+c;break;default:s+=gx(t,n,o,u,0,0)}(s||l)&&yx(e,o,s,l),(s=Math.round(o.bounds.x1-r))<0&&(yx(e,n,-s,0),yx(e,o,-s,0))}else(a||i)&&yx(e,n,a,i)}(e,a,a.items[0].items[0]),u=function(e,t){return e.items.forEach((function(e){return t.union(e.bounds)})),t.x1=e.padding,t.y1=e.padding,t}(a,u),n=2*a.padding,r=2*a.padding,u.empty()||(n=Math.ceil(u.width()+n),r=Math.ceil(u.height()+r)),"symbol"===i.type&&function(e){var t=e.reduce((function(e,t){return e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e}),{});e.forEach((function(e){e.width=t[e.column],e.height=e.bounds.y2-e.y}))}(a.items[0].items[0].items[0].items),o!==Fy&&(a.x=c=0,a.y=s=0),a.width=n,a.height=r,Rv(u.set(c,s,c+n,s+r),a),a.mark.bounds.clear().union(u),a}function gx(e,t,n,r,a,i,o){var u="symbol"!==e.datum.type,c=n.datum.vgrad,s=(!u||!i&&c||o?t:t.items[0]).bounds[a?"y2":"x2"]-e.padding,l=c&&i?s:0,f=c&&i?0:s,d=a<=0?0:vb(n);return Math.round(r===vy?l:r===by?f-d:.5*(s-d))}function yx(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function xx(e){fo.call(this,null,e)}function Ox(e,t){var n=0;if(void 0===t){var r,a=Object(mo.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;(i=+i)&&(n+=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,c=Object(mo.a)(e);try{for(c.s();!(o=c.n()).done;){var s=o.value;(s=+t(s,++u,e))&&(n+=s)}}catch(l){c.e(l)}finally{c.f()}}return n}function kx(e){fo.call(this,null,e)}function wx(e){fo.call(this,null,e)}function jx(){return Ai({})}function _x(e){fo.call(this,null,e)}function Sx(e){fo.call(this,[],e)}Object(ne.z)(xx,fo,{transform:function(e,t){var n,r=t.dataflow;return e.mark.items.forEach((function(t){e.layout&&fx(r,t,e.layout),function(e,t,n){var r,a,i,o,u,c=t.items,s=Math.max(0,t.width||0),l=Math.max(0,t.height||0),f=(new Nv).set(0,0,s,l),d=f.clone(),h=f.clone(),p=[];for(o=0,u=c.length;o<u;++o)switch((a=c[o]).role){case yy:(tx(a)?d:h).union(nx(e,a,s,l));break;case xy:r=a;break;case wy:p.push(bx(e,a));break;case Oy:case ky:case jy:case _y:case Sy:case Ey:case Cy:case Ay:d.union(a.bounds),h.union(a.bounds);break;default:f.union(a.bounds)}if(p.length){var v={};for(var m in p.forEach((function(e){(i=e.orient||hy)!==Fy&&(v[i]||(v[i]=[])).push(e)})),v){var b=v[m];lx(e,b,mx(b,m,n.legends,d,h,s,l))}p.forEach((function(t){var r=t.bounds;if(r.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=r,e.dirty(t)),n.autosize&&n.autosize.type===Ty)switch(t.orient){case dy:case hy:f.add(r.x1,0).add(r.x2,0);break;case fy:case py:f.add(0,r.y1).add(0,r.y2)}else f.union(r)}))}f.union(d).union(h),r&&f.union(function(e,t,n,r,a){var i,o=t.items[0],u=o.frame,c=o.orient,s=o.anchor,l=o.offset,f=o.padding,d=o.items[0].items[0],h=o.items[1]&&o.items[1].items[0],p=c===dy||c===hy?r:n,v=0,m=0,b=0,g=0,y=0;if(u!==gy?c===dy?(v=a.y2,p=a.y1):c===hy?(v=a.y1,p=a.y2):(v=a.x1,p=a.x2):c===dy&&(v=r,p=0),i=s===vy?v:s===by?p:(v+p)/2,h&&h.text){switch(c){case fy:case py:y=d.bounds.height()+f;break;case dy:g=d.bounds.width()+f;break;case hy:g=-d.bounds.width()-f}Zy.clear().union(h.bounds),Zy.translate(g-(h.x||0),y-(h.y||0)),ex(h,"x",g)|ex(h,"y",y)&&(e.dirty(h),h.bounds.clear().union(Zy),h.mark.bounds.clear().union(Zy),e.dirty(h)),Zy.clear().union(h.bounds)}else Zy.clear();switch(Zy.union(d.bounds),c){case fy:m=i,b=a.y1-Zy.height()-l;break;case dy:m=a.x1-Zy.width()-l,b=i;break;case hy:m=a.x2+Zy.width()+l,b=i;break;case py:m=i,b=a.y2+l;break;default:m=o.x,b=o.y}return ex(o,"x",m)|ex(o,"y",b)&&(Zy.translate(m,b),e.dirty(o),o.bounds.clear().union(Zy),t.bounds.clear().union(Zy),e.dirty(o)),o.bounds}(e,r,s,l,f));t.clip&&f.set(0,0,t.width||0,t.height||0);!function(e,t,n,r){var a=r.autosize||{},i=a.type;if(e._autosize<1||!i)return;var o=e._width,u=e._height,c=Math.max(0,t.width||0),s=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1)),d=Math.max(0,Math.ceil(n.x2-c)),h=Math.max(0,Math.ceil(n.y2-l));if(a.contains===Ny){var p=e.padding();o-=p.left+p.right,u-=p.top+p.bottom}i===Fy?(s=0,f=0,c=o,l=u):i===Ty?(c=Math.max(0,o-s-d),l=Math.max(0,u-f-h)):i===Iy?(c=Math.max(0,o-s-d),u=l+f+h):i===Dy?(o=c+s+d,l=Math.max(0,u-f-h)):"pad"===i&&(o=c+s+d,u=l+f+h);e._resizeView(o,u,c,l,[s,f],a.resize)}(e,t,f,n)}(r,t,e)})),(n=e.mark.group)&&"legend-entry"!==n.mark.role?t.reflow():t}}),Object(ne.z)(kx,fo,{transform:function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=this.value,i=e.scale,o=mp(i,null==e.count?e.values?e.values.length:10:e.count,e.minstep),u=e.format||yp(n,i,o,e.formatSpecifier,e.formatType,!!e.values),c=e.values?bp(i,e.values,o):gp(i,o);return a&&(r.rem=a),a=c.map((function(e,t){return Ai({index:t/(c.length-1||1),value:e,label:u(e)})})),e.extra&&a.length&&a.push(Ai({index:-1,extra:{value:a[0].value},label:""})),r.source=a,r.add=a,this.value=a,r}}),Object(ne.z)(wx,fo,{transform:function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.item||jx,i=e.key||Ei,o=this.value;return Object(ne.B)(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(i))&&Object(ne.o)("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=function(e){var t=Object(ne.t)().test((function(e){return e.exit}));return t.lookup=function(n){return t.get(e(n))},t}(i)),t.visit(t.ADD,(function(e){var t=i(e),n=o.get(t);n?n.exit?(o.empty--,r.add.push(n)):r.mod.push(n):(n=a(e),o.set(t,n),r.add.push(n)),n.datum=e,n.exit=!1})),t.visit(t.MOD,(function(e){var t=i(e),n=o.get(t);n&&(n.datum=e,r.mod.push(n))})),t.visit(t.REM,(function(e){var t=i(e),n=o.get(t);e!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++o.empty)})),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}}),Object(ne.z)(_x,fo,{transform:function(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,a=e.encoders,i=t.encode;if(Object(ne.B)(i)){if(!n.changed()&&!i.every((function(e){return a[e]})))return t.StopPropagation;i=i[0],n.encode=null}var o="enter"===i,u=a.update||ne.s,c=a.enter||ne.s,s=a.exit||ne.s,l=(i&&!o?a[i]:u)||ne.s;if(t.changed(t.ADD)&&(t.visit(t.ADD,(function(t){c(t,e),u(t,e)})),n.modifies(c.output),n.modifies(u.output),l!==ne.s&&l!==u&&(t.visit(t.ADD,(function(t){l(t,e)})),n.modifies(l.output))),t.changed(t.REM)&&s!==ne.s&&(t.visit(t.REM,(function(t){s(t,e)})),n.modifies(s.output)),o||l!==ne.s){var f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,(function(t){var a=c(t,e)||r;(l(t,e)||a)&&n.mod.push(t)})),n.mod.length&&n.modifies(c.output)):t.visit(f,(function(t){(l(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(l.output)}return n.changed()?n:t.StopPropagation}}),Object(ne.z)(Sx,fo,{transform:function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,r,a,i,o,u=t.dataflow.locale(),c=t.fork(t.NO_SOURCE|t.NO_FIELDS),s=this.value,l=e.type||dp,f=e.scale,d=+e.limit,h=mp(f,null==e.count?5:e.count,e.minstep),p=!!e.values||l===dp,v=e.format||jp(u,f,h,l,e.formatSpecifier,e.formatType,p),m=e.values||wp(f,h);return s&&(c.rem=s),l===dp?(d&&m.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),s=m.slice(0,d-1),o=!0):s=m,Object(ne.E)(a=e.size)?(e.values||0!==f(s[0])||(s=s.slice(1)),i=s.reduce((function(t,n){return Math.max(t,a(n,e))}),0)):a=Object(ne.m)(i=a||8),s=s.map((function(t,n){return Ai({index:n,label:v(t,n,s),value:t,offset:i,size:a(t,e)})})),o&&(o=m[s.length],s.push(Ai({index:s.length,label:"\u2026".concat(m.length-s.length," entries"),value:o,offset:i,size:a(o,e)})))):"gradient"===l?(n=f.domain(),r=op(f,n[0],Object(ne.W)(n)),m.length<3&&!e.values&&n[0]!==Object(ne.W)(n)&&(m=[n[0],Object(ne.W)(n)]),s=m.map((function(e,t){return Ai({index:t,label:v(e,t,m),value:e,perc:r(e)})}))):(a=m.length-1,r=function(e){var t=e.domain(),n=t.length-1,r=+t[0],a=+Object(ne.W)(t),i=a-r;if(e.type===Nh){var o=n?i/n:.1;i=(a+=o)-(r-=o)}return function(e){return(e-r)/i}}(f),s=m.map((function(e,t){return Ai({index:t,label:v(e,t,m),value:e,perc:t?r(e):0,perc2:t===a?1:r(m[t+1])})}))),c.source=s,c.add=s,this.value=s,c}});var Ex=function(e){return e.source.x},Cx=function(e){return e.source.y},Ax=function(e){return e.target.x},Nx=function(e){return e.target.y};function Tx(e){fo.call(this,{},e)}Tx.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Object(ne.z)(Tx,fo,{transform:function(e,t){var n=e.sourceX||Ex,r=e.sourceY||Cx,a=e.targetX||Ax,i=e.targetY||Nx,o=e.as||"path",u=e.orient||"vertical",c=e.shape||"line",s=Mx.get(c+"-"+u)||Mx.get(c);return s||Object(ne.o)("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(function(e){e[o]=s(n(e),r(e),a(e),i(e))})),t.reflow(e.modified()).modifies(o)}});var Ix=function(e,t,n,r){return"M"+e+","+t+"L"+n+","+r},Dx=function(e,t,n,r){var a=n-e,i=r-t,o=Math.sqrt(a*a+i*i)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(i,a)/Math.PI+" 0 1 "+n+","+r},Fx=function(e,t,n,r){var a=n-e,i=r-t,o=.2*(a+i),u=.2*(i-a);return"M"+e+","+t+"C"+(e+o)+","+(t+u)+" "+(n+u)+","+(r-o)+" "+n+","+r},Mx=Object(ne.t)({line:Ix,"line-radial":function(e,t,n,r){return Ix(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},arc:Dx,"arc-radial":function(e,t,n,r){return Dx(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},curve:Fx,"curve-radial":function(e,t,n,r){return Fx(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},"orthogonal-horizontal":function(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n},"orthogonal-vertical":function(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r},"orthogonal-radial":function(e,t,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),u=Math.sin(n);return"M"+t*a+","+t*i+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*o+","+t*u+"L"+r*o+","+r*u},"diagonal-horizontal":function(e,t,n,r){var a=(e+n)/2;return"M"+e+","+t+"C"+a+","+t+" "+a+","+r+" "+n+","+r},"diagonal-vertical":function(e,t,n,r){var a=(t+r)/2;return"M"+e+","+t+"C"+e+","+a+" "+n+","+a+" "+n+","+r},"diagonal-radial":function(e,t,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),u=Math.sin(n),c=(t+r)/2;return"M"+t*a+","+t*i+"C"+c*a+","+c*i+" "+c*o+","+c*u+" "+r*o+","+r*u}});function Rx(e){fo.call(this,null,e)}Rx.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Object(ne.z)(Rx,fo,{transform:function(e,t){var n,r,a,i=e.as||["startAngle","endAngle"],o=i[0],u=i[1],c=e.field||ne.Q,s=e.startAngle||0,l=null!=e.endAngle?e.endAngle:2*Math.PI,f=t.source,d=f.map(c),h=d.length,p=s,v=(l-s)/Ox(d),m=ju(h);for(e.sort&&m.sort((function(e,t){return d[e]-d[t]})),n=0;n<h;++n)a=d[m[n]],(r=f[m[n]])[o]=p,r[u]=p+=a*v;return this.value=d,t.reflow(e.modified()).modifies(i)}});function zx(e){return $h(e)&&e!==Sh}var Lx=Object(ne.fb)(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Px(e){fo.call(this,null,e),this.modified(!0)}function Bx(e,t,n){Zh(e)&&(Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0))!==t.length&&n.warn("Log scale domain includes zero: "+Object(ne.bb)(t)));return t}function Wx(e,t,n){return Object(ne.E)(e)&&(t||n)?rp(e,Ux(t||[0,1],n)):e}function Ux(e,t){return t?e.slice().reverse():e}function Vx(e){fo.call(this,null,e)}Object(ne.z)(Px,fo,{transform:function(e,t){var n=t.dataflow,r=this.value,a=function(e){var t,n=e.type,r="";if(n===Sh)return"sequential-linear";(function(e){var t=e.type;return $h(t)&&t!==jh&&t!==_h&&(e.scheme||e.range&&e.range.length&&e.range.every(ne.J))})(e)&&(r=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?"sequential-":3===t?"diverging-":"");return(r+n||yh).toLowerCase()}(e);for(a in r&&a===r.type||(this.value=r=Kh(a)()),e)if(!Lx[a]){if("padding"===a&&zx(r.type))continue;Object(ne.E)(r[a])?r[a](e[a]):n.warn("Unsupported scale property: "+a)}return function(e,t,n){var r=e.type,a=t.round||!1,i=t.range;if(null!=t.rangeStep)i=function(e,t,n){e!==Dh&&e!==Ih&&Object(ne.o)("Only band and point scales support rangeStep.");var r=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,a=e===Ih?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*gh(n,a,r)]}(r,t,n);else if(t.scheme&&(i=function(e,t,n){var r,a=t.schemeExtent;Object(ne.B)(t.scheme)?r=ap(t.scheme,t.interpolate,t.interpolateGamma):(r=fp(t.scheme.toLowerCase()))||Object(ne.o)("Unrecognized scheme name: ".concat(t.scheme));return n=e===Nh?n+1:e===Fh?n-1:e===Ch||e===Ah?+t.schemeCount||5:n,ep(e)?Wx(r,a,t.reverse):Object(ne.E)(r)?ip(Wx(r,a),n):e===Th?r:r.slice(0,n)}(r,t,n),Object(ne.E)(i))){if(e.interpolator)return e.interpolator(i);Object(ne.o)("Scale type ".concat(r," does not support interpolating color schemes."))}if(i&&ep(r))return e.interpolator(ap(Ux(i,t.reverse),t.interpolate,t.interpolateGamma));i&&t.interpolate&&e.interpolate?e.interpolate(up(t.interpolate,t.interpolateGamma)):Object(ne.E)(e.round)?e.round(a):Object(ne.E)(e.rangeRound)&&e.interpolate(a?Ef:Sf);i&&e.range(Ux(i,t.reverse))}(r,e,function(e,t,n){var r=t.bins;if(r&&!Object(ne.B)(r)){var a=e.domain(),i=a[0],o=Object(ne.W)(a),u=r.step,c=null==r.start?i:r.start,s=null==r.stop?o:r.stop;u||Object(ne.o)("Scale bins parameter missing step property."),c<i&&(c=u*Math.ceil(i/u)),s>o&&(s=u*Math.floor(o/u)),r=ju(c,s+u/2,u)}r?e.bins=r:e.bins&&delete e.bins;e.type===Fh&&(r?t.domain||t.domainRaw||(e.domain(r),n=r.length):e.bins=e.domain());return n}(r,e,function(e,t,n){var r=function(e,t,n){return t?(e.domain(Bx(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var a,i,o=t.domain,u=e.type,c=t.zero||void 0===t.zero&&function(e){var t=e.type;return!e.bins&&(t===yh||t===Oh||t===kh)}(e);if(!o)return 0;zx(u)&&t.padding&&o[0]!==Object(ne.W)(o)&&(o=function(e,t,n,r,a,i){var o=Math.abs(Object(ne.W)(n)-n[0]),u=o/(o-2*r),c=e===xh?Object(ne.ob)(t,null,u):e===kh?Object(ne.pb)(t,null,u,.5):e===Oh?Object(ne.pb)(t,null,u,a||1):e===wh?Object(ne.qb)(t,null,u,i||1):Object(ne.nb)(t,null,u);return(t=t.slice())[0]=c[0],t[t.length-1]=c[1],t}(u,o,t.range,t.padding,t.exponent,t.constant));if((c||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(a=(o=o.slice()).length-1||1,c&&(o[0]>0&&(o[0]=0),o[a]<0&&(o[a]=0)),null!=t.domainMin&&(o[0]=t.domainMin),null!=t.domainMax&&(o[a]=t.domainMax),null!=t.domainMid)){var s=(i=t.domainMid)>o[a]?a+1:i<o[0]?0:a;s!==a&&n.warn("Scale domainMid exceeds domain min or max.",i),o.splice(s,0,i)}e.domain(Bx(u,o,n)),u===Th&&e.unknown(t.domainImplicit?Ol:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&mp(e,t.nice)||null);return o.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),Object(ne.z)(Vx,fo,{transform:function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Di(e.sort)),this.modified(n),t}});var qx="zero",Hx="center",Gx="normalize",Kx=["y0","y1"];function Xx(e){fo.call(this,null,e)}function Yx(e,t,n,r,a){for(var i,o=(t-e.sum)/2,u=e.length,c=0;c<u;++c)(i=e[c])[r]=o,i[a]=o+=Math.abs(n(i))}function $x(e,t,n,r,a){for(var i,o=1/e.sum,u=0,c=e.length,s=0,l=0;s<c;++s)(i=e[s])[r]=u,i[a]=u=o*(l+=Math.abs(n(i)))}function Jx(e,t,n,r,a){for(var i,o,u=0,c=0,s=e.length,l=0;l<s;++l)(i=+n(o=e[l]))<0?(o[r]=c,o[a]=c+=i):(o[r]=u,o[a]=u+=i)}Xx.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:qx,values:[qx,Hx,Gx]},{name:"as",type:"string",array:!0,length:2,default:Kx}]},Object(ne.z)(Xx,fo,{transform:function(e,t){var n,r,a,i,o=e.as||Kx,u=o[0],c=o[1],s=Di(e.sort),l=e.field||ne.Q,f=e.offset===Hx?Yx:e.offset===Gx?$x:Jx;for(n=function(e,t,n,r){var a,i,o,u,c,s,l,f,d,h=[],p=function(e){return e(c)};if(null==t)h.push(e.slice());else for(a={},i=0,o=e.length;i<o;++i)c=e[i],(l=a[s=t.map(p)])||(a[s]=l=[],h.push(l)),l.push(c);for(s=0,d=0,u=h.length;s<u;++s){for(i=0,f=0,o=(l=h[s]).length;i<o;++i)f+=Math.abs(r(l[i]));l.sum=f,f>d&&(d=f),n&&l.sort(n)}return h.max=d,h}(t.source,e.groupby,s,l),r=0,a=n.length,i=n.max;r<a;++r)f(n[r],i,l,u,c);return t.reflow(e.modified()).modifies(o)}});var Qx=function(e){return e};function Zx(e,t){e&&tO.hasOwnProperty(e.type)&&tO[e.type](e,t)}var eO={Feature:function(e,t){Zx(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,a=n.length;++r<a;)Zx(n[r].geometry,t)}},tO={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){nO(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)nO(n[r],t,0)},Polygon:function(e,t){rO(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)rO(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,a=n.length;++r<a;)Zx(n[r],t)}};function nO(e,t,n){var r,a=-1,i=e.length-n;for(t.lineStart();++a<i;)r=e[a],t.point(r[0],r[1],r[2]);t.lineEnd()}function rO(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)nO(e[n],t,1);t.polygonEnd()}var aO=function(e,t){e&&eO.hasOwnProperty(e.type)?eO[e.type](e,t):Zx(e,t)},iO=n(3),oO=n(10),uO=function(){function e(){Object(iO.a)(this,e),this._partials=new Float64Array(32),this._n=0}return Object(oO.a)(e,[{key:"add",value:function(e){for(var t=this._partials,n=0,r=0;r<this._n&&r<32;r++){var a=t[r],i=e+a,o=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}},{key:"valueOf",value:function(){var e,t,n,r=this._partials,a=this._n,i=0;if(a>0){for(i=r[--a];a>0&&(e=i,!(n=(t=r[--a])-((i=e+t)-e))););a>0&&(n<0&&r[a-1]<0||n>0&&r[a-1]>0)&&(t=2*n)==(e=i+t)-i&&(i=e)}return i}}]),e}();var cO=1e-6,sO=1e-12,lO=Math.PI,fO=lO/2,dO=lO/4,hO=2*lO,pO=180/lO,vO=lO/180,mO=Math.abs,bO=Math.atan,gO=Math.atan2,yO=Math.cos,xO=Math.ceil,OO=Math.exp,kO=(Math.floor,Math.hypot),wO=Math.log,jO=Math.pow,_O=Math.sin,SO=Math.sign||function(e){return e>0?1:e<0?-1:0},EO=Math.sqrt,CO=Math.tan;function AO(e){return e>1?0:e<-1?lO:Math.acos(e)}function NO(e){return e>1?fO:e<-1?-fO:Math.asin(e)}function TO(){}var IO,DO,FO,MO,RO=new uO,zO=new uO,LO={point:TO,lineStart:TO,lineEnd:TO,polygonStart:function(){LO.lineStart=PO,LO.lineEnd=UO},polygonEnd:function(){LO.lineStart=LO.lineEnd=LO.point=TO,RO.add(mO(zO)),zO=new uO},result:function(){var e=RO/2;return RO=new uO,e}};function PO(){LO.point=BO}function BO(e,t){LO.point=WO,IO=FO=e,DO=MO=t}function WO(e,t){zO.add(MO*e-FO*t),FO=e,MO=t}function UO(){WO(IO,DO)}var VO=LO,qO=1/0,HO=qO,GO=-qO,KO=GO;var XO,YO,$O,JO,QO={point:function(e,t){e<qO&&(qO=e);e>GO&&(GO=e);t<HO&&(HO=t);t>KO&&(KO=t)},lineStart:TO,lineEnd:TO,polygonStart:TO,polygonEnd:TO,result:function(){var e=[[qO,HO],[GO,KO]];return GO=KO=-(HO=qO=1/0),e}},ZO=0,ek=0,tk=0,nk=0,rk=0,ak=0,ik=0,ok=0,uk=0,ck={point:sk,lineStart:lk,lineEnd:hk,polygonStart:function(){ck.lineStart=pk,ck.lineEnd=vk},polygonEnd:function(){ck.point=sk,ck.lineStart=lk,ck.lineEnd=hk},result:function(){var e=uk?[ik/uk,ok/uk]:ak?[nk/ak,rk/ak]:tk?[ZO/tk,ek/tk]:[NaN,NaN];return ZO=ek=tk=nk=rk=ak=ik=ok=uk=0,e}};function sk(e,t){ZO+=e,ek+=t,++tk}function lk(){ck.point=fk}function fk(e,t){ck.point=dk,sk($O=e,JO=t)}function dk(e,t){var n=e-$O,r=t-JO,a=EO(n*n+r*r);nk+=a*($O+e)/2,rk+=a*(JO+t)/2,ak+=a,sk($O=e,JO=t)}function hk(){ck.point=sk}function pk(){ck.point=mk}function vk(){bk(XO,YO)}function mk(e,t){ck.point=bk,sk(XO=$O=e,YO=JO=t)}function bk(e,t){var n=e-$O,r=t-JO,a=EO(n*n+r*r);nk+=a*($O+e)/2,rk+=a*(JO+t)/2,ak+=a,ik+=(a=JO*e-$O*t)*($O+e),ok+=a*(JO+t),uk+=3*a,sk($O=e,JO=t)}var gk=ck;function yk(e){this._context=e}yk.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,hO)}},result:TO};var xk,Ok,kk,wk,jk,_k=new uO,Sk={point:TO,lineStart:function(){Sk.point=Ek},lineEnd:function(){xk&&Ck(Ok,kk),Sk.point=TO},polygonStart:function(){xk=!0},polygonEnd:function(){xk=null},result:function(){var e=+_k;return _k=new uO,e}};function Ek(e,t){Sk.point=Ck,Ok=wk=e,kk=jk=t}function Ck(e,t){wk-=e,jk-=t,_k.add(EO(wk*wk+jk*jk)),wk=e,jk=t}var Ak=Sk;function Nk(){this._string=[]}function Tk(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}Nk.prototype={_radius:4.5,_circle:Tk(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=Tk(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var Ik=function(e,t){var n,r,a=4.5;function i(e){return e&&("function"===typeof a&&r.pointRadius(+a.apply(this,arguments)),aO(e,n(r))),r.result()}return i.area=function(e){return aO(e,n(VO)),VO.result()},i.measure=function(e){return aO(e,n(Ak)),Ak.result()},i.bounds=function(e){return aO(e,n(QO)),QO.result()},i.centroid=function(e){return aO(e,n(gk)),gk.result()},i.projection=function(t){return arguments.length?(n=null==t?(e=null,Qx):(e=t).stream,i):e},i.context=function(e){return arguments.length?(r=null==e?(t=null,new Nk):new yk(t=e),"function"!==typeof a&&r.pointRadius(a),i):t},i.pointRadius=function(e){return arguments.length?(a="function"===typeof e?e:(r.pointRadius(+e),+e),i):a},i.projection(e).context(t)},Dk=function(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:TO,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}},Fk=function(e,t){return mO(e[0]-t[0])<cO&&mO(e[1]-t[1])<cO};function Mk(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var Rk=function(e,t,n,r,a){var i,o,u=[],c=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],o=e[t];if(Fk(r,o)){if(!r[2]&&!o[2]){for(a.lineStart(),i=0;i<t;++i)a.point((r=e[i])[0],r[1]);return void a.lineEnd()}o[0]+=2e-6}u.push(n=new Mk(r,e,null,!0)),c.push(n.o=new Mk(r,null,n,!1)),u.push(n=new Mk(o,e,null,!1)),c.push(n.o=new Mk(o,null,n,!0))}})),u.length){for(c.sort(t),zk(u),zk(c),i=0,o=c.length;i<o;++i)c[i].e=n=!n;for(var s,l,f=u[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;s=d.z,a.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(i=0,o=s.length;i<o;++i)a.point((l=s[i])[0],l[1]);else r(d.x,d.n.x,1,a);d=d.n}else{if(h)for(s=d.p.z,i=s.length-1;i>=0;--i)a.point((l=s[i])[0],l[1]);else r(d.x,d.p.x,-1,a);d=d.p}s=(d=d.o).z,h=!h}while(!d.v);a.lineEnd()}}};function zk(e){if(t=e.length){for(var t,n,r=0,a=e[0];++r<t;)a.n=n=e[r],n.p=a,a=n;a.n=n=e[0],n.p=a}}function Lk(e){return[gO(e[1],e[0]),NO(e[2])]}function Pk(e){var t=e[0],n=e[1],r=yO(n);return[r*yO(t),r*_O(t),_O(n)]}function Bk(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Wk(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Uk(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Vk(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function qk(e){var t=EO(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Hk(e){return mO(e[0])<=lO?e[0]:SO(e[0])*((mO(e[0])+lO)%hO-lO)}var Gk=k.a.mark(Kk);function Kk(e){var t,n,r;return k.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=Object(mo.a)(e),a.prev=1,t.s();case 3:if((n=t.n()).done){a.next=8;break}return r=n.value,a.delegateYield(r,"t0",6);case 6:a.next=3;break;case 8:a.next=13;break;case 10:a.prev=10,a.t1=a.catch(1),t.e(a.t1);case 13:return a.prev=13,t.f(),a.finish(13);case 16:case"end":return a.stop()}}),Gk,null,[[1,10,13,16]])}function Xk(e){return Array.from(Kk(e))}var Yk=function(e,t,n,r){return function(a){var i,o,u,c=t(a),s=Dk(),l=t(s),f=!1,d={point:h,lineStart:v,lineEnd:m,polygonStart:function(){d.point=b,d.lineStart=g,d.lineEnd=y,o=[],i=[]},polygonEnd:function(){d.point=h,d.lineStart=v,d.lineEnd=m,o=Xk(o);var e=function(e,t){var n=Hk(t),r=t[1],a=_O(r),i=[_O(n),-yO(n),0],o=0,u=0,c=new uO;1===a?r=fO+cO:-1===a&&(r=-fO-cO);for(var s=0,l=e.length;s<l;++s)if(d=(f=e[s]).length)for(var f,d,h=f[d-1],p=Hk(h),v=h[1]/2+dO,m=_O(v),b=yO(v),g=0;g<d;++g,p=x,m=k,b=w,h=y){var y=f[g],x=Hk(y),O=y[1]/2+dO,k=_O(O),w=yO(O),j=x-p,_=j>=0?1:-1,S=_*j,E=S>lO,C=m*k;if(c.add(gO(C*_*_O(S),b*w+C*yO(S))),o+=E?j+_*hO:j,E^p>=n^x>=n){var A=Wk(Pk(h),Pk(y));qk(A);var N=Wk(i,A);qk(N);var T=(E^j>=0?-1:1)*NO(N[2]);(r>T||r===T&&(A[0]||A[1]))&&(u+=E^j>=0?1:-1)}}return(o<-1e-6||o<cO&&c<-1e-12)^1&u}(i,r);o.length?(f||(a.polygonStart(),f=!0),Rk(o,Jk,e,n,a)):e&&(f||(a.polygonStart(),f=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),o=i=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function h(t,n){e(t,n)&&a.point(t,n)}function p(e,t){c.point(e,t)}function v(){d.point=p,c.lineStart()}function m(){d.point=h,c.lineEnd()}function b(e,t){u.push([e,t]),l.point(e,t)}function g(){l.lineStart(),u=[]}function y(){b(u[0][0],u[0][1]),l.lineEnd();var e,t,n,r,c=l.clean(),d=s.result(),h=d.length;if(u.pop(),i.push(u),u=null,h)if(1&c){if((t=(n=d[0]).length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),e=0;e<t;++e)a.point((r=n[e])[0],r[1]);a.lineEnd()}}else h>1&&2&c&&d.push(d.pop().concat(d.shift())),o.push(d.filter($k))}return d}};function $k(e){return e.length>1}function Jk(e,t){return((e=e.x)[0]<0?e[1]-fO-cO:fO-e[1])-((t=t.x)[0]<0?t[1]-fO-cO:fO-t[1])}var Qk=Yk((function(){return!0}),(function(e){var t,n=NaN,r=NaN,a=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(i,o){var u=i>0?lO:-lO,c=mO(i-n);mO(c-lO)<cO?(e.point(n,r=(r+o)/2>0?fO:-fO),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(u,r),e.point(i,r),t=0):a!==u&&c>=lO&&(mO(n-a)<cO&&(n-=a*cO),mO(i-u)<cO&&(i-=u*cO),r=function(e,t,n,r){var a,i,o=_O(e-n);return mO(o)>cO?bO((_O(t)*(i=yO(r))*_O(n)-_O(r)*(a=yO(t))*_O(e))/(a*i*o)):(t+r)/2}(n,r,i,o),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(u,r),t=0),e.point(n=i,r=o),a=u},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var a;if(null==e)a=n*fO,r.point(-lO,a),r.point(0,a),r.point(lO,a),r.point(lO,0),r.point(lO,-a),r.point(0,-a),r.point(-lO,-a),r.point(-lO,0),r.point(-lO,a);else if(mO(e[0]-t[0])>cO){var i=e[0]<t[0]?lO:-lO;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(t[0],t[1])}),[-lO,-fO]);var Zk=function(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n};function ew(e,t){return[mO(e)>lO?e+Math.round(-e/hO)*hO:e,t]}function tw(e,t,n){return(e%=hO)?t||n?Zk(rw(e),aw(t,n)):rw(e):t||n?aw(t,n):ew}function nw(e){return function(t,n){return[(t+=e)>lO?t-hO:t<-lO?t+hO:t,n]}}function rw(e){var t=nw(e);return t.invert=nw(-e),t}function aw(e,t){var n=yO(e),r=_O(e),a=yO(t),i=_O(t);function o(e,t){var o=yO(t),u=yO(e)*o,c=_O(e)*o,s=_O(t),l=s*n+u*r;return[gO(c*a-l*i,u*n-s*r),NO(l*a+c*i)]}return o.invert=function(e,t){var o=yO(t),u=yO(e)*o,c=_O(e)*o,s=_O(t),l=s*a-c*i;return[gO(c*a+s*i,u*n+l*r),NO(l*n-u*r)]},o}ew.invert=ew;function iw(e,t,n,r,a,i){if(n){var o=yO(t),u=_O(t),c=r*n;null==a?(a=t+r*hO,i=t-c/2):(a=ow(o,a),i=ow(o,i),(r>0?a<i:a>i)&&(a+=r*hO));for(var s,l=a;r>0?l>i:l<i;l-=c)s=Lk([o,-u*yO(l),-u*_O(l)]),e.point(s[0],s[1])}}function ow(e,t){(t=Pk(t))[0]-=e,qk(t);var n=AO(-t[1]);return((-t[2]<0?-n:n)+hO-cO)%hO}var uw=function(e){var t=yO(e),n=6*vO,r=t>0,a=mO(t)>cO;function i(e,n){return yO(e)*yO(n)>t}function o(e,n,r){var a=[1,0,0],i=Wk(Pk(e),Pk(n)),o=Bk(i,i),u=i[0],c=o-u*u;if(!c)return!r&&e;var s=t*o/c,l=-t*u/c,f=Wk(a,i),d=Vk(a,s);Uk(d,Vk(i,l));var h=f,p=Bk(d,h),v=Bk(h,h),m=p*p-v*(Bk(d,d)-1);if(!(m<0)){var b=EO(m),g=Vk(h,(-p-b)/v);if(Uk(g,d),g=Lk(g),!r)return g;var y,x=e[0],O=n[0],k=e[1],w=n[1];O<x&&(y=x,x=O,O=y);var j=O-x,_=mO(j-lO)<cO;if(!_&&w<k&&(y=k,k=w,w=y),_||j<cO?_?k+w>0^g[1]<(mO(g[0]-x)<cO?k:w):k<=g[1]&&g[1]<=w:j>lO^(x<=g[0]&&g[0]<=O)){var S=Vk(h,(-p+b)/v);return Uk(S,d),[g,Lk(S)]}}}function u(t,n){var a=r?e:lO-e,i=0;return t<-a?i|=1:t>a&&(i|=2),n<-a?i|=4:n>a&&(i|=8),i}return Yk(i,(function(e){var t,n,c,s,l;return{lineStart:function(){s=c=!1,l=1},point:function(f,d){var h,p=[f,d],v=i(f,d),m=r?v?0:u(f,d):v?u(f+(f<0?lO:-lO),d):0;if(!t&&(s=c=v)&&e.lineStart(),v!==c&&(!(h=o(t,p))||Fk(t,h)||Fk(p,h))&&(p[2]=1),v!==c)l=0,v?(e.lineStart(),h=o(p,t),e.point(h[0],h[1])):(h=o(t,p),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(a&&t&&r^v){var b;m&n||!(b=o(p,t,!0))||(l=0,r?(e.lineStart(),e.point(b[0][0],b[0][1]),e.point(b[1][0],b[1][1]),e.lineEnd()):(e.point(b[1][0],b[1][1]),e.lineEnd(),e.lineStart(),e.point(b[0][0],b[0][1],3)))}!v||t&&Fk(t,p)||e.point(p[0],p[1]),t=p,c=v,n=m},lineEnd:function(){c&&e.lineEnd(),t=null},clean:function(){return l|(s&&c)<<1}}}),(function(t,r,a,i){iw(i,e,n,a,t,r)}),r?[0,-e]:[-lO,e-lO])},cw=1e9,sw=-cw;function lw(e,t,n,r){function a(a,i){return e<=a&&a<=n&&t<=i&&i<=r}function i(a,i,u,s){var l=0,f=0;if(null==a||(l=o(a,u))!==(f=o(i,u))||c(a,i)<0^u>0)do{s.point(0===l||3===l?e:n,l>1?r:t)}while((l=(l+u+4)%4)!==f);else s.point(i[0],i[1])}function o(r,a){return mO(r[0]-e)<cO?a>0?0:3:mO(r[0]-n)<cO?a>0?2:1:mO(r[1]-t)<cO?a>0?1:0:a>0?3:2}function u(e,t){return c(e.x,t.x)}function c(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var c,s,l,f,d,h,p,v,m,b,g,y=o,x=Dk(),O={point:k,lineStart:function(){O.point=w,s&&s.push(l=[]);b=!0,m=!1,p=v=NaN},lineEnd:function(){c&&(w(f,d),h&&m&&x.rejoin(),c.push(x.result()));O.point=k,m&&y.lineEnd()},polygonStart:function(){y=x,c=[],s=[],g=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,a=s.length;n<a;++n)for(var i,o,u=s[n],c=1,l=u.length,f=u[0],d=f[0],h=f[1];c<l;++c)i=d,o=h,d=(f=u[c])[0],h=f[1],o<=r?h>r&&(d-i)*(r-o)>(h-o)*(e-i)&&++t:h<=r&&(d-i)*(r-o)<(h-o)*(e-i)&&--t;return t}(),n=g&&t,a=(c=Xk(c)).length;(n||a)&&(o.polygonStart(),n&&(o.lineStart(),i(null,null,1,o),o.lineEnd()),a&&Rk(c,u,t,i,o),o.polygonEnd());y=o,c=s=l=null}};function k(e,t){a(e,t)&&y.point(e,t)}function w(i,o){var u=a(i,o);if(s&&l.push([i,o]),b)f=i,d=o,h=u,b=!1,u&&(y.lineStart(),y.point(i,o));else if(u&&m)y.point(i,o);else{var c=[p=Math.max(sw,Math.min(cw,p)),v=Math.max(sw,Math.min(cw,v))],x=[i=Math.max(sw,Math.min(cw,i)),o=Math.max(sw,Math.min(cw,o))];!function(e,t,n,r,a,i){var o,u=e[0],c=e[1],s=0,l=1,f=t[0]-u,d=t[1]-c;if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<s)return;o<l&&(l=o)}else if(f>0){if(o>l)return;o>s&&(s=o)}if(o=a-u,f||!(o<0)){if(o/=f,f<0){if(o>l)return;o>s&&(s=o)}else if(f>0){if(o<s)return;o<l&&(l=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<s)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>s&&(s=o)}if(o=i-c,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>s&&(s=o)}else if(d>0){if(o<s)return;o<l&&(l=o)}return s>0&&(e[0]=u+s*f,e[1]=c+s*d),l<1&&(t[0]=u+l*f,t[1]=c+l*d),!0}}}}}(c,x,e,t,n,r)?u&&(y.lineStart(),y.point(i,o),g=!1):(m||(y.lineStart(),y.point(c[0],c[1])),y.point(x[0],x[1]),u||y.lineEnd(),g=!1)}p=i,v=o,m=u}return O}}function fw(e){return function(t){var n=new dw;for(var r in e)n[r]=e[r];return n.stream=t,n}}function dw(){}function hw(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),aO(n,e.stream(QO)),t(QO.result()),null!=r&&e.clipExtent(r),e}function pw(e,t,n){return hw(e,(function(n){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],i=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),o=+t[0][0]+(r-i*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(a-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,u])}),n)}function vw(e,t,n){return pw(e,[[0,0],t],n)}function mw(e,t,n){return hw(e,(function(n){var r=+t,a=r/(n[1][0]-n[0][0]),i=(r-a*(n[1][0]+n[0][0]))/2,o=-a*n[0][1];e.scale(150*a).translate([i,o])}),n)}function bw(e,t,n){return hw(e,(function(n){var r=+t,a=r/(n[1][1]-n[0][1]),i=-a*n[0][0],o=(r-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([i,o])}),n)}dw.prototype={constructor:dw,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var gw=yO(30*vO),yw=function(e,t){return+t?function(e,t){function n(r,a,i,o,u,c,s,l,f,d,h,p,v,m){var b=s-r,g=l-a,y=b*b+g*g;if(y>4*t&&v--){var x=o+d,O=u+h,k=c+p,w=EO(x*x+O*O+k*k),j=NO(k/=w),_=mO(mO(k)-1)<cO||mO(i-f)<cO?(i+f)/2:gO(O,x),S=e(_,j),E=S[0],C=S[1],A=E-r,N=C-a,T=g*A-b*N;(T*T/y>t||mO((b*A+g*N)/y-.5)>.3||o*d+u*h+c*p<gw)&&(n(r,a,i,o,u,c,E,C,_,x/=w,O/=w,k,v,m),m.point(E,C),n(E,C,_,x,O,k,s,l,f,d,h,p,v,m))}}return function(t){var r,a,i,o,u,c,s,l,f,d,h,p,v={point:m,lineStart:b,lineEnd:y,polygonStart:function(){t.polygonStart(),v.lineStart=x},polygonEnd:function(){t.polygonEnd(),v.lineStart=b}};function m(n,r){n=e(n,r),t.point(n[0],n[1])}function b(){l=NaN,v.point=g,t.lineStart()}function g(r,a){var i=Pk([r,a]),o=e(r,a);n(l,f,s,d,h,p,l=o[0],f=o[1],s=r,d=i[0],h=i[1],p=i[2],16,t),t.point(l,f)}function y(){v.point=m,t.lineEnd()}function x(){b(),v.point=O,v.lineEnd=k}function O(e,t){g(r=e,t),a=l,i=f,o=d,u=h,c=p,v.point=g}function k(){n(l,f,s,d,h,p,a,i,r,o,u,c,16,t),v.lineEnd=y,y()}return v}}(e,t):function(e){return fw({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)};var xw=fw({point:function(e,t){this.stream.point(e*vO,t*vO)}});function Ow(e,t,n,r,a,i){if(!i)return function(e,t,n,r,a){function i(i,o){return[t+e*(i*=r),n-e*(o*=a)]}return i.invert=function(i,o){return[(i-t)/e*r,(n-o)/e*a]},i}(e,t,n,r,a);var o=yO(i),u=_O(i),c=o*e,s=u*e,l=o/e,f=u/e,d=(u*n-o*t)/e,h=(u*t+o*n)/e;function p(e,i){return[c*(e*=r)-s*(i*=a)+t,n-s*e-c*i]}return p.invert=function(e,t){return[r*(l*e-f*t+d),a*(h-f*e-l*t)]},p}function kw(e){return ww((function(){return e}))()}function ww(e){var t,n,r,a,i,o,u,c,s,l,f=150,d=480,h=250,p=0,v=0,m=0,b=0,g=0,y=0,x=1,O=1,k=null,w=Qk,j=null,_=Qx,S=.5;function E(e){return c(e[0]*vO,e[1]*vO)}function C(e){return(e=c.invert(e[0],e[1]))&&[e[0]*pO,e[1]*pO]}function A(){var e=Ow(f,0,0,x,O,y).apply(null,t(p,v)),r=Ow(f,d-e[0],h-e[1],x,O,y);return n=tw(m,b,g),u=Zk(t,r),c=Zk(n,u),o=yw(u,S),N()}function N(){return s=l=null,E}return E.stream=function(e){return s&&l===e?s:s=xw(function(e){return fw({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(w(o(_(l=e)))))},E.preclip=function(e){return arguments.length?(w=e,k=void 0,N()):w},E.postclip=function(e){return arguments.length?(_=e,j=r=a=i=null,N()):_},E.clipAngle=function(e){return arguments.length?(w=+e?uw(k=e*vO):(k=null,Qk),N()):k*pO},E.clipExtent=function(e){return arguments.length?(_=null==e?(j=r=a=i=null,Qx):lw(j=+e[0][0],r=+e[0][1],a=+e[1][0],i=+e[1][1]),N()):null==j?null:[[j,r],[a,i]]},E.scale=function(e){return arguments.length?(f=+e,A()):f},E.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],A()):[d,h]},E.center=function(e){return arguments.length?(p=e[0]%360*vO,v=e[1]%360*vO,A()):[p*pO,v*pO]},E.rotate=function(e){return arguments.length?(m=e[0]%360*vO,b=e[1]%360*vO,g=e.length>2?e[2]%360*vO:0,A()):[m*pO,b*pO,g*pO]},E.angle=function(e){return arguments.length?(y=e%360*vO,A()):y*pO},E.reflectX=function(e){return arguments.length?(x=e?-1:1,A()):x<0},E.reflectY=function(e){return arguments.length?(O=e?-1:1,A()):O<0},E.precision=function(e){return arguments.length?(o=yw(u,S=e*e),N()):EO(S)},E.fitExtent=function(e,t){return pw(E,e,t)},E.fitSize=function(e,t){return vw(E,e,t)},E.fitWidth=function(e,t){return mw(E,e,t)},E.fitHeight=function(e,t){return bw(E,e,t)},function(){return t=e.apply(this,arguments),E.invert=t.invert&&C,A()}}function jw(e){var t=0,n=lO/3,r=ww(e),a=r(t,n);return a.parallels=function(e){return arguments.length?r(t=e[0]*vO,n=e[1]*vO):[t*pO,n*pO]},a}function _w(e,t){var n=_O(e),r=(n+_O(t))/2;if(mO(r)<cO)return function(e){var t=yO(e);function n(e,n){return[e*t,_O(n)/t]}return n.invert=function(e,n){return[e/t,NO(n*t)]},n}(e);var a=1+n*(2*r-n),i=EO(a)/r;function o(e,t){var n=EO(a-2*r*_O(t))/r;return[n*_O(e*=r),i-n*yO(e)]}return o.invert=function(e,t){var n=i-t,o=gO(e,mO(n))*SO(n);return n*r<0&&(o-=lO*SO(e)*SO(n)),[o/r,NO((a-(e*e+n*n)*r*r)/(2*r))]},o}var Sw=function(){return jw(_w).scale(155.424).center([0,33.6442])},Ew=function(){return Sw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function Cw(e){return function(t,n){var r=yO(t),a=yO(n),i=e(r*a);return i===1/0?[2,0]:[i*a*_O(t),i*_O(n)]}}function Aw(e){return function(t,n){var r=EO(t*t+n*n),a=e(r),i=_O(a),o=yO(a);return[gO(t*i,r*o),NO(r&&n*i/r)]}}var Nw=Cw((function(e){return EO(2/(1+e))}));Nw.invert=Aw((function(e){return 2*NO(e/2)}));var Tw=Cw((function(e){return(e=AO(e))&&e/_O(e)}));Tw.invert=Aw((function(e){return e}));function Iw(e,t){return[e,wO(CO((fO+t)/2))]}Iw.invert=function(e,t){return[e,2*bO(OO(t))-fO]};function Dw(e){var t,n,r,a=kw(e),i=a.center,o=a.scale,u=a.translate,c=a.clipExtent,s=null;function l(){var i=lO*o(),u=a(function(e){function t(t){return(t=e(t[0]*vO,t[1]*vO))[0]*=pO,t[1]*=pO,t}return e=tw(e[0]*vO,e[1]*vO,e.length>2?e[2]*vO:0),t.invert=function(t){return(t=e.invert(t[0]*vO,t[1]*vO))[0]*=pO,t[1]*=pO,t},t}(a.rotate()).invert([0,0]));return c(null==s?[[u[0]-i,u[1]-i],[u[0]+i,u[1]+i]]:e===Iw?[[Math.max(u[0]-i,s),t],[Math.min(u[0]+i,n),r]]:[[s,Math.max(u[1]-i,t)],[n,Math.min(u[1]+i,r)]])}return a.scale=function(e){return arguments.length?(o(e),l()):o()},a.translate=function(e){return arguments.length?(u(e),l()):u()},a.center=function(e){return arguments.length?(i(e),l()):i()},a.clipExtent=function(e){return arguments.length?(null==e?s=t=n=r=null:(s=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),l()):null==s?null:[[s,t],[n,r]]},l()}function Fw(e){return CO((fO+e)/2)}function Mw(e,t){var n=yO(e),r=e===t?_O(e):wO(n/yO(t))/wO(Fw(t)/Fw(e)),a=n*jO(Fw(e),r)/r;if(!r)return Iw;function i(e,t){a>0?t<-fO+cO&&(t=-fO+cO):t>fO-cO&&(t=fO-cO);var n=a/jO(Fw(t),r);return[n*_O(r*e),a-n*yO(r*e)]}return i.invert=function(e,t){var n=a-t,i=SO(r)*EO(e*e+n*n),o=gO(e,mO(n))*SO(n);return n*r<0&&(o-=lO*SO(e)*SO(n)),[o/r,2*bO(jO(a/i,1/r))-fO]},i}function Rw(e,t){return[e,t]}Rw.invert=Rw;function zw(e,t){var n=yO(e),r=e===t?_O(e):(n-yO(t))/(t-e),a=n/r+e;if(mO(r)<cO)return Rw;function i(e,t){var n=a-t,i=r*e;return[n*_O(i),a-n*yO(i)]}return i.invert=function(e,t){var n=a-t,i=gO(e,mO(n))*SO(n);return n*r<0&&(i-=lO*SO(e)*SO(n)),[i/r,a-SO(r)*EO(e*e+n*n)]},i}var Lw=1.340264,Pw=-.081106,Bw=893e-6,Ww=.003796,Uw=EO(3)/2;function Vw(e,t){var n=NO(Uw*_O(t)),r=n*n,a=r*r*r;return[e*yO(n)/(Uw*(Lw+3*Pw*r+a*(7*Bw+9*Ww*r))),n*(Lw+Pw*r+a*(Bw+Ww*r))]}Vw.invert=function(e,t){for(var n,r=t,a=r*r,i=a*a*a,o=0;o<12&&(i=(a=(r-=n=(r*(Lw+Pw*a+i*(Bw+Ww*a))-t)/(Lw+3*Pw*a+i*(7*Bw+9*Ww*a)))*r)*a*a,!(mO(n)<sO));++o);return[Uw*e*(Lw+3*Pw*a+i*(7*Bw+9*Ww*a))/yO(r),NO(_O(r)/Uw)]};function qw(e,t){var n=yO(t),r=yO(e)*n;return[n*_O(e)/r,_O(t)/r]}qw.invert=Aw(bO);function Hw(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}Hw.invert=function(e,t){var n,r=t,a=25;do{var i=r*r,o=i*i;r-=n=(r*(1.007226+i*(.015085+o*(.028874*i-.044475-.005916*o)))-t)/(1.007226+i*(.045255+o*(.259866*i-.311325-.005916*11*o)))}while(mO(n)>cO&&--a>0);return[e/(.8707+(i=r*r)*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979)),r]};function Gw(e,t){return[yO(t)*_O(e),_O(t)]}Gw.invert=Aw(NO);function Kw(e,t){var n=yO(t),r=1+yO(e)*n;return[n*_O(e)/r,_O(t)/r]}Kw.invert=Aw((function(e){return 2*bO(e)}));function Xw(e,t){return[wO(CO((fO+t)/2)),-e]}Xw.invert=function(e,t){return[-t,2*bO(OO(e))-fO]};var Yw=Math.abs,$w=(Math.atan,Math.atan2,Math.ceil,Math.cos),Jw=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),Qw=(Math.tan,Math.PI),Zw=Qw/2,ej=(Math.SQRT1_2,nj(2));nj(Qw);function tj(e){return e>1?Zw:e<-1?-Zw:Math.asin(e)}function nj(e){return e>0?Math.sqrt(e):0}function rj(e,t){var n,r=e*Jw(t),a=30;do{t-=n=(t+Jw(t)-r)/(1+$w(t))}while(Yw(n)>1e-6&&--a>0);return t/2}var aj=function(e,t,n){function r(r,a){return[e*r*$w(a=rj(n,a)),t*Jw(a)]}return r.invert=function(r,a){return a=tj(a/t),[r/(e*$w(a)),tj((2*a+Jw(2*a))/n)]},r}(ej/Zw,ej,Qw),ij=Ik(),oj=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function uj(e,t){return function n(){var r=t();return r.type=e,r.path=Ik().projection(r),r.copy=r.copy||function(){var e=n();return oj.forEach((function(t){r[t]&&e[t](r[t]())})),e.path.pointRadius(r.path.pointRadius()),e},r}}function cj(e,t){if(!e||"string"!==typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(lj[e]=uj(e,t),this):lj[e]||null}function sj(e){return e&&e.path||ij}var lj={albers:Ew,albersusa:function(){var e,t,n,r,a,i,o=Ew(),u=Sw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Sw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(e,t){i=[e,t]}};function l(e){var t=e[0],o=e[1];return i=null,n.point(t,o),i||(r.point(t,o),i)||(a.point(t,o),i)}function f(){return e=t=null,l}return l.invert=function(e){var t=o.scale(),n=o.translate(),r=(e[0]-n[0])/t,a=(e[1]-n[1])/t;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?u:a>=.166&&a<.234&&r>=-.214&&r<-.115?c:o).invert(e)},l.stream=function(n){return e&&t===n?e:e=function(e){var t=e.length;return{point:function(n,r){for(var a=-1;++a<t;)e[a].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([o.stream(t=n),u.stream(n),c.stream(n)])},l.precision=function(e){return arguments.length?(o.precision(e),u.precision(e),c.precision(e),f()):o.precision()},l.scale=function(e){return arguments.length?(o.scale(e),u.scale(.35*e),c.scale(e),l.translate(o.translate())):o.scale()},l.translate=function(e){if(!arguments.length)return o.translate();var t=o.scale(),i=+e[0],l=+e[1];return n=o.translate(e).clipExtent([[i-.455*t,l-.238*t],[i+.455*t,l+.238*t]]).stream(s),r=u.translate([i-.307*t,l+.201*t]).clipExtent([[i-.425*t+cO,l+.12*t+cO],[i-.214*t-cO,l+.234*t-cO]]).stream(s),a=c.translate([i-.205*t,l+.212*t]).clipExtent([[i-.214*t+cO,l+.166*t+cO],[i-.115*t-cO,l+.234*t-cO]]).stream(s),f()},l.fitExtent=function(e,t){return pw(l,e,t)},l.fitSize=function(e,t){return vw(l,e,t)},l.fitWidth=function(e,t){return mw(l,e,t)},l.fitHeight=function(e,t){return bw(l,e,t)},l.scale(1070)},azimuthalequalarea:function(){return kw(Nw).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return kw(Tw).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return jw(Mw).scale(109.5).parallels([30,30])},conicequalarea:Sw,conicequidistant:function(){return jw(zw).scale(131.154).center([0,13.9389])},equalEarth:function(){return kw(Vw).scale(177.158)},equirectangular:function(){return kw(Rw).scale(152.63)},gnomonic:function(){return kw(qw).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,r,a,i,o,u=1,c=0,s=0,l=1,f=1,d=0,h=null,p=1,v=1,m=fw({point:function(e,t){var n=y([e,t]);this.stream.point(n[0],n[1])}}),b=Qx;function g(){return p=u*l,v=u*f,i=o=null,y}function y(n){var r=n[0]*p,a=n[1]*v;if(d){var i=a*e-r*t;r=r*e+a*t,a=i}return[r+c,a+s]}return y.invert=function(n){var r=n[0]-c,a=n[1]-s;if(d){var i=a*e+r*t;r=r*e-a*t,a=i}return[r/p,a/v]},y.stream=function(e){return i&&o===e?i:i=m(b(o=e))},y.postclip=function(e){return arguments.length?(b=e,h=n=r=a=null,g()):b},y.clipExtent=function(e){return arguments.length?(b=null==e?(h=n=r=a=null,Qx):lw(h=+e[0][0],n=+e[0][1],r=+e[1][0],a=+e[1][1]),g()):null==h?null:[[h,n],[r,a]]},y.scale=function(e){return arguments.length?(u=+e,g()):u},y.translate=function(e){return arguments.length?(c=+e[0],s=+e[1],g()):[c,s]},y.angle=function(n){return arguments.length?(t=_O(d=n%360*vO),e=yO(d),g()):d*pO},y.reflectX=function(e){return arguments.length?(l=e?-1:1,g()):l<0},y.reflectY=function(e){return arguments.length?(f=e?-1:1,g()):f<0},y.fitExtent=function(e,t){return pw(y,e,t)},y.fitSize=function(e,t){return vw(y,e,t)},y.fitWidth=function(e,t){return mw(y,e,t)},y.fitHeight=function(e,t){return bw(y,e,t)},y},mercator:function(){return Dw(Iw).scale(961/hO)},mollweide:function(){return kw(aj).scale(169.529)},naturalEarth1:function(){return kw(Hw).scale(175.295)},orthographic:function(){return kw(Gw).scale(249.5).clipAngle(90.000001)},stereographic:function(){return kw(Kw).scale(250).clipAngle(142)},transversemercator:function(){var e=Dw(Xw),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(var fj in lj)cj(fj,lj[fj]);function dj(e,t,n){var r=ju(e,t-cO,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function hj(e,t,n){var r=ju(e,t-cO,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function pj(){var e,t,n,r,a,i,o,u,c,s,l,f,d=10,h=d,p=90,v=360,m=2.5;function b(){return{type:"MultiLineString",coordinates:g()}}function g(){return ju(xO(r/p)*p,n,p).map(l).concat(ju(xO(u/v)*v,o,v).map(f)).concat(ju(xO(t/d)*d,e,d).filter((function(e){return mO(e%p)>cO})).map(c)).concat(ju(xO(i/h)*h,a,h).filter((function(e){return mO(e%v)>cO})).map(s))}return b.lines=function(){return g().map((function(e){return{type:"LineString",coordinates:e}}))},b.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(f(o).slice(1),l(n).reverse().slice(1),f(u).reverse().slice(1))]}},b.extent=function(e){return arguments.length?b.extentMajor(e).extentMinor(e):b.extentMinor()},b.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],u=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),u>o&&(e=u,u=o,o=e),b.precision(m)):[[r,u],[n,o]]},b.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],i=+n[0][1],a=+n[1][1],t>e&&(n=t,t=e,e=n),i>a&&(n=i,i=a,a=n),b.precision(m)):[[t,i],[e,a]]},b.step=function(e){return arguments.length?b.stepMajor(e).stepMinor(e):b.stepMinor()},b.stepMajor=function(e){return arguments.length?(p=+e[0],v=+e[1],b):[p,v]},b.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],b):[d,h]},b.precision=function(d){return arguments.length?(m=+d,c=dj(i,a,90),s=hj(t,e,m),l=dj(u,o,90),f=hj(r,n,m),b):m},b.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function vj(){}var mj=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function bj(){var e=1,t=1,n=o;function r(e,t){return t.map((function(t){return a(e,t)}))}function a(r,a){var o=[],u=[];return function(n,r,a){var o,u,c,s,l,f,d=new Array,h=new Array;o=u=-1,s=n[0]>=r,mj[s<<1].forEach(p);for(;++o<e-1;)c=s,s=n[o+1]>=r,mj[c|s<<1].forEach(p);mj[s<<0].forEach(p);for(;++u<t-1;){for(o=-1,s=n[u*e+e]>=r,l=n[u*e]>=r,mj[s<<1|l<<2].forEach(p);++o<e-1;)c=s,s=n[u*e+e+o+1]>=r,f=l,l=n[u*e+o+1]>=r,mj[c|s<<1|l<<2|f<<3].forEach(p);mj[s|l<<3].forEach(p)}o=-1,l=n[u*e]>=r,mj[l<<2].forEach(p);for(;++o<e-1;)f=l,l=n[u*e+o+1]>=r,mj[l<<2|f<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+o,e[0][1]+u],c=[e[1][0]+o,e[1][1]+u],s=i(r),l=i(c);(t=h[s])?(n=d[l])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(c),a(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(c),h[t.end=l]=t):(t=d[l])?(n=h[s])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(c),a(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=s]=t):d[s]=h[l]={start:s,end:l,ring:[r,c]}}mj[l<<3].forEach(p)}(r,a,(function(e){n(e,r,a),function(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?o.push([e]):u.push(e)})),u.forEach((function(e){for(var t,n=0,r=o.length;n<r;++n)if(-1!==gj((t=o[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:a,coordinates:o}}function i(t){return 2*t[0]+t[1]*(e+1)*4}function o(n,r,a){n.forEach((function(n){var i,o=n[0],u=n[1],c=0|o,s=0|u,l=r[s*e+c];o>0&&o<e&&c===o&&(i=r[s*e+c-1],n[0]=o+(a-i)/(l-i)-.5),u>0&&u<t&&s===u&&(i=r[(s-1)*e+c],n[1]=u+(a-i)/(l-i)-.5)}))}return r.contour=a,r.size=function(n){if(!arguments.length)return[e,t];var a=Math.floor(n[0]),i=Math.floor(n[1]);return a>=0&&i>=0||Object(ne.o)("invalid size"),e=a,t=i,r},r.smooth=function(e){return arguments.length?(n=e?o:vj,r):n===o},r}function gj(e,t){for(var n,r=-1,a=t.length;++r<a;)if(n=yj(e,t[r]))return n;return 0}function yj(e,t){for(var n=t[0],r=t[1],a=-1,i=0,o=e.length,u=o-1;i<o;u=i++){var c=e[i],s=c[0],l=c[1],f=e[u],d=f[0],h=f[1];if(xj(c,f,t))return 0;l>r!==h>r&&n<(d-s)*(r-l)/(h-l)+s&&(a=-a)}return a}function xj(e,t,n){var r,a,i,o;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(a=e[r=+(e[0]===t[0])],i=n[r],o=t[r],a<=i&&i<=o||o<=i&&i<=a)}function Oj(e,t,n){return function(r){var a=Object(ne.q)(r),i=n?Math.min(a[0],0):a[0],o=a[1],u=o-i,c=t?Ze(i,o,e):u/(e+1);return ju(i+c,o,c)}}function kj(e){fo.call(this,null,e)}function wj(e,t,n,r,a){var i=e.x1||0,o=e.y1||0,u=t*n<0;function c(e){e.forEach(s)}function s(e){u&&e.reverse(),e.forEach(l)}function l(e){e[0]=(e[0]-i)*t+r,e[1]=(e[1]-o)*n+a}return function(e){return e.coordinates.forEach(c),e}}function jj(e,t,n){var r=e>=0?e:Do(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function _j(e){return Object(ne.E)(e)?e:Object(ne.m)(+e)}function Sj(){var e=function(e){return e[0]},t=function(e){return e[1]},n=ne.Q,r=[-1,-1],a=960,i=500,o=2;function u(u,c){var s=jj(r[0],u,e)>>o,l=jj(r[1],u,t)>>o,f=s?s+2:0,d=l?l+2:0,h=2*f+(a>>o),p=2*d+(i>>o),v=new Float32Array(h*p),m=new Float32Array(h*p),b=v;u.forEach((function(r){var a=f+(+e(r)>>o),i=d+(+t(r)>>o);a>=0&&a<h&&i>=0&&i<p&&(v[a+i*h]+=+n(r))})),s>0&&l>0?(Ej(h,p,v,m,s),Cj(h,p,m,v,l),Ej(h,p,v,m,s),Cj(h,p,m,v,l),Ej(h,p,v,m,s),Cj(h,p,m,v,l)):s>0?(Ej(h,p,v,m,s),Ej(h,p,m,v,s),Ej(h,p,v,m,s),b=m):l>0&&(Cj(h,p,v,m,l),Cj(h,p,m,v,l),Cj(h,p,v,m,l),b=m);for(var g=c?Math.pow(2,-2*o):1/Ox(b),y=0,x=h*p;y<x;++y)b[y]*=g;return{values:b,scale:1<<o,width:h,height:p,x1:f,y1:d,x2:f+(a>>o),y2:d+(i>>o)}}return u.x=function(t){return arguments.length?(e=_j(t),u):e},u.y=function(e){return arguments.length?(t=_j(e),u):t},u.weight=function(e){return arguments.length?(n=_j(e),u):n},u.size=function(e){if(!arguments.length)return[a,i];var t=+e[0],n=+e[1];return t>=0&&n>=0||Object(ne.o)("invalid size"),a=t,i=n,u},u.cellSize=function(e){return arguments.length?((e=+e)>=1||Object(ne.o)("invalid cell size"),o=Math.floor(Math.log(e)/Math.LN2),u):1<<o},u.bandwidth=function(e){return arguments.length?(1===(e=Object(ne.i)(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&Object(ne.o)("invalid bandwidth"),r=e,u):r},u}function Ej(e,t,n,r,a){for(var i=1+(a<<1),o=0;o<t;++o)for(var u=0,c=0;u<e+a;++u)u<e&&(c+=n[u+o*e]),u>=a&&(u>=i&&(c-=n[u-i+o*e]),r[u-a+o*e]=c/Math.min(u+1,e-1+i-u,i))}function Cj(e,t,n,r,a){for(var i=1+(a<<1),o=0;o<e;++o)for(var u=0,c=0;u<t+a;++u)u<t&&(c+=n[o+u*e]),u>=a&&(u>=i&&(c-=n[o+(u-i)*e]),r[o+(u-a)*e]=c/Math.min(u+1,t-1+i-u,i))}function Aj(e){fo.call(this,null,e)}kj.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},Object(ne.z)(kj,fo,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,a=e.field||ne.y,i=bj().smooth(!1!==e.smooth),o=e.thresholds||function(e,t,n){var r=Oj(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map((function(e){return go(t(e).values)})))}(r,a,e),u=null===e.as?null:e.as||"contour",c=[];return r.forEach((function(t){var n=a(t),r=i.size([n.width,n.height])(n.values,Object(ne.B)(o)?o:o(n.values));!function(e,t,n,r){var a=r.scale||t.scale,i=r.translate||t.translate;Object(ne.E)(a)&&(a=a(n,r));Object(ne.E)(i)&&(i=i(n,r));if((1===a||null==a)&&!i)return;var o=(Object(ne.G)(a)?a:a[0])||1,u=(Object(ne.G)(a)?a:a[1])||1,c=i&&i[0]||0,s=i&&i[1]||0;e.forEach(wj(t,o,u,c,s))}(r,n,t,e),r.forEach((function(e){c.push(Ti(t,Ai(null!=u?Object(vt.a)({},u,e):e)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=c,n}}),Aj.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};var Nj=["x","y","weight","size","cellSize","bandwidth"];function Tj(e,t){return Nj.forEach((function(n){return null!=t[n]?e[n](t[n]):0})),e}function Ij(e){fo.call(this,null,e)}Object(ne.z)(Aj,fo,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=function(e,t){var n,r,a,i,o,u,c=[],s=function(e){return e(i)};if(null==t)c.push(e);else for(n={},r=0,a=e.length;r<a;++r)i=e[r],(u=n[o=t.map(s)])||(n[o]=u=[],u.dims=o,c.push(u)),u.push(i);return c}(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(ne.h),o=Tj(Sj(),e),u=e.as||"grid";return n=a.map((function(t){return Ai(function(e,t){for(var n=0;n<i.length;++n)e[i[n]]=t[n];return e}(Object(vt.a)({},u,o(t,e.counts)),t.dims))})),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),Ij.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},Object(ne.z)(Ij,fo,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=bj().smooth(!1!==e.smooth),o=e.values,u=e.thresholds||Oj(e.count||10,e.nice,!!o),c=e.size;return o||(o=t.materialize(t.SOURCE).source,r=wj(n=Tj(Sj(),e)(o,!0),n.scale||1,n.scale||1,0,0),c=[n.width,n.height],o=n.values),u=Object(ne.B)(u)?u:u(o),o=i.size(c)(o,u),r&&o.forEach(r),this.value&&(a.rem=this.value),this.value=a.source=a.add=(o||[]).map(Ai),a}});var Dj="Feature",Fj="FeatureCollection";function Mj(e){fo.call(this,null,e)}function Rj(e){fo.call(this,null,e)}function zj(e){fo.call(this,null,e)}function Lj(e){fo.call(this,null,e)}function Pj(e){fo.call(this,[],e),this.generator=pj()}function Bj(e){fo.call(this,null,e)}function Wj(e){if(!Object(ne.E)(e))return!1;var t=Object(ne.fb)(Object(ne.g)(e));return t.$x||t.$y||t.$value||t.$max}function Uj(e){fo.call(this,null,e),this.modified(!0)}function Vj(e,t,n){Object(ne.E)(e[t])&&e[t](n)}Mj.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Object(ne.z)(Mj,fo,{transform:function(e,t){var n,r=this._features,a=this._points,i=e.fields,o=i&&i[0],u=i&&i[1],c=e.geojson||!i&&ne.y,s=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(Object(ne.g)(c))||o&&t.modified(Object(ne.g)(o))||u&&t.modified(Object(ne.g)(u)),this.value&&!n||(s=t.SOURCE,this._features=r=[],this._points=a=[]),c&&t.visit(s,(function(e){return r.push(c(e))})),o&&u&&(t.visit(s,(function(e){var t=o(e),n=u(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&a.push([t,n])})),r=r.concat({type:Dj,geometry:{type:"MultiPoint",coordinates:a}})),this.value={type:Fj,features:r}}}),Rj.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Object(ne.z)(Rj,fo,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,a=e.field||ne.y,i=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=sj(e.projection),n.materialize().reflow()):o=a===ne.y||t.modified(a.fields)?n.ADD_MOD:n.ADD;var u=function(e,t){var n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n}(r,e.pointRadius);return n.visit(o,(function(e){return e[i]=r(a(e))})),r.pointRadius(u),n.modifies(i)}}),zj.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Object(ne.z)(zj,fo,{transform:function(e,t){var n,r=e.projection,a=e.fields[0],i=e.fields[1],o=e.as||["x","y"],u=o[0],c=o[1];function s(e){var t=r([a(e),i(e)]);t?(e[u]=t[0],e[c]=t[1]):(e[u]=void 0,e[c]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,s):(n=t.modified(a.fields)||t.modified(i.fields),t.visit(n?t.ADD_MOD:t.ADD,s)),t.modifies(o)}}),Lj.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Object(ne.z)(Lj,fo,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,a=e.as||"shape",i=n.ADD;return r&&!e.modified()||(this.value=r=function(e,t,n){var r=null==n?function(n){return e(t(n))}:function(r){var a=e.pointRadius(),i=e.pointRadius(n)(t(r));return e.pointRadius(a),i};return r.context=function(t){return e.context(t),r},r}(sj(e.projection),e.field||Object(ne.u)("datum"),e.pointRadius),n.materialize().reflow(),i=n.SOURCE),n.visit(i,(function(e){return e[a]=r})),n.modifies(a)}}),Pj.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Object(ne.z)(Pj,fo,{transform:function(e,t){var n,r=this.value,a=this.generator;if(!r.length||e.modified())for(var i in e)Object(ne.E)(a[i])&&a[i](e[i]);return n=a(),r.length?t.mod.push(Ii(r[0],n)):t.add.push(Ai(n)),r[0]=n,t}}),Bj.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},Object(ne.z)(Bj,fo,{transform:function(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,a=e.field||ne.y,i=function(e,t){var n;Object(ne.E)(e)?(n=function(n){return e(n,t)}).dep=Wj(e):e?n=Object(ne.m)(e):(n=function(e){return e.$value/e.$max||0}).dep=!0;return n}(e.opacity,e),o=function(e,t){var n;Object(ne.E)(e)?(n=function(n){return Kl(e(n,t))}).dep=Wj(e):n=Object(ne.m)(Kl(e||"#888"));return n}(e.color,e),u=e.as||"image",c={$x:0,$y:0,$value:0,$max:r?go(n.map((function(e){return go(a(e).values)}))):0};return n.forEach((function(e){var t=a(e),n=Object(ne.p)({},e,c);r||(n.$max=go(t.values||[])),e[u]=function(e,t,n,r){for(var a=e.width,i=e.height,o=e.x1||0,u=e.y1||0,c=e.x2||a,s=e.y2||i,l=e.values,f=l?function(e){return l[e]}:ne.mb,d=hl(c-o,s-u),h=d.getContext("2d"),p=h.getImageData(0,0,c-o,s-u),v=p.data,m=u,b=0;m<s;++m){t.$y=m-u;for(var g=o,y=m*a;g<c;++g,b+=4){t.$x=g-o,t.$value=f(g+y);var x=n(t);v[b+0]=x.r,v[b+1]=x.g,v[b+2]=x.b,v[b+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}(t,n,o.dep?o:Object(ne.m)(o(n)),i.dep?i:Object(ne.m)(i(n)))})),t.reflow(!0).modifies(u)}}),Object(ne.z)(Uj,fo,{transform:function(e,t){var n=this.value;return!n||e.modified("type")?(this.value=n=function(e){var t=cj((e||"mercator").toLowerCase());t||Object(ne.o)("Unrecognized projection type: "+e);return t()}(e.type),oj.forEach((function(t){null!=e[t]&&Vj(n,t,e[t])}))):oj.forEach((function(t){e.modified(t)&&Vj(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){var n=function(e){return 1===(e=Object(ne.i)(e)).length?e[0]:{type:Fj,features:e.reduce((function(e,t){return e.concat(function(e){return e.type===Fj?e.features:Object(ne.i)(e).filter((function(e){return null!=e})).map((function(e){return e.type===Dj?e:{type:Dj,geometry:e}}))}(t))}),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function qj(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var a,i,o,u,c,s,l,f,d,h=e._root,p={data:r},v=e._x0,m=e._y0,b=e._x1,g=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((s=t>=(i=(v+b)/2))?v=i:b=i,(l=n>=(o=(m+g)/2))?m=o:g=o,a=h,!(h=h[f=l<<1|s]))return a[f]=p,e;if(u=+e._x.call(null,h.data),c=+e._y.call(null,h.data),t===u&&n===c)return p.next=h,a?a[f]=p:e._root=p,e;do{a=a?a[f]=new Array(4):e._root=new Array(4),(s=t>=(i=(v+b)/2))?v=i:b=i,(l=n>=(o=(m+g)/2))?m=o:g=o}while((f=l<<1|s)===(d=(c>=o)<<1|u>=i));return a[d]=h,a[f]=p,e}var Hj=function(e,t,n,r,a){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=a};function Gj(e){return e[0]}function Kj(e){return e[1]}function Xj(e,t,n){var r=new Yj(null==t?Gj:t,null==n?Kj:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function Yj(e,t,n,r,a,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=a,this._y1=i,this._root=void 0}function $j(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Jj=Xj.prototype=Yj.prototype;Jj.copy=function(){var e,t,n=new Yj(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=$j(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var a=0;a<4;++a)(t=r.source[a])&&(t.length?e.push({source:t,target:r.target[a]=new Array(4)}):r.target[a]=$j(t));return n},Jj.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return qj(this.cover(t,n),t,n,e)},Jj.addAll=function(e){var t,n,r,a,i=e.length,o=new Array(i),u=new Array(i),c=1/0,s=1/0,l=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=r,u[n]=a,r<c&&(c=r),r>l&&(l=r),a<s&&(s=a),a>f&&(f=a));if(c>l||s>f)return this;for(this.cover(c,s).cover(l,f),n=0;n<i;++n)qj(this,o[n],u[n],e[n]);return this},Jj.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,a=this._x1,i=this._y1;if(isNaN(n))a=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var o,u,c=a-n||1,s=this._root;n>e||e>=a||r>t||t>=i;)switch(u=(t<r)<<1|e<n,(o=new Array(4))[u]=s,s=o,c*=2,u){case 0:a=n+c,i=r+c;break;case 1:n=a-c,i=r+c;break;case 2:a=n+c,r=i-c;break;case 3:n=a-c,r=i-c}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=a,this._y1=i,this},Jj.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},Jj.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Jj.find=function(e,t,n){var r,a,i,o,u,c,s,l=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],v=this._root;for(v&&p.push(new Hj(v,l,f,d,h)),null==n?n=1/0:(l=e-n,f=t-n,d=e+n,h=t+n,n*=n);c=p.pop();)if(!(!(v=c.node)||(a=c.x0)>d||(i=c.y0)>h||(o=c.x1)<l||(u=c.y1)<f))if(v.length){var m=(a+o)/2,b=(i+u)/2;p.push(new Hj(v[3],m,b,o,u),new Hj(v[2],a,b,m,u),new Hj(v[1],m,i,o,b),new Hj(v[0],a,i,m,b)),(s=(t>=b)<<1|e>=m)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-s],p[p.length-1-s]=c)}else{var g=e-+this._x.call(null,v.data),y=t-+this._y.call(null,v.data),x=g*g+y*y;if(x<n){var O=Math.sqrt(n=x);l=e-O,f=t-O,d=e+O,h=t+O,r=v.data}}return r},Jj.remove=function(e){if(isNaN(i=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e)))return this;var t,n,r,a,i,o,u,c,s,l,f,d,h=this._root,p=this._x0,v=this._y0,m=this._x1,b=this._y1;if(!h)return this;if(h.length)for(;;){if((s=i>=(u=(p+m)/2))?p=u:m=u,(l=o>=(c=(v+b)/2))?v=c:b=c,t=h,!(h=h[f=l<<1|s]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,d=f)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(a=h.next)&&delete h.next,r?(a?r.next=a:delete r.next,this):t?(a?t[f]=a:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=a,this)},Jj.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},Jj.root=function(){return this._root},Jj.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},Jj.visit=function(e){var t,n,r,a,i,o,u=[],c=this._root;for(c&&u.push(new Hj(c,this._x0,this._y0,this._x1,this._y1));t=u.pop();)if(!e(c=t.node,r=t.x0,a=t.y0,i=t.x1,o=t.y1)&&c.length){var s=(r+i)/2,l=(a+o)/2;(n=c[3])&&u.push(new Hj(n,s,l,i,o)),(n=c[2])&&u.push(new Hj(n,r,l,s,o)),(n=c[1])&&u.push(new Hj(n,s,a,i,l)),(n=c[0])&&u.push(new Hj(n,r,a,s,l))}return this},Jj.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new Hj(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var a=t.node;if(a.length){var i,o=t.x0,u=t.y0,c=t.x1,s=t.y1,l=(o+c)/2,f=(u+s)/2;(i=a[0])&&n.push(new Hj(i,o,u,l,f)),(i=a[1])&&n.push(new Hj(i,l,u,c,f)),(i=a[2])&&n.push(new Hj(i,o,f,l,s)),(i=a[3])&&n.push(new Hj(i,l,f,c,s))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},Jj.x=function(e){return arguments.length?(this._x=e,this):this._x},Jj.y=function(e){return arguments.length?(this._y=e,this):this._y};var Qj=function(e){return function(){return e}},Zj=function(e){return 1e-6*(e()-.5)};function e_(e){return e.x+e.vx}function t_(e){return e.y+e.vy}var n_={value:function(){}};function r_(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new a_(r)}function a_(e){this._=e}function i_(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function o_(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}function u_(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=n_,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}a_.prototype=r_.prototype={constructor:a_,on:function(e,t){var n,r=this._,a=i_(e+"",r),i=-1,o=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(n=(e=a[i]).type)r[n]=u_(r[n],e.name,t);else if(null==t)for(n in r)r[n]=u_(r[n],e.name,null);return this}for(;++i<o;)if((n=(e=a[i]).type)&&(n=o_(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new a_(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};var c_,s_,l_=r_,f_=0,d_=0,h_=0,p_=0,v_=0,m_=0,b_="object"===typeof performance&&performance.now?performance:Date,g_="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function y_(){return v_||(g_(x_),v_=b_.now()+m_)}function x_(){v_=0}function O_(){this._call=this._time=this._next=null}function k_(e,t,n){var r=new O_;return r.restart(e,t,n),r}function w_(){v_=(p_=b_.now())+m_,f_=d_=0;try{!function(){y_(),++f_;for(var e,t=c_;t;)(e=v_-t._time)>=0&&t._call.call(null,e),t=t._next;--f_}()}finally{f_=0,function(){var e,t,n=c_,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:c_=t);s_=e,__(r)}(),v_=0}}function j_(){var e=b_.now(),t=e-p_;t>1e3&&(m_-=t,p_=e)}function __(e){f_||(d_&&(d_=clearTimeout(d_)),e-v_>24?(e<1/0&&(d_=setTimeout(w_,e-b_.now()-m_)),h_&&(h_=clearInterval(h_))):(h_||(p_=b_.now(),h_=setInterval(j_,1e3)),f_=1,g_(w_)))}O_.prototype=k_.prototype={constructor:O_,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?y_():+n)+(null==t?0:+t),this._next||s_===this||(s_?s_._next=this:c_=this,s_=this),this._call=e,this._time=n,__()},stop:function(){this._call&&(this._call=null,this._time=1/0,__())}};var S_=4294967296;function E_(e){return e.x}function C_(e){return e.y}var A_=Math.PI*(3-Math.sqrt(5)),N_=function(e){var t,n=1,r=.001,a=1-Math.pow(r,1/300),i=0,o=.6,u=new Map,c=k_(f),s=l_("tick","end"),l=function(){var e=1;return function(){return(e=(1664525*e+1013904223)%S_)/S_}}();function f(){d(),s.call("tick",t),n<r&&(c.stop(),s.call("end",t))}function d(r){var c,s,l=e.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(i-n)*a,u.forEach((function(e){e(n)})),c=0;c<l;++c)null==(s=e[c]).fx?s.x+=s.vx*=o:(s.x=s.fx,s.vx=0),null==s.fy?s.y+=s.vy*=o:(s.y=s.fy,s.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var a=10*Math.sqrt(.5+n),i=n*A_;t.x=a*Math.cos(i),t.y=a*Math.sin(i)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,l),t}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return c.restart(f),t},stop:function(){return c.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),u.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(a=+e,t):+a},alphaTarget:function(e){return arguments.length?(i=+e,t):i},velocityDecay:function(e){return arguments.length?(o=1-e,t):1-o},randomSource:function(e){return arguments.length?(l=e,u.forEach(p),t):l},force:function(e,n){return arguments.length>1?(null==n?u.delete(e):u.set(e,p(n)),t):u.get(e)},find:function(t,n,r){var a,i,o,u,c,s=0,l=e.length;for(null==r?r=1/0:r*=r,s=0;s<l;++s)(o=(a=t-(u=e[s]).x)*a+(i=n-u.y)*i)<r&&(c=u,r=o);return c},on:function(e,n){return arguments.length>1?(s.on(e,n),t):s.on(e)}}};function T_(e){return e.index}function I_(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}var D_={center:function(e,t){var n,r=1;function a(){var a,i,o=n.length,u=0,c=0;for(a=0;a<o;++a)u+=(i=n[a]).x,c+=i.y;for(u=(u/o-e)*r,c=(c/o-t)*r,a=0;a<o;++a)(i=n[a]).x-=u,i.y-=c}return null==e&&(e=0),null==t&&(t=0),a.initialize=function(e){n=e},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(e){return arguments.length?(t=+e,a):t},a.strength=function(e){return arguments.length?(r=+e,a):r},a},collide:function(e){var t,n,r,a=1,i=1;function o(){for(var e,o,c,s,l,f,d,h=t.length,p=0;p<i;++p)for(o=Xj(t,e_,t_).visitAfter(u),e=0;e<h;++e)c=t[e],f=n[c.index],d=f*f,s=c.x+c.vx,l=c.y+c.vy,o.visit(v);function v(e,t,n,i,o){var u=e.data,h=e.r,p=f+h;if(!u)return t>s+p||i<s-p||n>l+p||o<l-p;if(u.index>c.index){var v=s-u.x-u.vx,m=l-u.y-u.vy,b=v*v+m*m;b<p*p&&(0===v&&(b+=(v=Zj(r))*v),0===m&&(b+=(m=Zj(r))*m),b=(p-(b=Math.sqrt(b)))/b*a,c.vx+=(v*=b)*(p=(h*=h)/(d+h)),c.vy+=(m*=b)*p,u.vx-=v*(p=1-p),u.vy-=m*p)}}}function u(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function c(){if(t){var r,a,i=t.length;for(n=new Array(i),r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}}return"function"!==typeof e&&(e=Qj(null==e?1:+e)),o.initialize=function(e,n){t=e,r=n,c()},o.iterations=function(e){return arguments.length?(i=+e,o):i},o.strength=function(e){return arguments.length?(a=+e,o):a},o.radius=function(t){return arguments.length?(e="function"===typeof t?t:Qj(+t),c(),o):e},o},nbody:function(){var e,t,n,r,a,i=Qj(-30),o=1,u=1/0,c=.81;function s(n){var a,i=e.length,o=Xj(e,E_,C_).visitAfter(f);for(r=n,a=0;a<i;++a)t=e[a],o.visit(d)}function l(){if(e){var t,n,r=e.length;for(a=new Array(r),t=0;t<r;++t)n=e[t],a[n.index]=+i(n,t,e)}}function f(e){var t,n,r,i,o,u=0,c=0;if(e.length){for(r=i=o=0;o<4;++o)(t=e[o])&&(n=Math.abs(t.value))&&(u+=t.value,c+=n,r+=n*t.x,i+=n*t.y);e.x=r/c,e.y=i/c}else{(t=e).x=t.data.x,t.y=t.data.y;do{u+=a[t.data.index]}while(t=t.next)}e.value=u}function d(e,i,s,l){if(!e.value)return!0;var f=e.x-t.x,d=e.y-t.y,h=l-i,p=f*f+d*d;if(h*h/c<p)return p<u&&(0===f&&(p+=(f=Zj(n))*f),0===d&&(p+=(d=Zj(n))*d),p<o&&(p=Math.sqrt(o*p)),t.vx+=f*e.value*r/p,t.vy+=d*e.value*r/p),!0;if(!(e.length||p>=u)){(e.data!==t||e.next)&&(0===f&&(p+=(f=Zj(n))*f),0===d&&(p+=(d=Zj(n))*d),p<o&&(p=Math.sqrt(o*p)));do{e.data!==t&&(h=a[e.data.index]*r/p,t.vx+=f*h,t.vy+=d*h)}while(e=e.next)}}return s.initialize=function(t,r){e=t,n=r,l()},s.strength=function(e){return arguments.length?(i="function"===typeof e?e:Qj(+e),l(),s):i},s.distanceMin=function(e){return arguments.length?(o=e*e,s):Math.sqrt(o)},s.distanceMax=function(e){return arguments.length?(u=e*e,s):Math.sqrt(u)},s.theta=function(e){return arguments.length?(c=e*e,s):Math.sqrt(c)},s},link:function(e){var t,n,r,a,i,o,u=T_,c=function(e){return 1/Math.min(a[e.source.index],a[e.target.index])},s=Qj(30),l=1;function f(r){for(var a=0,u=e.length;a<l;++a)for(var c,s,f,d,h,p,v,m=0;m<u;++m)s=(c=e[m]).source,d=(f=c.target).x+f.vx-s.x-s.vx||Zj(o),h=f.y+f.vy-s.y-s.vy||Zj(o),d*=p=((p=Math.sqrt(d*d+h*h))-n[m])/p*r*t[m],h*=p,f.vx-=d*(v=i[m]),f.vy-=h*v,s.vx+=d*(v=1-v),s.vy+=h*v}function d(){if(r){var o,c,s=r.length,l=e.length,f=new Map(r.map((function(e,t){return[u(e,t,r),e]})));for(o=0,a=new Array(s);o<l;++o)(c=e[o]).index=o,"object"!==typeof c.source&&(c.source=I_(f,c.source)),"object"!==typeof c.target&&(c.target=I_(f,c.target)),a[c.source.index]=(a[c.source.index]||0)+1,a[c.target.index]=(a[c.target.index]||0)+1;for(o=0,i=new Array(l);o<l;++o)c=e[o],i[o]=a[c.source.index]/(a[c.source.index]+a[c.target.index]);t=new Array(l),h(),n=new Array(l),p()}}function h(){if(r)for(var n=0,a=e.length;n<a;++n)t[n]=+c(e[n],n,e)}function p(){if(r)for(var t=0,a=e.length;t<a;++t)n[t]=+s(e[t],t,e)}return null==e&&(e=[]),f.initialize=function(e,t){r=e,o=t,d()},f.links=function(t){return arguments.length?(e=t,d(),f):e},f.id=function(e){return arguments.length?(u=e,f):u},f.iterations=function(e){return arguments.length?(l=+e,f):l},f.strength=function(e){return arguments.length?(c="function"===typeof e?e:Qj(+e),h(),f):c},f.distance=function(e){return arguments.length?(s="function"===typeof e?e:Qj(+e),p(),f):s},f},x:function(e){var t,n,r,a=Qj(.1);function i(e){for(var a,i=0,o=t.length;i<o;++i)(a=t[i]).vx+=(r[i]-a.x)*n[i]*e}function o(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=Qj(null==e?0:+e)),i.initialize=function(e){t=e,o()},i.strength=function(e){return arguments.length?(a="function"===typeof e?e:Qj(+e),o(),i):a},i.x=function(t){return arguments.length?(e="function"===typeof t?t:Qj(+t),o(),i):e},i},y:function(e){var t,n,r,a=Qj(.1);function i(e){for(var a,i=0,o=t.length;i<o;++i)(a=t[i]).vy+=(r[i]-a.y)*n[i]*e}function o(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=Qj(null==e?0:+e)),i.initialize=function(e){t=e,o()},i.strength=function(e){return arguments.length?(a="function"===typeof e?e:Qj(+e),o(),i):a},i.y=function(t){return arguments.length?(e="function"===typeof t?t:Qj(+t),o(),i):e},i}},F_="forces",M_=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],R_=["static","iterations"],z_=["x","y","vx","vy"];function L_(e){fo.call(this,null,e)}function P_(e,t,n,r){var a,i,o,u,c=Object(ne.i)(t.forces);for(a=0,i=M_.length;a<i;++a)(o=M_[a])!==F_&&t.modified(o)&&e[o](t[o]);for(a=0,i=c.length;a<i;++a)u=F_+a,(o=n||t.modified(F_,a)?W_(c[a]):r&&B_(c[a],r)?e.force(u):null)&&e.force(u,o);for(i=e.numForces||0;a<i;++a)e.force(F_+a,null);return e.numForces=c.length,e}function B_(e,t){var n,r;for(n in e)if(Object(ne.E)(r=e[n])&&t.modified(Object(ne.g)(r)))return 1;return 0}function W_(e){var t,n;for(n in Object(ne.w)(D_,e.force)||Object(ne.o)("Unrecognized force: "+e.force),t=D_[e.force](),e)Object(ne.E)(t[n])&&U_(t[n],e[n],e);return t}function U_(e,t,n){e(Object(ne.E)(t)?function(e){return t(e,n)}:t)}function V_(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}L_.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:z_}]},Object(ne.z)(L_,fo,{transform:function(e,t){var n,r,a=this.value,i=t.changed(t.ADD_REM),o=e.modified(M_),u=e.iterations||300;if(a?(i&&(t.modifies("index"),a.nodes(t.source)),(o||t.changed(t.MOD))&&P_(a,e,0,t)):(this.value=a=function(e,t){var n=N_(e),r=n.stop,a=n.restart,i=!1;return n.stopped=function(){return i},n.restart=function(){return i=!1,a()},n.stop=function(){return i=!0,r()},P_(n,t,!0).on("end",(function(){return i=!0}))}(t.source,e),a.on("tick",(n=t.dataflow,r=this,function(){return n.touch(r).run()})),e.static||(i=!0,a.tick()),t.modifies("index")),o||i||e.modified(R_)||t.changed()&&e.restart)if(a.alpha(Math.max(a.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(a.alphaMin(),1/u)),e.static)for(a.stop();--u>=0;)a.tick();else if(a.stopped()&&a.restart(),!i)return t.StopPropagation;return this.finish(e,t)},finish:function(e,t){for(var n,r=t.dataflow,a=this._argops,i=0,o=a.length;i<o;++i)if((n=a[i]).name===F_&&"link"===n.op._argval.force)for(var u,c=n.op._argops,s=0,l=c.length;s<l;++s)if("links"===c[s].name&&(u=c[s].op.source)){r.pulse(u,r.changeset().reflow());break}return t.reflow(e.modified()).modifies(z_)}});var q_=k.a.mark(H_);function H_(){var e,t,n,r,a,i;return k.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=[e=this];case 1:t=n.reverse(),n=[];case 2:if(!(e=t.pop())){o.next=8;break}return o.next=5,e;case 5:if(r=e.children)for(a=0,i=r.length;a<i;++a)n.push(r[a]);o.next=2;break;case 8:if(n.length){o.next=1;break}case 9:case"end":return o.stop()}}),q_,this)}function G_(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=X_)):void 0===t&&(t=K_);for(var n,r,a,i,o,u=new J_(e),c=[u];n=c.pop();)if((a=t(n.data))&&(o=(a=Array.from(a)).length))for(n.children=a,i=o-1;i>=0;--i)c.push(r=a[i]=new J_(a[i])),r.parent=n,r.depth=n.depth+1;return u.eachBefore($_)}function K_(e){return e.children}function X_(e){return Array.isArray(e)?e[1]:null}function Y_(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function $_(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function J_(e){this.data=e,this.depth=this.height=0,this.parent=null}J_.prototype=G_.prototype=Object(vt.a)({constructor:J_,count:function(){return this.eachAfter(V_)},each:function(e,t){var n,r=-1,a=Object(mo.a)(this);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.call(t,i,++r,this)}}catch(o){a.e(o)}finally{a.f()}return this},eachAfter:function(e,t){for(var n,r,a,i=this,o=[i],u=[],c=-1;i=o.pop();)if(u.push(i),n=i.children)for(r=0,a=n.length;r<a;++r)o.push(n[r]);for(;i=u.pop();)e.call(t,i,++c,this);return this},eachBefore:function(e,t){for(var n,r,a=this,i=[a],o=-1;a=i.pop();)if(e.call(t,a,++o,this),n=a.children)for(r=n.length-1;r>=0;--r)i.push(n[r]);return this},find:function(e,t){var n,r=-1,a=Object(mo.a)(this);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e.call(t,i,++r,this))return i}}catch(o){a.e(o)}finally{a.f()}},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,a=r&&r.length;--a>=0;)n+=r[a].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),a=null;e=n.pop(),t=r.pop();for(;e===t;)a=e,e=n.pop(),t=r.pop();return a}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var a=r.length;e!==n;)r.splice(a,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return G_(this).eachBefore(Y_)}},Symbol.iterator,H_);var Q_=function(e){for(var t,n,r=0,a=(e=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}(Array.from(e))).length,i=[];r<a;)t=e[r],n&&tS(n,t)?++r:(n=rS(i=Z_(i,t)),r=0);return n};function Z_(e,t){var n,r;if(nS(t,e))return[t];for(n=0;n<e.length;++n)if(eS(t,e[n])&&nS(aS(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(eS(aS(e[n],e[r]),t)&&eS(aS(e[n],t),e[r])&&eS(aS(e[r],t),e[n])&&nS(iS(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function eS(e,t){var n=e.r-t.r,r=t.x-e.x,a=t.y-e.y;return n<0||n*n<r*r+a*a}function tS(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function nS(e,t){for(var n=0;n<t.length;++n)if(!tS(e,t[n]))return!1;return!0}function rS(e){switch(e.length){case 1:return{x:(t=e[0]).x,y:t.y,r:t.r};case 2:return aS(e[0],e[1]);case 3:return iS(e[0],e[1],e[2])}var t}function aS(e,t){var n=e.x,r=e.y,a=e.r,i=t.x,o=t.y,u=t.r,c=i-n,s=o-r,l=u-a,f=Math.sqrt(c*c+s*s);return{x:(n+i+c/f*l)/2,y:(r+o+s/f*l)/2,r:(f+a+u)/2}}function iS(e,t,n){var r=e.x,a=e.y,i=e.r,o=t.x,u=t.y,c=t.r,s=n.x,l=n.y,f=n.r,d=r-o,h=r-s,p=a-u,v=a-l,m=c-i,b=f-i,g=r*r+a*a-i*i,y=g-o*o-u*u+c*c,x=g-s*s-l*l+f*f,O=h*p-d*v,k=(p*x-v*y)/(2*O)-r,w=(v*m-p*b)/O,j=(h*y-d*x)/(2*O)-a,_=(d*b-h*m)/O,S=w*w+_*_-1,E=2*(i+k*w+j*_),C=k*k+j*j-i*i,A=-(S?(E+Math.sqrt(E*E-4*S*C))/(2*S):C/E);return{x:r+k+w*A,y:a+j+_*A,r:A}}function oS(e,t,n){var r,a,i,o,u=e.x-t.x,c=e.y-t.y,s=u*u+c*c;s?(a=t.r+n.r,a*=a,o=e.r+n.r,a>(o*=o)?(r=(s+o-a)/(2*s),i=Math.sqrt(Math.max(0,o/s-r*r)),n.x=e.x-r*u-i*c,n.y=e.y-r*c+i*u):(r=(s+a-o)/(2*s),i=Math.sqrt(Math.max(0,a/s-r*r)),n.x=t.x+r*u-i*c,n.y=t.y+r*c+i*u)):(n.x=t.x+n.r,n.y=t.y)}function uS(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function cS(e){var t=e._,n=e.next._,r=t.r+n.r,a=(t.x*n.r+n.x*t.r)/r,i=(t.y*n.r+n.y*t.r)/r;return a*a+i*i}function sS(e){this._=e,this.next=null,this.previous=null}function lS(e){if(!(i=(t=e,e="object"===typeof t&&"length"in t?t:Array.from(t)).length))return 0;var t,n,r,a,i,o,u,c,s,l,f,d;if((n=e[0]).x=0,n.y=0,!(i>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(i>2))return n.r+r.r;oS(r,n,a=e[2]),n=new sS(n),r=new sS(r),a=new sS(a),n.next=a.previous=r,r.next=n.previous=a,a.next=r.previous=n;e:for(c=3;c<i;++c){oS(n._,r._,a=e[c]),a=new sS(a),s=r.next,l=n.previous,f=r._.r,d=n._.r;do{if(f<=d){if(uS(s._,a._)){r=s,n.next=r,r.previous=n,--c;continue e}f+=s._.r,s=s.next}else{if(uS(l._,a._)){(n=l).next=r,r.previous=n,--c;continue e}d+=l._.r,l=l.previous}}while(s!==l.next);for(a.previous=n,a.next=r,n.next=r.previous=r=a,o=cS(n);(a=a.next)!==r;)(u=cS(a))<o&&(n=a,o=u);r=n.next}for(n=[r._],a=r;(a=a.next)!==r;)n.push(a._);for(a=Q_(n),c=0;c<i;++c)(n=e[c]).x-=a.x,n.y-=a.y;return a.r}function fS(e){return null==e?null:dS(e)}function dS(e){if("function"!==typeof e)throw new Error;return e}function hS(){return 0}var pS=function(e){return function(){return e}};function vS(e){return Math.sqrt(e.value)}function mS(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function bS(e,t){return function(n){if(r=n.children){var r,a,i,o=r.length,u=e(n)*t||0;if(u)for(a=0;a<o;++a)r[a].r+=u;if(i=lS(r),u)for(a=0;a<o;++a)r[a].r-=u;n.r=i+u}}}function gS(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}var yS=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)},xS=function(e,t,n,r,a){for(var i,o=e.children,u=-1,c=o.length,s=e.value&&(r-t)/e.value;++u<c;)(i=o[u]).y0=n,i.y1=a,i.x0=t,i.x1=t+=i.value*s},OS={depth:-1},kS={};function wS(e){return e.id}function jS(e){return e.parentId}var _S=function(){var e=wS,t=jS;function n(n){var r,a,i,o,u,c,s,l=Array.from(n),f=l.length,d=new Map;for(a=0;a<f;++a)r=l[a],u=l[a]=new J_(r),null!=(c=e(r,a,n))&&(c+="")&&(s=u.id=c,d.set(s,d.has(s)?kS:u)),null!=(c=t(r,a,n))&&(c+="")&&(u.parent=c);for(a=0;a<f;++a)if(c=(u=l[a]).parent){if(!(o=d.get(c)))throw new Error("missing: "+c);if(o===kS)throw new Error("ambiguous: "+c);o.children?o.children.push(u):o.children=[u],u.parent=o}else{if(i)throw new Error("multiple roots");i=u}if(!i)throw new Error("no root");if(i.parent=OS,i.eachBefore((function(e){e.depth=e.parent.depth+1,--f})).eachBefore($_),i.parent=null,f>0)throw new Error("cycle");return i}return n.id=function(t){return arguments.length?(e=dS(t),n):e},n.parentId=function(e){return arguments.length?(t=dS(e),n):t},n};function SS(e,t){return e.parent===t.parent?1:2}function ES(e){var t=e.children;return t?t[0]:e.t}function CS(e){var t=e.children;return t?t[t.length-1]:e.t}function AS(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function NS(e,t,n){return e.a.parent===t.parent?e.a:n}function TS(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}TS.prototype=Object.create(J_.prototype);function IS(e,t){return e.parent===t.parent?1:2}function DS(e,t){return e+t.x}function FS(e,t){return Math.max(e,t.y)}var MS=function(e,t,n,r,a){for(var i,o=e.children,u=-1,c=o.length,s=e.value&&(a-n)/e.value;++u<c;)(i=o[u]).x0=t,i.x1=r,i.y0=n,i.y1=n+=i.value*s},RS=(1+Math.sqrt(5))/2;function zS(e,t,n,r,a,i){for(var o,u,c,s,l,f,d,h,p,v,m,b=[],g=t.children,y=0,x=0,O=g.length,k=t.value;y<O;){c=a-n,s=i-r;do{l=g[x++].value}while(!l&&x<O);for(f=d=l,m=l*l*(v=Math.max(s/c,c/s)/(k*e)),p=Math.max(d/m,m/f);x<O;++x){if(l+=u=g[x].value,u<f&&(f=u),u>d&&(d=u),m=l*l*v,(h=Math.max(d/m,m/f))>p){l-=u;break}p=h}b.push(o={value:l,dice:c<s,children:g.slice(y,x)}),o.dice?xS(o,n,r,a,k?r+=s*l/k:i):MS(o,n,r,k?n+=c*l/k:a,i),k-=l,y=x}return b}var LS=function e(t){function n(e,n,r,a,i){zS(t,e,n,r,a,i)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(RS),PS=function e(t){function n(e,n,r,a,i){if((o=e._squarify)&&o.ratio===t)for(var o,u,c,s,l,f=-1,d=o.length,h=e.value;++f<d;){for(c=(u=o[f]).children,s=u.value=0,l=c.length;s<l;++s)u.value+=c[s].value;u.dice?xS(u,n,r,a,h?r+=(i-r)*u.value/h:i):MS(u,n,r,h?n+=(a-n)*u.value/h:a,i),h-=u.value}else e._squarify=o=zS(t,e,n,r,a,i),o.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(RS);function BS(e,t,n){var r={};return e.each((function(e){var a=e.data;n(a)&&(r[t(a)]=e)})),e.lookup=r,e}function WS(e){fo.call(this,null,e)}WS.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};var US=function(e){return e.values};function VS(){var e=[],t={entries:function(e){return r(n(e,0),0)},key:function(n){return e.push(n),t}};function n(t,r){if(r>=e.length)return t;for(var a,i,o,u=t.length,c=e[r++],s={},l={},f=-1;++f<u;)(o=s[a=c(i=t[f])+""])?o.push(i):s[a]=[i];for(a in s)l[a]=n(s[a],r);return l}function r(t,n){if(++n>e.length)return t;var a=[];for(var i in t)a.push({key:i,values:r(t[i],n)});return a}return t}function qS(e){fo.call(this,null,e)}Object(ne.z)(WS,fo,{transform:function(e,t){t.source||Object(ne.o)("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),a=t.clone(),i=this.value;return(!i||r||t.changed())&&(i&&i.each((function(e){e.children&&Si(e.data)&&a.rem.push(e.data)})),this.value=i=G_({values:Object(ne.i)(e.keys).reduce((function(e,t){return e.key(t),e}),VS()).entries(a.source)},US),n&&i.each((function(e){e.children&&(e=Ai(e.data),a.add.push(e),a.source.push(e))})),BS(i,Ei,Ei)),a.source.root=i,a}});var HS=function(e,t){return e.parent===t.parent?1:2};Object(ne.z)(qS,fo,{transform:function(e,t){t.source&&t.source.root||Object(ne.o)(this.constructor.name+" transform requires a backing tree data source.");var n=this.layout(e.method),r=this.fields,a=t.source.root,i=e.as||r;e.field?a.sum(e.field):a.count(),e.sort&&a.sort(Di(e.sort,(function(e){return e.data}))),function(e,t,n){for(var r,a=0,i=t.length;a<i;++a)(r=t[a])in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?HS:ne.Q);try{this.value=n(a)}catch(o){Object(ne.o)(o)}return a.each((function(e){return function(e,t,n){for(var r=e.data,a=t.length-1,i=0;i<a;++i)r[n[i]]=e[t[i]];r[n[a]]=e.children?e.children.length:0}(e,r,i)})),t.reflow(e.modified()).modifies(i).modifies("leaf")}});var GS=["x","y","r","depth","children"];function KS(e){qS.call(this,e)}KS.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:GS.length,default:GS}]},Object(ne.z)(KS,qS,{layout:function(){var e=null,t=1,n=1,r=hS;function a(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(mS(e)).eachAfter(bS(r,.5)).eachBefore(gS(1)):a.eachBefore(mS(vS)).eachAfter(bS(hS,1)).eachAfter(bS(r,a.r/Math.min(t,n))).eachBefore(gS(Math.min(t,n)/(2*a.r))),a}return a.radius=function(t){return arguments.length?(e=fS(t),a):e},a.size=function(e){return arguments.length?(t=+e[0],n=+e[1],a):[t,n]},a.padding=function(e){return arguments.length?(r="function"===typeof e?e:pS(+e),a):r},a},params:["radius","size","padding"],fields:GS});var XS=["x0","y0","x1","y1","depth","children"];function YS(e){qS.call(this,e)}function $S(e){fo.call(this,null,e)}YS.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:XS.length,default:XS}]},Object(ne.z)(YS,qS,{layout:function(){var e=1,t=1,n=0,r=!1;function a(a){var i=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/i,a.eachBefore(function(e,t){return function(r){r.children&&xS(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var a=r.x0,i=r.y0,o=r.x1-n,u=r.y1-n;o<a&&(a=o=(a+o)/2),u<i&&(i=u=(i+u)/2),r.x0=a,r.y0=i,r.x1=o,r.y1=u}}(t,i)),r&&a.eachBefore(yS),a}return a.round=function(e){return arguments.length?(r=!!e,a):r},a.size=function(n){return arguments.length?(e=+n[0],t=+n[1],a):[e,t]},a.padding=function(e){return arguments.length?(n=+e,a):n},a},params:["size","round","padding"],fields:XS}),$S.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Object(ne.z)($S,fo,{transform:function(e,t){t.source||Object(ne.o)("Stratify transform requires an upstream data source.");var n=this.value,r=e.modified(),a=t.fork(t.ALL).materialize(t.SOURCE),i=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return a.source=a.source.slice(),i&&(n=a.source.length?BS(_S().id(e.key).parentId(e.parentKey)(a.source),e.key,ne.ib):BS(_S()([{}]),e.key,e.key)),a.source.root=this.value=n,a}});var JS={tidy:function(){var e=SS,t=1,n=1,r=null;function a(a){var c=function(e){for(var t,n,r,a,i,o=new TS(e,0),u=[o];t=u.pop();)if(r=t._.children)for(t.children=new Array(i=r.length),a=i-1;a>=0;--a)u.push(n=t.children[a]=new TS(r[a],a)),n.parent=t;return(o.parent=new TS(null,0)).children=[o],o}(a);if(c.eachAfter(i),c.parent.m=-c.z,c.eachBefore(o),r)a.eachBefore(u);else{var s=a,l=a,f=a;a.eachBefore((function(e){e.x<s.x&&(s=e),e.x>l.x&&(l=e),e.depth>f.depth&&(f=e)}));var d=s===l?1:e(s,l)/2,h=d-s.x,p=t/(l.x+d+h),v=n/(f.depth||1);a.eachBefore((function(e){e.x=(e.x+h)*p,e.y=e.depth*v}))}return a}function i(t){var n=t.children,r=t.parent.children,a=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,a=e.children,i=a.length;--i>=0;)(t=a[i]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var i=(n[0].z+n[n.length-1].z)/2;a?(t.z=a.z+e(t._,a._),t.m=t.z-i):t.z=i}else a&&(t.z=a.z+e(t._,a._));t.parent.A=function(t,n,r){if(n){for(var a,i=t,o=t,u=n,c=i.parent.children[0],s=i.m,l=o.m,f=u.m,d=c.m;u=CS(u),i=ES(i),u&&i;)c=ES(c),(o=CS(o)).a=t,(a=u.z+f-i.z-s+e(u._,i._))>0&&(AS(NS(u,t,r),t,a),s+=a,l+=a),f+=u.m,s+=i.m,d+=c.m,l+=o.m;u&&!CS(o)&&(o.t=u,o.m+=f-l),i&&!ES(c)&&(c.t=i,c.m+=s-d,r=t)}return r}(t,a,t.parent.A||r[0])}function o(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function u(e){e.x*=t,e.y=e.depth*n}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a},cluster:function(){var e=IS,t=1,n=1,r=!1;function a(a){var i,o=0;a.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(DS,0)/e.length}(n),t.y=function(e){return 1+e.reduce(FS,0)}(n)):(t.x=i?o+=e(t,i):0,t.y=0,i=t)}));var u=function(e){for(var t;t=e.children;)e=t[0];return e}(a),c=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(a),s=u.x-e(u,c)/2,l=c.x+e(c,u)/2;return a.eachAfter(r?function(e){e.x=(e.x-a.x)*t,e.y=(a.y-e.y)*n}:function(e){e.x=(e.x-s)/(l-s)*t,e.y=(1-(a.y?e.y/a.y:1))*n})}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a}},QS=["x","y","depth","children"];function ZS(e){qS.call(this,e)}function eE(e){fo.call(this,[],e)}ZS.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:QS.length,default:QS}]},Object(ne.z)(ZS,qS,{layout:function(e){var t=e||"tidy";if(Object(ne.w)(JS,t))return JS[t]();Object(ne.o)("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:QS}),eE.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},Object(ne.z)(eE,fo,{transform:function(e,t){var n=this.value,r=t.source&&t.source.root,a=t.fork(t.NO_SOURCE),i={};return r||Object(ne.o)("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(a.rem=n,t.visit(t.SOURCE,(function(e){return i[Ei(e)]=1})),r.each((function(e){var t=e.data,n=e.parent&&e.parent.data;n&&i[Ei(t)]&&i[Ei(n)]&&a.add.push(Ai({source:n,target:t}))})),this.value=a.add):t.changed(t.MOD)&&(t.visit(t.MOD,(function(e){return i[Ei(e)]=1})),n.forEach((function(e){(i[Ei(e.source)]||i[Ei(e.target)])&&a.mod.push(e)}))),a}});var tE={binary:function(e,t,n,r,a){var i,o,u=e.children,c=u.length,s=new Array(c+1);for(s[0]=o=i=0;i<c;++i)s[i+1]=o+=u[i].value;!function e(t,n,r,a,i,o,c){if(t>=n-1){var l=u[t];return l.x0=a,l.y0=i,l.x1=o,void(l.y1=c)}var f=s[t],d=r/2+f,h=t+1,p=n-1;for(;h<p;){var v=h+p>>>1;s[v]<d?h=v+1:p=v}d-s[h-1]<s[h]-d&&t+1<h&&--h;var m=s[h]-f,b=r-m;if(o-a>c-i){var g=r?(a*b+o*m)/r:o;e(t,h,m,a,i,g,c),e(h,n,b,g,i,o,c)}else{var y=r?(i*b+c*m)/r:c;e(t,h,m,a,i,o,y),e(h,n,b,a,y,o,c)}}(0,c,e.value,t,n,r,a)},dice:xS,slice:MS,slicedice:function(e,t,n,r,a){(1&e.depth?MS:xS)(e,t,n,r,a)},squarify:LS,resquarify:PS},nE=["x0","y0","x1","y1","depth","children"];function rE(e){qS.call(this,e)}rE.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:nE.length,default:nE}]},Object(ne.z)(rE,qS,{layout:function(){var e=function(){var e=LS,t=!1,n=1,r=1,a=[0],i=hS,o=hS,u=hS,c=hS,s=hS;function l(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(f),a=[0],t&&e.eachBefore(yS),e}function f(t){var n=a[t.depth],r=t.x0+n,l=t.y0+n,f=t.x1-n,d=t.y1-n;f<r&&(r=f=(r+f)/2),d<l&&(l=d=(l+d)/2),t.x0=r,t.y0=l,t.x1=f,t.y1=d,t.children&&(n=a[t.depth+1]=i(t)/2,r+=s(t)-n,l+=o(t)-n,(f-=u(t)-n)<r&&(r=f=(r+f)/2),(d-=c(t)-n)<l&&(l=d=(l+d)/2),e(t,r,l,f,d))}return l.round=function(e){return arguments.length?(t=!!e,l):t},l.size=function(e){return arguments.length?(n=+e[0],r=+e[1],l):[n,r]},l.tile=function(t){return arguments.length?(e=dS(t),l):e},l.padding=function(e){return arguments.length?l.paddingInner(e).paddingOuter(e):l.paddingInner()},l.paddingInner=function(e){return arguments.length?(i="function"===typeof e?e:pS(+e),l):i},l.paddingOuter=function(e){return arguments.length?l.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):l.paddingTop()},l.paddingTop=function(e){return arguments.length?(o="function"===typeof e?e:pS(+e),l):o},l.paddingRight=function(e){return arguments.length?(u="function"===typeof e?e:pS(+e),l):u},l.paddingBottom=function(e){return arguments.length?(c="function"===typeof e?e:pS(+e),l):c},l.paddingLeft=function(e){return arguments.length?(s="function"===typeof e?e:pS(+e),l):s},l}();return e.ratio=function(t){var n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=function(t){Object(ne.w)(tE,t)?e.tile(tE[t]):Object(ne.o)("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:nE});function aE(e,t,n,r){var a=e.width,i=e.height,o=n||r,u=hl(a,i).getContext("2d");t.forEach((function(e){return iE(u,e,o)}));var c,s,l,f,d,h=new Uint32Array(u.getImageData(0,0,a,i).data.buffer),p=e.bitmap(),v=o&&e.bitmap();for(s=0;s<i;++s)for(c=0;c<a;++c)(d=4278190080&h[s*a+c])&&(l=e(c),f=e(s),r||p.set(l,f),o&&268435456^d&&v.set(l,f));return[p,v]}function iE(e,t,n){if(t.length){var r=t[0].mark.marktype;"group"===r?t.forEach((function(t){t.items.forEach((function(t){return iE(e,t.items,n)}))})):jb[r].draw(e,{items:n?t.map(oE):t})}}function oE(e){var t=Ti(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=.0625,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}var uE=31,cE=new Uint32Array(33),sE=new Uint32Array(33);sE[0]=0,cE[0]=~sE[0];for(var lE=1;lE<=32;++lE)sE[lE]=sE[lE-1]<<1|1,cE[lE]=~sE[lE];function fE(e,t,n){var r=Math.max(1,Math.sqrt(e*t/1e6)),a=~~((e+2*n+r)/r),i=~~((t+2*n+r)/r),o=function(e){return~~((e+n)/r)};return o.invert=function(e){return e*r-n},o.bitmap=function(){return function(e,t){var n=new Uint32Array(~~((e*t+32)/32));function r(e,t){n[e]|=t}function a(e,t){n[e]&=t}return{array:n,get:function(t,r){var a=r*e+t;return n[a>>>5]&1<<(a&uE)},set:function(t,n){var a=n*e+t;r(a>>>5,1<<(a&uE))},clear:function(t,n){var r=n*e+t;a(r>>>5,~(1<<(r&uE)))},getRange:function(t,r,a,i){for(var o,u,c,s,l=i;l>=r;--l)if((c=(o=l*e+t)>>>5)===(s=(u=l*e+a)>>>5)){if(n[c]&cE[o&uE]&sE[1+(u&uE)])return!0}else{if(n[c]&cE[o&uE])return!0;if(n[s]&sE[1+(u&uE)])return!0;for(var f=c+1;f<s;++f)if(n[f])return!0}return!1},setRange:function(t,n,a,i){for(var o,u,c,s,l;n<=i;++n)if((c=(o=n*e+t)>>>5)===(s=(u=n*e+a)>>>5))r(c,cE[o&uE]&sE[1+(u&uE)]);else for(r(c,cE[o&uE]),r(s,sE[1+(u&uE)]),l=c+1;l<s;++l)r(l,4294967295)},clearRange:function(t,n,r,i){for(var o,u,c,s,l;n<=i;++n)if((c=(o=n*e+t)>>>5)===(s=(u=n*e+r)>>>5))a(c,sE[o&uE]|cE[1+(u&uE)]);else for(a(c,sE[o&uE]),a(s,cE[1+(u&uE)]),l=c+1;l<s;++l)a(l,0)},outOfBounds:function(n,r,a,i){return n<0||r<0||i>=t||a>=e}}}(a,i)},o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function dE(e,t,n,r,a,i){var o=n/2;return e-o<0||e+o>a||t-(o=r/2)<0||t+o>i}function hE(e,t,n,r,a,i,o,u){var c=a*i/(2*r),s=e(t-c),l=e(t+c),f=e(n-(i/=2)),d=e(n+i);return o.outOfBounds(s,f,l,d)||o.getRange(s,f,l,d)||u&&u.getRange(s,f,l,d)}var pE=[-1,-1,1,1],vE=[-1,1,-1,1];var mE=["right","center","left"],bE=["bottom","middle","top"];function gE(e,t,n,r,a,i,o,u,c,s,l,f){return!(a.outOfBounds(e,n,t,r)||(f&&i?i.getRange(e,n,t,r)||!function(e,t,n,r,a){return a[0]<=e&&n<=a[2]&&a[3]<=t&&r<=a[5]}(o,c,u,s,l):a.getRange(e,n,t,r)))}var yE={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},xE={naive:function(e,t,n,r){var a=e.width,i=e.height;return function(e){for(var t,n,o,u,c,s,l,f=e.datum.datum.items[r].items,d=f.length,h=e.datum.fontSize,p=ob.width(e.datum,e.datum.text),v=0,m=0;m<d;++m)t=f[m].x,o=f[m].y,c=(t+(n=void 0===f[m].x2?t:f[m].x2))/2,s=(o+(u=void 0===f[m].y2?o:f[m].y2))/2,(l=Math.abs(n-t+u-o))>=v&&(v=l,e.x=c,e.y=s);return c=p/2,s=h/2,t=e.x-c,n=e.x+c,o=e.y-s,u=e.y+s,e.align="center",t<0&&n<=a?e.align="left":0<=t&&a<n&&(e.align="right"),e.baseline="middle",o<0&&u<=i?e.baseline="top":0<=o&&i<u&&(e.baseline="bottom"),!0}},"reduced-search":function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1];function c(t,n,r,c,s){var l,f=e.invert(t),d=e.invert(n),h=r,p=i;if(!dE(f,d,c,s,a,i)&&!hE(e,f,d,s,c,h,o,u)&&!hE(e,f,d,s,c,s,o,null)){for(;p-h>=1;)hE(e,f,d,s,c,l=(h+p)/2,o,u)?p=l:h=l;if(h>r)return[f,d,h,!0]}}return function(t){for(var u,s,l,f,d,h,p,v,m,b,g,y,x,O,k,w,j,_=t.datum.datum.items[r].items,S=_.length,E=t.datum.fontSize,C=ob.width(t.datum,t.datum.text),A=n?E:0,N=!1,T=!1,I=0,D=0;D<S;++D){for(u=_[D].x,l=_[D].y,u>(s=void 0===_[D].x2?u:_[D].x2)&&(j=u,u=s,s=j),l>(f=void 0===_[D].y2?l:_[D].y2)&&(j=l,l=f,f=j),b=~~(((m=e(u))+(g=e(s)))/2),x=~~(((y=e(l))+(O=e(f)))/2),p=b;p>=m;--p)for(v=x;v>=y;--v)if(w=c(p,v,A,C,E)){var F=w,M=Object(bo.a)(F,4);t.x=M[0],t.y=M[1],A=M[2],N=M[3]}for(p=b;p<=g;++p)for(v=x;v<=O;++v)if(w=c(p,v,A,C,E)){var R=w,z=Object(bo.a)(R,4);t.x=z[0],t.y=z[1],A=z[2],N=z[3]}N||n||(d=(u+s)/2,h=(l+f)/2,(k=Math.abs(s-u+f-l))>=I&&!dE(d,h,C,E,a,i)&&!hE(e,d,h,E,C,E,o,null)&&(I=k,t.x=d,t.y=h,T=!0))}return!(!N&&!T)&&(d=C/2,h=E/2,o.setRange(e(t.x-d),e(t.y-h),e(t.x+d),e(t.y+h)),t.align="center",t.baseline="middle",!0)}},floodfill:function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1],c=e.bitmap();return function(t){for(var s,l,f,d,h,p,v,m,b,g,y,x,O=t.datum.datum.items[r].items,k=O.length,w=t.datum.fontSize,j=ob.width(t.datum,t.datum.text),_=[],S=n?w:0,E=!1,C=!1,A=0,N=0;N<k;++N){for(s=O[N].x,f=O[N].y,l=void 0===O[N].x2?s:O[N].x2,d=void 0===O[N].y2?f:O[N].y2,_.push([e((s+l)/2),e((f+d)/2)]);_.length;){var T=_.pop(),I=Object(bo.a)(T,2);if(v=I[0],m=I[1],!(o.get(v,m)||u.get(v,m)||c.get(v,m))){c.set(v,m);for(var D=0;D<4;++D)h=v+pE[D],p=m+vE[D],c.outOfBounds(h,p,h,p)||_.push([h,p]);if(h=e.invert(v),p=e.invert(m),b=S,g=i,!dE(h,p,j,w,a,i)&&!hE(e,h,p,w,j,b,o,u)&&!hE(e,h,p,w,j,w,o,null)){for(;g-b>=1;)hE(e,h,p,w,j,y=(b+g)/2,o,u)?g=y:b=y;b>S&&(t.x=h,t.y=p,S=b,E=!0)}}}E||n||(h=(s+l)/2,p=(f+d)/2,(x=Math.abs(l-s+d-f))>=A&&!dE(h,p,j,w,a,i)&&!hE(e,h,p,w,j,w,o,null)&&(A=x,t.x=h,t.y=p,C=!0))}return!(!E&&!C)&&(h=j/2,p=w/2,o.setRange(e(t.x-h),e(t.y-p),e(t.x+h),e(t.y+p)),t.align="center",t.baseline="middle",!0)}}};function OE(e,t,n,r,a,i,o,u,c,s,l){if(!e.length)return e;var f,d,h=Math.max(r.length,a.length),p=function(e,t){for(var n=new Float64Array(t),r=e.length,a=0;a<r;++a)n[a]=e[a]||0;for(var i=r;i<t;++i)n[i]=n[r-1];return n}(r,h),v=function(e,t){for(var n=new Int8Array(t),r=e.length,a=0;a<r;++a)n[a]|=yE[e[a]];for(var i=r;i<t;++i)n[i]=n[r-1];return n}(a,h),m=(f=e[0].datum)&&f.mark&&f.mark.marktype,b="group"===m&&e[0].datum.items[c].marktype,g="area"===b,y=function(e,t,n,r){var a=function(e){return[e.x,e.x,e.x,e.y,e.y,e.y]};return e?"line"===e||"area"===e?function(e){return a(e.datum)}:"line"===t?function(e){var t=e.datum.items[r].items;return a(t.length?t["start"===n?0:t.length-1]:{x:NaN,y:NaN})}:function(e){var t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:a}(m,b,u,c),x=fE(t[0],t[1],s),O=g&&"naive"===l,k=e.map((function(e){return{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(e)}}));if(!O){n&&k.sort((function(e,t){return n(e.datum,t.datum)}));for(var w=!1,j=0;j<v.length&&!w;++j)w=5===v[j]||p[j]<0;m&&(o||g)&&(i=[e.map((function(e){return e.datum}))].concat(i)),d=i.length?aE(x,i,w,g):function(e,t){var n=e.bitmap();return(t||[]).forEach((function(t){return n.set(e(t.boundary[0]),e(t.boundary[3]))})),[n,void 0]}(x,o&&k)}var _=g?xE[l](x,d,o,c):function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1],c=r.length;return function(t){var s=t.boundary,l=t.datum.fontSize;if(s[2]<0||s[5]<0||s[0]>a||s[3]>i)return!1;for(var f,d,h,p,v,m,b,g,y,x,O,k,w,j,_,S=0,E=0;E<c;++E){if(f=(3&n[E])-1,d=(n[E]>>>2&3)-1,h=0===f&&0===d||r[E]<0,p=f&&d?Math.SQRT1_2:1,v=r[E]<0?-1:1,m=s[1+f]+r[E]*f*p,g=(O=s[4+d]+v*l*d/2+r[E]*d*p)-l/2,y=O+l/2,k=e(m),j=e(g),_=e(y),!S){if(!gE(k,k,j,_,o,u,m,m,g,y,s,h))continue;S=ob.width(t.datum,t.datum.text)}if(b=(x=m+v*S*f/2)+S/2,gE(k=e(m=x-S/2),w=e(b),j,_,o,u,m,b,g,y,s,h))return t.x=f?f*v<0?b:m:x,t.y=d?d*v<0?y:g:O,t.align=mE[f*v+1],t.baseline=bE[d*v+1],o.setRange(k,j,w,_),!0}return!1}}(x,d,v,p);return k.forEach((function(e){return e.opacity=+_(e)})),k}var kE=["x","y","opacity","align","baseline"],wE=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function jE(e){fo.call(this,null,e)}function _E(e,t){var n,r,a,i,o,u,c=[],s=function(e){return e(i)};if(null==t)c.push(e);else for(n={},r=0,a=e.length;r<a;++r)i=e[r],(u=n[o=t.map(s)])||(n[o]=u=[],u.dims=o,c.push(u)),u.push(i);return c}function SE(e){fo.call(this,null,e)}jE.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:wE},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:kE.length,default:kE}]},Object(ne.z)(jE,fo,{transform:function(e,t){var n=e.modified();if(n||t.changed(t.ADD_REM)||function(n){var r=e[n];return Object(ne.E)(r)&&t.modified(r.fields)}("sort")){e.size&&2===e.size.length||Object(ne.o)("Size parameter should be specified as a [width, height] array.");var r=e.as||kE;return OE(t.materialize(t.SOURCE).source,e.size,e.sort,Object(ne.i)(e.offset||1),Object(ne.i)(e.anchor||wE),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach((function(e){var t=e.datum;t[r[0]]=e.x,t[r[1]]=e.y,t[r[2]]=e.opacity,t[r[3]]=e.align,t[r[4]]=e.baseline})),t.reflow(n).modifies(r)}}}),SE.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},Object(ne.z)(SE,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=_E(t.materialize(t.SOURCE).source,e.groupby),a=(e.groupby||[]).map(ne.h),i=a.length,o=e.as||[Object(ne.h)(e.x),Object(ne.h)(e.y)],u=[];r.forEach((function(t){gu(t,e.x,e.y,e.bandwidth||.3).forEach((function(e){for(var n={},r=0;r<i;++r)n[a[r]]=t.dims[r];n[o[0]]=e[0],n[o[1]]=e[1],u.push(Ai(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});var EE={linear:fu,log:du,exp:hu,pow:pu,quad:vu,poly:mu};function CE(e){fo.call(this,null,e)}CE.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(EE)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},Object(ne.z)(CE,fo,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=_E(t.materialize(t.SOURCE).source,e.groupby),a=(e.groupby||[]).map(ne.h),i=e.method||"linear",o=e.order||3,u=function(e,t){return"poly"===e?t:"quad"===e?2:1}(i,o),c=e.as||[Object(ne.h)(e.x),Object(ne.h)(e.y)],s=EE[i],l=[],f=e.extent;Object(ne.w)(EE,i)||Object(ne.o)("Invalid regression method: "+i),null!=f&&"log"===i&&f[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((function(n){if(n.length<=u)t.dataflow.warn("Skipping regression with more parameters than data points.");else{var r=s(n,e.x,e.y,o);if(e.params)l.push(Ai({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));else{var d=f||Object(ne.q)(n,e.x),h=function(e){for(var t={},r=0;r<a.length;++r)t[a[r]]=n.dims[r];t[c[0]]=e[0],t[c[1]]=e[1],l.push(Ai(t))};"linear"===i?d.forEach((function(e){return h([e,r.predict(e)])})):ku(r.predict,d,25,200).forEach(h)}}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});var AE=Math.pow(2,-52),NE=new Uint32Array(512),TE=function(){function e(t){Object(iO.a)(this,e);var n=t.length>>1;if(n>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}return Object(oO.a)(e,[{key:"update",value:function(){for(var e=this.coords,t=this._hullPrev,n=this._hullNext,r=this._hullTri,a=this._hullHash,i=e.length>>1,o=1/0,u=1/0,c=-1/0,s=-1/0,l=0;l<i;l++){var f=e[2*l],d=e[2*l+1];f<o&&(o=f),d<u&&(u=d),f>c&&(c=f),d>s&&(s=d),this._ids[l]=l}for(var h,p,v,m=(o+c)/2,b=(u+s)/2,g=1/0,y=0;y<i;y++){var x=IE(m,b,e[2*y],e[2*y+1]);x<g&&(h=y,g=x)}var O=e[2*h],k=e[2*h+1];g=1/0;for(var w=0;w<i;w++)if(w!==h){var j=IE(O,k,e[2*w],e[2*w+1]);j<g&&j>0&&(p=w,g=j)}for(var _=e[2*p],S=e[2*p+1],E=1/0,C=0;C<i;C++)if(C!==h&&C!==p){var A=RE(O,k,_,S,e[2*C],e[2*C+1]);A<E&&(v=C,E=A)}var N=e[2*v],T=e[2*v+1];if(E===1/0){for(var I=0;I<i;I++)this._dists[I]=e[2*I]-e[0]||e[2*I+1]-e[1];zE(this._ids,this._dists,0,i-1);for(var D=new Uint32Array(i),F=0,M=0,R=-1/0;M<i;M++){var z=this._ids[M];this._dists[z]>R&&(D[F++]=z,R=this._dists[z])}return this.hull=D.subarray(0,F),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(FE(O,k,_,S,N,T)){var L=p,P=_,B=S;p=v,_=N,S=T,v=L,N=P,T=B}var W=function(e,t,n,r,a,i){var o=n-e,u=r-t,c=a-e,s=i-t,l=o*o+u*u,f=c*c+s*s,d=.5/(o*s-u*c);return{x:e+(s*l-u*f)*d,y:t+(o*f-c*l)*d}}(O,k,_,S,N,T);this._cx=W.x,this._cy=W.y;for(var U=0;U<i;U++)this._dists[U]=IE(e[2*U],e[2*U+1],W.x,W.y);zE(this._ids,this._dists,0,i-1),this._hullStart=h;var V=3;n[h]=t[v]=p,n[p]=t[h]=v,n[v]=t[p]=h,r[h]=0,r[p]=1,r[v]=2,a.fill(-1),a[this._hashKey(O,k)]=h,a[this._hashKey(_,S)]=p,a[this._hashKey(N,T)]=v,this.trianglesLen=0,this._addTriangle(h,p,v,-1,-1,-1);for(var q,H,G=0;G<this._ids.length;G++){var K=this._ids[G],X=e[2*K],Y=e[2*K+1];if(!(G>0&&Math.abs(X-q)<=AE&&Math.abs(Y-H)<=AE)&&(q=X,H=Y,K!==h&&K!==p&&K!==v)){for(var $=0,J=0,Q=this._hashKey(X,Y);J<this._hashSize&&(-1===($=a[(Q+J)%this._hashSize])||$===n[$]);J++);for(var Z=$=t[$],ee=void 0;ee=n[Z],!FE(X,Y,e[2*Z],e[2*Z+1],e[2*ee],e[2*ee+1]);)if((Z=ee)===$){Z=-1;break}if(-1!==Z){var te=this._addTriangle(Z,K,n[Z],-1,-1,r[Z]);r[K]=this._legalize(te+2),r[Z]=te,V++;for(var ne=n[Z];ee=n[ne],FE(X,Y,e[2*ne],e[2*ne+1],e[2*ee],e[2*ee+1]);)te=this._addTriangle(ne,K,ee,r[K],-1,r[ne]),r[K]=this._legalize(te+2),n[ne]=ne,V--,ne=ee;if(Z===$)for(;FE(X,Y,e[2*(ee=t[Z])],e[2*ee+1],e[2*Z],e[2*Z+1]);)te=this._addTriangle(ee,K,Z,-1,r[Z],r[ee]),this._legalize(te+2),r[ee]=te,n[Z]=Z,V--,Z=ee;this._hullStart=t[K]=Z,n[Z]=t[ne]=K,n[K]=ne,a[this._hashKey(X,Y)]=K,a[this._hashKey(e[2*Z],e[2*Z+1])]=Z}}}this.hull=new Uint32Array(V);for(var re=0,ae=this._hullStart;re<V;re++)this.hull[re]=ae,ae=n[ae];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(e,t){return Math.floor(function(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}},{key:"_legalize",value:function(e){for(var t=this._triangles,n=this._halfedges,r=this.coords,a=0,i=0;;){var o=n[e],u=e-e%3;if(i=u+(e+2)%3,-1!==o){var c=o-o%3,s=u+(e+1)%3,l=c+(o+2)%3,f=t[i],d=t[e],h=t[s],p=t[l];if(ME(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){t[e]=p,t[o]=f;var v=n[l];if(-1===v){var m=this._hullStart;do{if(this._hullTri[m]===l){this._hullTri[m]=e;break}m=this._hullPrev[m]}while(m!==this._hullStart)}this._link(e,v),this._link(o,n[i]),this._link(i,l);var b=c+(o+1)%3;a<NE.length&&(NE[a++]=b)}else{if(0===a)break;e=NE[--a]}}else{if(0===a)break;e=NE[--a]}}return i}},{key:"_link",value:function(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}},{key:"_addTriangle",value:function(e,t,n,r,a,i){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,a),this._link(o+2,i),this.trianglesLen+=3,o}}],[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:PE,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:BE,a=t.length,i=new Float64Array(2*a),o=0;o<a;o++){var u=t[o];i[2*o]=n(u),i[2*o+1]=r(u)}return new e(i)}}]),e}();function IE(e,t,n,r){var a=e-n,i=t-r;return a*a+i*i}function DE(e,t,n,r,a,i){var o=(r-t)*(a-e),u=(n-e)*(i-t);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function FE(e,t,n,r,a,i){return(DE(a,i,e,t,n,r)||DE(e,t,n,r,a,i)||DE(n,r,a,i,e,t))<0}function ME(e,t,n,r,a,i,o,u){var c=e-o,s=t-u,l=n-o,f=r-u,d=a-o,h=i-u,p=l*l+f*f,v=d*d+h*h;return c*(f*v-p*h)-s*(l*v-p*d)+(c*c+s*s)*(l*h-f*d)<0}function RE(e,t,n,r,a,i){var o=n-e,u=r-t,c=a-e,s=i-t,l=o*o+u*u,f=c*c+s*s,d=.5/(o*s-u*c),h=(s*l-u*f)*d,p=(o*f-c*l)*d;return h*h+p*p}function zE(e,t,n,r){if(r-n<=20)for(var a=n+1;a<=r;a++){for(var i=e[a],o=t[i],u=a-1;u>=n&&t[e[u]]>o;)e[u+1]=e[u--];e[u+1]=i}else{var c=n+1,s=r;LE(e,n+r>>1,c),t[e[n]]>t[e[r]]&&LE(e,n,r),t[e[c]]>t[e[r]]&&LE(e,c,r),t[e[n]]>t[e[c]]&&LE(e,n,c);for(var l=e[c],f=t[l];;){do{c++}while(t[e[c]]<f);do{s--}while(t[e[s]]>f);if(s<c)break;LE(e,c,s)}e[n+1]=e[s],e[s]=l,r-c+1>=s-n?(zE(e,t,c,r),zE(e,t,n,s-1)):(zE(e,t,n,s-1),zE(e,t,c,r))}}function LE(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function PE(e){return e[0]}function BE(e){return e[1]}var WE=1e-6,UE=function(){function e(){Object(iO.a)(this,e),this._x0=this._y0=this._x1=this._y1=null,this._=""}return Object(oO.a)(e,[{key:"moveTo",value:function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}},{key:"arc",value:function(e,t,n){var r=(e=+e)+(n=+n),a=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(a):(Math.abs(this._x1-r)>WE||Math.abs(this._y1-a)>WE)&&(this._+="L"+r+","+a),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=a))}},{key:"rect",value:function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),e}(),VE=function(){function e(){Object(iO.a)(this,e),this._=[]}return Object(oO.a)(e,[{key:"moveTo",value:function(e,t){this._.push([e,t])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(e,t){this._.push([e,t])}},{key:"value",value:function(){return this._.length?this._:null}}]),e}(),qE=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=Object(bo.a)(n,4),a=r[0],i=r[1],o=r[2],u=r[3];if(Object(iO.a)(this,e),!((o=+o)>=(a=+a))||!((u=+u)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=o,this.xmin=a,this.ymax=u,this.ymin=i,this._init()}return Object(oO.a)(e,[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var e,t,n=this.delaunay,r=n.points,a=n.hull,i=n.triangles,o=this.vectors,u=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2),c=0,s=0,l=i.length;c<l;c+=3,s+=2){var f=2*i[c],d=2*i[c+1],h=2*i[c+2],p=r[f],v=r[f+1],m=r[d],b=r[d+1],g=r[h],y=r[h+1],x=m-p,O=b-v,k=g-p,w=y-v,j=x*x+O*O,_=k*k+w*w,S=2*(x*w-O*k);if(S)if(Math.abs(S)<1e-8)e=(p+g)/2,t=(v+y)/2;else{var E=1/S;e=p+(w*j-O*_)*E,t=v+(x*_-k*j)*E}else e=(p+g)/2-1e8*w,t=(v+y)/2+1e8*k;u[s]=e,u[s+1]=t}var C,A,N,T=a[a.length-1],I=4*T,D=r[2*T],F=r[2*T+1];o.fill(0);for(var M=0;M<a.length;++M)C=I,A=D,N=F,I=4*(T=a[M]),D=r[2*T],F=r[2*T+1],o[C+2]=o[I]=N-F,o[C+3]=o[I+1]=D-A}},{key:"render",value:function(e){var t=null==e?e=new UE:void 0,n=this.delaunay,r=n.halfedges,a=n.inedges,i=n.hull,o=this.circumcenters,u=this.vectors;if(i.length<=1)return null;for(var c=0,s=r.length;c<s;++c){var l=r[c];if(!(l<c)){var f=2*Math.floor(c/3),d=2*Math.floor(l/3),h=o[f],p=o[f+1],v=o[d],m=o[d+1];this._renderSegment(h,p,v,m,e)}}for(var b,g=i[i.length-1],y=0;y<i.length;++y){b=g,g=i[y];var x=2*Math.floor(a[g]/3),O=o[x],k=o[x+1],w=4*b,j=this._project(O,k,u[w+2],u[w+3]);j&&this._renderSegment(O,k,j[0],j[1],e)}return t&&t.value()}},{key:"renderBounds",value:function(e){var t=null==e?e=new UE:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}},{key:"renderCell",value:function(e,t){var n=null==t?t=new UE:void 0,r=this._clip(e);if(null!==r&&r.length){t.moveTo(r[0],r[1]);for(var a=r.length;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(var i=2;i<a;i+=2)r[i]===r[i-2]&&r[i+1]===r[i-1]||t.lineTo(r[i],r[i+1]);return t.closePath(),n&&n.value()}}},{key:"cellPolygons",value:k.a.mark((function e(){var t,n,r,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.delaunay.points,n=0,r=t.length/2;case 2:if(!(n<r)){e.next=11;break}if(!(a=this.cellPolygon(n))){e.next=8;break}return a.index=n,e.next=8,a;case 8:++n,e.next=2;break;case 11:case"end":return e.stop()}}),e,this)}))},{key:"cellPolygon",value:function(e){var t=new VE;return this.renderCell(e,t),t.value()}},{key:"_renderSegment",value:function(e,t,n,r,a){var i,o=this._regioncode(e,t),u=this._regioncode(n,r);0===o&&0===u?(a.moveTo(e,t),a.lineTo(n,r)):(i=this._clipSegment(e,t,n,r,o,u))&&(a.moveTo(i[0],i[1]),a.lineTo(i[2],i[3]))}},{key:"contains",value:function(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}},{key:"neighbors",value:k.a.mark((function e(t){var n,r,a,i,o,u,c,s,l;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._clip(t))){e.next=33;break}r=Object(mo.a)(this.delaunay.neighbors(t)),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=25;break}if(i=a.value,!(o=this._clip(i))){e.next=23;break}u=0,c=n.length;case 10:if(!(u<c)){e.next=23;break}s=0,l=o.length;case 12:if(!(s<l)){e.next=20;break}if(n[u]!=o[s]||n[u+1]!=o[s+1]||n[(u+2)%c]!=o[(s+l-2)%l]||n[(u+3)%c]!=o[(s+l-1)%l]){e.next=17;break}return e.next=16,i;case 16:return e.abrupt("break",23);case 17:s+=2,e.next=12;break;case 20:u+=2,e.next=10;break;case 23:e.next=5;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(3),r.e(e.t0);case 30:return e.prev=30,r.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[3,27,30,33]])}))},{key:"_cell",value:function(e){var t=this.circumcenters,n=this.delaunay,r=n.inedges,a=n.halfedges,i=n.triangles,o=r[e];if(-1===o)return null;var u=[],c=o;do{var s=Math.floor(c/3);if(u.push(t[2*s],t[2*s+1]),i[c=c%3===2?c-2:c+1]!==e)break;c=a[c]}while(c!==o&&-1!==c);return u}},{key:"_clip",value:function(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var t=this._cell(e);if(null===t)return null;var n=this.vectors,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}},{key:"_clipFinite",value:function(e,t){for(var n,r,a,i,o,u=t.length,c=null,s=t[u-2],l=t[u-1],f=this._regioncode(s,l),d=0;d<u;d+=2)if(n=s,r=l,s=t[d],l=t[d+1],a=f,f=this._regioncode(s,l),0===a&&0===f)i=o,o=0,c?c.push(s,l):c=[s,l];else{var h=void 0,p=void 0,v=void 0,m=void 0,b=void 0;if(0===a){if(null===(h=this._clipSegment(n,r,s,l,a,f)))continue;var g=h,y=Object(bo.a)(g,4);p=y[0],v=y[1],m=y[2],b=y[3]}else{if(null===(h=this._clipSegment(s,l,n,r,f,a)))continue;var x=h,O=Object(bo.a)(x,4);m=O[0],b=O[1],p=O[2],v=O[3],i=o,o=this._edgecode(p,v),i&&o&&this._edge(e,i,o,c,c.length),c?c.push(p,v):c=[p,v]}i=o,o=this._edgecode(m,b),i&&o&&this._edge(e,i,o,c,c.length),c?c.push(m,b):c=[m,b]}if(c)i=o,o=this._edgecode(c[0],c[1]),i&&o&&this._edge(e,i,o,c,c.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return c}},{key:"_clipSegment",value:function(e,t,n,r,a,i){for(;;){if(0===a&&0===i)return[e,t,n,r];if(a&i)return null;var o=void 0,u=void 0,c=a||i;8&c?(o=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax):4&c?(o=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin):2&c?(u=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax):(u=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin),a?(e=o,t=u,a=this._regioncode(e,t)):(n=o,r=u,i=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(e,t,n,r,a,i){var o,u=Array.from(t);if((o=this._project(u[0],u[1],n,r))&&u.unshift(o[0],o[1]),(o=this._project(u[u.length-2],u[u.length-1],a,i))&&u.push(o[0],o[1]),u=this._clipFinite(e,u))for(var c,s=0,l=u.length,f=this._edgecode(u[l-2],u[l-1]);s<l;s+=2)c=f,f=this._edgecode(u[s],u[s+1]),c&&f&&(s=this._edge(e,c,f,u,s),l=u.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}},{key:"_edge",value:function(e,t,n,r,a){for(;t!==n;){var i=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,i=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,i=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,i=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,i=this.xmin,o=this.ymin}r[a]===i&&r[a+1]===o||!this.contains(e,i,o)||(r.splice(a,0,i,o),a+=2)}if(r.length>4)for(var u=0;u<r.length;u+=2){var c=(u+2)%r.length,s=(u+4)%r.length;(r[u]===r[c]&&r[c]===r[s]||r[u+1]===r[c+1]&&r[c+1]===r[s+1])&&(r.splice(c,2),u-=2)}return a}},{key:"_project",value:function(e,t,n,r){var a,i,o,u=1/0;if(r<0){if(t<=this.ymin)return null;(a=(this.ymin-t)/r)<u&&(o=this.ymin,i=e+(u=a)*n)}else if(r>0){if(t>=this.ymax)return null;(a=(this.ymax-t)/r)<u&&(o=this.ymax,i=e+(u=a)*n)}if(n>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<u&&(i=this.xmax,o=t+(u=a)*r)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<u&&(i=this.xmin,o=t+(u=a)*r)}return[i,o]}},{key:"_edgecode",value:function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}},{key:"_regioncode",value:function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}]),e}(),HE=k.a.mark(ZE),GE=2*Math.PI,KE=Math.pow;function XE(e){return e[0]}function YE(e){return e[1]}function $E(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var JE=function(){function e(t){Object(iO.a)(this,e),this._delaunator=new TE(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}return Object(oO.a)(e,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){for(var t=e.triangles,n=e.coords,r=0;r<t.length;r+=3){var a=2*t[r],i=2*t[r+1],o=2*t[r+2];if((n[o]-n[a])*(n[i+1]-n[a+1])-(n[i]-n[a])*(n[o+1]-n[a+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));for(var n=this.collinear[0],r=this.collinear[this.collinear.length-1],a=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],i=1e-8*Math.hypot(a[3]-a[1],a[2]-a[0]),o=0,u=t.length/2;o<u;++o){var c=$E(t[2*o],t[2*o+1],i);t[2*o]=c[0],t[2*o+1]=c[1]}this._delaunator=new TE(t)}else delete this.collinear;for(var s=this.halfedges=this._delaunator.halfedges,l=this.hull=this._delaunator.hull,f=this.triangles=this._delaunator.triangles,d=this.inedges.fill(-1),h=this._hullIndex.fill(-1),p=0,v=s.length;p<v;++p){var m=f[p%3===2?p-2:p+1];-1!==s[p]&&-1!==d[m]||(d[m]=p)}for(var b=0,g=l.length;b<g;++b)h[l[b]]=b;l.length<=2&&l.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=l[0],this.triangles[1]=l[1],this.triangles[2]=l[1],d[l[0]]=1,2===l.length&&(d[l[1]]=0))}},{key:"voronoi",value:function(e){return new qE(this,e)}},{key:"neighbors",value:k.a.mark((function e(t){var n,r,a,i,o,u,c,s,l,f,d;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inedges,r=this.hull,a=this._hullIndex,i=this.halfedges,o=this.triangles,!(u=this.collinear)){e.next=10;break}if(!((c=u.indexOf(t))>0)){e.next=6;break}return e.next=6,u[c-1];case 6:if(!(c<u.length-1)){e.next=9;break}return e.next=9,u[c+1];case 9:return e.abrupt("return");case 10:if(-1!==(s=n[t])){e.next=13;break}return e.abrupt("return");case 13:l=s,f=-1;case 14:return e.next=16,f=o[l];case 16:if(o[l=l%3===2?l-2:l+1]===t){e.next=19;break}return e.abrupt("return");case 19:if(-1!==(l=i[l])){e.next=26;break}if((d=r[(a[t]+1)%r.length])===f){e.next=25;break}return e.next=25,d;case 25:return e.abrupt("return");case 26:if(l!==s){e.next=14;break}case 27:case"end":return e.stop()}}),e,this)}))},{key:"find",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;for(var r,a=n;(r=this._step(n,e,t))>=0&&r!==n&&r!==a;)n=r;return r}},{key:"_step",value:function(e,t,n){var r=this.inedges,a=this.hull,i=this._hullIndex,o=this.halfedges,u=this.triangles,c=this.points;if(-1===r[e]||!c.length)return(e+1)%(c.length>>1);var s=e,l=KE(t-c[2*e],2)+KE(n-c[2*e+1],2),f=r[e],d=f;do{var h=u[d],p=KE(t-c[2*h],2)+KE(n-c[2*h+1],2);if(p<l&&(l=p,s=h),u[d=d%3===2?d-2:d+1]!==e)break;if(-1===(d=o[d])){if((d=a[(i[e]+1)%a.length])!==h&&KE(t-c[2*d],2)+KE(n-c[2*d+1],2)<l)return d;break}}while(d!==f);return s}},{key:"render",value:function(e){for(var t=null==e?e=new UE:void 0,n=this.points,r=this.halfedges,a=this.triangles,i=0,o=r.length;i<o;++i){var u=r[i];if(!(u<i)){var c=2*a[i],s=2*a[u];e.moveTo(n[c],n[c+1]),e.lineTo(n[s],n[s+1])}}return this.renderHull(e),t&&t.value()}},{key:"renderPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=null==e?e=new UE:void 0,r=this.points,a=0,i=r.length;a<i;a+=2){var o=r[a],u=r[a+1];e.moveTo(o+t,u),e.arc(o,u,t,0,GE)}return n&&n.value()}},{key:"renderHull",value:function(e){var t=null==e?e=new UE:void 0,n=this.hull,r=this.points,a=2*n[0],i=n.length;e.moveTo(r[a],r[a+1]);for(var o=1;o<i;++o){var u=2*n[o];e.lineTo(r[u],r[u+1])}return e.closePath(),t&&t.value()}},{key:"hullPolygon",value:function(){var e=new VE;return this.renderHull(e),e.value()}},{key:"renderTriangle",value:function(e,t){var n=null==t?t=new UE:void 0,r=this.points,a=this.triangles,i=2*a[e*=3],o=2*a[e+1],u=2*a[e+2];return t.moveTo(r[i],r[i+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[u],r[u+1]),t.closePath(),n&&n.value()}},{key:"trianglePolygons",value:k.a.mark((function e(){var t,n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.triangles,n=0,r=t.length/3;case 2:if(!(n<r)){e.next=8;break}return e.next=5,this.trianglePolygon(n);case 5:++n,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"trianglePolygon",value:function(e){var t=new VE;return this.renderTriangle(e,t),t.value()}}],[{key:"from",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:XE,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:YE,a=arguments.length>3?arguments[3]:void 0;return new e("length"in t?QE(t,n,r,a):Float64Array.from(ZE(t,n,r,a)))}}]),e}();function QE(e,t,n,r){for(var a=e.length,i=new Float64Array(2*a),o=0;o<a;++o){var u=e[o];i[2*o]=t.call(r,u,o,e),i[2*o+1]=n.call(r,u,o,e)}return i}function ZE(e,t,n,r){var a,i,o,u;return k.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:a=0,i=Object(mo.a)(e),c.prev=2,i.s();case 4:if((o=i.n()).done){c.next=13;break}return u=o.value,c.next=8,t.call(r,u,a,e);case 8:return c.next=10,n.call(r,u,a,e);case 10:++a;case 11:c.next=4;break;case 13:c.next=18;break;case 15:c.prev=15,c.t0=c.catch(2),i.e(c.t0);case 18:return c.prev=18,i.f(),c.finish(18);case 21:case"end":return c.stop()}}),HE,null,[[2,15,18,21]])}function eC(e){fo.call(this,null,e)}eC.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var tC=[-1e5,-1e5,1e5,1e5];function nC(e){for(var t=e[0][0],n=e[0][1],r=e.length-1;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}Object(ne.z)(eC,fo,{transform:function(e,t){var n=e.as||"path",r=t.source;if(!r||!r.length)return t;var a=e.size;a=a?[0,0,a[0],a[1]]:(a=e.extent)?[a[0][0],a[0][1],a[1][0],a[1][1]]:tC;for(var i=this.value=JE.from(r,e.x,e.y).voronoi(a),o=0,u=r.length;o<u;++o){var c=i.cellPolygon(o);r[o][n]=c?nC(c):null}return t.reflow(e.modified()).modifies(n)}});var rC=Math.PI/180,aC=2048;function iC(){var e,t,n,r,a,i,o,u=[256,256],c=sC,s=[],l=Math.random,f={};function d(e,t,n){for(var r,a,i,o,s,f=t.x,d=t.y,h=Math.sqrt(u[0]*u[0]+u[1]*u[1]),p=c(u),v=l()<.5?1:-1,m=-v;(r=p(m+=v))&&(a=~~r[0],i=~~r[1],!(Math.min(Math.abs(a),Math.abs(i))>=h));)if(t.x=f+a,t.y=d+i,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>u[0]||t.y+t.y1>u[1])&&(!n||!uC(t,e,u[0]))&&(!n||(s=n,(o=t).x+o.x1>s[0].x&&o.x+o.x0<s[1].x&&o.y+o.y1>s[0].y&&o.y+o.y0<s[1].y))){for(var b,g=t.sprite,y=t.width>>5,x=u[0]>>5,O=t.x-(y<<4),k=127&O,w=32-k,j=t.y1-t.y0,_=(t.y+t.y0)*x+(O>>5),S=0;S<j;S++){b=0;for(var E=0;E<=y;E++)e[_+E]|=b<<w|(E<y?(b=g[S*y+E])>>>k:0);_+=x}return t.sprite=null,!0}return!1}return f.layout=function(){for(var c=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=2048/t,e.height=aC/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(hl()),f=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((u[0]>>5)*u[1]),h=null,p=s.length,v=-1,m=[],b=s.map((function(u){return{text:e(u),font:t(u),style:r(u),weight:a(u),rotate:i(u),size:~~(n(u)+1e-14),padding:o(u),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:u}})).sort((function(e,t){return t.size-e.size}));++v<p;){var g=b[v];g.x=u[0]*(l()+.5)>>1,g.y=u[1]*(l()+.5)>>1,oC(c,g,b,v),g.hasText&&d(f,g,h)&&(m.push(g),h?cC(h,g):h=[{x:g.x+g.x0,y:g.y+g.y0},{x:g.x+g.x1,y:g.y+g.y1}],g.x-=u[0]>>1,g.y-=u[1]>>1)}return m},f.words=function(e){return arguments.length?(s=e,f):s},f.size=function(e){return arguments.length?(u=[+e[0],+e[1]],f):u},f.font=function(e){return arguments.length?(t=lC(e),f):t},f.fontStyle=function(e){return arguments.length?(r=lC(e),f):r},f.fontWeight=function(e){return arguments.length?(a=lC(e),f):a},f.rotate=function(e){return arguments.length?(i=lC(e),f):i},f.text=function(t){return arguments.length?(e=lC(t),f):e},f.spiral=function(e){return arguments.length?(c=fC[e]||e,f):c},f.fontSize=function(e){return arguments.length?(n=lC(e),f):n},f.padding=function(e){return arguments.length?(o=lC(e),f):o},f.random=function(e){return arguments.length?(l=e,f):l},f}function oC(e,t,n,r){if(!t.sprite){var a=e.context,i=e.ratio;a.clearRect(0,0,2048/i,aC/i);var o,u,c,s,l,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(t=n[r],a.save(),a.font=t.style+" "+t.weight+" "+~~((t.size+1)/i)+"px "+t.font,o=a.measureText(t.text+"m").width*i,c=t.size<<1,t.rotate){var v=Math.sin(t.rotate*rC),m=Math.cos(t.rotate*rC),b=o*m,g=o*v,y=c*m,x=c*v;o=Math.max(Math.abs(b+x),Math.abs(b-x))+31>>5<<5,c=~~Math.max(Math.abs(g+y),Math.abs(g-y))}else o=o+31>>5<<5;if(c>h&&(h=c),f+o>=2048&&(f=0,d+=h,h=0),d+c>=aC)break;a.translate((f+(o>>1))/i,(d+(c>>1))/i),t.rotate&&a.rotate(t.rotate*rC),a.fillText(t.text,0,0),t.padding&&(a.lineWidth=2*t.padding,a.strokeText(t.text,0,0)),a.restore(),t.width=o,t.height=c,t.xoff=f,t.yoff=d,t.x1=o>>1,t.y1=c>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,f+=o}for(var O=a.getImageData(0,0,2048/i,aC/i).data,k=[];--r>=0;)if((t=n[r]).hasText){for(u=(o=t.width)>>5,c=t.y1-t.y0,s=0;s<c*u;s++)k[s]=0;if(null==(f=t.xoff))return;d=t.yoff;var w=0,j=-1;for(l=0;l<c;l++){for(s=0;s<o;s++){var _=u*l+(s>>5),S=O[2048*(d+l)+(f+s)<<2]?1<<31-s%32:0;k[_]|=S,w|=S}w?j=l:(t.y0++,c--,l--,d++)}t.y1=t.y0+j,t.sprite=k.slice(0,(t.y1-t.y0)*u)}}}function uC(e,t,n){n>>=5;for(var r,a=e.sprite,i=e.width>>5,o=e.x-(i<<4),u=127&o,c=32-u,s=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),f=0;f<s;f++){r=0;for(var d=0;d<=i;d++)if((r<<c|(d<i?(r=a[f*i+d])>>>u:0))&t[l+d])return!0;l+=n}return!1}function cC(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function sC(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function lC(e){return"function"===typeof e?e:function(){return e}}var fC={archimedean:sC,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var a=e<0?-1:1;switch(Math.sqrt(1+4*a*e)-a&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}},dC=["x","y","font","fontSize","fontStyle","fontWeight","angle"],hC=["text","font","rotate","fontSize","fontStyle","fontWeight"];function pC(e){fo.call(this,iC(),e)}pC.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:dC}]},Object(ne.z)(pC,fo,{transform:function(e,t){!e.size||e.size[0]&&e.size[1]||Object(ne.o)("Wordcloud size dimensions must be non-zero.");var n=e.modified();if(n||t.changed(t.ADD_REM)||hC.some((function(n){var r=e[n];return Object(ne.E)(r)&&t.modified(r.fields)}))){var r,a=t.materialize(t.SOURCE).source,i=this.value,o=e.as||dC,u=e.fontSize||14;if(Object(ne.E)(u)?r=e.fontSizeRange:u=Object(ne.m)(u),r){var c=u,s=Kh("sqrt")().domain(Object(ne.q)(a,c)).range(r);u=function(e){return s(c(e))}}a.forEach((function(e){e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0}));for(var l,f,d=i.words(a).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(u).random(Mo).layout(),h=i.size(),p=h[0]>>1,v=h[1]>>1,m=d.length,b=0;b<m;++b)(f=(l=d[b]).datum)[o[0]]=l.x+p,f[o[1]]=l.y+v,f[o[2]]=l.font,f[o[3]]=l.size,f[o[4]]=l.style,f[o[5]]=l.weight,f[o[6]]=l.rotate;return t.reflow(n).modifies(o)}}});var vC=function(e){return new Uint8Array(e)},mC=function(e){return new Uint16Array(e)},bC=function(e){return new Uint32Array(e)};function gC(e,t,n){var r=(t<257?vC:t<65537?mC:bC)(e);return n&&r.set(n),r}function yC(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n,a=this,i=a.bisect(a.range,e.value),o=e.index,u=i[0],c=i[1],s=o.length;for(n=0;n<u;++n)t[o[n]]|=r;for(n=c;n<s;++n)t[o[n]]|=r;return a}}}function xC(){var e=bC(0),t=[],n=0;return{insert:function(r,a,i){if(!a.length)return[];var o,u,c,s,l,f,d,h=n,p=a.length,v=bC(p),m=Array(p);for(c=0;c<p;++c)m[c]=r(a[c]),v[c]=c;if(d=v,(f=m).sort.call(d,(function(e,t){var n=f[e],r=f[t];return n<r?-1:n>r?1:0})),s=f,l=d,m=Array.from(l,(function(e){return s[e]})),h)o=t,u=e,t=Array(h+p),e=bC(h+p),function(e,t,n,r,a,i,o,u,c){var s,l=0,f=0;for(s=0;l<r&&f<o;++s)t[l]<a[f]?(u[s]=t[l],c[s]=n[l++]):(u[s]=a[f],c[s]=i[f++]+e);for(;l<r;++l,++s)u[s]=t[l],c[s]=n[l];for(;f<o;++f,++s)u[s]=a[f],c[s]=i[f]+e}(i,o,u,h,m,v,p,t,e);else{if(i>0)for(c=0;c<p;++c)v[c]+=i;t=m,e=v}return n=h+p,{index:v,value:m}},remove:function(r,a){var i,o,u,c=n;for(o=0;!a[e[o]]&&o<c;++o);for(u=o;o<c;++o)a[i=e[o]]||(e[u]=i,t[u]=t[o],++u);n=c-r},bisect:function(e,r){var a;return r?a=r.length:(r=t,a=n),[bl(r,e[0],0,a),ml(r,e[1],0,a)]},reindex:function(t){for(var r=0,a=n;r<a;++r)e[r]=t[e[r]]},index:function(){return e},size:function(){return n}}}function OC(e){fo.call(this,function(){var e=8,t=[],n=bC(0),r=gC(0,e),a=gC(0,e);return{data:function(){return t},seen:function(){return e=n,r=t.length,n=e.length>=r?e:((a=a||new e.constructor(r)).set(e),a);var e,r,a},add:function(e){for(var n,r=0,a=t.length,i=e.length;r<i;++r)(n=e[r])._index=a++,t.push(n)},remove:function(e,n){var i,o,u,c=t.length,s=Array(c-e),l=t;for(o=0;!n[o]&&o<c;++o)s[o]=t[o],l[o]=o;for(u=o;o<c;++o)i=t[o],n[o]?l[o]=-1:(l[o]=u,r[u]=r[o],a[u]=a[o],s[u]=i,i._index=u++),r[o]=0;return t=s,l},size:function(){return t.length},curr:function(){return r},prev:function(){return a},reset:function(e){return a[e]=r[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){(t>r.length||n>e)&&(e=Math.max(n,e),r=gC(t,e,r),a=gC(t,e))}}}(),e),this._indices=null,this._dims=null}function kC(e){fo.call(this,null,e)}OC.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},Object(ne.z)(OC,fo,{transform:function(e,t){return this._dims?e.modified("fields")||e.fields.some((function(e){return t.modified(e.fields)}))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init:function(e,t){for(var n,r,a=e.fields,i=e.query,o=this._indices={},u=this._dims=[],c=i.length,s=0;s<c;++s)r=o[n=a[s].fname]||(o[n]=xC()),u.push(yC(r,s,i[s]));return this.eval(e,t)},reinit:function(e,t){var n,r,a,i,o,u,c,s,l,f=t.materialize().fork(),d=e.fields,h=e.query,p=this._indices,v=this._dims,m=this.value,b=m.curr(),g=m.prev(),y=m.all(),x=f.rem=f.add,O=f.mod,k=h.length,w={};if(g.set(b),t.rem.length&&(o=this.remove(e,t,f)),t.add.length&&m.add(t.add),t.mod.length)for(u={},c=0,s=(i=t.mod).length;c<s;++c)u[i[c]._index]=1;for(c=0;c<k;++c)l=d[c],(!v[c]||e.modified("fields",c)||t.modified(l.fields))&&((n=w[a=l.fname])||(p[a]=r=xC(),w[a]=n=r.insert(l,t.source,0)),v[c]=yC(r,c,h[c]).onAdd(n,b));for(c=0,s=m.data().length;c<s;++c)o[c]||(g[c]!==b[c]?x.push(c):u[c]&&b[c]!==y&&O.push(c));return m.mask=(1<<k)-1,f},eval:function(e,t){var n=t.materialize().fork(),r=this._dims.length,a=0;return t.rem.length&&(this.remove(e,t,n),a|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(a|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),a|=(1<<r)-1),t.mod.length&&(this.modify(t,n),a|=(1<<r)-1),this.value.mask=a,n},insert:function(e,t,n){var r,a,i,o=t.add,u=this.value,c=this._dims,s=this._indices,l=e.fields,f={},d=n.add,h=u.size()+o.length,p=c.length,v=u.size();u.resize(h,p),u.add(o);var m=u.curr(),b=u.prev(),g=u.all();for(r=0;r<p;++r)i=f[a=l[r].fname]||(f[a]=s[a].insert(l[r],o,v)),c[r].onAdd(i,m);for(;v<h;++v)b[v]=g,m[v]!==g&&d.push(v)},modify:function(e,t){var n,r,a,i=t.mod,o=this.value,u=o.curr(),c=o.all(),s=e.mod;for(n=0,r=s.length;n<r;++n)u[a=s[n]._index]!==c&&i.push(a)},remove:function(e,t,n){var r,a,i,o,u=this._indices,c=this.value,s=c.curr(),l=c.prev(),f=c.all(),d={},h=n.rem,p=t.rem;for(r=0,a=p.length;r<a;++r)d[i=p[r]._index]=1,l[i]=o=s[i],s[i]=f,o!==f&&h.push(i);for(i in u)u[i].remove(a,d);return this.reindex(t,a,d),d},reindex:function(e,t,n){var r=this._indices,a=this.value;e.runAfter((function(){var e=a.remove(t,n);for(var i in r)r[i].reindex(e)}))},update:function(e,t,n){var r,a,i=this._dims,o=e.query,u=t.stamp,c=i.length,s=0;for(n.filters=0,a=0;a<c;++a)e.modified("query",a)&&(r=a,++s);if(1===s)s=i[r].one,this.incrementOne(i[r],o[r],n.add,n.rem);else for(a=0,s=0;a<c;++a)e.modified("query",a)&&(s|=i[a].one,this.incrementAll(i[a],o[a],u,n.add),n.rem=n.add);return s},incrementAll:function(e,t,n,r){var a,i,o,u=this.value,c=u.seen(),s=u.curr(),l=u.prev(),f=e.index(),d=e.bisect(e.range),h=e.bisect(t),p=h[0],v=h[1],m=d[0],b=d[1],g=e.one;if(p<m)for(a=p,i=Math.min(m,v);a<i;++a)c[o=f[a]]!==n&&(l[o]=s[o],c[o]=n,r.push(o)),s[o]^=g;else if(p>m)for(a=m,i=Math.min(p,b);a<i;++a)c[o=f[a]]!==n&&(l[o]=s[o],c[o]=n,r.push(o)),s[o]^=g;if(v>b)for(a=Math.max(p,b),i=v;a<i;++a)c[o=f[a]]!==n&&(l[o]=s[o],c[o]=n,r.push(o)),s[o]^=g;else if(v<b)for(a=Math.max(m,v),i=b;a<i;++a)c[o=f[a]]!==n&&(l[o]=s[o],c[o]=n,r.push(o)),s[o]^=g;e.range=t.slice()},incrementOne:function(e,t,n,r){var a,i,o,u=this.value.curr(),c=e.index(),s=e.bisect(e.range),l=e.bisect(t),f=l[0],d=l[1],h=s[0],p=s[1],v=e.one;if(f<h)for(a=f,i=Math.min(h,d);a<i;++a)u[o=c[a]]^=v,n.push(o);else if(f>h)for(a=h,i=Math.min(f,p);a<i;++a)u[o=c[a]]^=v,r.push(o);if(d>p)for(a=Math.max(f,p),i=d;a<i;++a)u[o=c[a]]^=v,n.push(o);else if(d<p)for(a=Math.max(h,d),i=p;a<i;++a)u[o=c[a]]^=v,r.push(o);e.range=t.slice()}}),kC.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Object(ne.z)(kC,fo,{transform:function(e,t){var n=~(e.ignore||0),r=e.filter,a=r.mask;if(0===(a&n))return t.StopPropagation;var i=t.fork(t.ALL),o=r.data(),u=r.curr(),c=r.prev(),s=function(e){return u[e]&n?null:o[e]};return i.filter(i.MOD,s),a&a-1?(i.filter(i.ADD,(function(e){var t=u[e]&n;return!t&&t^c[e]&n?o[e]:null})),i.filter(i.REM,(function(e){var t=u[e]&n;return t&&!(t^t^c[e]&n)?o[e]:null}))):(i.filter(i.ADD,s),i.filter(i.REM,(function(e){return(u[e]&n)===a?o[e]:null}))),i.filter(i.SOURCE,(function(e){return s(e._index)}))}});var wC,jC,_C,SC,EC,CC="RawCode",AC="Literal",NC="Property",TC="Identifier",IC="ArrayExpression",DC="BinaryExpression",FC="CallExpression",MC="ConditionalExpression",RC="LogicalExpression",zC="MemberExpression",LC="ObjectExpression",PC="UnaryExpression";function BC(e){this.type=e}BC.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case IC:return e.elements;case DC:case RC:return[e.left,e.right];case FC:return[e.callee].concat(e.arguments);case MC:return[e.test,e.consequent,e.alternate];case zC:return[e.object,e.property];case LC:return e.properties;case NC:return[e.key,e.value];case PC:return[e.argument];case TC:case AC:case CC:default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(wC={})[1]="Boolean",wC[2]="<end>",wC[3]="Identifier",wC[4]="Keyword",wC[5]="Null",wC[6]="Numeric",wC[7]="Punctuator",wC[8]="String",wC[9]="RegularExpression";var WC="Identifier",UC="Unexpected token %0",VC="Invalid regular expression",qC="Invalid regular expression: missing /",HC="Octal literals are not allowed in strict mode.",GC="ILLEGAL",KC="Disabled.",XC=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),YC=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function $C(e,t){if(!e)throw new Error("ASSERT: "+t)}function JC(e){return e>=48&&e<=57}function QC(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function ZC(e){return"01234567".indexOf(e)>=0}function eA(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function tA(e){return 10===e||13===e||8232===e||8233===e}function nA(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&XC.test(String.fromCharCode(e))}function rA(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&YC.test(String.fromCharCode(e))}var aA={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function iA(){for(;_C<SC;){var e=jC.charCodeAt(_C);if(!eA(e)&&!tA(e))break;++_C}}function oA(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t)_C<SC&&QC(jC[_C])?(r=jC[_C++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):kA({},UC,GC);return String.fromCharCode(a)}function uA(){var e,t,n,r;for(t=0,"}"===(e=jC[_C])&&kA({},UC,GC);_C<SC&&QC(e=jC[_C++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&kA({},UC,GC),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function cA(){var e,t;for(e=jC.charCodeAt(_C++),t=String.fromCharCode(e),92===e&&(117!==jC.charCodeAt(_C)&&kA({},UC,GC),++_C,(e=oA("u"))&&"\\"!==e&&nA(e.charCodeAt(0))||kA({},UC,GC),t=e);_C<SC&&rA(e=jC.charCodeAt(_C));)++_C,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==jC.charCodeAt(_C)&&kA({},UC,GC),++_C,(e=oA("u"))&&"\\"!==e&&rA(e.charCodeAt(0))||kA({},UC,GC),t+=e);return t}function sA(){var e,t;return e=_C,{type:1===(t=92===jC.charCodeAt(_C)?cA():function(){var e,t;for(e=_C++;_C<SC;){if(92===(t=jC.charCodeAt(_C)))return _C=e,cA();if(!rA(t))break;++_C}return jC.slice(e,_C)}()).length?3:aA.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:_C}}function lA(){var e,t,n,r,a=_C,i=jC.charCodeAt(_C),o=jC[_C];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_C,{type:7,value:String.fromCharCode(i),start:a,end:_C};default:if(61===(e=jC.charCodeAt(_C+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _C+=2,{type:7,value:String.fromCharCode(i)+String.fromCharCode(e),start:a,end:_C};case 33:case 61:return _C+=2,61===jC.charCodeAt(_C)&&++_C,{type:7,value:jC.slice(a,_C),start:a,end:_C}}}return">>>="===(r=jC.substr(_C,4))?{type:7,value:r,start:a,end:_C+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:a,end:_C+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:7,value:t,start:a,end:_C+=2}:("//"===t&&kA({},UC,GC),"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:a,end:++_C}:void kA({},UC,GC))}function fA(){var e,t,n;if($C(JC((n=jC[_C]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=_C,e="","."!==n){if(e=jC[_C++],n=jC[_C],"0"===e){if("x"===n||"X"===n)return++_C,function(e){for(var t="";_C<SC&&QC(jC[_C]);)t+=jC[_C++];return 0===t.length&&kA({},UC,GC),nA(jC.charCodeAt(_C))&&kA({},UC,GC),{type:6,value:parseInt("0x"+t,16),start:e,end:_C}}(t);if(ZC(n))return function(e){for(var t="0"+jC[_C++];_C<SC&&ZC(jC[_C]);)t+=jC[_C++];return(nA(jC.charCodeAt(_C))||JC(jC.charCodeAt(_C)))&&kA({},UC,GC),{type:6,value:parseInt(t,8),octal:!0,start:e,end:_C}}(t);n&&JC(n.charCodeAt(0))&&kA({},UC,GC)}for(;JC(jC.charCodeAt(_C));)e+=jC[_C++];n=jC[_C]}if("."===n){for(e+=jC[_C++];JC(jC.charCodeAt(_C));)e+=jC[_C++];n=jC[_C]}if("e"===n||"E"===n)if(e+=jC[_C++],"+"!==(n=jC[_C])&&"-"!==n||(e+=jC[_C++]),JC(jC.charCodeAt(_C)))for(;JC(jC.charCodeAt(_C));)e+=jC[_C++];else kA({},UC,GC);return nA(jC.charCodeAt(_C))&&kA({},UC,GC),{type:6,value:parseFloat(e),start:t,end:_C}}function dA(){var e,t,n,r;return EC=null,iA(),e=_C,t=function(){var e,t,n,r;for($C("/"===(e=jC[_C]),"Regular expression literal must start with a slash"),t=jC[_C++],n=!1,r=!1;_C<SC;)if(t+=e=jC[_C++],"\\"===e)tA((e=jC[_C++]).charCodeAt(0))&&kA({},qC),t+=e;else if(tA(e.charCodeAt(0)))kA({},qC);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||kA({},qC),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";_C<SC&&rA((e=jC[_C]).charCodeAt(0));)++_C,"\\"===e&&_C<SC?kA({},UC,GC):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&kA({},VC,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";kA({},VC)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){kA({},VC)}try{return new RegExp(e,t)}catch(a){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:_C}}function hA(){if(iA(),_C>=SC)return{type:2,start:_C,end:_C};var e=jC.charCodeAt(_C);return nA(e)?sA():40===e||41===e||59===e?lA():39===e||34===e?function(){var e,t,n,r,a="",i=!1;for($C("'"===(e=jC[_C])||'"'===e,"String literal must starts with a quote"),t=_C,++_C;_C<SC;){if((n=jC[_C++])===e){e="";break}if("\\"===n)if((n=jC[_C++])&&tA(n.charCodeAt(0)))"\r"===n&&"\n"===jC[_C]&&++_C;else switch(n){case"u":case"x":"{"===jC[_C]?(++_C,a+=uA()):a+=oA(n);break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;default:ZC(n)?(0!==(r="01234567".indexOf(n))&&(i=!0),_C<SC&&ZC(jC[_C])&&(i=!0,r=8*r+"01234567".indexOf(jC[_C++]),"0123".indexOf(n)>=0&&_C<SC&&ZC(jC[_C])&&(r=8*r+"01234567".indexOf(jC[_C++]))),a+=String.fromCharCode(r)):a+=n}else{if(tA(n.charCodeAt(0)))break;a+=n}}return""!==e&&kA({},UC,GC),{type:8,value:a,octal:i,start:t,end:_C}}():46===e?JC(jC.charCodeAt(_C+1))?fA():lA():JC(e)?fA():lA()}function pA(){var e=EC;return _C=e.end,EC=hA(),_C=e.end,e}function vA(){var e=_C;EC=hA(),_C=e}function mA(e,t,n){var r=new BC("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function bA(e,t){var n=new BC("CallExpression");return n.callee=e,n.arguments=t,n}function gA(e){var t=new BC(WC);return t.name=e,t}function yA(e){var t=new BC("Literal");return t.value=e.value,t.raw=jC.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function xA(e,t,n){var r=new BC("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function OA(e,t,n){var r=new BC("Property");return r.key=t,r.value=n,r.kind=e,r}function kA(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return $C(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=_C,n.description=a,n}function wA(e){2===e.type&&kA(e,"Unexpected end of input"),6===e.type&&kA(e,"Unexpected number"),8===e.type&&kA(e,"Unexpected string"),3===e.type&&kA(e,"Unexpected identifier"),4===e.type&&kA(e,"Unexpected reserved word"),kA(e,UC,e.value)}function jA(e){var t=pA();7===t.type&&t.value===e||wA(t)}function _A(e){return 7===EC.type&&EC.value===e}function SA(e){return 4===EC.type&&EC.value===e}function EA(){var e=[];for(_C=EC.start,jA("[");!_A("]");)_A(",")?(pA(),e.push(null)):(e.push(PA()),_A("]")||jA(","));return pA(),function(e){var t=new BC("ArrayExpression");return t.elements=e,t}(e)}function CA(){_C=EC.start;var e=pA();return 8===e.type||6===e.type?(e.octal&&kA(e,HC),yA(e)):gA(e.value)}function AA(){var e,t,n;return _C=EC.start,3===(e=EC).type?(n=CA(),jA(":"),OA("init",n,PA())):2!==e.type&&7!==e.type?(t=CA(),jA(":"),OA("init",t,PA())):void wA(e)}function NA(){var e,t,n=[],r={},a=String;for(_C=EC.start,jA("{");!_A("}");)t="$"+((e=AA()).key.type===WC?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?kA({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),_A("}")||jA(",");return jA("}"),function(e){var t=new BC("ObjectExpression");return t.properties=e,t}(n)}var TA={if:1};function IA(){var e,t,n;if(_A("("))return function(){jA("(");var e=BA();return jA(")"),e}();if(_A("["))return EA();if(_A("{"))return NA();if(e=EC.type,_C=EC.start,3===e||TA[EC.value])n=gA(pA().value);else if(8===e||6===e)EC.octal&&kA(EC,HC),n=yA(pA());else{if(4===e)throw new Error(KC);1===e?((t=pA()).value="true"===t.value,n=yA(t)):5===e?((t=pA()).value=null,n=yA(t)):_A("/")||_A("/=")?(n=yA(dA()),vA()):wA(pA())}return n}function DA(){var e=[];if(jA("("),!_A(")"))for(;_C<SC&&(e.push(PA()),!_A(")"));)jA(",");return jA(")"),e}function FA(){return jA("."),function(){_C=EC.start;var e=pA();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||wA(e),gA(e.value)}()}function MA(){jA("[");var e=BA();return jA("]"),e}function RA(){var e=function(){var e;for(e=IA();;)if(_A("."))e=xA(".",e,FA());else if(_A("("))e=bA(e,DA());else{if(!_A("["))break;e=xA("[",e,MA())}return e}();if(7===EC.type&&(_A("++")||_A("--")))throw new Error(KC);return e}function zA(){var e,t;if(7!==EC.type&&4!==EC.type)t=RA();else{if(_A("++")||_A("--"))throw new Error(KC);if(_A("+")||_A("-")||_A("~")||_A("!"))e=pA(),t=zA(),t=function(e,t){var n=new BC("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(SA("delete")||SA("void")||SA("typeof"))throw new Error(KC);t=RA()}}return t}function LA(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function PA(){var e,t;return e=function(){var e,t,n,r,a,i,o,u,c,s;if(e=EC,c=zA(),0===(a=LA(r=EC)))return c;for(r.prec=a,pA(),t=[e,EC],i=[c,r,o=zA()];(a=LA(EC))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),u=i.pop().value,c=i.pop(),t.pop(),n=mA(u,c,o),i.push(n);(r=pA()).prec=a,i.push(r),t.push(EC),n=zA(),i.push(n)}for(n=i[s=i.length-1],t.pop();s>1;)t.pop(),n=mA(i[s-1].value,i[s-2],n),s-=2;return n}(),_A("?")&&(pA(),t=PA(),jA(":"),e=function(e,t,n){var r=new BC("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,PA())),e}function BA(){var e=PA();if(_A(","))throw new Error(KC);return e}function WA(e){_C=0,SC=(jC=e).length,EC=null,vA();var t=BA();if(2!==EC.type)throw new Error("Unexpect token after expression.");return t}var UA={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function VA(e){function t(t,n,r){return function(a){return function(t,n,r,a){var i=e(n[0]);return r&&(i=r+"("+i+")",0===r.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(a<0?"":0===a?"()":"("+n.slice(1).map(e).join(",")+")")}(t,a,n,r)}}var n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&Object(ne.o)("Missing arguments to clamp function."),t.length>3&&Object(ne.o)("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:a,test:t("test",a),if:function(t){t.length<3&&Object(ne.o)("Missing arguments to if function."),t.length>3&&Object(ne.o)("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function qA(e){var t=(e=e||{}).allowed?Object(ne.fb)(e.allowed):{},n=e.forbidden?Object(ne.fb)(e.forbidden):{},r=e.constants||UA,a=(e.functions||VA)(f),i=e.globalvar,o=e.fieldvar,u=Object(ne.E)(i)?i:function(e){return"".concat(i,'["').concat(e,'"]')},c={},s={},l=0;function f(e){if(Object(ne.J)(e))return e;var t=d[e.type];return null==t&&Object(ne.o)("Unsupported type: "+e.type),t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var a=e.name;return l>0?a:Object(ne.w)(n,a)?Object(ne.o)("Illegal identifier: "+a):Object(ne.w)(r,a)?r[a]:Object(ne.w)(t,a)?a:(c[a]=1,u(a))},MemberExpression:function(e){var t=!e.computed,n=f(e.object);t&&(l+=1);var r=f(e.property);return n===o&&(s[function(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(l-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&Object(ne.o)("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=Object(ne.w)(a,t)&&a[t];return r||Object(ne.o)("Unrecognized function: "+t),Object(ne.E)(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(f).join(",")+"]"},BinaryExpression:function(e){return"("+f(e.left)+" "+e.operator+" "+f(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+f(e.argument)+")"},ConditionalExpression:function(e){return"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")"},LogicalExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(f).join(",")+"}"},Property:function(e){l+=1;var t=f(e.key);return l-=1,t+":"+f(e.value)}};function h(e){var t={code:f(e),globals:Object.keys(c),fields:Object.keys(s)};return c={},s={},t}return h.functions=a,h.constants=r,h}var HA,GA,KA,XA,YA,$A=new uO,JA=new uO,QA={point:TO,lineStart:TO,lineEnd:TO,polygonStart:function(){$A=new uO,QA.lineStart=ZA,QA.lineEnd=eN},polygonEnd:function(){var e=+$A;JA.add(e<0?hO+e:e),this.lineStart=this.lineEnd=this.point=TO},sphere:function(){JA.add(hO)}};function ZA(){QA.point=tN}function eN(){nN(HA,GA)}function tN(e,t){QA.point=nN,HA=e,GA=t,KA=e*=vO,XA=yO(t=(t*=vO)/2+dO),YA=_O(t)}function nN(e,t){var n=(e*=vO)-KA,r=n>=0?1:-1,a=r*n,i=yO(t=(t*=vO)/2+dO),o=_O(t),u=YA*o,c=XA*i+u*yO(a),s=u*r*_O(a);$A.add(gO(s,c)),KA=e,XA=i,YA=o}var rN,aN,iN,oN,uN,cN,sN,lN,fN,dN,hN,pN={point:vN,lineStart:bN,lineEnd:gN,polygonStart:function(){pN.point=yN,pN.lineStart=xN,pN.lineEnd=ON,fN=new uO,QA.polygonStart()},polygonEnd:function(){QA.polygonEnd(),pN.point=vN,pN.lineStart=bN,pN.lineEnd=gN,$A<0?(rN=-(iN=180),aN=-(oN=90)):fN>cO?oN=90:fN<-1e-6&&(aN=-90),hN[0]=rN,hN[1]=iN},sphere:function(){rN=-(iN=180),aN=-(oN=90)}};function vN(e,t){dN.push(hN=[rN=e,iN=e]),t<aN&&(aN=t),t>oN&&(oN=t)}function mN(e,t){var n=Pk([e*vO,t*vO]);if(lN){var r=Wk(lN,n),a=Wk([r[1],-r[0],0],r);qk(a),a=Lk(a);var i,o=e-uN,u=o>0?1:-1,c=a[0]*pO*u,s=mO(o)>180;s^(u*uN<c&&c<u*e)?(i=a[1]*pO)>oN&&(oN=i):s^(u*uN<(c=(c+360)%360-180)&&c<u*e)?(i=-a[1]*pO)<aN&&(aN=i):(t<aN&&(aN=t),t>oN&&(oN=t)),s?e<uN?kN(rN,e)>kN(rN,iN)&&(iN=e):kN(e,iN)>kN(rN,iN)&&(rN=e):iN>=rN?(e<rN&&(rN=e),e>iN&&(iN=e)):e>uN?kN(rN,e)>kN(rN,iN)&&(iN=e):kN(e,iN)>kN(rN,iN)&&(rN=e)}else dN.push(hN=[rN=e,iN=e]);t<aN&&(aN=t),t>oN&&(oN=t),lN=n,uN=e}function bN(){pN.point=mN}function gN(){hN[0]=rN,hN[1]=iN,pN.point=vN,lN=null}function yN(e,t){if(lN){var n=e-uN;fN.add(mO(n)>180?n+(n>0?360:-360):n)}else cN=e,sN=t;QA.point(e,t),mN(e,t)}function xN(){QA.lineStart()}function ON(){yN(cN,sN),QA.lineEnd(),mO(fN)>cO&&(rN=-(iN=180)),hN[0]=rN,hN[1]=iN,lN=null}function kN(e,t){return(t-=e)<0?t+360:t}function wN(e,t){return e[0]-t[0]}function jN(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var _N,SN,EN,CN,AN,NN,TN,IN,DN,FN,MN,RN,zN,LN,PN,BN,WN={sphere:TO,point:UN,lineStart:qN,lineEnd:KN,polygonStart:function(){WN.lineStart=XN,WN.lineEnd=YN},polygonEnd:function(){WN.lineStart=qN,WN.lineEnd=KN}};function UN(e,t){e*=vO;var n=yO(t*=vO);VN(n*yO(e),n*_O(e),_O(t))}function VN(e,t,n){++_N,EN+=(e-EN)/_N,CN+=(t-CN)/_N,AN+=(n-AN)/_N}function qN(){WN.point=HN}function HN(e,t){e*=vO;var n=yO(t*=vO);LN=n*yO(e),PN=n*_O(e),BN=_O(t),WN.point=GN,VN(LN,PN,BN)}function GN(e,t){e*=vO;var n=yO(t*=vO),r=n*yO(e),a=n*_O(e),i=_O(t),o=gO(EO((o=PN*i-BN*a)*o+(o=BN*r-LN*i)*o+(o=LN*a-PN*r)*o),LN*r+PN*a+BN*i);SN+=o,NN+=o*(LN+(LN=r)),TN+=o*(PN+(PN=a)),IN+=o*(BN+(BN=i)),VN(LN,PN,BN)}function KN(){WN.point=UN}function XN(){WN.point=$N}function YN(){JN(RN,zN),WN.point=UN}function $N(e,t){RN=e,zN=t,e*=vO,t*=vO,WN.point=JN;var n=yO(t);LN=n*yO(e),PN=n*_O(e),BN=_O(t),VN(LN,PN,BN)}function JN(e,t){e*=vO;var n=yO(t*=vO),r=n*yO(e),a=n*_O(e),i=_O(t),o=PN*i-BN*a,u=BN*r-LN*i,c=LN*a-PN*r,s=kO(o,u,c),l=NO(s),f=s&&-l/s;DN.add(f*o),FN.add(f*u),MN.add(f*c),SN+=l,NN+=l*(LN+(LN=r)),TN+=l*(PN+(PN=a)),IN+=l*(BN+(BN=i)),VN(LN,PN,BN)}var QN="intersect",ZN="union",eT="index:unit";function tT(e,t){for(var n,r,a=t.fields,i=t.values,o=a.length,u=0;u<o;++u)if((r=a[u]).getter=ne.u.getter||Object(ne.u)(r.field),n=r.getter(e),Object(ne.D)(n)&&(n=Object(ne.eb)(n)),Object(ne.D)(i[u])&&(i[u]=Object(ne.eb)(i[u])),Object(ne.D)(i[u][0])&&(i[u]=i[u].map(ne.eb)),"E"===r.type){if(Object(ne.B)(i[u])?i[u].indexOf(n)<0:n!==i[u])return!1}else if("R"===r.type){if(!Object(ne.A)(n,i[u]))return!1}else if("R-RE"===r.type){if(!Object(ne.A)(n,i[u],!0,!1))return!1}else if("R-E"===r.type){if(!Object(ne.A)(n,i[u],!1,!1))return!1}else if("R-LE"===r.type&&!Object(ne.A)(n,i[u],!1,!0))return!1;return!0}var nT=Object(ne.u)("_vgsid_"),rT=function(e){var t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return(r=e(t))<(a=n)?-1:r>a?1:r>=a?0:NaN;var r,a}}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);var o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}}(nT),aT=rT.left,iT=rT.right;var oT={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter((function(e){return t.indexOf(e)>=0})):t},R_union:function(e,t){var n=Object(ne.eb)(t[0]),r=Object(ne.eb)(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Object(ne.eb)(t[0]),r=Object(ne.eb)(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};function uT(e,t,n,r){t[0].type!==AC&&Object(ne.o)("First argument to selection functions must be a string literal.");var a=t[0].value,i="unit",o="@unit",u=":"+a;(t.length>=2&&Object(ne.W)(t).value)!==QN||Object(ne.w)(r,o)||(r["@unit"]=n.getData(a).indataRef(n,i)),Object(ne.w)(r,u)||(r[u]=n.getData(a).tuplesRef())}function cT(e){var t=this.context.data[e];return t?t.values.value:[]}var sT=function(e){return function(t,n){return this.context.dataflow.locale()[e](n)(t)}},lT=sT("format"),fT=sT("timeFormat"),dT=sT("utcFormat"),hT=sT("timeParse"),pT=sT("utcParse"),vT=new Date(2e3,0,1);function mT(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(vT.setYear(2e3),vT.setMonth(e),vT.setDate(t),fT.call(this,vT,n)):""}function bT(e,t,n,r){t[0].type!==AC&&Object(ne.o)("First argument to data functions must be a string literal.");var a=t[0].value,i=":"+a;if(!Object(ne.w)(i,r))try{r[i]=n.getData(a).tuplesRef()}catch(o){}}function gT(e,t,n,r){if(t[0].type===AC)yT(n,r,t[0].value);else for(e in n.scales)yT(n,r,e)}function yT(e,t,n){var r="%"+n;if(!Object(ne.w)(t,r))try{t[r]=e.scaleRef(n)}catch(a){}}function xT(e,t){var n;return Object(ne.E)(e)?e:Object(ne.J)(e)?(n=t.scales[e])&&n.value:void 0}function OT(e,t,n){t.__bandwidth=function(e){return e&&e.bandwidth?e.bandwidth():0},n._bandwidth=gT,n._range=gT,n._scale=gT;var r=function(t){return"_["+(t.type===AC?Object(ne.bb)("%"+t.value):Object(ne.bb)("%")+"+"+e(t))+"]"};return{_bandwidth:function(e){return"this.__bandwidth(".concat(r(e[0]),")")},_range:function(e){return"".concat(r(e[0]),".range()")},_scale:function(t){return"".concat(r(t[0]),"(").concat(e(t[1]),")")}}}function kT(e,t){return function(n,r,a){if(n){var i=xT(n,(a||this).context);return i&&i.path[e](r)}return t(r)}}var wT=kT("area",(function(e){return JA=new uO,aO(e,QA),2*JA})),jT=kT("bounds",(function(e){var t,n,r,a,i,o,u;if(oN=iN=-(rN=aN=1/0),dN=[],aO(e,pN),n=dN.length){for(dN.sort(wN),t=1,i=[r=dN[0]];t<n;++t)jN(r,(a=dN[t])[0])||jN(r,a[1])?(kN(r[0],a[1])>kN(r[0],r[1])&&(r[1]=a[1]),kN(a[0],r[1])>kN(r[0],r[1])&&(r[0]=a[0])):i.push(r=a);for(o=-1/0,t=0,r=i[n=i.length-1];t<=n;r=a,++t)a=i[t],(u=kN(r[1],a[0]))>o&&(o=u,rN=a[0],iN=r[1])}return dN=hN=null,rN===1/0||aN===1/0?[[NaN,NaN],[NaN,NaN]]:[[rN,aN],[iN,oN]]})),_T=kT("centroid",(function(e){_N=SN=EN=CN=AN=NN=TN=IN=0,DN=new uO,FN=new uO,MN=new uO,aO(e,WN);var t=+DN,n=+FN,r=+MN,a=kO(t,n,r);return a<sO&&(t=NN,n=TN,r=IN,SN<cO&&(t=EN,n=CN,r=AN),(a=kO(t,n,r))<sO)?[NaN,NaN]:[gO(n,t)*pO,NO(r/a)*pO]}));function ST(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function ET(e){var t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function CT(e){var t=Kl(e);return.2126*ET(t.r)+.7152*ET(t.g)+.0722*ET(t.b)}function AT(e,t){return e===t||e!==e&&t!==t||(Object(ne.B)(e)?!(!Object(ne.B)(t)||e.length!==t.length)&&function(e,t){for(var n=0,r=e.length;n<r;++n)if(!AT(e[n],t[n]))return!1;return!0}(e,t):!(!Object(ne.H)(e)||!Object(ne.H)(t))&&NT(e,t))}function NT(e,t){for(var n in e)if(!AT(e[n],t[n]))return!1;return!0}function TT(e){return function(t){return NT(e,t)}}var IT={};function DT(e){return Object(ne.B)(e)||ArrayBuffer.isView(e)?e:null}function FT(e){return DT(e)||(Object(ne.J)(e)?e:null)}var MT=function(e){return e.data};function RT(e,t){var n=cT.call(t,e);return n.root&&n.root.lookup||{}}var zT=function(){return"undefined"!==typeof window&&window||null};var LT={random:function(){return Mo()},cumulativeNormal:Go,cumulativeLogNormal:Qo,cumulativeUniform:au,densityNormal:Ho,densityLogNormal:Jo,densityUniform:ru,quantileNormal:Ko,quantileLogNormal:Zo,quantileUniform:iu,sampleNormal:qo,sampleLogNormal:$o,sampleUniform:nu,isArray:ne.B,isBoolean:ne.C,isDate:ne.D,isDefined:function(e){return void 0!==e},isNumber:ne.G,isObject:ne.H,isRegExp:ne.I,isString:ne.J,isTuple:Si,isValid:function(e){return null!=e&&e===e},toBoolean:ne.cb,toDate:ne.db,toNumber:ne.eb,toString:ne.gb,indexof:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=FT(e)).indexOf.apply(t,r)},join:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=DT(e)).join.apply(t,r)},lastindexof:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=FT(e)).lastIndexOf.apply(t,r)},replace:function(e,t,n){return Object(ne.E)(n)&&Object(ne.o)("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return DT(e).slice().reverse()},slice:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=FT(e)).slice.apply(t,r)},flush:ne.v,lerp:ne.L,merge:function(){var e=[].slice.call(arguments);return e.unshift({}),ne.p.apply(void 0,Object(Jc.a)(e))},pad:ne.R,peek:ne.W,pluck:function(e,t){var n=IT[t]||(IT[t]=Object(ne.u)(t));return Object(ne.B)(e)?e.map(n):n(e)},span:ne.Z,inrange:ne.A,truncate:ne.hb,rgb:Kl,lab:Wd,hcl:Xd,hsl:ef,luminance:CT,contrast:function(e,t){var n=CT(e),r=CT(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:ju,format:lT,utcFormat:dT,utcParse:pT,utcOffset:dr,utcSequence:vr,timeFormat:fT,timeParse:hT,timeOffset:fr,timeSequence:pr,timeUnitSpecifier:zn,monthFormat:function(e){return mT.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return mT.call(this,e,1,"%b")},dayFormat:function(e){return mT.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return mT.call(this,0,2+e,"%a")},quarter:ne.X,utcquarter:ne.jb,week:Wn,utcweek:Kn,dayofyear:Bn,utcdayofyear:Gn,warn:function(){return ST(this.context.dataflow,"warn",arguments)},info:function(){return ST(this.context.dataflow,"info",arguments)},debug:function(){return ST(this.context.dataflow,"debug",arguments)},extent:ne.q,inScope:function(e){var t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:function(e,t,n){if(!e)return[];var r=Object(bo.a)(e,2),a=r[0],i=r[1],o=(new Nv).set(a[0],a[1],i[0],i[1]);return ny(n||this.context.dataflow.scenegraph().root,o,function(e){var t=null;if(e){var n=Object(ne.i)(e.marktype),r=Object(ne.i)(e.markname);t=function(e){return(!n.length||n.some((function(t){return e.marktype===t})))&&(!r.length||r.some((function(t){return e.name===t})))}}return t}(t))},clampRange:ne.k,pinchDistance:function(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){var e=zT();return e?e.screen:{}},containerSize:function(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){var e=zT();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return gh(e||0,t||0,n||0)},setdata:function(e,t){var n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(ne.ib).insert(t)),1},pathShape:function(e){var t=null;return function(n){return n?Zp(n,t=t||Up(e)):e}},panLinear:ne.S,panLog:ne.T,panPow:ne.U,panSymlog:ne.V,zoomLinear:ne.nb,zoomLog:ne.ob,zoomPow:ne.pb,zoomSymlog:ne.qb,encode:function(e,t,n){if(e){var r=this.context.dataflow,a=e.mark.source;r.pulse(a,r.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,a,i){var o,u,c=this.context.dataflow,s=this.context.data[e],l=s.input,f=c.stamp(),d=s.changes;if(!1===c._trigger||!(l.value.length||t||r))return 0;if((!d||d.stamp<f)&&(s.changes=d=c.changeset(),d.stamp=f,c.runAfter((function(){s.modified=!0,c.pulse(l,d).run()}),!0,1)),n&&(o=!0===n?ne.ib:Object(ne.B)(n)||Si(n)?n:TT(n),d.remove(o)),t&&d.insert(t),r&&(o=TT(r),l.value.some(o)?d.remove(o):d.insert(r)),a)for(u in i)d.modify(a,u,i[u]);return 1}},PT=["view","item","group","xy","x","y"],BT="this.",WT={},UT={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_[".concat(Object(ne.bb)("$"+e),"]")},functions:function(e){var t=VA(e);for(var n in PT.forEach((function(e){return t[e]="event.vega."+e})),LT)t[n]=BT+n;return Object(ne.p)(t,OT(e,LT,WT)),t},constants:UA,visitors:WT},VT=qA(UT);function qT(e,t,n){return 1===arguments.length?LT[e]:(LT[e]=t,n&&(WT[e]=n),VT&&(VT.functions[e]=BT+e),this)}function HT(e,t){var n,r={};try{n=WA(e=Object(ne.J)(e)?e:Object(ne.bb)(e)+"")}catch(i){Object(ne.o)("Expression parse error: "+e)}n.visit((function(e){if(e.type===FC){var n=e.callee.name,a=UT.visitors[n];a&&a(n,e.arguments,t,r)}}));var a=VT(n);return a.globals.forEach((function(e){var n="$"+e;!Object(ne.w)(r,n)&&t.getSignal(e)&&(r[n]=t.signalRef(e))})),{$expr:Object(ne.p)({code:a.code},t.options.ast?{ast:n}:null),$fields:a.fields,$params:r}}qT("bandwidth",(function(e,t){var n=xT(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),gT),qT("copy",(function(e,t){var n=xT(e,(t||this).context);return n?n.copy():void 0}),gT),qT("domain",(function(e,t){var n=xT(e,(t||this).context);return n?n.domain():[]}),gT),qT("range",(function(e,t){var n=xT(e,(t||this).context);return n&&n.range?n.range():[]}),gT),qT("invert",(function(e,t,n){var r=xT(e,(n||this).context);return r?Object(ne.B)(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),gT),qT("scale",(function(e,t,n){var r=xT(e,(n||this).context);return r?r(t):void 0}),gT),qT("gradient",(function(e,t,n,r,a){e=xT(e,(a||this).context);var i=zp(t,n),o=e.domain(),u=o[0],c=Object(ne.W)(o),s=ne.y;return c-u?s=op(e,u,c):e=(e.interpolator?Kh("sequential")().interpolator(e.interpolator()):Kh("linear")().interpolate(e.interpolate()).range(e.range())).domain([u=0,c=1]),e.ticks&&(u!==(o=e.ticks(+r||15))[0]&&o.unshift(u),c!==Object(ne.W)(o)&&o.push(c)),o.forEach((function(t){return i.stop(s(t),e(t))})),i}),gT),qT("geoArea",wT,gT),qT("geoBounds",jT,gT),qT("geoCentroid",_T,gT),qT("geoShape",(function(e,t,n){var r=xT(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),gT),qT("indata",(function(e,t,n){var r=this.context.data[e]["index:"+t],a=r?r.value.get(n):void 0;return a?a.count:a}),(function(e,t,n,r){t[0].type!==AC&&Object(ne.o)("First argument to indata must be a string literal."),t[1].type!==AC&&Object(ne.o)("Second argument to indata must be a string literal.");var a=t[0].value,i=t[1].value,o="@"+i;Object(ne.w)(o,r)||(r[o]=n.getData(a).indataRef(n,i))})),qT("data",cT,bT),qT("treePath",(function(e,t,n){var r=RT(e,this),a=r[t],i=r[n];return a&&i?a.path(i).map(MT):void 0}),bT),qT("treeAncestors",(function(e,t){var n=RT(e,this)[t];return n?n.ancestors().map(MT):void 0}),bT),qT("vlSelectionTest",(function(e,t,n){for(var r,a,i,o,u,c=this.context.data[e],s=c?c.values.value:[],l=c?c[eT]&&c[eT].value:void 0,f=n===QN,d=s.length,h=0;h<d;++h)if(r=s[h],l&&f){if(-1===(i=(a=a||{})[o=r.unit]||0))continue;if(u=tT(t,r),a[o]=u?-1:++i,u&&1===l.size)return!0;if(!u&&i===l.get(o).count)return!1}else if(f^(u=tT(t,r)))return u;return d&&f}),uT),qT("vlSelectionIdTest",(function(e,t,n){var r=this.context.data[e],a=r?r.values.value:[],i=r?r[eT]&&r[eT].value:void 0,o=n===QN,u=nT(t),c=aT(a,u);if(c===a.length)return!1;if(nT(a[c])!==u)return!1;if(i&&o){if(1===i.size)return!0;if(iT(a,u)-c<i.size)return!1}return!0}),uT),qT("vlSelectionResolve",(function(e,t,n,r){for(var a,i,o,u,c,s,l,f,d,h,p,v=this.context.data[e],m=v?v.values.value:[],b={},g={},y={},x=m.length,O=0;O<x;++O){for(u=(a=m[O]).unit,i=a.fields,o=a.values,h=0,p=i.length;h<p;++h)c=i[h],l=(s=b[c.field]||(b[c.field]={}))[u]||(s[u]=[]),y[c.field]=f=c.type.charAt(0),d=oT[f+"_union"],s[u]=d(l,Object(ne.i)(o[h]));n&&(l=g[u]||(g[u]=[])).push(Object(ne.i)(o).reduce((function(e,t,n){return e[i[n].field]=t,e}),{}))}return t=t||ZN,Object.keys(b).forEach((function(e){b[e]=Object.keys(b[e]).map((function(t){return b[e][t]})).reduce((function(n,r){return void 0===n?r:oT[y[e]+"_"+t](n,r)}))})),m=Object.keys(g),n&&m.length&&(b[r?"vlPoint":"vlMulti"]=t===ZN?Object(vt.a)({},"or",m.reduce((function(e,t){return e.push.apply(e,Object(Jc.a)(g[t])),e}),[])):Object(vt.a)({},"and",m.map((function(e){return Object(vt.a)({},"or",g[e])})))),b}),uT),qT("vlSelectionTuples",(function(e,t){return e.map((function(e){return Object(ne.p)({values:t.fields.map((function(t){return(t.getter||(t.getter=Object(ne.u)(t.field)))(e.datum)}))},t)}))}));var GT=Object(ne.fb)(["rule"]),KT=Object(ne.fb)(["group","image","rect"]);function XT(e){return(e+"").toLowerCase()}function YT(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");var r=Function.apply(void 0,Object(Jc.a)(t.concat(n)));return e&&e.functions?r.bind(e.functions):r}var $T={operator:function(e,t){return YT(e,["_"],t.code)},parameter:function(e,t){return YT(e,["datum","_"],t.code)},event:function(e,t){return YT(e,["event"],t.code)},handler:function(e,t){return YT(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";"))},encode:function(e,t){var n=t.marktype,r=t.channels,a="var o=item,datum=o.datum,m=0,$;";for(var i in r){var o="o["+Object(ne.bb)(i)+"]";a+="$=".concat(r[i].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return a+=function(e,t){var n="";return GT[t]||(e.x2&&(e.x?(KT[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(KT[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),YT(e,["item","_"],a+="return m;")},codegen:{get:function(e){var t="[".concat(e.map(ne.bb).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator:function(e,t){var n,r=Function("a","b","var u, v; return "+e.map((function(e,r){var a,i,o=t[r];return e.path?(a="a".concat(e.path),i="b".concat(e.path)):((n=n||{})["f"+r]=e,a="this.f".concat(r,"(a)"),i="this.f".concat(r,"(b)")),function(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(a,i,-o,o)})).join("")+"0;");return n?r.bind(n):r}}};function JT(e,t,n){if(!e||!Object(ne.H)(e))return e;for(var r,a=0,i=QT.length;a<i;++a)if(r=QT[a],Object(ne.w)(e,r.key))return r.parse(e,t,n);return e}var QT=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||Object(ne.o)("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Object(ne.K)(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);var r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=Object(ne.f)(t.parameterExpression(e.$expr),e.$fields,e.$name))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Object(ne.u)(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){var n=e.$encode,r={};for(var a in n){var i=n[a];r[a]=Object(ne.f)(t.encodeExpression(i.$expr),i.$fields),r[a].output=i.$output}return r}},{key:"$compare",parse:function(e,t){var n="c:"+e.$compare+"_"+e.$order,r=Object(ne.i)(e.$compare).map((function(e){return e&&e.$tupleid?Ei:e}));return t.fn[n]||(t.fn[n]=Object(ne.l)(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){var n=e.$subflow;return function(e,r,a){var i=t.fork().parse(n),o=i.get(n.operators[0].id),u=i.signals.parent;return u&&u.set(a),o.detachSubflow=function(){return t.detach(i)},o}}},{key:"$tupleid",parse:function(){return Ei}}];var ZT={skip:!0};function eI(e,t,n,r){return new tI(e,t,n,r)}function tI(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||$T,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function nI(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}tI.prototype=nI.prototype={fork:function(){var e=new nI(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach:function(e){this.subcontext=this.subcontext.filter((function(t){return t!==e}));for(var t=Object.keys(e.nodes),n=0,r=t;n<r.length;n++){var a=r[n];e.nodes[a]._targets=null}for(var i=0,o=t;i<o.length;i++){var u=o[i];e.nodes[u].detach()}e.nodes=null},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,r=n.dataflow,a=e.value;if(n.set(e.id,t),"collect"===XT(e.type)&&a&&(a.$ingest?r.ingest(t,a.$ingest,a.$format):a.$request?r.preload(t,a.$request,a.$format):r.pulse(t,r.changeset().insert(a))),e.root&&(n.root=t),e.parent){var i=n.get(e.parent.$ref);i?(r.connect(i,[t]),t.targets().add(i)):(n.unresolved=n.unresolved||[]).push((function(){i=n.get(e.parent.$ref),r.connect(i,[t]),t.targets().add(i)}))}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data){var o=function(r){var a=n.data[r]||(n.data[r]={});e.data[r].forEach((function(e){return a[e]=t}))};for(var u in e.data)o(u)}},resolve:function(){return(this.unresolved||[]).forEach((function(e){return e()})),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[XT(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,a){this.dataflow.on(t,n,r,a,e.options)},operatorExpression:function(e){return this.expr.operator(this,e)},parameterExpression:function(e){return this.expr.parameter(this,e)},eventExpression:function(e){return this.expr.event(this,e)},handlerExpression:function(e){return this.expr.handler(this,e)},encodeExpression:function(e){return this.expr.encode(this,e)},parse:function(e){var t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach((function(e){return t.parseOperator(e)})),n.forEach((function(e){return t.parseOperatorParameters(e)})),(e.streams||[]).forEach((function(e){return t.parseStream(e)})),(e.updates||[]).forEach((function(e){return t.parseUpdate(e)})),t.resolve()},parseOperator:function(e){var t=this;"operator"!==XT(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){var t=this;if(e.params){var n=t.get(e.id);n||Object(ne.o)("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};var n=this;for(var r in e){var a=e[r];t[r]=Object(ne.B)(a)?a.map((function(e){return JT(e,n,t)})):JT(a,n,t)}return t},parseStream:function(e){var t,n=this,r=null!=e.filter?n.eventExpression(e.filter):void 0,a=null!=e.stream?n.get(e.stream):void 0;e.source?a=n.events(e.source,e.type,r):e.merge&&(a=(t=e.merge.map((function(e){return n.get(e)})))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map((function(e){return n.get(e)})),a=a.between(t[0],t[1])),e.filter&&(a=a.filter(r)),null!=e.throttle&&(a=a.throttle(+e.throttle)),null!=e.debounce&&(a=a.debounce(+e.debounce)),null==a&&Object(ne.o)("Invalid stream definition: "+JSON.stringify(e)),e.consume&&a.consume(!0),n.stream(e,a)},parseUpdate:function(e){var t,n=this,r=Object(ne.H)(r=e.source)?r.$ref:r,a=n.get(r),i=e.update,o=void 0;a||Object(ne.o)("Source not defined: "+e.source),t=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),i&&i.$expr&&(i.$params&&(o=n.parseParameters(i.$params)),i=n.handlerExpression(i.$expr)),n.update(e,a,t,i,o)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((function(n){var a=t.signals[n];e.signals(n,a)&&(r[n]=a.value)}))}if(e.data){var a=n.data={};Object.keys(t.data).forEach((function(n){var r=t.data[n];e.data(n,r)&&(a[n]=r.input.value)}))}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map((function(t){return t.getState(e)}))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,a=e.signals;Object.keys(a||{}).forEach((function(e){n.update(t.signals[e],a[e],ZT)})),Object.keys(r||{}).forEach((function(e){n.pulse(t.data[e].input,n.changeset().remove(ne.ib).insert(r[e]))})),(e.subcontext||[]).forEach((function(e,n){var r=t.subcontext[n];r&&r.setState(e)}))}};function rI(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}var aI="default";function iI(e,t){var n=e.globalCursor()?"undefined"!==typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function oI(e,t){var n=e._runtime.data;return Object(ne.w)(n,t)||Object(ne.o)("Unrecognized data set: "+t),n[t]}function uI(e,t){Fi(t)||Object(ne.o)("Second argument to changes must be a changeset.");var n=oI(this,e);return n.modified=!0,this.pulse(n.input,t)}function cI(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function sI(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function lI(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function fI(e){var t=lI(e),n=cI(e),r=sI(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach((function(t){try{t(n,r)}catch(a){e.error(a)}}))}function dI(e,t,n){var r,a,i=e._renderer,o=i&&i.canvas();return o&&(a=lI(e),(r=Pb(t.changedTouches?t.changedTouches[0]:t,o))[0]-=a[0],r[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){var r=t?"group"===t.mark.marktype?t:t.mark.group:null;function a(e){var n,a=r;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){a=n;break}return a&&a.mark&&a.mark.interactive?a:{}}function i(e){if(!e)return n;Object(ne.J)(e)&&(e=a(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:Object(ne.m)(e),item:Object(ne.m)(t||{}),group:a,xy:i,x:function(e){return i(e)[0]},y:function(e){return i(e)[1]}}}(e,n,r),t}var hI="view",pI={trap:!1};function vI(e,t,n,r){e._eventListeners.push({type:n,sources:Object(ne.i)(t),handler:r})}function mI(e,t,n){var r=e._eventConfig&&e._eventConfig[t];return!(!1===r||Object(ne.H)(r)&&!r[n])||(e.warn("Blocked ".concat(t," ").concat(n," event listener.")),!1)}function bI(e){return e.item}function gI(e){return e.item.mark.source}function yI(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function xI(e,t,n){var r=document.createElement(e);for(var a in t)r.setAttribute(a,t[a]);return null!=n&&(r.textContent=n),r}function OI(e,t,n,r){var a=n.event||"input",i=function(){return e.update(t.value)};r.signal(n.signal,t.value),t.addEventListener(a,i),vI(r,t,a,i),e.set=function(e){t.value=e,t.dispatchEvent(function(e){return"undefined"!==typeof Event?new Event(e):{type:e}}(a))}}function kI(e,t,n,r){var a=r.signal(n.signal),i=xI("div",{class:"vega-bind"}),o="radio"===n.input?i:i.appendChild(xI("label"));o.appendChild(xI("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(i);var u=wI;switch(n.input){case"checkbox":u=jI;break;case"select":u=_I;break;case"radio":u=SI;break;case"range":u=EI}u(e,o,n,a)}function wI(e,t,n,r){var a=xI("input");for(var i in n)"signal"!==i&&"element"!==i&&a.setAttribute("input"===i?"type":i,n[i]);a.setAttribute("name",n.signal),a.value=r,t.appendChild(a),a.addEventListener("input",(function(){return e.update(a.value)})),e.elements=[a],e.set=function(e){return a.value=e}}function jI(e,t,n,r){var a={type:"checkbox",name:n.signal};r&&(a.checked=!0);var i=xI("input",a);t.appendChild(i),i.addEventListener("change",(function(){return e.update(i.checked)})),e.elements=[i],e.set=function(e){return i.checked=!!e||null}}function _I(e,t,n,r){var a=xI("select",{name:n.signal}),i=n.labels||[];n.options.forEach((function(e,t){var n={value:e};CI(e,r)&&(n.selected=!0),a.appendChild(xI("option",n,(i[t]||e)+""))})),t.appendChild(a),a.addEventListener("change",(function(){e.update(n.options[a.selectedIndex])})),e.elements=[a],e.set=function(e){for(var t=0,r=n.options.length;t<r;++t)if(CI(n.options[t],e))return void(a.selectedIndex=t)}}function SI(e,t,n,r){var a=xI("span",{class:"vega-bind-radio"}),i=n.labels||[];t.appendChild(a),e.elements=n.options.map((function(t,o){var u={type:"radio",name:n.signal,value:t};CI(t,r)&&(u.checked=!0);var c=xI("input",u);c.addEventListener("change",(function(){return e.update(t)}));var s=xI("label",{},(i[o]||t)+"");return s.prepend(c),a.appendChild(s),c})),e.set=function(t){for(var n=e.elements,r=n.length,a=0;a<r;++a)CI(n[a].value,t)&&(n[a].checked=!0)}}function EI(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;var a=null!=n.max?n.max:Math.max(100,+r)||100,i=n.min||Math.min(0,a,+r)||0,o=n.step||Ze(i,a,100),u=xI("input",{type:"range",name:n.signal,min:i,max:a,step:o});u.value=r;var c=xI("span",{},+r);t.appendChild(u),t.appendChild(c);var s=function(){c.textContent=u.value,e.update(+u.value)};u.addEventListener("input",s),u.addEventListener("change",s),e.elements=[u],e.set=function(e){u.value=e,c.textContent=e}}function CI(e,t){return e===t||e+""===t+""}function AI(e,t,n,r,a,i){return(t=t||new r(e.loader())).initialize(n,cI(e),sI(e),lI(e),a,i).background(e.background())}function NI(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function TI(e,t,n){if("string"===typeof t){if("undefined"===typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}var II=function(e){return+e||0};function DI(e){return Object(ne.H)(e)?{top:II(e.top),bottom:II(e.bottom),left:II(e.left),right:II(e.right)}:function(e){return{top:e,bottom:e,left:e,right:e}}(II(e))}function FI(e,t,n,r){return MI.apply(this,arguments)}function MI(){return(MI=Object(re.a)(k.a.mark((function e(t,n,r,a){var i,o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ty(n),(o=i&&i.headless)||Object(ne.o)("Unrecognized renderer type: "+n),e.next=4,t.runAsync();case 4:return e.abrupt("return",AI(t,null,null,o,r,a).renderAsync(t._scenegraph.root));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function RI(){return(RI=Object(re.a)(k.a.mark((function e(t,n){var r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t!==Zg.Canvas&&t!==Zg.SVG&&t!==Zg.PNG&&Object(ne.o)("Unrecognized image type: "+t),e.next=3,FI(this,t,n);case 3:return r=e.sent,e.abrupt("return",t===Zg.SVG?zI(r.svg(),"image/svg+xml"):r.canvas().toDataURL("image/png"));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function zI(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function LI(){return(LI=Object(re.a)(k.a.mark((function e(t,n){var r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FI(this,Zg.Canvas,t,n);case 2:return r=e.sent,e.abrupt("return",r.canvas());case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function PI(){return(PI=Object(re.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FI(this,Zg.SVG,t);case 2:return n=e.sent,e.abrupt("return",n.svg());case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var BI="width",WI="height",UI="padding",VI={skip:!0};function qI(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===UI?r.left+r.right:0)}function HI(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===UI?r.top+r.bottom:0)}function GI(e,t){return t.modified&&Object(ne.B)(t.input.value)&&e.indexOf("_:vega:_")}function KI(e,t){return!("parent"===e||t instanceof ho.proxy)}function XI(e,t,n,r){var a=e.element();a&&a.setAttribute("title",function(e){return null==e?"":Object(ne.B)(e)?YI(e):Object(ne.H)(e)&&!Object(ne.D)(e)?(t=e,Object.keys(t).map((function(e){var n=t[e];return e+": "+(Object(ne.B)(n)?YI(n):$I(n))})).join("\n")):e+"";var t}(r))}function YI(e){return"["+e.map($I).join(", ")+"]"}function $I(e){return Object(ne.B)(e)?"[\u2026]":Object(ne.H)(e)&&!Object(ne.D)(e)?"{\u2026}":e}function JI(e,t){var n=this;if(t=t||{},so.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){var r=Object(ne.p)({},e.locale,t.locale);n.locale(mi(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Zg.Canvas,n._scenegraph=new Ib;var a=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||XI,n._redraw=!0,n._handler=(new ig).scene(a),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){var t=Object(ne.p)({defaults:{}},e),n=function(e,t){t.forEach((function(t){Object(ne.B)(e[t])&&(e[t]=Object(ne.fb)(e[t]))}))};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);var i=function(e,t,n){return eI(e,ho,LT,n).parse(t)}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map((function(e){return{state:null,param:Object(ne.p)({},e)}})),i.root&&i.root.set(a),a.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(a.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=qI(n,n._width),n._viewHeight=HI(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t.width,r=t.height,a=t.padding;function i(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size,e._viewWidth=qI(e,t.size),i()}),{size:n}),e._resizeHeight=e.add(null,(function(t){e._height=t.size,e._viewHeight=HI(e,t.size),i()}),{size:r});var o=e.add(null,i,{pad:a});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=a.rank+1}(n),function(e){e.add(null,(function(t){return e._background=t.bg,e._resize=1,t.bg}),{bg:e._signals.background})}(n),function(e){var t=e._signals.cursor||(e._signals.cursor=e.add({user:aI,item:null}));e.on(e.events("view","mousemove"),t,(function(e,n){var r=t.value,a=r?Object(ne.J)(r)?r:r.user:aI,i=n.item&&n.item.cursor||null;return r&&a===r.user&&i==r.item?r:{user:a,item:i}})),e.add(null,(function(t){var n=t.cursor,r=this.value;return Object(ne.J)(n)||(r=n.item,n=n.user),iI(e,n&&n!==aI?n:r||n),r}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function QI(e,t){return Object(ne.w)(e._signals,t)?e._signals[t]:Object(ne.o)("Unrecognized signal name: "+Object(ne.bb)(t))}function ZI(e,t){var n=(e._targets||[]).filter((function(e){return e._update&&e._update.handler===t}));return n.length?n[0]:null}function eD(e,t,n,r){var a=ZI(n,r);return a||((a=NI(e,(function(){return r(t,n.value)}))).handler=r,e.on(n,null,a)),e}function tD(e,t,n){var r=ZI(t,n);return r&&t._targets.remove(r),e}Object(ne.z)(JI,so,{evaluate:function(e,t,n){var r=this;return Object(re.a)(k.a.mark((function a(){return k.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,so.prototype.evaluate.call(r,e,t);case 2:if(!r._redraw&&!r._resize){a.next=14;break}if(a.prev=3,!r._renderer){a.next=8;break}return r._resize&&(r._resize=0,fI(r)),a.next=8,r._renderer.renderAsync(r._scenegraph.root);case 8:r._redraw=!1,a.next=14;break;case 11:a.prev=11,a.t0=a.catch(3),r.error(a.t0);case 14:return n&&ki(r,n),a.abrupt("return",r);case 16:case"end":return a.stop()}}),a,null,[[3,11]])})))()},dirty:function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description:function(e){if(arguments.length){var t=null!=e?e+"":null;return t!==this._desc&&rI(this._el,this._desc=t),this}return this._desc},container:function(){return this._el},scenegraph:function(){return this._scenegraph},origin:function(){return this._origin.slice()},signal:function(e,t,n){var r=QI(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width:function(e){return arguments.length?this.signal("width",e):this.signal("width")},height:function(e){return arguments.length?this.signal("height",e):this.signal("height")},padding:function(e){return arguments.length?this.signal("padding",DI(e)):DI(this.signal("padding"))},autosize:function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background:function(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer:function(e){return arguments.length?(ty(e)||Object(ne.o)("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip:function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader:function(e){return arguments.length?(e!==this._loader&&(so.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize:function(){return this._autosize=1,this.touch(QI(this,"autosize"))},_resetRenderer:function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,a,i){this.runAfter((function(o){var u=0;o._autosize=0,o.width()!==n&&(u=1,o.signal(BI,n,VI),o._resizeWidth.skip(!0)),o.height()!==r&&(u=1,o.signal(WI,r,VI),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),o._origin[0]===a[0]&&o._origin[1]===a[1]||(o._resize=1,o._origin=a),u&&o.run("enter"),i&&o.runAfter((function(e){return e.resize()}))}),!1,1)},addEventListener:function(e,t,n){var r=t;return n&&!1===n.trap||((r=NI(this,t)).raw=t),this._handler.on(e,r),this},removeEventListener:function(e,t){for(var n,r,a=this._handler.handlers(e),i=a.length;--i>=0;)if(r=a[i].type,n=a[i].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},addResizeListener:function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener:function(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener:function(e,t){return eD(this,e,QI(this,e),t)},removeSignalListener:function(e,t){return tD(this,QI(this,e),t)},addDataListener:function(e,t){return eD(this,e,oI(this,e).values,t)},removeDataListener:function(e,t){return tD(this,oI(this,e).values,t)},globalCursor:function(e){if(arguments.length){if(this._globalCursor!==!!e){var t=iI(this,null);this._globalCursor=!!e,t&&iI(this,t)}return this}return this._globalCursor},preventDefault:function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var r=new O_,a=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?y_():+n,r._restart((function i(o){o+=a,r._restart(i,a+=t,n),e(o)}),t,n)},r.restart(e,t,n),r)}((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var r,a=this,i=new Vi(n),o=function(n,r){a.runAsync(null,(function(){e===hI&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,a=n.allow;return!1!==r&&!0!==a&&(!0===r||!1===a||(r?r[t]:a?!a[t]:e.preventDefault()))}(a,t)&&n.preventDefault(),i.receive(dI(a,n,r))}))};if("timer"===e)mI(a,"timer",t)&&a.timer(o,t);else if(e===hI)mI(a,"view",t)&&a.addEventListener(t,o,pI);else if("window"===e?mI(a,"window",t)&&"undefined"!==typeof window&&(r=[window]):"undefined"!==typeof document&&mI(a,"selector",t)&&(r=document.querySelectorAll(e)),r){for(var u=0,c=r.length;u<c;++u)r[u].addEventListener(t,o);vI(a,r,t,o)}else a.warn("Can not resolve event source: "+e);return i},finalize:function(){var e,t,n,r=this._tooltip,a=this._timers,i=this._eventListeners;for(e=a.length;--e>=0;)a[e].stop();for(e=i.length;--e>=0;)for(t=(n=i[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",bI),gI,yI(e)),this.on(this.events("view","mouseout",bI),gI,yI(t)),this},data:function(e,t){return arguments.length<2?oI(this,e).values.value:uI.call(this,e,Mi().remove(ne.ib).insert(t))},change:uI,insert:function(e,t){return uI.call(this,e,Mi().insert(t))},remove:function(e,t){return uI.call(this,e,Mi().remove(t))},scale:function(e){var t=this._runtime.scales;return Object(ne.w)(t,e)||Object(ne.o)("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){var n=this,r=n._renderType,a=n._eventConfig.bind,i=ty(r);e=n._el=e?TI(n,e,!0):null,function(e){var t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),rI(t,e.description()))}(n),i||n.error("Unrecognized renderer type: "+r);var o=i.handler||ig,u=e?i.renderer:i.headless;return n._renderer=u?AI(n,n._renderer,e,u):null,n._handler=function(e,t,n,r){var a=new r(e.loader(),NI(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,lI(e),e);return t&&t.handlers().forEach((function(e){a.on(e.type,e.handler)})),a}(n,n._handler,e,o),n._redraw=!0,e&&"none"!==a&&(t=t?n._elBind=TI(n,t,!0):e.appendChild(xI("form",{class:"vega-bindings"})),n._bind.forEach((function(e){e.param.element&&"container"!==a&&(e.element=TI(n,e.param.element,!!e.param.input))})),n._bind.forEach((function(e){!function(e,t,n){if(t){var r=n.param,a=n.state;a||(a=n.state={elements:null,active:!1,set:null,update:function(t){t!=e.signal(r.signal)&&e.runAsync(null,(function(){a.source=!0,e.signal(r.signal,t)}))}},r.debounce&&(a.update=Object(ne.n)(r.debounce,a.update))),(null==r.input&&r.element?OI:kI)(a,t,r,e),a.active||(e.on(e._signals[r.signal],null,(function(){a.source?a.source=!1:a.set(e.signal(r.signal))})),a.active=!0)}}(n,e.element||t,e)}))),n},toImageURL:function(e,t){return RI.apply(this,arguments)},toCanvas:function(e,t){return LI.apply(this,arguments)},toSVG:function(e){return PI.apply(this,arguments)},getState:function(e){return this._runtime.getState(e||{data:GI,signals:KI,recurse:!0})},setState:function(e){return this.runAsync(null,(function(t){t._trigger=!1,t._runtime.setState(e)}),(function(e){e._trigger=!0})),this}});var nD,rD,aD="[",iD="]",oD=/[[\]{}]/,uD={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function cD(e,t,n){return nD=t||"view",rD=n||uD,lD(e.trim()).map(fD)}function sD(e,t,n,r,a){for(var i,o=e.length,u=0;t<o;++t){if(i=e[t],!u&&i===n)return t;a&&a.indexOf(i)>=0?--u:r&&r.indexOf(i)>=0&&++u}return t}function lD(e){for(var t=[],n=e.length,r=0,a=0;a<n;)a=sD(e,a,",","[{","]}"),t.push(e.substring(r,a).trim()),r=++a;if(0===t.length)throw"Empty event selector: "+e;return t}function fD(e){return"["===e[0]?function(e){var t,n=e.length,r=1;if((r=sD(e,r,iD,aD,iD))===n)throw"Empty between selector: "+e;if(2!==(t=lD(e.substring(1,r))).length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+e;t=t.map(fD);var a=fD(e.slice(1).trim());if(a.between)return{between:t,stream:a};a.between=t;return a}(e):function(e){var t,n,r={source:nD},a=[],i=[0,0],o=0,u=0,c=e.length,s=0;if("}"===e[c-1]){if(!((s=e.lastIndexOf("{"))>=0))throw"Unmatched right brace: "+e;try{i=function(e){var t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}(e.substring(s+1,c-1))}catch(f){throw"Invalid throttle specification: "+e}c=(e=e.slice(0,s).trim()).length,s=0}if(!c)throw e;"@"===e[0]&&(o=++s);(t=sD(e,s,":"))<c&&(a.push(e.substring(u,t).trim()),u=s=++t);if((s=sD(e,s,aD))===c)a.push(e.substring(u,c).trim());else if(a.push(e.substring(u,s).trim()),n=[],(u=++s)===c)throw"Unmatched left bracket: "+e;for(;s<c;){if((s=sD(e,s,iD))===c)throw"Unmatched left bracket: "+e;if(n.push(e.substring(u,s).trim()),s<c-1&&e[++s]!==aD)throw"Expected left bracket: "+e;u=++s}if(!(c=a.length)||oD.test(a[c-1]))throw"Invalid event selector: "+e;c>1?(r.type=a[1],o?r.markname=a[0].slice(1):(l=a[0],rD[l]?r.marktype=a[0]:r.source=a[0])):r.type=a[0];var l;"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1));null!=n&&(r.filter=n);i[0]&&(r.throttle=i[0]);i[1]&&(r.debounce=i[1]);return r}(e)}function dD(e){return Object(ne.H)(e)?e:{type:e||"pad"}}var hD=function(e){return+e||0};function pD(e){return Object(ne.H)(e)?e.signal?e:{top:hD(e.top),bottom:hD(e.bottom),left:hD(e.left),right:hD(e.right)}:{top:t=hD(e),bottom:t,left:t,right:t};var t}var vD=function(e){return Object(ne.H)(e)&&!Object(ne.B)(e)?Object(ne.p)({},e):{value:e}};function mD(e,t,n,r){return null!=n?(Object(ne.H)(n)&&!Object(ne.B)(n)||Object(ne.B)(n)&&n.length&&Object(ne.H)(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function bD(e,t,n){for(var r in t)mD(e,r,t[r]);for(var a in n)mD(e,a,n[a],"update")}function gD(e,t,n){for(var r in t)n&&Object(ne.w)(n,r)||(e[r]=Object(ne.p)(e[r]||{},t[r]));return e}function yD(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var xD="mark",OD="frame",kD="scope",wD="legend-label",jD="title-text",_D="title-subtitle";function SD(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}var ED=function(e){return Object(ne.J)(e)?Object(ne.bb)(e):e.signal?"(".concat(e.signal,")"):TD(e)};function CD(e){if(null!=e.gradient)return function(e){var t=[e.start,e.stop,e.count].map((function(e){return null==e?null:Object(ne.bb)(e)}));for(;t.length&&null==Object(ne.W)(t);)t.pop();return t.unshift(ED(e.gradient)),"gradient(".concat(t.join(","),")")}(e);var t=e.signal?"(".concat(e.signal,")"):e.color?function(e){return e.c?AD("hcl",e.h,e.c,e.l):e.h||e.s?AD("hsl",e.h,e.s,e.l):e.l||e.a?AD("lab",e.l,e.a,e.b):e.r||e.g||e.b?AD("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?TD(e.field):void 0!==e.value?Object(ne.bb)(e.value):void 0;return null!=e.scale&&(t=function(e,t){var n=ED(e.scale);null!=e.range?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(void 0!==t&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(1===+e.band?"":"*"+ND(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),null==t&&(t="0"));return t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t="pow(".concat(t,",").concat(ND(e.exponent),")")),null!=e.mult&&(t+="*".concat(ND(e.mult))),null!=e.offset&&(t+="+".concat(ND(e.offset))),e.round&&(t="round(".concat(t,")")),t}var AD=function(e,t,n,r){return"(".concat(e,"(").concat([t,n,r].map(CD).join(","),")+'')")};function ND(e){return Object(ne.H)(e)?"("+CD(e)+")":e}function TD(e){return ID(Object(ne.H)(e)?e:{datum:e})}function ID(e){var t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Object(ne.o)("Invalid field reference: "+Object(ne.bb)(e));return e.signal||(r=Object(ne.J)(r)?Object(ne.ab)(r).map(ne.bb).join("]["):ID(r)),t+"["+r+"]"}function DD(e,t,n,r,a,i){var o={};for(var u in(i=i||{}).encoders={$encode:o},e=function(e,t,n,r,a){var i,o,u,c={},s={};for(o in o="lineBreak","text"!==t||null==a[o]||yD(o,e)||SD(c,o,a[o]),("legend"==n||String(n).startsWith("axis"))&&(n=null),u=n===OD?a.group:n===xD?Object(ne.p)({},a.mark,a[t]):null)yD(o,e)||("fill"===o||"stroke"===o)&&(yD("fill",e)||yD("stroke",e))||SD(c,o,u[o]);for(o in Object(ne.i)(r).forEach((function(t){var n=a.style&&a.style[t];for(var r in n)yD(r,e)||SD(c,r,n[r])})),e=Object(ne.p)({},e),c)(u=c[o]).signal?(i=i||{})[o]=u:s[o]=u;return e.enter=Object(ne.p)(s,e.enter),i&&(e.update=Object(ne.p)(i,e.update)),e}(e,t,n,r,a.config))o[u]=FD(e[u],t,i,a);return i}function FD(e,t,n,r){var a,i={},o={};for(var u in e)null!=e[u]&&(i[u]=MD((a=e[u],Object(ne.B)(a)?function(e){var t="";return e.forEach((function(e){var n=CD(e);t+=e.test?"(".concat(e.test,")?").concat(n,":"):n})),":"===Object(ne.W)(t)&&(t+="null"),t}(a):CD(a)),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function MD(e,t,n,r){var a=HT(e,t);return a.$fields.forEach((function(e){return r[e]=1})),Object(ne.p)(n,a.$params),a.$expr}var RD=["value","update","init","react","bind"];function zD(e,t){Object(ne.o)(e+' for "outer" push: '+Object(ne.bb)(t))}function LD(e,t){var n=e.name;if("outer"===e.push)t.signals[n]||zD("No prior signal definition",n),RD.forEach((function(t){void 0!==e[t]&&zD("Invalid property ",t)}));else{var r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function PD(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function BD(e,t,n,r){return new PD(e,t,n,r)}function WD(e,t){return BD("operator",e,t)}function UD(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function VD(e,t){return t?{$field:e,$name:t}:{$field:e}}var qD=VD("key");function HD(e,t){return{$compare:e,$order:t}}function GD(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var KD="scope",XD="view";function YD(e){return e&&e.signal}function $D(e){if(YD(e))return!0;if(Object(ne.H)(e))for(var t in e)if($D(e[t]))return!0;return!1}function JD(e,t){return null!=e?e:t}function QD(e){return e&&e.signal||e}var ZD="timer";function eF(e,t){return(e.merge?tF:e.stream?nF:e.type?rF:Object(ne.o)("Invalid stream specification: "+Object(ne.bb)(e)))(e,t)}function tF(e,t){var n=aF({merge:e.merge.map((function(e){return eF(e,t)}))},e,t);return t.addStream(n).id}function nF(e,t){var n=aF({stream:eF(e.stream,t)},e,t);return t.addStream(n).id}function rF(e,t){var n,r;e.type===ZD?(n=t.event(ZD,e.throttle),e={between:e.between,filter:e.filter}):n=t.event((r=e.source)===KD?XD:r||XD,e.type);var a=aF({stream:n},e,t);return 1===Object.keys(a).length?n:t.addStream(a).id}function aF(e,t,n){var r=t.between;return r&&(2!==r.length&&Object(ne.o)('Stream "between" parameter must have 2 entries: '+Object(ne.bb)(t)),e.between=[eF(r[0],n),eF(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(function(e,t,n){var r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===KD&&r.push("inScope(event.item)"),r.length&&(e.filter=HT("("+r.join(")&&(")+")",n).$expr),null!=(r=t.throttle)&&(e.throttle=+r),null!=(r=t.debounce)&&(e.debounce=+r),t.consume&&(e.consume=!0),e}var iF={code:"_.$value",ast:{type:"Identifier",value:"value"}};function oF(e,t,n){var r=e.encode,a={target:n},i=e.events,o=e.update,u=[];i||Object(ne.o)("Signal update missing events specification."),Object(ne.J)(i)&&(i=cD(i,t.isSubscope()?KD:XD)),i=Object(ne.i)(i).filter((function(e){return e.signal||e.scale?(u.push(e),0):1})),u.length>1&&(u=[uF(u)]),i.length&&u.push(i.length>1?{merge:i}:i[0]),null!=r&&(o&&Object(ne.o)("Signal encode and update are mutually exclusive."),o="encode(item(),"+Object(ne.bb)(r)+")"),a.update=Object(ne.J)(o)?HT(o,t):null!=o.expr?HT(o.expr,t):null!=o.value?o.value:null!=o.signal?{$expr:iF,$params:{$value:t.signalRef(o.signal)}}:Object(ne.o)("Invalid signal update specification."),e.force&&(a.options={force:!0}),u.forEach((function(e){return t.addUpdate(Object(ne.p)(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):eF(e,t)}}(e,t),a))}))}function uF(e){return{signal:"["+e.map((function(e){return e.scale?'scale("'+e.scale+'")':e.signal}))+"]"}}var cF=function(e){return function(t,n,r){return BD(e,n,t||void 0,r)}},sF=cF("aggregate"),lF=cF("axisticks"),fF=cF("bound"),dF=cF("collect"),hF=cF("compare"),pF=cF("datajoin"),vF=cF("encode"),mF=cF("expression"),bF=cF("facet"),gF=cF("field"),yF=cF("key"),xF=cF("legendentries"),OF=cF("load"),kF=cF("mark"),wF=cF("multiextent"),jF=cF("multivalues"),_F=cF("overlap"),SF=cF("params"),EF=cF("prefacet"),CF=cF("projection"),AF=cF("proxy"),NF=cF("relay"),TF=cF("render"),IF=cF("scale"),DF=cF("sieve"),FF=cF("sortitems"),MF=cF("viewlayout"),RF=cF("values"),zF=0,LF={min:"min",max:"max",count:"sum"};function PF(e,t){var n,r,a=t.getScale(e.name).params;for(n in a.domain=VF(e.domain,e,t),null!=e.range&&(a.range=JF(e,t,a)),null!=e.interpolate&&function(e,t){t.interpolate=BF(e.type||e),null!=e.gamma&&(t.interpolateGamma=BF(e.gamma))}(e.interpolate,a),null!=e.nice&&(a.nice=(r=e.nice,Object(ne.H)(r)?{interval:BF(r.interval),step:BF(r.step)}:BF(r))),null!=e.bins&&(a.bins=function(e,t){return e.signal||Object(ne.B)(e)?WF(e,t):t.objectProperty(e)}(e.bins,t)),e)Object(ne.w)(a,n)||"name"===n||(a[n]=BF(e[n],t))}function BF(e,t){return Object(ne.H)(e)?e.signal?t.signalRef(e.signal):Object(ne.o)("Unsupported object: "+Object(ne.bb)(e)):e}function WF(e,t){return e.signal?t.signalRef(e.signal):e.map((function(e){return BF(e,t)}))}function UF(e){Object(ne.o)("Can not find data set: "+Object(ne.bb)(e))}function VF(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(Object(ne.B)(e)?qF:e.fields?GF:HF)(e,t,n);null==t.domainMin&&null==t.domainMax||Object(ne.o)("No scale domain defined for domainMin/domainMax to override.")}function qF(e,t,n){return e.map((function(e){return BF(e,n)}))}function HF(e,t,n){var r=n.getData(e.data);return r||UF(e.data),Jh(t.type)?r.valuesRef(n,e.field,XF(e.sort,!1)):tp(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function GF(e,t,n){var r=e.data,a=e.fields.reduce((function(e,t){return t=Object(ne.J)(t)?{data:r,field:t}:Object(ne.B)(t)||t.signal?function(e,t){var n="_:vega:_"+zF++,r=dF({});if(Object(ne.B)(e))r.value={$ingest:e};else if(e.signal){var a="setdata("+Object(ne.bb)(n)+","+e.signal+")";r.params.input=t.signalRef(a)}return t.addDataPipeline(n,[r,DF({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e}),[]);return(Jh(t.type)?KF:tp(t.type)?YF:$F)(e,n,a)}function KF(e,t,n){var r,a,i=XF(e.sort,!0),o=n.map((function(e){var n=t.getData(e.data);return n||UF(e.data),n.countsRef(t,e.field,i)})),u={groupby:qD,pulse:o};i&&(r=i.op||"count",a=i.field?GD(r,i.field):"count",u.ops=[LF[r]],u.fields=[t.fieldRef(a)],u.as=[a]),r=t.add(sF(u));var c=t.add(dF({pulse:UD(r)}));return a=t.add(RF({field:qD,sort:t.sortRef(i),pulse:UD(c)})),UD(a)}function XF(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!LF[e.op]&&Object(ne.o)("Multiple domain scales can not be sorted using "+e.op):Object(ne.o)("No field provided for sort aggregate op: "+e.op):Object(ne.H)(e)?e.field="key":e={field:"key"}),e}function YF(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);return n||UF(e.data),n.domainRef(t,e.field)}));return UD(t.add(jF({values:r})))}function $F(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);return n||UF(e.data),n.extentRef(t,e.field)}));return UD(t.add(wF({extents:r})))}function JF(e,t,n){var r=t.config.range,a=e.range;if(a.signal)return t.signalRef(a.signal);if(Object(ne.J)(a)){if(r&&Object(ne.w)(r,a))return JF(e=Object(ne.p)({},e,{range:r[a]}),t,n);"width"===a?a=[0,{signal:"width"}]:"height"===a?a=Jh(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Object(ne.o)("Unrecognized scale range value: "+Object(ne.bb)(a))}else{if(a.scheme)return n.scheme=Object(ne.B)(a.scheme)?WF(a.scheme,t):BF(a.scheme,t),a.extent&&(n.schemeExtent=WF(a.extent,t)),void(a.count&&(n.schemeCount=BF(a.count,t)));if(a.step)return void(n.rangeStep=BF(a.step,t));if(Jh(e.type)&&!Object(ne.B)(a))return VF(a,e,t);Object(ne.B)(a)||Object(ne.o)("Unsupported range type: "+Object(ne.bb)(a))}return a.map((function(e){return(Object(ne.B)(e)?WF:BF)(e,t)}))}function QF(e,t,n){return Object(ne.B)(e)?e.map((function(e){return QF(e,t,n)})):Object(ne.H)(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:Object(ne.o)("Unsupported parameter object: "+Object(ne.bb)(e)):e}var ZF="top",eM="left",tM="right",nM="bottom",rM="center",aM="index",iM="label",oM="perc",uM="value",cM="guide-label",sM="guide-title",lM="group-title",fM="group-subtitle",dM="symbol",hM="gradient",pM="discrete",vM="size",mM=[vM,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],bM={name:1,style:1,interactive:1},gM={value:0},yM={value:1},xM="group",OM="rect",kM="rule",wM="text";function jM(e){return e.type=xM,e.interactive=e.interactive||!1,e}function _M(e,t){var n=function(n,r){return JD(e[n],JD(t[n],r))};return n.isVertical=function(n){return"vertical"===JD(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection))},n.gradientLength=function(){return JD(e.gradientLength,t.gradientLength||t.gradientWidth)},n.gradientThickness=function(){return JD(e.gradientThickness,t.gradientThickness||t.gradientHeight)},n.entryColumns=function(){return JD(e.columns,JD(t.columns,+n.isVertical(!0)))},n}function SM(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function EM(e,t,n){return"item.anchor === '".concat("start","' ? ").concat(e," : item.anchor === '").concat("end","' ? ").concat(t," : ").concat(n)}var CM=EM(Object(ne.bb)(eM),Object(ne.bb)(tM),Object(ne.bb)(rM));function AM(e,t){return t?e?Object(ne.H)(e)?Object.assign({},e,{offset:AM(e.offset,t)}):{value:e,offset:t}:t:e}function NM(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=gD(e.encode,t,bM)):e.interactive=!1,e}function TM(e,t,n,r){var a,i,o,u,c,s=_M(e,n),l=s.isVertical(),f=s.gradientThickness(),d=s.gradientLength();l?(i=[0,1],o=[0,0],u=f,c=d):(i=[0,0],o=[1,0],u=d,c=f);var h={enter:a={opacity:gM,x:gM,y:gM,width:vD(u),height:vD(c)},update:Object(ne.p)({},a,{opacity:yM,fill:{gradient:t,start:i,stop:o}}),exit:{opacity:gM}};return bD(h,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),NM({type:OM,role:"legend-gradient",encode:h},r)}function IM(e,t,n,r,a){var i,o,u,c,s=_M(e,n),l=s.isVertical(),f=s.gradientThickness(),d=s.gradientLength(),h="";l?(i="y",u="y2",o="x",c="width",h="1-"):(i="x",u="x2",o="y",c="height");var p={opacity:gM,fill:{scale:t,field:uM}};p[i]={signal:h+"datum."+oM,mult:d},p[o]=gM,p[u]={signal:h+"datum.perc2",mult:d},p[c]=vD(f);var v={enter:p,update:Object(ne.p)({},p,{opacity:yM}),exit:{opacity:gM}};return bD(v,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),NM({type:OM,role:"legend-band",key:uM,from:a,encode:v},r)}var DM="datum.".concat(oM,'<=0?"').concat(eM,'":datum.').concat(oM,'>=1?"').concat(tM,'":"').concat(rM,'"'),FM="datum.".concat(oM,'<=0?"').concat(nM,'":datum.').concat(oM,'>=1?"').concat(ZF,'":"').concat("middle",'"');function MM(e,t,n,r){var a,i,o,u,c=_M(e,t),s=c.isVertical(),l=vD(c.gradientThickness()),f=c.gradientLength(),d=c("labelOverlap"),h="",p={enter:a={opacity:gM},update:i={opacity:yM,text:{field:iM}},exit:{opacity:gM}};return bD(p,{fill:c("labelColor"),fillOpacity:c("labelOpacity"),font:c("labelFont"),fontSize:c("labelFontSize"),fontStyle:c("labelFontStyle"),fontWeight:c("labelFontWeight"),limit:JD(e.labelLimit,t.gradientLabelLimit)}),s?(a.align={value:"left"},a.baseline=i.baseline={signal:FM},o="y",u="x",h="1-"):(a.align=i.align={signal:DM},a.baseline={value:"top"},o="x",u="y"),a[o]=i[o]={signal:h+"datum."+oM,mult:f},a[u]=i[u]=l,l.offset=JD(e.labelOffset,t.gradientLabelOffset)||0,d=d?{separation:c("labelSeparation"),method:d,order:"datum.index"}:void 0,NM({type:wM,role:wD,style:cM,key:uM,from:r,encode:p,overlap:d},n)}function RM(e,t,n,r,a){var i,o,u,c,s,l=_M(e,t),f=n.entries,d=!(!f||!f.interactive),h=f?f.name:void 0,p=l("clipHeight"),v=l("symbolOffset"),m={data:"value"},b="(".concat(a,") ? datum.").concat("offset"," : datum.").concat(vM),g=p?vD(p):{field:vM},y="datum.".concat(aM),x="max(1, ".concat(a,")");g.mult=.5,i={enter:o={opacity:gM,x:{signal:b,mult:.5,offset:v},y:g},update:u={opacity:yM,x:o.x,y:o.y},exit:{opacity:gM}};var O=null,k=null;e.fill||(O=t.symbolBaseFillColor,k=t.symbolBaseStrokeColor),bD(i,{fill:l("symbolFillColor",O),shape:l("symbolType"),size:l("symbolSize"),stroke:l("symbolStrokeColor",k),strokeDash:l("symbolDash"),strokeDashOffset:l("symbolDashOffset"),strokeWidth:l("symbolStrokeWidth")},{opacity:l("symbolOpacity")}),mM.forEach((function(t){e[t]&&(u[t]=o[t]={scale:e[t],field:uM})}));var w=NM({type:"symbol",role:"legend-symbol",key:uM,from:m,clip:!!p||void 0,encode:i},n.symbols),j=vD(v);j.offset=l("labelOffset"),bD(i={enter:o={opacity:gM,x:{signal:b,offset:j},y:g},update:u={opacity:yM,text:{field:iM},x:o.x,y:o.y},exit:{opacity:gM}},{align:l("labelAlign"),baseline:l("labelBaseline"),fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontStyle:l("labelFontStyle"),fontWeight:l("labelFontWeight"),limit:l("labelLimit")});var _=NM({type:wM,role:wD,style:cM,key:uM,from:m,encode:i},n.labels);return i={enter:{noBound:{value:!p},width:gM,height:p?vD(p):gM,opacity:gM},exit:{opacity:gM},update:u={opacity:yM,row:{signal:null},column:{signal:null}}},l.isVertical(!0)?(c="ceil(item.mark.items.length / ".concat(x,")"),u.row.signal="".concat(y,"%").concat(c),u.column.signal="floor(".concat(y," / ").concat(c,")"),s={field:["row",y]}):(u.row.signal="floor(".concat(y," / ").concat(x,")"),u.column.signal="".concat(y," % ").concat(x),s={field:y}),u.column.signal="(".concat(a,")?").concat(u.column.signal,":").concat(y),jM({role:kD,from:r={facet:{data:r,name:"value",groupby:aM}},encode:gD(i,f,bM),marks:[w,_],name:h,interactive:d,sort:s})}var zM='item.orient === "left"',LM='item.orient === "right"',PM="(".concat(zM," || ").concat(LM,")"),BM="datum.vgrad && ".concat(PM),WM=EM('"top"','"bottom"','"middle"'),UM=EM('"right"','"left"','"center"'),VM="datum.vgrad && ".concat(LM," ? (").concat(UM,") : (").concat(PM," && !(datum.vgrad && ").concat(zM,')) ? "left" : ').concat(CM),qM="item._anchor || (".concat(PM,' ? "middle" : "start")'),HM="".concat(BM," ? (").concat(zM," ? -90 : 90) : 0"),GM="".concat(PM," ? (datum.vgrad ? (").concat(LM,' ? "bottom" : "top") : ').concat(WM,') : "top"');function KM(e,t){var n;return Object(ne.H)(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+XM(e.path)+")":e.sphere&&(n="geoShape("+XM(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function XM(e){return Object(ne.H)(e)&&e.signal?e.signal:Object(ne.bb)(e)}function YM(e){var t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===xM?kD:t||xD:t}function $M(e){return{marktype:e.type,name:e.name||void 0,role:e.role||YM(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function JM(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function QM(e,t){var n=po(e.type);n||Object(ne.o)("Unrecognized transform type: "+Object(ne.bb)(e.type));var r=BD(n.type.toLowerCase(),null,ZM(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function ZM(e,t,n){for(var r={},a=e.params.length,i=0;i<a;++i){var o=e.params[i];r[o.name]=eR(o,t,n)}return r}function eR(e,t,n){var r=e.type,a=t[e.name];return"index"===r?function(e,t,n){Object(ne.J)(t.from)||Object(ne.o)('Lookup "from" parameter must be a string literal.');return n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==a?"param"===r?function(e,t,n){var r=t[e.name];return e.array?(Object(ne.B)(r)||Object(ne.o)("Expected an array of sub-parameters. Instead: "+Object(ne.bb)(r)),r.map((function(t){return nR(e,t,n)}))):nR(e,r,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!YD(a)?a.map((function(t){return tR(e,t,n)})):tR(e,a,n):void(e.required&&Object(ne.o)("Missing required "+Object(ne.bb)(t.type)+" parameter: "+Object(ne.bb)(e.name)))}function tR(e,t,n){var r=e.type;if(YD(t))return oR(r)?Object(ne.o)("Expression references can not be signals."):uR(r)?n.fieldRef(t):cR(r)?n.compareRef(t):n.signalRef(t.signal);var a=e.expr||uR(r);return a&&rR(t)?n.exprRef(t.expr,t.as):a&&aR(t)?VD(t.field,t.as):oR(r)?HT(t,n):iR(r)?UD(n.getData(t).values):uR(r)?VD(t):cR(r)?n.compareRef(t):t}function nR(e,t,n){for(var r,a=e.params.length,i=0;i<a;++i){for(var o in(r=e.params[i]).key)if(r.key[o]!==t[o]){r=null;break}if(r)break}r||Object(ne.o)("Unsupported parameter: "+Object(ne.bb)(t));var u=Object(ne.p)(ZM(r,t,n),r.key);return UD(n.add(SF(u)))}var rR=function(e){return e&&e.expr},aR=function(e){return e&&e.field},iR=function(e){return"data"===e},oR=function(e){return"expr"===e},uR=function(e){return"field"===e},cR=function(e){return"compare"===e};function sR(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:UD(t.getData(e.data).output)}function lR(e,t,n,r,a){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=a,this.index={}}function fR(e){return Object(ne.J)(e)?e:null}function dR(e,t,n){var r,a=GD(n.op,n.field);if(t.ops){for(var i=0,o=t.as.length;i<o;++i)if(t.as[i]===a)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(a))}function hR(e,t,n,r,a,i,o){var u,c,s=t[n]||(t[n]={}),l=function(e){return Object(ne.H)(e)?("descending"===e.order?"-":"+")+GD(e.op,e.field):""}(i),f=fR(a);if(null!=f&&(e=t.scope,u=s[f+=l?"|"+l:""]),!u){var d=i?{field:qD,pulse:t.countsRef(e,a,i)}:{field:e.fieldRef(a),pulse:UD(t.output)};l&&(d.sort=e.sortRef(i)),c=e.add(BD(r,void 0,d)),o&&(t.index[a]=c),u=UD(c),null!=f&&(s[f]=u)}return u}function pR(e,t,n){var r=e.remove,a=e.insert,i=e.toggle,o=e.modify,u=e.values,c=t.add(WD()),s=HT("if("+e.trigger+',modify("'+n+'",'+[a,r,i,o,u].map((function(e){return null==e?"null":e})).join(",")+"),0)",t);c.update=s.$expr,c.params=s.$params}function vR(e,t){var n,r,a,i,o,u,c,s=YM(e),l=e.type===xM,f=e.from&&e.from.facet,d=e.overlap,h=e.layout||s===kD||s===OD,p=s===xD||h||f,v=function(e,t,n){var r,a,i,o,u;return e?(r=e.facet)&&(t||Object(ne.o)("Only group marks can be faceted."),null!=r.field?o=u=sR(r,n):(e.data?u=UD(n.getData(e.data).aggregate):((i=QM(Object(ne.p)({type:"aggregate",groupby:Object(ne.i)(r.groupby)},r.aggregate),n)).params.key=n.keyRef(r.groupby),i.params.pulse=sR(r,n),o=u=UD(n.add(i))),a=n.keyRef(r.groupby,!0))):o=UD(n.add(dF(null,[{}]))),o||(o=sR(e,n)),{key:a,pulse:o,parent:u}}(e.from,l,t),m=UD(r=t.add(pF({key:v.key||(e.key?VD(e.key):void 0),pulse:v.pulse,clean:!l})));r=a=t.add(dF({pulse:m})),r=t.add(kF({markdef:$M(e),interactive:JM(e.interactive,t),clip:KM(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:UD(r)}));var b=UD(r);(r=i=t.add(vF(DD(e.encode,e.type,s,e.style,t,{mod:!1,pulse:b})))).params.parent=t.encode(),e.transform&&e.transform.forEach((function(e){var n=QM(e,t),a=n.metadata;(a.generates||a.changes)&&Object(ne.o)("Mark transforms should not generate new data."),a.nomod||(i.params.mod=!0),n.params.pulse=UD(r),t.add(r=n)})),e.sort&&(r=t.add(FF({sort:t.compareRef(e.sort),pulse:UD(r)})));var g=UD(r);(f||h)&&(u=UD(h=t.add(MF({layout:t.objectProperty(e.layout),legends:t.legends,mark:b,pulse:g}))));var y=t.add(fF({mark:b,pulse:u||g}));c=UD(y),l&&(p&&((n=t.operators).pop(),h&&n.pop()),t.pushState(g,u||c,m),f?function(e,t,n){var r,a=e.from.facet,i=a.name,o=sR(a,t);a.name||Object(ne.o)("Facet must have a name: "+Object(ne.bb)(a)),a.data||Object(ne.o)("Facet must reference a data set: "+Object(ne.bb)(a)),a.field?r=t.add(EF({field:t.fieldRef(a.field),pulse:o})):a.groupby?r=t.add(bF({key:t.keyRef(a.groupby),group:UD(t.proxy(n.parent)),pulse:o})):Object(ne.o)("Facet must specify groupby or field: "+Object(ne.bb)(a));var u=t.fork(),c=u.add(dF()),s=u.add(DF({pulse:UD(c)}));u.addData(i,new lR(u,c,c,s)),u.addSignal("parent",null),r.params.subflow={$subflow:u.parse(e).toRuntime()}}(e,t,v):p?function(e,t,n){var r=t.add(EF({pulse:n.pulse})),a=t.fork();a.add(DF()),a.addSignal("parent",null),r.params.subflow={$subflow:a.parse(e).toRuntime()}}(e,t,v):t.parse(e),t.popState(),p&&(h&&n.push(h),n.push(y))),d&&(c=function(e,t,n){var r=e.method,a=e.bound,i=e.separation,o={separation:YD(i)?n.signalRef(i.signal):i,method:YD(r)?n.signalRef(r.signal):r,pulse:t};e.order&&(o.sort=n.compareRef({field:e.order}));if(a){var u=a.tolerance;o.boundTolerance=YD(u)?n.signalRef(u.signal):+u,o.boundScale=n.scaleRef(a.scale),o.boundOrient=a.orient}return UD(n.add(_F(o)))}(d,c,t));var x=t.add(TF({pulse:c})),O=t.add(DF({pulse:UD(x)},void 0,t.parent()));null!=e.name&&(o=e.name,t.addData(o,new lR(t,a,x,O)),e.on&&e.on.forEach((function(e){(e.insert||e.remove||e.toggle)&&Object(ne.o)("Marks only support modify triggers."),pR(e,t,o)})))}function mR(e,t){var n,r,a,i=t.config.legend,o=e.encode||{},u=_M(e,i),c=o.legend||{},s=c.name||void 0,l=c.interactive,f=c.style,d={},h=0;mM.forEach((function(t){return e[t]?(d[t]=e[t],h=h||e[t]):0})),h||Object(ne.o)("Missing valid scale for legend.");var p=function(e,t){var n=e.type||dM;e.type||1!==function(e){return mM.reduce((function(t,n){return t+(e[n]?1:0)}),0)}(e)||!e.fill&&!e.stroke||(n=$h(t)?hM:Qh(t)?pM:dM);return n!==hM?n:Qh(t)?pM:hM}(e,t.scaleType(h)),v={title:null!=e.title,scales:d,type:p,vgrad:"symbol"!==p&&u.isVertical()},m=UD(t.add(dF(null,[v]))),b=UD(t.add(xF(r={type:p,scale:t.scaleRef(h),count:t.objectProperty(u("tickCount")),limit:t.property(u("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===hM?(a=[TM(e,h,i,o.gradient),MM(e,i,o.labels,b)],r.count=r.count||t.signalRef("max(2,2*floor((".concat(QD(u.gradientLength()),")/100))"))):p===pM?a=[IM(e,h,i,o.gradient,b),MM(e,i,o.labels,b)]:(n=function(e,t){var n=_M(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,i),a=[RM(e,i,o,b,QD(n.columns))],r.size=function(e,t,n){var r=QD(gR("size",e,n)),a=QD(gR("strokeWidth",e,n)),i=QD(function(e,t,n){return SM("fontSize",e)||function(e,t,n){var r=t.config.style[n];return r&&r[e]}("fontSize",t,n)}(n[1].encode,t,cM));return HT("max(ceil(sqrt(".concat(r,")+").concat(a,"),").concat(i,")"),t)}(e,t,a[0].marks)),a=[jM({role:"legend-entry",from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:a,layout:n,interactive:l})],v.title&&a.push(function(e,t,n,r){var a=_M(e,t),i={enter:{opacity:gM},update:{opacity:yM,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:gM}};return bD(i,{orient:a("titleOrient"),_anchor:a("titleAnchor"),anchor:{signal:qM},angle:{signal:HM},align:{signal:VM},baseline:{signal:GM},text:e.title,fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),baseline:a("titleBaseline")}),NM({type:wM,role:"legend-title",style:sM,from:r,encode:i},n)}(e,i,o.title,m)),vR(jM({role:"legend",from:m,encode:gD(bR(u,e,i),c,bM),marks:a,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:s,interactive:l,style:f}),t)}function bR(e,t,n){var r={enter:{},update:{}};return bD(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function gR(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):SM(e,n[0].encode)}lR.fromEntries=function(e,t){var n=t.length,r=t[n-1],a=t[n-2],i=t[0],o=null,u=1;for(i&&"load"===i.type&&(i=t[1]),e.add(t[0]);u<n;++u)t[u].params.pulse=UD(t[u-1]),e.add(t[u]),"aggregate"===t[u].type&&(o=t[u]);return new lR(e,i,a,r,o)},lR.prototype={countsRef:function(e,t,n){var r,a,i,o=this,u=o.counts||(o.counts={}),c=fR(t);return null!=c&&(e=o.scope,r=u[c]),r?n&&n.field&&dR(e,r.agg.params,n):(i={groupby:e.fieldRef(t,"key"),pulse:UD(o.output)},n&&n.field&&dR(e,i,n),a=e.add(sF(i)),r=e.add(dF({pulse:UD(a)})),r={agg:a,ref:UD(r)},null!=c&&(u[c]=r)),r.ref},tuplesRef:function(){return UD(this.values)},extentRef:function(e,t){return hR(e,this,"extent","extent",t,!1)},domainRef:function(e,t){return hR(e,this,"domain","values",t,!1)},valuesRef:function(e,t,n){return hR(e,this,"vals","values",t,n||!0)},lookupRef:function(e,t){return hR(e,this,"lookup","tupleindex",t,!1)},indataRef:function(e,t){return hR(e,this,"indata","tupleindex",t,!0,!0)}};var yR='item.orient==="'.concat(eM,'"?-90:item.orient==="').concat(tM,'"?90:0');function xR(e,t){var n=_M(e=Object(ne.J)(e)?{text:e}:e,t.config.title),r=e.encode||{},a=r.group||{},i=a.name||void 0,o=a.interactive,u=a.style,c=[],s=UD(t.add(dF(null,[{}])));return c.push(function(e,t,n,r){var a={value:0},i=e.text,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return bD(o,{text:i,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),NM({type:wM,role:jD,style:lM,from:r,encode:o},n)}(e,n,function(e){var t=e.encode;return t&&t.title||Object(ne.p)({name:e.name,interactive:e.interactive,style:e.style},t)}(e),s)),e.subtitle&&c.push(function(e,t,n,r){var a={value:0},i=e.subtitle,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return bD(o,{text:i,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),NM({type:wM,role:_D,style:fM,from:r,encode:o},n)}(e,n,r.subtitle,s)),vR(jM({role:"title",from:s,encode:OR(n,a),marks:c,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:i,interactive:o,style:u}),t)}function OR(e,t){var n={enter:{},update:{}};return bD(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:CM},angle:{signal:yR},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),gD(n,t,bM)}function kR(e,t){var n=[];e.transform&&e.transform.forEach((function(e){n.push(QM(e,t))})),e.on&&e.on.forEach((function(n){pR(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){var r,a,i,o,u,c=[],s=null,l=!1,f=!1;e.values?YD(e.values)||$D(e.format)?(c.push(jR(t,e)),c.push(s=wR())):c.push(s=wR({$ingest:e.values,$format:e.format})):e.url?$D(e.url)||$D(e.format)?(c.push(jR(t,e)),c.push(s=wR())):c.push(s=wR({$request:e.url,$format:e.format})):e.source&&(s=r=Object(ne.i)(e.source).map((function(e){return UD(t.getData(e).output)})),c.push(null));for(a=0,i=n.length;a<i;++a)u=(o=n[a]).metadata,s||u.source||c.push(s=wR()),c.push(o),u.generates&&(f=!0),u.modifies&&!f&&(l=!0),u.source?s=o:u.changes&&(s=null);r&&(i=r.length-1,c[0]=NF({derive:l,pulse:i?r:r[0]}),(l||i)&&c.splice(1,0,wR()));s||c.push(wR());return c.push(DF({})),c}(e,t,n))}function wR(e){var t=dF({},e);return t.metadata={source:!0},t}function jR(e,t){return OF({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}var _R=function(e){return e===nM||e===ZF},SR=function(e,t,n){return YD(e)?IR(e.signal,t,n):e===eM||e===ZF?t:n},ER=function(e,t,n){return YD(e)?NR(e.signal,t,n):_R(e)?t:n},CR=function(e,t,n){return YD(e)?TR(e.signal,t,n):_R(e)?n:t},AR=function(e,t,n){return YD(e)?DR(e.signal,t,n):e===ZF?{value:t}:{value:n}},NR=function(e,t,n){return MR("".concat(e," === '").concat(ZF,"' || ").concat(e," === '").concat(nM,"'"),t,n)},TR=function(e,t,n){return MR("".concat(e," !== '").concat(ZF,"' && ").concat(e," !== '").concat(nM,"'"),t,n)},IR=function(e,t,n){return zR("".concat(e," === '").concat(eM,"' || ").concat(e," === '").concat(ZF,"'"),t,n)},DR=function(e,t,n){return zR("".concat(e," === '").concat(ZF,"'"),t,n)},FR=function(e,t,n){return zR("".concat(e," === '").concat(tM,"'"),t,n)},MR=function(e,t,n){return t=null!=t?vD(t):t,n=null!=n?vD(n):n,RR(t)&&RR(n)?(t=t?t.signal||Object(ne.bb)(t.value):null,n=n?n.signal||Object(ne.bb)(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[Object(ne.p)({test:e},t)].concat(n||[])},RR=function(e){return null==e||1===Object.keys(e).length},zR=function(e,t,n){return{signal:"".concat(e," ? (").concat(LR(t),") : (").concat(LR(n),")")}},LR=function(e){return YD(e)?e.signal:null==e?null:Object(ne.bb)(e)},PR=function(e,t){var n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function BR(e,t,n,r){var a;if(t&&Object(ne.w)(t,e))return t[e];if(Object(ne.w)(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":a="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":a=e[5].toLowerCase()+e.slice(6)}return r["guide-title"][a]}if(e.startsWith("label")){switch(e){case"labelColor":a="fill";break;case"labelFont":case"labelFontSize":a=e[5].toLowerCase()+e.slice(6)}return r["guide-label"][a]}return null}function WR(e){var t,n={},r=Object(mo.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a)for(var i in a)n[i]=1}}catch(o){r.e(o)}finally{r.f()}return Object.keys(n)}function UR(e,t){return{scale:e.scale,range:t}}function VR(e,t,n,r,a){var i,o,u,c=_M(e,t),s=e.orient,l=e.gridScale,f=SR(s,1,-1),d=function(e,t){if(1===t);else if(Object(ne.H)(e)){for(var n=e=Object(ne.p)({},e);null!=n.mult;){if(!Object(ne.H)(n.mult))return n.mult=YD(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n=n.mult=Object(ne.p)({},n.mult)}n.mult=t}else e=YD(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);return e}(e.offset,f),h={enter:i={opacity:gM},update:u={opacity:yM},exit:o={opacity:gM}};bD(h,{stroke:c("gridColor"),strokeCap:c("gridCap"),strokeDash:c("gridDash"),strokeDashOffset:c("gridDashOffset"),strokeOpacity:c("gridOpacity"),strokeWidth:c("gridWidth")});var p={scale:e.scale,field:uM,band:a.band,extra:a.extra,offset:a.offset,round:c("tickRound")},v=ER(s,{signal:"height"},{signal:"width"}),m=l?{scale:l,range:0,mult:f,offset:d}:{value:0,offset:d},b=l?{scale:l,range:1,mult:f,offset:d}:Object(ne.p)(v,{mult:f,offset:d});return i.x=u.x=ER(s,p,m),i.y=u.y=CR(s,p,m),i.x2=u.x2=CR(s,b),i.y2=u.y2=ER(s,b),o.x=ER(s,p),o.y=CR(s,p),NM({type:kM,role:"axis-grid",key:uM,from:r,encode:h},n)}function qR(e,t,n,r,a){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+a+")"}}function HR(e,t,n,r,a,i){var o,u=_M(e,t),c=e.orient,s=e.scale,l=SR(c,-1,1),f=QD(u("labelFlush")),d=QD(u("labelFlushOffset")),h=u("labelAlign"),p=u("labelBaseline"),v=0===f||!!f,m=vD(a);m.mult=l,m.offset=vD(u("labelPadding")||0),m.offset.mult=l;var b={scale:s,field:uM,band:.5,offset:AM(i.offset,u("labelOffset"))},g=ER(c,v?qR(s,f,'"left"','"right"','"center"'):{value:"center"},function(e,t,n){return YD(e)?FR(e.signal,t,n):e===tM?{value:t}:{value:n}}(c,"left","right")),y=ER(c,AR(c,"bottom","top"),v?qR(s,f,'"top"','"bottom"','"middle"'):{value:"middle"}),x=qR(s,f,"-(".concat(d,")"),d,0);v=v&&d;var O={opacity:gM,x:ER(c,b,m),y:CR(c,b,m)},k={enter:O,update:o={opacity:yM,text:{field:iM},x:O.x,y:O.y,align:g,baseline:y},exit:{opacity:gM,x:O.x,y:O.y}};bD(k,{dx:!h&&v?ER(c,x):null,dy:!p&&v?CR(c,x):null}),bD(k,{angle:u("labelAngle"),fill:u("labelColor"),fillOpacity:u("labelOpacity"),font:u("labelFont"),fontSize:u("labelFontSize"),fontWeight:u("labelFontWeight"),fontStyle:u("labelFontStyle"),limit:u("labelLimit"),lineHeight:u("labelLineHeight")},{align:h,baseline:p});var w=u("labelBound"),j=u("labelOverlap");return j=j||w?{separation:u("labelSeparation"),method:j,order:"datum.index",bound:w?{scale:s,orient:c,tolerance:w}:null}:void 0,o.align!==g&&(o.align=PR(o.align,g)),o.baseline!==y&&(o.baseline=PR(o.baseline,y)),NM({type:wM,role:"axis-label",style:cM,key:uM,from:r,encode:k,overlap:j},n)}function GR(e,t,n,r){var a,i,o=_M(e,t),u=e.orient,c=SR(u,-1,1),s={enter:a={opacity:gM,anchor:vD(o("titleAnchor",null)),align:{signal:CM}},update:i=Object(ne.p)({},a,{opacity:yM,text:vD(e.title)}),exit:{opacity:gM}},l={signal:'lerp(range("'.concat(e.scale,'"), ').concat(EM(0,1,.5),")")};return i.x=ER(u,l),i.y=CR(u,l),a.angle=ER(u,gM,function(e,t){return 0===t?0:YD(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t}}(c,90)),a.baseline=ER(u,AR(u,nM,ZF),{value:nM}),i.angle=a.angle,i.baseline=a.baseline,bD(s,{fill:o("titleColor"),fillOpacity:o("titleOpacity"),font:o("titleFont"),fontSize:o("titleFontSize"),fontStyle:o("titleFontStyle"),fontWeight:o("titleFontWeight"),limit:o("titleLimit"),lineHeight:o("titleLineHeight")},{align:o("titleAlign"),angle:o("titleAngle"),baseline:o("titleBaseline")}),function(e,t,n,r){var a=function(e,t){return null!=e?(n.update[t]=PR(vD(e),n.update[t]),!1):!yD(t,r)},i=a(e("titleX"),"x"),o=a(e("titleY"),"y");n.enter.auto=o===i?vD(o):ER(t,vD(o),vD(i))}(o,u,s,n),s.update.align=PR(s.update.align,a.align),s.update.angle=PR(s.update.angle,a.angle),s.update.baseline=PR(s.update.baseline,a.baseline),NM({type:wM,role:"axis-title",style:sM,from:r,encode:s},n)}function KR(e,t){var n,r=function(e,t){var n,r,a,i,o,u,c,s,l=t.config,f=l.style,d=l.axis,h="band"===t.scaleType(e.scale)&&l.axisBand,p=e.orient;if(YD(p)){var v=WR([l.axisX,l.axisY]),m=WR([l.axisTop,l.axisBottom,l.axisLeft,l.axisRight]);n={};var b,g=Object(mo.a)(v);try{for(g.s();!(b=g.n()).done;)n[a=b.value]=ER(p,BR(a,l.axisX,d,f),BR(a,l.axisY,d,f))}catch(O){g.e(O)}finally{g.f()}r={};var y,x=Object(mo.a)(m);try{for(x.s();!(y=x.n()).done;)r[a=y.value]=(i=p.signal,o=BR(a,l.axisTop,d,f),u=BR(a,l.axisBottom,d,f),c=BR(a,l.axisLeft,d,f),s=BR(a,l.axisRight,d,f),{signal:(null!=c?"".concat(i," === '").concat(eM,"' ? (").concat(LR(c),") : "):"")+(null!=u?"".concat(i," === '").concat(nM,"' ? (").concat(LR(u),") : "):"")+(null!=s?"".concat(i," === '").concat(tM,"' ? (").concat(LR(s),") : "):"")+(null!=o?"".concat(i," === '").concat(ZF,"' ? (").concat(LR(o),") : "):"")+"(null)"})}catch(O){x.e(O)}finally{x.f()}}else n=p===ZF||p===nM?l.axisX:l.axisY,r=l["axis"+p[0].toUpperCase()+p.slice(1)];return n||r||h?Object(ne.p)({},d,n,r,h):d}(e,t),a=e.encode||{},i=a.axis||{},o=i.name||void 0,u=i.interactive,c=i.style,s=_M(e,r),l=function(e){var t,n,r=e("tickBand"),a=e("tickOffset");return r?r.signal?(t={signal:"(".concat(r.signal,") === 'extent' ? 1 : 0.5")},n={signal:"(".concat(r.signal,") === 'extent'")},Object(ne.H)(a)||(a={signal:"(".concat(r.signal,") === 'extent' ? 0 : ").concat(a)})):"extent"===r?(t=1,n=!0,a=0):(t=.5,n=!1):(t=e("bandPosition"),n=e("tickExtra")),{extra:n,band:t,offset:a}}(s),f={scale:e.scale,ticks:!!s("ticks"),labels:!!s("labels"),grid:!!s("grid"),domain:!!s("domain"),title:null!=e.title},d=UD(t.add(dF({},[f]))),h=UD(t.add(lF({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[];return f.grid&&p.push(VR(e,r,a.grid,h,l)),f.ticks&&(n=s("tickSize"),p.push(function(e,t,n,r,a,i){var o,u,c,s=_M(e,t),l=e.orient,f=SR(l,-1,1),d={enter:o={opacity:gM},update:c={opacity:yM},exit:u={opacity:gM}};bD(d,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});var h=vD(a);h.mult=f;var p={scale:e.scale,field:uM,band:i.band,extra:i.extra,offset:i.offset,round:s("tickRound")};return c.y=o.y=ER(l,gM,p),c.y2=o.y2=ER(l,h),u.x=ER(l,p),c.x=o.x=CR(l,gM,p),c.x2=o.x2=CR(l,h),u.y=CR(l,p),NM({type:kM,role:"axis-tick",key:uM,from:r,encode:d},n)}(e,r,a.ticks,h,n,l))),f.labels&&(n=f.ticks?n:0,p.push(HR(e,r,a.labels,h,n,l))),f.domain&&p.push(function(e,t,n,r){var a,i,o=_M(e,t),u=e.orient,c={enter:a={opacity:gM},update:i={opacity:yM},exit:{opacity:gM}};bD(c,{stroke:o("domainColor"),strokeCap:o("domainCap"),strokeDash:o("domainDash"),strokeDashOffset:o("domainDashOffset"),strokeWidth:o("domainWidth"),strokeOpacity:o("domainOpacity")});var s=UR(e,0),l=UR(e,1);return a.x=i.x=ER(u,s,gM),a.x2=i.x2=ER(u,l),a.y=i.y=CR(u,s,gM),a.y2=i.y2=CR(u,l),NM({type:kM,role:"axis-domain",from:r,encode:c},n)}(e,r,a.domain,d)),f.title&&p.push(GR(e,r,a.title,d)),vR(jM({role:"axis",from:d,encode:gD(XR(s,e),i,bM),marks:p,aria:s("aria"),description:s("description"),zindex:s("zindex"),name:o,interactive:u,style:c}),t)}function XR(e,t){var n={enter:{},update:{}};return bD(n,{orient:e("orient"),offset:e("offset")||0,position:JD(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function YR(e,t,n){var r=Object(ne.i)(e.signals),a=Object(ne.i)(e.scales);return n||r.forEach((function(e){return LD(e,t)})),Object(ne.i)(e.projections).forEach((function(e){return function(e,t){var n=t.config.projection||{},r={};for(var a in e)"name"!==a&&(r[a]=QF(e[a],a,t));for(var i in n)null==r[i]&&(r[i]=QF(n[i],i,t));t.addProjection(e.name,r)}(e,t)})),a.forEach((function(e){return function(e,t){var n=e.type||"linear";Xh(n)||Object(ne.o)("Unrecognized scale type: "+Object(ne.bb)(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t)})),Object(ne.i)(e.data).forEach((function(e){return kR(e,t)})),a.forEach((function(e){return PF(e,t)})),(n||r).forEach((function(e){return function(e,t){var n=t.getSignal(e.name),r=e.update;e.init&&(r?Object(ne.o)("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=HT(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach((function(e){return oF(e,t,n.id)}))}(e,t)})),Object(ne.i)(e.axes).forEach((function(e){return KR(e,t)})),Object(ne.i)(e.marks).forEach((function(e){return vR(e,t)})),Object(ne.i)(e.legends).forEach((function(e){return mR(e,t)})),e.title&&xR(e.title,t),t.parseLambdas(),t}function $R(e,t){var n=t.config,r=UD(t.root=t.add(WD())),a=function(e,t){var n=function(n){return JD(e[n],t[n])},r=[JR("background",n("background")),JR("autosize",dD(n("autosize"))),JR("padding",pD(n("padding"))),JR("width",n("width")||0),JR("height",n("height")||0)],a=r.reduce((function(e,t){return e[t.name]=t,e}),{}),i={};return Object(ne.i)(e.signals).forEach((function(e){Object(ne.w)(a,e.name)?e=Object(ne.p)(a[e.name],e):r.push(e),i[e.name]=e})),Object(ne.i)(t.signals).forEach((function(e){Object(ne.w)(i,e.name)||Object(ne.w)(a,e.name)||r.push(e)})),r}(e,n);a.forEach((function(e){return LD(e,t)})),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;var i=t.add(dF()),o=t.add(vF(DD(function(e){return gD({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e)}(e.encode),xM,OD,e.style,t,{pulse:UD(i)}))),u=t.add(MF({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:UD(o)}));t.operators.pop(),t.pushState(UD(o),UD(u),null),YR(e,t,a),t.operators.push(u);var c=t.add(fF({mark:r,pulse:UD(u)}));return c=t.add(TF({pulse:UD(c)})),c=t.add(DF({pulse:UD(c)})),t.addData("root",new lR(t,i,i,c)),t}function JR(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function QR(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function ZR(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function ez(e){return(Object(ne.B)(e)?tz:nz)(e)}function tz(e){for(var t=e.length,n="[",r=0;r<t;++r){var a=e[r];n+=(r>0?",":"")+(Object(ne.H)(a)?a.signal||ez(a):Object(ne.bb)(a))}return n+"]"}function nz(e){var t,n,r="{",a=0;for(t in e)n=e[t],r+=(++a>1?",":"")+Object(ne.bb)(t)+":"+(Object(ne.H)(n)?n.signal||ez(n):Object(ne.bb)(n));return r+"}"}function rz(e,t,n){return Object(ne.H)(e)||Object(ne.o)("Input Vega specification must be an object."),$R(e,new QR(t=Object(ne.P)(function(){var e="sans-serif",t="#4c78a8",n="#000",r="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:n,font:e,fontSize:10},"guide-title":{fill:n,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),n)).toRuntime()}QR.prototype=ZR.prototype={parse:function(e){return YR(e,this)},fork:function(){return new ZR(this)},isSubscope:function(){return this._subid>0},toRuntime:function(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id:function(){return(this._subid?this._subid+":":0)+this._id++},add:function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((function(t){t.$ref=e.id})),e.refs=null),e},proxy:function(e){var t=e instanceof PD?UD(e):e;return this.add(AF({value:t}))},addStream:function(e){return this.streams.push(e),e.id=this.id(),e},addUpdate:function(e){return this.updates.push(e),e},finish:function(){var e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){var r;e&&((r=e.data||(e.data={}))[t]||(r[t]=[])).push(n)}for(e in this.data)for(var r in n((t=this.data[e]).input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values"),t.index)n(t.index[r],e,"index:"+r);return this},pushState:function(e,t,n){this._encode.push(UD(this.add(DF({pulse:e})))),this._parent.push(t),this._lookup.push(n?UD(this.proxy(n)):null),this._markpath.push(-1)},popState:function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent:function(){return Object(ne.W)(this._parent)},encode:function(){return Object(ne.W)(this._encode)},lookup:function(){return Object(ne.W)(this._lookup)},markpath:function(){var e=this._markpath;return++e[e.length-1]},fieldRef:function(e,t){if(Object(ne.J)(e))return VD(e,t);e.signal||Object(ne.o)("Unsupported field reference: "+Object(ne.bb)(e));var n=e.signal,r=this.field[n];if(!r){var a={name:this.signalRef(n)};t&&(a.as=t),this.field[n]=r=UD(this.add(gF(a)))}return r},compareRef:function(e){var t=this,n=!1,r=function(e){return YD(e)?(n=!0,t.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(n=!0,t.exprRef(e.expr)):e},a=Object(ne.i)(e.field).map(r),i=Object(ne.i)(e.order).map(r);return n?UD(this.add(hF({fields:a,orders:i}))):HD(a,i)},keyRef:function(e,t){var n=!1,r=this.signals;return e=Object(ne.i)(e).map((function(e){return YD(e)?(n=!0,UD(r[e.signal])):e})),n?UD(this.add(yF({fields:e,flat:t}))):function(e,t){var n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef:function(e){if(!e)return e;var t=GD(e.op,e.field),n=e.order||"ascending";return n.signal?UD(this.add(hF({fields:t,orders:this.signalRef(n.signal)}))):HD(t,n)},event:function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal:function(e){return Object(ne.w)(this.signals,e)},addSignal:function(e,t){this.hasOwnSignal(e)&&Object(ne.o)("Duplicate signal name: "+Object(ne.bb)(e));var n=t instanceof PD?t:this.add(WD(t));return this.signals[e]=n},getSignal:function(e){return this.signals[e]||Object(ne.o)("Unrecognized signal name: "+Object(ne.bb)(e)),this.signals[e]},signalRef:function(e){return this.signals[e]?UD(this.signals[e]):(Object(ne.w)(this.lambdas,e)||(this.lambdas[e]=this.add(WD(null))),UD(this.lambdas[e]))},parseLambdas:function(){for(var e=Object.keys(this.lambdas),t=0,n=e.length;t<n;++t){var r=e[t],a=HT(r,this),i=this.lambdas[r];i.params=a.$params,i.update=a.$expr}},property:function(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty:function(e){return e&&Object(ne.H)(e)?this.signalRef(e.signal||ez(e)):e},exprRef:function(e,t){var n={expr:HT(e,this)};return t&&(n.expr.$name=t),UD(this.add(mF(n)))},addBinding:function(e,t){this.bindings||Object(ne.o)("Nested signals do not support binding: "+Object(ne.bb)(e)),this.bindings.push(Object(ne.p)({signal:e},t))},addScaleProj:function(e,t){Object(ne.w)(this.scales,e)&&Object(ne.o)("Duplicate scale or projection name: "+Object(ne.bb)(e)),this.scales[e]=this.add(t)},addScale:function(e,t){this.addScaleProj(e,IF(t))},addProjection:function(e,t){this.addScaleProj(e,CF(t))},getScale:function(e){return this.scales[e]||Object(ne.o)("Unrecognized scale name: "+Object(ne.bb)(e)),this.scales[e]},scaleRef:function(e){return UD(this.getScale(e))},scaleType:function(e){return this.getScale(e).params.type},projectionRef:function(e){return this.scaleRef(e)},projectionType:function(e){return this.scaleType(e)},addData:function(e,t){return Object(ne.w)(this.data,e)&&Object(ne.o)("Duplicate data set name: "+Object(ne.bb)(e)),this.data[e]=t},getData:function(e){return this.data[e]||Object(ne.o)("Undefined data set name: "+Object(ne.bb)(e)),this.data[e]},addDataPipeline:function(e,t){return Object(ne.w)(this.data,e)&&Object(ne.o)("Duplicate data set name: "+Object(ne.bb)(e)),this.addData(e,lR.fromEntries(this,t))}};var az="5.20.0";Object(ne.p)(ho,i,u,c,s,l,d,f,h,p,v,m);var iz=az,oz=n(321),uz=function(e,t,n){return e.fields=t||[],e.fname=n,e};var cz=function(e){return 1===e.length?sz(e[0]):lz(e)},sz=function(e){return function(t){return t[e]}},lz=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}},fz=function(e){throw Error(e)},dz=function(e){var t,n,r,a=[],i=null,o=0,u=e.length,c="";function s(){a.push(c+e.substring(t,n)),c="",t=n+1}for(e+="",t=n=0;n<u;++n)if("\\"===(r=e[n]))c+=e.substring(t,n),c+=e.substring(++n,++n),t=n;else if(r===i)s(),i=null,o=-1;else{if(i)continue;t===o&&'"'===r||t===o&&"'"===r?(t=n+1,i=r):"."!==r||o?"["===r?(n>t&&s(),o=t=n+1):"]"===r&&(o||fz("Access path missing open bracket: "+e),o>0&&s(),o=0,t=n+1):n>t?s():t=n+1}return o&&fz("Access path missing closing bracket: "+e),i&&fz("Access path missing closing quote: "+e),n>t&&(n++,s()),a},hz=function(e,t,n){var r=dz(e);return e=1===r.length?r[0]:e,uz((n&&n.get||cz)(r),[e],t||e)},pz=[],vz=(hz("id"),uz((function(e){return e}),pz,"identity"));uz((function(){return 0}),pz,"zero"),uz((function(){return 1}),pz,"one"),uz((function(){return!0}),pz,"true"),uz((function(){return!1}),pz,"false");function mz(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var bz=Array.isArray,gz=function(e){return e===Object(e)},yz=function(e){return"__proto__"!==e};function xz(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)if("signals"===n)e.signals=kz(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;Oz(e,n,t[n],r)}return e}),{})}function Oz(e,t,n,r){var a,i;if(yz(t))if(gz(n)&&!bz(n))for(a in i=gz(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[a])?Oz(i,a,n[a]):yz(a)&&(i[a]=n[a]);else e[t]=n}function kz(e,t){if(null==e)return t;var n={},r=[];function a(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(a),e.forEach(a),r}var wz=function(e){return null!=e?bz(e)?e:[e]:[]},jz=function(e){return"function"===typeof e},_z=Object.prototype.hasOwnProperty,Sz=function(e,t){return _z.call(e,t)},Ez=function(e){return"boolean"===typeof e},Cz=function(e){return"number"===typeof e},Az=function(e){return"string"===typeof e};function Nz(e){return bz(e)?"["+e.map(Nz)+"]":gz(e)||Az(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var Tz=function(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t};function Iz(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;Object.create;Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var Dz=n(322),Fz=n.n(Dz),Mz=n(323),Rz=n.n(Mz),zz=n(123),Lz=n.n(zz);function Pz(e){return!!e.or}function Bz(e){return!!e.and}function Wz(e){return!!e.not}function Uz(e,t){if(Wz(e))Uz(e.not,t);else if(Bz(e)){var n,r=Object(mo.a)(e.and);try{for(r.s();!(n=r.n()).done;){Uz(n.value,t)}}catch(o){r.e(o)}finally{r.f()}}else if(Pz(e)){var a,i=Object(mo.a)(e.or);try{for(i.s();!(a=i.n()).done;){Uz(a.value,t)}}catch(o){i.e(o)}finally{i.f()}}else t(e)}function Vz(e,t){return Wz(e)?{not:Vz(e.not,t)}:Bz(e)?{and:e.and.map((function(e){return Vz(e,t)}))}:Pz(e)?{or:e.or.map((function(e){return Vz(e,t)}))}:t(e)}var qz=Rz.a,Hz=Fz.a;function Gz(e,t){var n,r={},a=Object(mo.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;Sz(e,i)&&(r[i]=e[i])}}catch(o){a.e(o)}finally{a.f()}return r}function Kz(e,t){var n,r=Object.assign({},e),a=Object(mo.a)(t);try{for(a.s();!(n=a.n()).done;){delete r[n.value]}}catch(i){a.e(i)}finally{a.f()}return r}Set.prototype.toJSON=function(){return"Set(".concat(Object(Jc.a)(this).map((function(e){return Lz()(e)})).join(","),")")};var Xz=Lz.a;function Yz(e){if(Cz(e))return e;var t=Az(e)?e:Lz()(e);if(t.length<250)return t;for(var n=0,r=0;r<t.length;r++){n=(n<<5)-n+t.charCodeAt(r),n&=n}return n}function $z(e){return!1===e||null===e}function Jz(e,t){return e.indexOf(t)>-1}function Qz(e,t){var n,r=0,a=Object(mo.a)(e.entries());try{for(a.s();!(n=a.n()).done;){var i=Object(bo.a)(n.value,2),o=i[0];if(t(i[1],o,r++))return!0}}catch(u){a.e(u)}finally{a.f()}return!1}function Zz(e,t){var n,r=0,a=Object(mo.a)(e.entries());try{for(a.s();!(n=a.n()).done;){var i=Object(bo.a)(n.value,2),o=i[0];if(!t(i[1],o,r++))return!1}}catch(u){a.e(u)}finally{a.f()}return!0}function eL(e,t){var n,r=Object(mo.a)(oL(t));try{for(r.s();!(n=r.n()).done;){var a=n.value;Oz(e,a,t[a],!0)}}catch(i){r.e(i)}finally{r.f()}}function tL(e,t){var n,r,a=[],i={},o=Object(mo.a)(e);try{for(o.s();!(r=o.n()).done;){var u=r.value;(n=t(u))in i||(i[n]=1,a.push(u))}}catch(c){o.e(c)}finally{o.f()}return a}function nL(e,t){var n,r=Object(mo.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(t.has(a))return!0}}catch(i){r.e(i)}finally{r.f()}return!1}function rL(e){var t,n=new Set,r=Object(mo.a)(e);try{var a=function(){var e,r=t.value,a=dz(r).map((function(e,t){return 0===t?e:"[".concat(e,"]")})),i=a.map((function(e,t){return a.slice(0,t+1).join("")})),o=Object(mo.a)(i);try{for(o.s();!(e=o.n()).done;){var u=e.value;n.add(u)}}catch(c){o.e(c)}finally{o.f()}};for(r.s();!(t=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}return n}function aL(e,t){return void 0===e||void 0===t||nL(rL(e),rL(t))}function iL(e){return 0===oL(e).length}var oL=Object.keys,uL=Object.values;function cL(e){var t=[];for(var n in e)Sz(e,n)&&t.push({key:n,value:e[n]});return t}function sL(e){return!0===e||!1===e}function lL(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function fL(e,t){return Wz(e)?"!("+fL(e.not,t)+")":Bz(e)?"("+e.and.map((function(e){return fL(e,t)})).join(") && (")+")":Pz(e)?"("+e.or.map((function(e){return fL(e,t)})).join(") || (")+")":t(e)}function dL(e,t){if(0===t.length)return!0;var n=t.shift();return n in e&&dL(e[n],t)&&delete e[n],iL(e)}function hL(e){return e.charAt(0).toUpperCase()+e.substr(1)}function pL(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum",n=dz(e),r=[],a=1;a<=n.length;a++){var i="[".concat(n.slice(0,a).map(Nz).join("]["),"]");r.push("".concat(t).concat(i))}return r.join(" && ")}function vL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";return"".concat(t,"[").concat(Nz(dz(e).join(".")),"]")}function mL(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function bL(e){return"".concat(dz(e).map(mL).join("\\."))}function gL(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function yL(e){return"".concat(dz(e).join("."))}function xL(e){return e?dz(e).length:0}function OL(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++){var i=a[r];if(void 0!==i)return i}}var kL=42;function wL(e){var t=++kL;return e?String(e)+t:t}function jL(e){return function(e){return 0===e.indexOf("__")}(e)?e:"__".concat(e)}function _L(e){if(void 0!==e)return(e%360+360)%360}function SL(e){return!!Cz(e)||!isNaN(e)&&!isNaN(parseFloat(e))}var EL={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function CL(e){return e&&e.condition}var AL=["domain","grid","labels","ticks","title"],NL={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},TL={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},IL=Object.assign(Object.assign({},TL),{style:1,labelExpr:1,encoding:1});function DL(e){return!!IL[e]}oL(IL);var FL={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},ML=FL.arc,RL=FL.area,zL=FL.bar,LL=FL.image,PL=FL.line,BL=FL.point,WL=FL.rect,UL=FL.rule,VL=FL.text,qL=FL.tick,HL=FL.trail,GL=FL.circle,KL=FL.square,XL=FL.geoshape;function YL(e){return Jz(["line","area","trail"],e)}function $L(e){return Jz(["rect","bar","image","arc"],e)}var JL=oL(FL);function QL(e){return e.type}Tz(JL);var ZL=[].concat(["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],["fill","fillOpacity"]),eP=oL({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),tP={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},nP={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},rP={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function aP(e){return"mark"in e}var iP=function(){function e(t,n){Object(iO.a)(this,e),this.name=t,this.run=n}return Object(oO.a)(e,[{key:"hasMatchingType",value:function(e){return!!aP(e)&&(QL(t=e.mark)?t.type:t)===this.name;var t}}]),e}(),oP={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},uP={count:1,min:1,max:1};function cP(e){return!!e&&!!e.argmin}function sP(e){return!!e&&!!e.argmax}oL(oP);function lP(e){return Az(e)&&!!oP[e]}var fP=["count","valid","missing","distinct"];function dP(e){return Az(e)&&Jz(fP,e)}var hP=["count","sum","distinct","valid","missing"],pP=Tz(["mean","average","median","q1","q3","min","max"]),vP="row",mP="column",bP="facet",gP="x",yP="y",xP="x2",OP="y2",kP="radius",wP="radius2",jP="theta",_P="theta2",SP="latitude",EP="longitude",CP="latitude2",AP="longitude2",NP="color",TP="fill",IP="stroke",DP="shape",FP="size",MP="angle",RP="opacity",zP="fillOpacity",LP="strokeOpacity",PP="strokeWidth",BP="strokeDash",WP="text",UP="order",VP="detail",qP="key",HP="tooltip",GP="href",KP="url",XP="description",YP={theta:1,theta2:1,radius:1,radius2:1};function $P(e){return e in YP}var JP={longitude:1,longitude2:1,latitude:1,latitude2:1};var QP=oL(JP),ZP=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),YP),JP),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function eB(e){return e===NP||e===TP||e===IP}var tB={row:1,column:1,facet:1},nB=oL(tB),rB=Object.assign(Object.assign({},ZP),tB),aB=oL(rB),iB=(rB.order,rB.detail,rB.tooltip,Iz(rB,["order","detail","tooltip"])),oB=(iB.row,iB.column,iB.facet,Iz(iB,["row","column","facet"]));oL(iB),oL(oB);function uB(e){return!!rB[e]}var cB=[xP,OP,CP,AP,_P,wP];function sB(e){return lB(e)!==e}function lB(e){switch(e){case xP:return gP;case OP:return yP;case CP:return SP;case AP:return EP;case _P:return jP;case wP:return kP}return e}function fB(e){if($P(e))switch(e){case jP:return"startAngle";case _P:return"endAngle";case kP:return"outerRadius";case wP:return"innerRadius"}return e}function dB(e){switch(e){case gP:return xP;case yP:return OP;case SP:return CP;case EP:return AP;case jP:return _P;case kP:return wP}}function hB(e){switch(e){case gP:case xP:return"width";case yP:case OP:return"height"}}oL(ZP),ZP.x,ZP.y,ZP.x2,ZP.y2,ZP.latitude,ZP.longitude,ZP.latitude2,ZP.longitude2,ZP.theta,ZP.theta2,ZP.radius,ZP.radius2;var pB=Iz(ZP,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),vB=oL(pB),mB={x:1,y:1},bB=oL(mB);function gB(e){return e in mB}var yB={theta:1,radius:1},xB=oL(yB);function OB(e){return"width"===e?gP:yP}pB.text,pB.tooltip,pB.href,pB.url,pB.description,pB.detail,pB.key,pB.order;var kB=Iz(pB,["text","tooltip","href","url","description","detail","key","order"]),wB=oL(kB);var jB=Object.assign(Object.assign(Object.assign({},mB),yB),kB),_B=oL(jB);function SB(e){return!!jB[e]}function EB(e,t){return function(e){switch(e){case NP:case TP:case IP:case XP:case VP:case qP:case HP:case GP:case UP:case RP:case zP:case LP:case PP:case bP:case vP:case mP:return CB;case gP:case yP:case SP:case EP:return AB;case xP:case OP:case CP:case AP:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case FP:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case BP:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case DP:return{point:"always",geoshape:"always"};case WP:return{text:"always"};case MP:return{point:"always",square:"always",text:"always"};case KP:return{image:"always"};case jP:case kP:return{text:"always",arc:"always"};case _P:case wP:return{arc:"always"}}}(e)[t]}var CB={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},AB=Iz(CB,["geoshape"]);function NB(e){switch(e){case gP:case yP:case jP:case kP:case FP:case MP:case PP:case RP:case zP:case LP:case xP:case OP:case _P:case wP:return;case bP:case vP:case mP:case DP:case BP:case WP:case HP:case GP:case KP:case XP:return"discrete";case NP:case TP:case IP:return"flexible";case SP:case EP:case CP:case AP:case VP:case qP:case UP:return}}function TB(e){return Ez(e)&&(e=Kq(e,void 0)),"bin"+oL(e).map((function(t){return MB(e[t])?lL("_".concat(t,"_").concat(Object.entries(e[t]))):lL("_".concat(t,"_").concat(e[t]))})).join("")}function IB(e){return!0===e||FB(e)&&!e.binned}function DB(e){return"binned"===e||FB(e)&&!0===e.binned}function FB(e){return gz(e)}function MB(e){return null===e||void 0===e?void 0:e.selection}function RB(e){switch(e){case vP:case mP:case FP:case NP:case TP:case IP:case PP:case RP:case zP:case LP:case DP:return 6;case BP:return 4;default:return 10}}var zB=n(225);function LB(e){return"Invalid specification ".concat(JSON.stringify(e),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}var PB='Autosize "fit" only works for single views and layered views.';function BB(e){return"".concat("width"==e?"Width":"Height",' "container" only works for single views and layered views.')}function WB(e){var t="width"==e?"x":"y";return"".concat("width"==e?"Width":"Height",' "container" only works well with autosize "fit" or "fit-').concat(t,'".')}function UB(e){return e?'Dropping "fit-'.concat(e,'" because spec has discrete ').concat(hB(e),"."):'Dropping "fit" because spec has discrete size.'}function VB(e){return'Cannot project a selection on encoding channel "'.concat(e,'", which has no field.')}function qB(e,t){return'Cannot project a selection on encoding channel "'.concat(e,'" as it uses an aggregate function ("').concat(t,'").')}function HB(e){return'The "nearest" transform is not supported for '.concat(e," marks.")}function GB(e){return"Selection not supported for ".concat(e," yet.")}function KB(e){return'Cannot find a selection named "'.concat(e,'".')}var XB="Scale bindings are currently only supported for scales with unbinned, continuous domains.",YB="Legend bindings are only supported for selections over an individual field or encoding channel.";function $B(e){return'Cannot define and lookup the "'.concat(e,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?"}function JB(e){return'Unknown repeated value "'.concat(e,'".')}function QB(e){return'The "columns" property cannot be used when "'.concat(e,'" has nested row/column.')}var ZB="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function eW(e){return'Unrecognized parse "'.concat(e,'".')}function tW(e,t,n){return'An ancestor parsed field "'.concat(e,'" as ').concat(n," but a child wants to parse the field as ").concat(t,".")}function nW(e){return"Ignoring an invalid transform: ".concat(Xz(e),".")}var rW='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function aW(e){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(e," are dropped.")}function iW(e){return"Layer's shared ".concat(e.join(",")," channel ").concat(1===e.length?"is":"are"," overriden.")}function oW(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection ".concat(Xz(t)," is overridden by a child projection ").concat(Xz(n),".")}var uW="Arc marks uses theta channel rather than angle, replacing angle with theta.";function cW(e,t,n){return"Channel ".concat(e," is a ").concat(t,". Converted to {value: ").concat(Xz(n),"}.")}function sW(e){return'Invalid field type "'.concat(e,'".')}function lW(e,t){return'Invalid field type "'.concat(e,'" for aggregate: "').concat(t,'", using "quantitative" instead.')}function fW(e){return'Invalid aggregation operator "'.concat(e,'".')}function dW(e,t){return'Missing type for channel "'.concat(e,'", using "').concat(t,'" instead.')}function hW(e,t){var n=t.fill,r=t.stroke;return"Dropping color ".concat(e," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function pW(e,t){return"Dropping ".concat(Xz(e),' from channel "').concat(t,'" since it does not contain any data field, datum, value, or signal.')}function vW(e,t,n){return"".concat(e,"-encoding with type ").concat(t," is deprecated. Replacing with ").concat(n,"-encoding.")}var mW="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function bW(e,t,n){return"".concat(e,' dropped as it is incompatible with "').concat(t,'"').concat(n?" when ".concat(n):"",".")}function gW(e){return"".concat(e,"-encoding is dropped as ").concat(e," is not a valid encoding channel.")}function yW(e){return"".concat(e," encoding should be discrete (ordinal / nominal / binned).")}function xW(e){return"Facet encoding dropped as ".concat(e.join(" and ")," ").concat(e.length>1?"are":"is"," also specified.")}function OW(e,t){return'Using discrete channel "'.concat(e,'" to encode "').concat(t,'" field can be misleading as it does not encode ').concat("ordinal"===t?"order":"magnitude",".")}function kW(e,t){return"Line mark is for continuous lines and thus cannot be used with ".concat(e&&t?"x2 and y2":e?"x2":"y2",". We will use the rule mark (line segments) instead.")}function wW(e,t){return'Specified orient "'.concat(e,'" overridden with "').concat(t,'".')}var jW="Custom domain scale cannot be unioned with default field-based domain.",_W='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function SW(e){return'Cannot use the scale property "'.concat(e,'" with non-color channel.')}function EW(e){return"Using unaggregated domain with raw field has no effect (".concat(Xz(e),").")}function CW(e){return'Unaggregated domain not applicable for "'.concat(e,'" since it produces values outside the origin domain of the source data.')}function AW(e){return"Unaggregated domain is currently unsupported for log scale (".concat(Xz(e),").")}function NW(e){return'Cannot apply size to non-oriented mark "'.concat(e,'".')}function TW(e,t,n){return'Channel "'.concat(e,'" does not work with "').concat(t,'" scale. We are using "').concat(n,'" scale instead.')}function IW(e,t){return'FieldDef does not work with "'.concat(e,'" scale. We are using "').concat(t,'" scale instead.')}function DW(e,t,n){return"".concat(n,"-scale's \"").concat(t,'" is dropped as it does not work with ').concat(e," scale.")}function FW(e,t){return'Scale type "'.concat(t,'" does not work with mark "').concat(e,'".')}function MW(e){return'The step for "'.concat(e,'" is dropped because the ').concat("width"===e?"x":"y"," is continuous.")}function RW(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(Xz(n)," and ").concat(Xz(r),"). Using ").concat(Xz(n),".")}function zW(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(Xz(n)," and ").concat(Xz(r),"). Using the union of the two domains.")}function LW(e){return'Setting the scale to be independent for "'.concat(e,'" means we also have to set the guide (axis or legend) to be independent.')}function PW(e){return"Dropping sort property ".concat(Xz(e),' as unioned domains only support boolean or op "count", "min", and "max".')}var BW="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",WW="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",UW="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",VW="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.",qW="Invalid channel for axis.";function HW(e){return'Cannot stack "'.concat(e,'" if there is already "').concat(e,'2".')}function GW(e){return"Cannot stack non-linear scale (".concat(e,").")}function KW(e){return'Stacking is applied even though the aggregate function is non-summative ("'.concat(e,'").')}function XW(e,t){return"Invalid ".concat(e,": ").concat(Xz(t),".")}function YW(e){return"Dropping day from datetime ".concat(Xz(e)," as day cannot be combined with other units.")}function $W(e,t){return"".concat(t?"extent ":"").concat(t&&e?"and ":"").concat(e?"center ":"").concat(t&&e?"are ":"is ","not needed when data are aggregated.")}function JW(e,t,n){return"".concat(e," is not usually used with ").concat(t," for ").concat(n,".")}function QW(e,t){return"Continuous axis should not have customized aggregation function ".concat(e,"; ").concat(t," already agregates the axis.")}function ZW(e,t){return"Center is not needed to be specified in ".concat(t," when extent is ").concat(e,".")}function eU(e){return"1D error band does not support ".concat(e,".")}function tU(e){return"Channel ".concat(e,' is required for "binned" bin.')}function nU(e){return"Domain for ".concat(e," is required for threshold scale.")}var rU=function(e,t){var n=e||0;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=1&&mz(t||"error","ERROR",arguments),this},warn:function(){return n>=2&&mz(t||"warn","WARN",arguments),this},info:function(){return n>=3&&mz(t||"log","INFO",arguments),this},debug:function(){return n>=4&&mz(t||"log","DEBUG",arguments),this}}}(2),aU=rU;function iU(e){return aU=e}function oU(){return aU=rU}function uU(){var e;(e=aU).warn.apply(e,arguments)}function cU(e){if(e&&gz(e)){var t,n=Object(mo.a)(gU);try{for(n.s();!(t=n.n()).done;){if(t.value in e)return!0}}catch(r){n.e(r)}finally{n.f()}}return!1}var sU=["january","february","march","april","may","june","july","august","september","october","november","december"],lU=sU.map((function(e){return e.substr(0,3)})),fU=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],dU=fU.map((function(e){return e.substr(0,3)}));function hU(e,t){var n=[];if(t&&void 0!==e.day&&oL(e).length>1&&(uU(g.droppedDay(e)),delete(e=Hz(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){var r=t?function(e){if(SL(e)&&(e=+e),Cz(e))return e-1;var t=e.toLowerCase(),n=sU.indexOf(t);if(-1!==n)return n;var r=t.substr(0,3),a=lU.indexOf(r);if(-1!==a)return a;throw new Error(g.invalidTimeUnit("month",e))}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){var a=t?function(e){if(SL(e)&&(e=+e),Cz(e))return e>4&&uU(g.invalidTimeUnit("quarter",e)),e-1;throw new Error(g.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;n.push(Cz(a)?3*a:a+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){var i=t?function(e){if(SL(e)&&(e=+e),Cz(e))return e%7;var t=e.toLowerCase(),n=fU.indexOf(t);if(-1!==n)return n;var r=t.substr(0,3),a=dU.indexOf(r);if(-1!==a)return a;throw new Error(g.invalidTimeUnit("day",e))}(e.day):e.day;n.push(Cz(i)?i+1:i+"+1")}else n.push(1);for(var o=0,u=["hours","minutes","seconds","milliseconds"];o<u.length;o++){var c=e[u[o]];n.push("undefined"===typeof c?0:c)}return n}function pU(e){var t=hU(e,!0).join(", ");return e.utc?"utc(".concat(t,")"):"datetime(".concat(t,")")}function vU(e){var t=hU(e,!1).join(", ");return e.utc?"utc(".concat(t,")"):"datetime(".concat(t,")")}function mU(e){var t=hU(e,!0);return e.utc?+new Date(Date.UTC.apply(Date,Object(Jc.a)(t))):+Object(zB.a)(Date,Object(Jc.a)(t))}var bU={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},gU=oL(bU);function yU(e){return e.startsWith("utc")}var xU={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function OU(e){var t,n=[],r=Object(mo.a)(gU);try{for(r.s();!(t=r.n()).done;){var a=t.value;kU(e,a)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function kU(e,t){var n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function wU(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1},a=r.end,i=pL(t),o=yU(e)?"utc":"";function u(e){return"quarter"===e?"(".concat(o,"quarter(").concat(i,")-1)"):"".concat(o).concat(e,"(").concat(i,")")}var c,s={},l=Object(mo.a)(gU);try{for(l.s();!(c=l.n()).done;){var f=c.value;kU(e,f)&&(s[f]=u(f),n=f)}}catch(d){l.e(d)}finally{l.f()}return a&&(s[n]+="+1"),vU(s)}function jU(e){if(e){var t=OU(e);return"timeUnitSpecifier(".concat(Lz()(t),", ").concat(Lz()(xU),")")}}function _U(e){var t;if(e)return Az(e)?t={unit:e}:gz(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),yU(t.unit)&&(t.utc=!0,t.unit=t.unit.substr(3)),t}function SU(e){var t=_U(e),n=t.utc,r=Iz(t,["utc"]);return r.unit?(n?"utc":"")+oL(r).map((function(e){return lL("".concat("unit"===e?"":"_".concat(e,"_")).concat(r[e]))})).join(""):(n?"utc":"")+"timeunit"+oL(r).map((function(e){return lL("_".concat(e,"_").concat(r[e]))})).join("")}function EU(e){return e&&!!e.signal}function CU(e){return!!e.step}function AU(e){return!bz(e)&&("field"in e&&"data"in e)}var NU=oL({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),TU={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},IU=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function DU(e){return e&&!!e.field&&void 0!==e.equal}function FU(e){return e&&!!e.field&&void 0!==e.lt}function MU(e){return e&&!!e.field&&void 0!==e.lte}function RU(e){return e&&!!e.field&&void 0!==e.gt}function zU(e){return e&&!!e.field&&void 0!==e.gte}function LU(e){if(e&&e.field){if(bz(e.range)&&2===e.range.length)return!0;if(EU(e.range))return!0}return!1}function PU(e){return e&&!!e.field&&(bz(e.oneOf)||bz(e.in))}function BU(e){return e&&!!e.field&&void 0!==e.valid}function WU(e){return PU(e)||DU(e)||LU(e)||FU(e)||RU(e)||MU(e)||zU(e)}function UU(e,t){return $q(e,{timeUnit:t,wrapTime:!0})}function VU(e,t){return e.map((function(e){return UU(e,t)}))}function qU(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.field,a=null===(t=_U(e.timeUnit))||void 0===t?void 0:t.unit,i=a?"time("+wU(a,r)+")":Nq(e,{expr:"datum"});if(DU(e))return i+"==="+UU(e.equal,a);if(FU(e)){var o=e.lt;return"".concat(i,"<").concat(UU(o,a))}if(RU(e)){var u=e.gt;return"".concat(i,">").concat(UU(u,a))}if(MU(e)){var c=e.lte;return"".concat(i,"<=").concat(UU(c,a))}if(zU(e)){var s=e.gte;return"".concat(i,">=").concat(UU(s,a))}if(PU(e))return"indexof([".concat(VU(e.oneOf,a).join(","),"], ").concat(i,") !== -1");if(BU(e))return HU(i,e.valid);if(LU(e)){var l=e.range,f=EU(l)?{signal:"".concat(l.signal,"[0]")}:l[0],d=EU(l)?{signal:"".concat(l.signal,"[1]")}:l[1];if(null!==f&&null!==d&&n)return"inrange("+i+", ["+UU(f,a)+", "+UU(d,a)+"])";var h=[];return null!==f&&h.push("".concat(i," >= ").concat(UU(f,a))),null!==d&&h.push("".concat(i," <= ").concat(UU(d,a))),h.length>0?h.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(JSON.stringify(e)))}function HU(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?"isValid(".concat(e,") && isFinite(+").concat(e,")"):"!isValid(".concat(e,") || !isFinite(+").concat(e,")")}function GU(e){var t;return WU(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=_U(e.timeUnit))||void 0===t?void 0:t.unit}):e}var KU={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};var XU=KU.quantitative,YU=KU.ordinal,$U=KU.temporal,JU=KU.nominal,QU=KU.geojson,ZU=oL(KU);var eV="linear",tV="log",nV="pow",rV="sqrt",aV="symlog",iV="time",oV="utc",uV="quantile",cV="quantize",sV="threshold",lV="point",fV="band",dV={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},hV=oL(dV);function pV(e,t){var n=dV[e],r=dV[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}var vV={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function mV(e){return vV[e]}var bV=["linear","log","pow","sqrt","symlog","time","utc"],gV=Tz(bV),yV=Tz(["linear","log","pow","sqrt","symlog"]);var xV=Tz(["quantile","quantize","threshold"]),OV=Tz(bV.concat(["quantile","quantize","threshold","sequential","identity"])),kV=Tz(["ordinal","bin-ordinal","point","band"]);function wV(e){return e in kV}function jV(e){return e in OV}function _V(e){return e in gV}function SV(e){return e in xV}function EV(e){return null===e||void 0===e?void 0:e.selection}var CV={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},AV=(oL(CV),Iz(CV,["type","domain","range","scheme"])),NV=oL(AV);!function(){var e,t,n={},r=Object(mo.a)(aB);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,o=Object(mo.a)(ZU);try{for(o.s();!(a=o.n()).done;){var u,c=a.value,s=Object(mo.a)(hV);try{for(s.s();!(u=s.n()).done;){var l=u.value,f=MV(i,c);FV(i,l)&&DV(l,c)&&(n[f]=null!==(e=n[f])&&void 0!==e?e:[],n[f].push(l))}}catch(d){s.e(d)}finally{s.f()}}}catch(d){o.e(d)}finally{o.f()}}}catch(d){r.e(d)}finally{r.f()}}();function TV(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!Jz(["point","band","identity"],e);case"bins":return!Jz(["point","band","identity","ordinal"],e);case"round":return _V(e)||"band"===e||"point"===e;case"padding":return _V(e)||Jz(["point","band"],e);case"paddingOuter":case"align":return Jz(["point","band"],e);case"paddingInner":return"band"===e;case"domainMid":case"clamp":return _V(e);case"nice":return _V(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return jV(e)&&!Jz(["log","time","utc","threshold","quantile"],e)}}function IV(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return eB(e)?void 0:g.cannotUseScalePropertyWithNonColor(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function DV(e,t){return Jz([YU,JU],t)?void 0===e||wV(e):t===$U?Jz([iV,oV,void 0],e):t!==XU||Jz([tV,nV,rV,aV,uV,cV,sV,eV,void 0],e)}function FV(e,t){if(!SB(e))return!1;switch(e){case gP:case yP:case jP:case kP:return _V(t)||Jz(["band","point"],t);case FP:case PP:case RP:case zP:case LP:case MP:return _V(t)||SV(t)||Jz(["band","point","ordinal"],t);case NP:case TP:case IP:return"band"!==t;case BP:return"ordinal"===t||SV(t);case DP:return"ordinal"===t}}function MV(e,t){return e+"_"+t}function RV(e){var t=e.channel,n=e.channelDef,r=e.markDef,a=e.scale,i=e.config,o=UV(e);return bq(n)&&!dP(n.aggregate)&&a&&_V(a.get("type"))&&!1===a.get("zero")?zV({fieldDef:n,channel:t,markDef:r,ref:o,config:i}):o}function zV(e){var t=e.fieldDef,n=e.channel,r=e.markDef,a=e.ref,i=e.config;return YL(r.type)||null===iH("invalid",r,i)?a:[LV(t,n),a]}function LV(e,t){var n=PV(e,!0),r="y"===lB(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function PV(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return HU(Az(e)?e:Nq(e,{expr:"datum"}),!t)}function BV(e,t,n,r){var a={};if(t&&(a.scale=t),yq(e)){var i=e.datum;cU(i)?a.signal=pU(i):EU(i)?a.signal=i.signal:a.value=i}else a.field=Nq(e,n);if(r){var o=r.offset,u=r.band;o&&(a.offset=o),u&&(a.band=u)}return a}function WV(e){var t=e.scaleName,n=e.fieldOrDatumDef,r=e.fieldOrDatumDef2,a=e.offset,i=e.startSuffix,o=e.band,u=void 0===o?.5:o,c=0<u&&u<1?"datum":void 0,s=Nq(n,{expr:c,suffix:i}),l=void 0!==r?Nq(r,{expr:c}):Nq(n,{suffix:"end",expr:c}),f={};if(0===u||1===u){f.scale=t;var d=0===u?s:l;f.field=d}else{var h="".concat(u," * ").concat(s," + ").concat(1-u," * ").concat(l);f.signal='scale("'.concat(t,'", ').concat(h,")")}return a&&(f.offset=a),f}function UV(e){var t,n=e.channel,r=e.channelDef,a=e.channel2Def,i=e.markDef,o=e.config,u=e.scaleName,c=e.scale,s=e.stack,l=e.offset,f=e.defaultRef,d=e.band;if(r){if(kq(r)){if(wq(r)){d=null!==d&&void 0!==d?d:dq({channel:n,fieldDef:r,fieldDef2:a,markDef:i,stack:s,config:o,isMidPoint:!0});var h=r.bin,p=r.timeUnit,v=r.type;if(IB(h)||d&&p&&v===$U)return s&&s.impute?BV(r,u,{binSuffix:"mid"},{offset:l}):d?WV({scaleName:u,fieldOrDatumDef:r,band:d,offset:l}):BV(r,u,Qq(r,n)?{binSuffix:"range"}:{},{offset:l});if(DB(h)){if(bq(a))return WV({scaleName:u,fieldOrDatumDef:r,fieldOrDatumDef2:a,band:d,offset:l});var m=n===gP?xP:OP;uU(g.channelRequiredForBinned(m))}}var b=null===c||void 0===c?void 0:c.get("type");return BV(r,u,wV(b)?{binSuffix:"range"}:{},{offset:l,band:"band"===b?null!==(t=null!==d&&void 0!==d?d:r.band)&&void 0!==t?t:.5:void 0})}if(jq(r)){var y=r.value,x=l?{offset:l}:{};return Object.assign(Object.assign({},VV(n,y)),x)}}return jz(f)&&(f=f()),f?Object.assign(Object.assign({},f),l?{offset:l}:{}):f}function VV(e,t){return Jz(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:Jz(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:tH(t)}function qV(e){return e&&"number"!==e&&"time"!==e}function HV(e,t,n){return"".concat(e,"(").concat(t).concat(n?", ".concat(JSON.stringify(n)):"",")")}function GV(e){var t,n,r=e.fieldOrDatumDef,a=e.format,i=e.formatType,o=e.expr,u=e.normalizeStack,c=e.config;if(qV(i))return XV({fieldOrDatumDef:r,format:a,formatType:i,expr:o,config:c});var s=KV(r,o,u);if(Yq(r)){var l=function(e,t,n,r,a){return!t||n?(n=Az(n)?n:r,"".concat(a?"utc":"time","Format(").concat(e,", '").concat(n,"')")):function(e,t,n){if(e){var r=jU(e),a=n||yU(e);return"".concat(a?"utc":"time","Format(").concat(t,", ").concat(r,")")}}(t,e,a)}(s,bq(r)?null===(t=_U(r.timeUnit))||void 0===t?void 0:t.unit:void 0,a,c.timeFormat,_q(r)&&(null===(n=r.scale)||void 0===n?void 0:n.type)===oV);return l?{signal:l}:void 0}return a=JV(gq(r),a,c),bq(r)&&IB(r.bin)?{signal:eq(s,Nq(r,{expr:o,binSuffix:"end"}),a,i,c)}:a||"quantitative"===gq(r)?{signal:"".concat(QV(s,a))}:{signal:"isValid(".concat(s,") ? ").concat(s,' : ""+').concat(s)}}function KV(e,t,n){return bq(e)?n?"".concat(Nq(e,{expr:t,suffix:"end"}),"-").concat(Nq(e,{expr:t,suffix:"start"})):Nq(e,{expr:t}):function(e){var t=e.datum;return cU(t)?pU(t):"".concat(JSON.stringify(t))}(e)}function XV(e){var t=e.fieldOrDatumDef,n=e.format,r=e.formatType,a=e.expr,i=e.normalizeStack,o=e.config,u=e.field;return u=null!==u&&void 0!==u?u:KV(t,a,i),bq(t)&&IB(t.bin)?{signal:eq(u,Nq(t,{expr:a,binSuffix:"end"}),n,r,o)}:{signal:HV(r,u,n)}}function YV(e,t,n,r,a,i){var o;if(!qV(r))return Yq(e)?function(e,t,n,r){if(e)return e;if(t)return{signal:jU(t)};return r?void 0:n.timeFormat}(n,bq(e)?null===(o=_U(e.timeUnit))||void 0===o?void 0:o.unit:void 0,a,i):JV(t,n,a)}function $V(e,t,n){return e&&(EU(e)||"number"===e||"time"===e)?e:Yq(t)&&"time"!==n&&"utc"!==n?"time":void 0}function JV(e,t,n){return Az(t)?t:e===XU?n.numberFormat:void 0}function QV(e,t){return"format(".concat(e,', "').concat(t||"",'")')}function ZV(e,t,n,r){var a;return qV(n)?HV(n,e,t):QV(e,null!==(a=Az(t)?t:void 0)&&void 0!==a?a:r.numberFormat)}function eq(e,t,n,r,a){var i=ZV(e,n,r,a),o=ZV(t,n,r,a);return"".concat(HU(e,!1),' ? "null" : ').concat(i,' + "').concat(" \u2013 ",'" + ').concat(o)}var tq="min",nq={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function rq(e){return e in nq}function aq(e){return!!e&&!!e.encoding}function iq(e){return!!e&&("count"===e.op||!!e.field)}function oq(e){return!!e&&bz(e)}function uq(e){return"row"in e||"column"in e}function cq(e){return!!e&&"header"in e}function sq(e){return"facet"in e}function lq(e){var t=e.field,n=e.timeUnit,r=e.bin,a=e.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),a?{aggregate:a}:{}),{field:t})}function fq(e){return wq(e)&&"sort"in e}function dq(e){var t=e.channel,n=e.fieldDef,r=e.fieldDef2,a=e.markDef,i=e.stack,o=e.config,u=e.isMidPoint;if(kq(n)&&void 0!==n.band)return n.band;if(bq(n)){var c=n.timeUnit,s=n.bin;if(c&&!r)return u?oH("timeUnitBandPosition",a,o):$L(a.type)?oH("timeUnitBand",a,o):0;if(IB(s))return $L(a.type)&&!u?1:.5}return(null===i||void 0===i?void 0:i.fieldChannel)===t&&u?.5:void 0}function hq(e,t,n,r,a,i){return!!(IB(t.bin)||t.timeUnit&&wq(t)&&"temporal"===t.type)&&!!dq({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:a,config:i})}function pq(e){return!!e&&"condition"in e}function vq(e){var t=e&&e.condition;return!!t&&!bz(t)&&bq(t)}function mq(e){var t=e&&e.condition;return!!t&&!bz(t)&&kq(t)}function bq(e){return!!e&&(!!e.field||"count"===e.aggregate)}function gq(e){return e&&e.type}function yq(e){return!!e&&"datum"in e}function xq(e){return wq(e)&&Iq(e)||Oq(e)}function Oq(e){return yq(e)&&Cz(e.datum)}function kq(e){return bq(e)||yq(e)}function wq(e){return!!e&&("field"in e&&"type"in e||"count"===e.aggregate)}function jq(e){return e&&"value"in e&&"value"in e}function _q(e){return!!e&&("scale"in e||"sort"in e)}function Sq(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Eq(e){return!!e&&"legend"in e}function Cq(e){return!!e&&("format"in e||"formatType"in e)}function Aq(e){return"op"in e}function Nq(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.field,o=a.prefix,u=a.suffix,c="";if(Dq(e))i=jL("count");else{var s;if(!a.nofn)if(Aq(e))s=e.op;else{var l=e.bin,f=e.aggregate,d=e.timeUnit;IB(l)?(s=TB(l),u=(null!==(t=a.binSuffix)&&void 0!==t?t:"")+(null!==(n=a.suffix)&&void 0!==n?n:"")):f?sP(f)?(c='["'.concat(i,'"]'),i="argmax_".concat(f.argmax)):cP(f)?(c='["'.concat(i,'"]'),i="argmin_".concat(f.argmin)):s=String(f):d&&(s=SU(d),u=(!Jz(["range","mid"],a.binSuffix)&&a.binSuffix||"")+(null!==(r=a.suffix)&&void 0!==r?r:""))}s&&(i=i?"".concat(s,"_").concat(i):s)}return u&&(i="".concat(i,"_").concat(u)),o&&(i="".concat(o,"_").concat(i)),a.forAs?yL(i):a.expr?vL(i,a.expr)+c:bL(i)+c}function Tq(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return bq(e)&&!!e.bin;case"temporal":return!1}throw new Error(g.invalidFieldType(e.type))}function Iq(e){return!Tq(e)}function Dq(e){return"count"===e.aggregate}var Fq=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){var t=e.aggregate,n=e.bin,r=e.timeUnit,a=e.field;if(sP(t))return"".concat(a," for argmax(").concat(t.argmax,")");if(cP(t))return"".concat(a," for argmin(").concat(t.argmin,")");var i=_U(r),o=t||(null===i||void 0===i?void 0:i.unit)||(null===i||void 0===i?void 0:i.maxbins)&&"timeunit"||IB(n)&&"bin";return o?o.toUpperCase()+"("+a+")":a}(e);default:return function(e,t){var n,r=e.field,a=e.bin,i=e.timeUnit,o=e.aggregate;if("count"===o)return t.countTitle;if(IB(a))return"".concat(r," (binned)");if(i){var u=null===(n=_U(i))||void 0===n?void 0:n.unit;if(u)return"".concat(r," (").concat(OU(u).join("-"),")")}else if(o)return sP(o)?"".concat(r," for max ").concat(o.argmax):cP(o)?"".concat(r," for min ").concat(o.argmin):"".concat(hL(o)," of ").concat(r);return r}(e,t)}},Mq=Fq;function Rq(e){Mq=e}function zq(){Rq(Fq)}function Lq(e,t,n){var r,a,i=n.allowDisabling,o=n.includeDefault,u=void 0===o||o,c=(null!==(r=Pq(e))&&void 0!==r?r:{}).title;if(!bq(e))return c;var s=e,l=u?Bq(s,t):void 0;return i?OL(c,s.title,l):null!==(a=null!==c&&void 0!==c?c:s.title)&&void 0!==a?a:l}function Pq(e){return Sq(e)&&e.axis?e.axis:Eq(e)&&e.legend?e.legend:cq(e)&&e.header?e.header:void 0}function Bq(e,t){return Mq(e,t)}function Wq(e){var t;if(Cq(e))return{format:e.format,formatType:e.formatType};var n=null!==(t=Pq(e))&&void 0!==t?t:{};return{format:n.format,formatType:n.formatType}}function Uq(e){return bq(e)?e:vq(e)?e.condition:void 0}function Vq(e){return kq(e)?e:mq(e)?e.condition:void 0}function qq(e,t,n){if(Az(e)||Cz(e)||Ez(e)){var r=Az(e)?"string":Cz(e)?"number":"boolean";return uU(g.primitiveChannelDef(t,r,e)),{value:e}}return kq(e)?Hq(e,t,n):mq(e)?Object.assign(Object.assign({},e),{condition:Hq(e.condition,t,n)}):e}function Hq(e,t,n){if(Cq(e)){e.format;var r=e.formatType,a=Iz(e,["format","formatType"]);if(qV(r)&&!n.customFormatTypes)return uU(g.customFormatTypeNotAllowed(t)),Hq(a,t,n)}else{var i=Sq(e)?"axis":Eq(e)?"legend":cq(e)?"header":null;if(i&&e[i]){var o=e[i],u=(o.format,o.formatType),c=Iz(o,["format","formatType"]);if(qV(u)&&!n.customFormatTypes)return uU(g.customFormatTypeNotAllowed(t)),Hq(Object.assign(Object.assign({},e),Object(vt.a)({},i,c)),t,n)}}return bq(e)?Gq(e,t):function(e){var t=e.type;if(t)return e;var n=e.datum;return t=Cz(n)?"quantitative":Az(n)?"nominal":cU(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function Gq(e,t){var n=e.aggregate,r=e.timeUnit,a=e.bin,i=e.field,o=Object.assign({},e);if(!n||lP(n)||sP(n)||cP(n)||(uU(g.invalidAggregate(n)),delete o.aggregate),r&&(o.timeUnit=_U(r)),i&&(o.field="".concat(i)),IB(a)&&(o.bin=Kq(a,t)),DB(a)&&!gB(t)&&uU("Channel ".concat(t,' should not be used with "binned" bin.')),wq(o)){var u=o.type,c=function(e){if(e)switch(e=e.toLowerCase()){case"q":case XU:return"quantitative";case"t":case $U:return"temporal";case"o":case YU:return"ordinal";case"n":case JU:return"nominal";case QU:return"geojson"}}(u);u!==c&&(o.type=c),"quantitative"!==u&&dP(n)&&(uU(g.invalidFieldTypeForCountAggregate(u,n)),o.type="quantitative")}else if(!sB(t)){var s=function(e,t){if(e.timeUnit)return"temporal";if(IB(e.bin))return"quantitative";switch(NB(t)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}(o,t);uU(g.missingFieldType(t,s)),o.type=s}if(wq(o)){var l=function(e,t){var n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:"Channel ".concat(t," should not be used with a geojson data.")};switch(t){case vP:case mP:case bP:return Iq(e)?{compatible:!1,warning:g.facetChannelShouldBeDiscrete(t)}:Xq;case gP:case yP:case NP:case TP:case IP:case WP:case VP:case qP:case HP:case GP:case KP:case MP:case jP:case kP:case XP:return Xq;case EP:case AP:case SP:case CP:return n!==XU?{compatible:!1,warning:"Channel ".concat(t," should be used with a quantitative field only, not ").concat(e.type," field.")}:Xq;case RP:case zP:case LP:case PP:case FP:case _P:case wP:case xP:case OP:return"nominal"!==n||e.sort?Xq:{compatible:!1,warning:"Channel ".concat(t," should not be used with an unsorted discrete field.")};case BP:return Jz(["ordinal","nominal"],e.type)?Xq:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case DP:return Jz(["ordinal","nominal","geojson"],e.type)?Xq:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case UP:return"nominal"!==e.type||"sort"in e?Xq:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(o,t),f=l.compatible,d=l.warning;f||uU(d)}if(fq(o)&&Az(o.sort)){var h=o.sort;if(rq(h))return Object.assign(Object.assign({},o),{sort:{encoding:h}});var p=h.substr(1);if("-"===h.charAt(0)&&rq(p))return Object.assign(Object.assign({},o),{sort:{encoding:p,order:"descending"}})}if(cq(o)){var v=o.header,m=v.orient,b=Iz(v,["orient"]);if(m)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},b),{labelOrient:v.labelOrient||m,titleOrient:v.titleOrient||m})})}return o}function Kq(e,t){return Ez(e)?{maxbins:RB(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:RB(t)})}var Xq={compatible:!0};function Yq(e){var t,n=Wq(e).formatType;return"time"===n||!n&&((t=e)&&("temporal"===t.type||bq(t)&&!!t.timeUnit))}function $q(e,t){var n,r,a=t.timeUnit,i=t.type,o=t.wrapTime,u=t.undefinedIfExprNotRequired,c=a&&(null===(n=_U(a))||void 0===n?void 0:n.unit),s=c||"temporal"===i;return EU(e)?r=e.signal:cU(e)?(s=!0,r=pU(e)):(Az(e)||Cz(e))&&s&&(r="datetime(".concat(JSON.stringify(e),")"),function(e){return!!bU[e]}(c)&&(Cz(e)&&e<1e4||Az(e)&&isNaN(Date.parse(e)))&&(r=pU(Object(vt.a)({},c,e)))),r?o&&s?"time(".concat(r,")"):r:u?void 0:JSON.stringify(e)}function Jq(e,t){var n=e.type;return t.map((function(t){var r=$q(t,{timeUnit:bq(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:t}))}function Qq(e,t){return IB(e.bin)?SB(t)&&Jz(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function Zq(e){var t=e.anchor,n=e.frame,r=e.offset,a=e.orient,i=e.color,o=e.subtitleColor,u=e.subtitleFont,c=e.subtitleFontSize,s=e.subtitleFontStyle,l=e.subtitleFontWeight,f=e.subtitleLineHeight,d=e.subtitlePadding,h=Iz(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),i?{fill:i}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),a?{orient:a}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),u?{subtitleFont:u}:{}),c?{subtitleFontSize:c}:{}),s?{subtitleFontStyle:s}:{}),l?{subtitleFontWeight:l}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{});return{titleMarkConfig:p,subtitleMarkConfig:Gz(p,["align","baseline","dx","dy","limit"]),nonMark:v,subtitle:m}}function eH(e){return Az(e)||bz(e)&&Az(e[0])}function tH(e){return EU(e)?e:void 0!==e?{value:e}:void 0}function nH(e){return EU(e)?e.signal:Nz(e.value)}function rH(e){return EU(e)?e.signal:null==e?null:Nz(e)}function aH(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function iH(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.vgChannel,i=r.ignoreVgConfig;return a&&void 0!==t[a]?t[a]:void 0!==t[e]?t[e]:!i||a&&a!==e?oH(e,t,n,r):void 0}function oH(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.vgChannel;return OL(a?uH(e,t,n.style):void 0,uH(e,t,n.style),a?n[t.type][a]:void 0,n[t.type][e],a?n.mark[a]:n.mark[e])}function uH(e,t,n){return cH(e,aH(t),n)}function cH(e,t,n){var r;t=wz(t);var a,i=Object(mo.a)(t);try{for(i.s();!(a=i.n()).done;){var o=n[a.value];o&&void 0!==o[e]&&(r=o[e])}}catch(u){i.e(u)}finally{i.f()}return r}function sH(e,t){return wz(e).reduce((function(e,n){var r;return e.field.push(Nq(n,t)),e.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),e}),{field:[],order:[]})}function lH(e,t){var n=Object(Jc.a)(e);return t.forEach((function(e){var t,r=Object(mo.a)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(qz(a,e))return}}catch(i){r.e(i)}finally{r.f()}n.push(e)})),n}function fH(e,t){return qz(e,t)||!t?e:e?[].concat(Object(Jc.a)(wz(e)),Object(Jc.a)(wz(t))).join(", "):t}function dH(e,t){var n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((eH(n)||EU(n))&&(eH(r)||EU(r)))return{explicit:e.explicit,value:fH(n,r)};if(eH(n)||EU(n))return{explicit:e.explicit,value:n};if(eH(r)||EU(r))return{explicit:e.explicit,value:r};if(!eH(n)&&!EU(n)&&!eH(r)&&!EU(r))return{explicit:e.explicit,value:lH(n,r)};throw new Error("It should never reach here")}function hH(e,t){var n=e&&e[t];return!!n&&(bz(n)?Qz(n,(function(e){return!!e.field})):bq(n)||vq(n))}function pH(e){return Qz(aB,(function(t){if(hH(e,t)){var n=e[t];if(bz(n))return Qz(n,(function(e){return!!e.aggregate}));var r=Uq(n);return r&&!!r.aggregate}return!1}))}function vH(e,t){var n=[],r=[],a=[],i=[],o={};return gH(e,(function(u,c){if(bq(u)){var s=u.field,l=u.aggregate,f=u.bin,d=u.timeUnit,h=Iz(u,["field","aggregate","bin","timeUnit"]);if(l||d||f){var p,v=Pq(u),m=v&&v.title,b=Nq(u,{forAs:!0}),g=Object.assign(Object.assign(Object.assign({},m?[]:{title:Lq(u,t,{allowDisabling:!0})}),h),{field:b});if(l){if(sP(l)?(p="argmax",b=Nq({op:"argmax",field:l.argmax},{forAs:!0}),g.field="".concat(b,".").concat(s)):cP(l)?(p="argmin",b=Nq({op:"argmin",field:l.argmin},{forAs:!0}),g.field="".concat(b,".").concat(s)):"boxplot"!==l&&"errorbar"!==l&&"errorband"!==l&&(p=l),p){var y={op:p,as:b};s&&(y.field=s),i.push(y)}}else if(n.push(b),wq(u)&&IB(f)){if(r.push({bin:f,field:s,as:b}),n.push(Nq(u,{binSuffix:"end"})),Qq(u,c)&&n.push(Nq(u,{binSuffix:"range"})),gB(c)){var x={field:b+"_end"};o[c+"2"]=x}g.bin="binned",sB(c)||(g.type=XU)}else if(d){a.push({timeUnit:d,field:s,as:b});var O=wq(u)&&u.type!==$U&&"time";O&&(c===WP||c===HP?g.formatType=O:!function(e){return!!pB[e]}(c)?gB(c)&&(g.axis=Object.assign({formatType:O},g.axis)):g.legend=Object.assign({formatType:O},g.legend))}o[c]=g}else n.push(s),o[c]=e[c]}else o[c]=e[c]})),{bins:r,timeUnits:a,aggregate:i,groupby:n,encoding:o}}function mH(e,t,n){var r=t.type;return oL(e).reduce((function(a,i){if(!uB(i))return uU(g.invalidEncodingChannel(i)),a;var o=e[i];if("angle"!==i||"arc"!==r||e.theta||(uU(g.REPLACE_ANGLE_WITH_THETA),i=jP),!function(e,t,n){var r=EB(t,n);if(!r)return!1;if("binned"===r){var a=e[t===xP?gP:yP];return!!(bq(a)&&bq(e[t])&&DB(a.bin))}return!0}(e,i,r))return uU(g.incompatibleChannel(i,r)),a;if(i===FP&&"line"===r){var u=Uq(e[i]);if(null===u||void 0===u?void 0:u.aggregate)return uU(g.LINE_WITH_VARYING_SIZE),a}if(i===NP&&(t.filled?"fill"in e:"stroke"in e))return uU(g.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),a;if(i===VP||i===UP&&!bz(o)&&!jq(o)||i===HP&&bz(o))o&&(a[i]=wz(o).reduce((function(e,t){return bq(t)?e.push(Gq(t,i)):uU(g.emptyFieldDef(t,i)),e}),[]));else{if(i===HP&&null===o)a[i]=null;else if(!bq(o)&&!yq(o)&&!jq(o)&&!pq(o)&&!EU(o))return uU(g.emptyFieldDef(o,i)),a;a[i]=qq(o,i,n)}return a}),{})}function bH(e){var t,n=[],r=Object(mo.a)(oL(e));try{for(r.s();!(t=r.n()).done;){var a=t.value;if(hH(e,a)){var i,o=e[a],u=wz(o),c=Object(mo.a)(u);try{for(c.s();!(i=c.n()).done;){var s=i.value;bq(s)?n.push(s):vq(s)&&n.push(s.condition)}}catch(l){c.e(l)}finally{c.f()}}}}catch(l){r.e(l)}finally{r.f()}return n}function gH(e,t,n){if(e){var r,a=Object(mo.a)(oL(e));try{for(a.s();!(r=a.n()).done;){var i=r.value,o=e[i];if(bz(o)){var u,c=Object(mo.a)(o);try{for(c.s();!(u=c.n()).done;){var s=u.value;t.call(n,s,i)}}catch(l){c.e(l)}finally{c.f()}}else t.call(n,o,i)}}catch(l){a.e(l)}finally{a.f()}}}function yH(e,t,n,r){return e?oL(e).reduce((function(n,a){var i=e[a];return bz(i)?i.reduce((function(e,n){return t.call(r,e,n,a)}),n):t.call(r,n,i,a)}),n):n}function xH(e,t){return oL(t).reduce((function(n,r){switch(r){case gP:case yP:case GP:case XP:case KP:case xP:case OP:case jP:case _P:case kP:case wP:case SP:case EP:case CP:case AP:case WP:case DP:case MP:case HP:return n;case UP:if("line"===e||"trail"===e)return n;case VP:case qP:var a=t[r];if(bz(a)||bq(a)){var i,o=Object(mo.a)(wz(a));try{for(o.s();!(i=o.n()).done;){var u=i.value;u.aggregate||n.push(Nq(u,{}))}}catch(s){o.e(s)}finally{o.f()}}return n;case FP:if("trail"===e)return n;case NP:case TP:case IP:case RP:case zP:case LP:case BP:case PP:var c=Uq(t[r]);return c&&!c.aggregate&&n.push(Nq(c,{})),n}}),[])}function OH(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};var a=e.map((function(e){var n=e.fieldPrefix,a=e.titlePrefix,i=r?" of ".concat(t.field):"";return{field:n+t.field,type:t.type,title:EU(a)?{signal:a+'"'.concat(escape(i),'"')}:a+i}}));return{tooltip:[].concat(Object(Jc.a)(a),Object(Jc.a)(bH(n)))}}function kH(e){var t=e.axis,n=e.title,r=e.field;return t&&void 0!==t.title?void 0:OL(n,r)}function wH(e,t,n,r,a){var i=n.scale,o=n.axis;return function(u){var c=u.partName,s=u.mark,l=u.positionPrefix,f=u.endPositionPrefix,d=void 0===f?void 0:f,h=u.aria,p=u.extraEncoding,v=void 0===p?{}:p,m=kH(n);return jH(e,c,a,h,{mark:s,encoding:Object.assign(Object.assign(Object.assign(Object(vt.a)({},t,Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==m?{title:m}:{}),void 0!==i?{scale:i}:{}),void 0!==o?{axis:o}:{})),Az(d)?Object(vt.a)({},t+"2",{field:d+"_"+n.field}):{}),r),v)})}}function jH(e,t,n,r,a){var i=e.clip,o=e.color,u=e.opacity,c=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},a),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),o?{color:o}:{}),u?{opacity:u}:{}),QL(a.mark)?a.mark:{type:a.mark}),{style:"".concat(c,"-").concat(t)}),Ez(e[t])?{}:e[t]),!1===r?{aria:r}:{})})]:[]}function _H(e,t,n){var r=e.encoding,a="vertical"===t?"y":"x",i=r[a],o=r[a+"2"],u=r[a+"Error"],c=r[a+"Error2"];return{continuousAxisChannelDef:SH(i,n),continuousAxisChannelDef2:SH(o,n),continuousAxisChannelDefError:SH(u,n),continuousAxisChannelDefError2:SH(c,n),continuousAxis:a}}function SH(e,t){if(e&&e.aggregate){var n=e.aggregate,r=Iz(e,["aggregate"]);return n!==t&&uU(g.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}return e}function EH(e,t){var n=e.mark,r=e.encoding,a=r.x,i=r.y;if(xq(a)){if(xq(i)){var o=bq(a)&&a.aggregate,u=bq(i)&&i.aggregate;if(o||u!==t){if(u||o!==t){if(o===t&&u===t)throw new Error("Both x and y cannot have aggregate");return QL(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(xq(i))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}var CH="boxplot",AH=new iP(CH,TH);function NH(e){return Cz(e)?"tukey":e}function TH(e,t){var n,r,a=t.config,i=e.mark,o=(e.encoding,e.selection),u=(e.projection,Iz(e,["mark","encoding","selection","projection"])),c=QL(i)?i:{type:i};o&&uU(g.selectionNotSupported("boxplot"));var s,l=null!==(n=c.extent)&&void 0!==n?n:a.boxplot.extent,f=iH("size",c,a),d=NH(l),h=function(e,t,n){var r=EH(e,CH),a=_H(e,r,CH),i=a.continuousAxisChannelDef,o=a.continuousAxis,u=i.field,c=NH(t),s=[].concat(Object(Jc.a)(IH(u)),[{op:"median",field:u,as:"mid_box_"+u},{op:"min",field:u,as:("min-max"===c?"lower_whisker_":"min_")+u},{op:"max",field:u,as:("min-max"===c?"upper_whisker_":"max_")+u}]),l="min-max"===c||"tukey"===c?[]:[{calculate:'datum["upper_box_'.concat(u,'"] - datum["lower_box_').concat(u,'"]'),as:"iqr_"+u},{calculate:'min(datum["upper_box_'.concat(u,'"] + datum["iqr_').concat(u,'"] * ').concat(t,', datum["max_').concat(u,'"])'),as:"upper_whisker_"+u},{calculate:'max(datum["lower_box_'.concat(u,'"] - datum["iqr_').concat(u,'"] * ').concat(t,', datum["min_').concat(u,'"])'),as:"lower_whisker_"+u}],f=e.encoding,d=o,h=(f[d],function(e){var t,n,r=e.tooltip,a=Iz(e,["tooltip"]);if(!r)return{filteredEncoding:e};if(bz(r)){var i,o=Object(mo.a)(r);try{for(o.s();!(i=o.n()).done;){var u=i.value;u.aggregate?(t||(t=[]),t.push(u)):(n||(n=[]),n.push(u))}}catch(c){o.e(c)}finally{o.f()}t&&(a.tooltip=t)}else r.aggregate?a.tooltip=r:n=r;return bz(n)&&1===n.length&&(n=n[0]),{customTooltipWithoutAggregatedField:n,filteredEncoding:a}}(Iz(f,["symbol"===typeof d?d:d+""]))),p=h.customTooltipWithoutAggregatedField,v=vH(h.filteredEncoding,n),m=v.bins,b=v.timeUnits,g=v.aggregate,y=v.groupby,x=v.encoding,O="vertical"===r?"horizontal":"vertical",k=r;return{transform:[].concat(Object(Jc.a)(m),Object(Jc.a)(b),[{aggregate:[].concat(Object(Jc.a)(g),Object(Jc.a)(s)),groupby:y}],l),groupby:y,aggregate:g,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:x,ticksOrient:O,boxOrient:k,customTooltipWithoutAggregatedField:p}}(e,l,a),p=h.transform,v=h.continuousAxisChannelDef,m=h.continuousAxis,b=h.groupby,y=h.aggregate,x=h.encodingWithoutContinuousAxis,O=h.ticksOrient,k=h.boxOrient,w=h.customTooltipWithoutAggregatedField,j=(x.color,x.size),_=Iz(x,["color","size"]),S=function(e){return wH(c,m,v,e,a.boxplot)},E=S(_),C=S(x),A=S(Object.assign(Object.assign({},_),j?{size:j}:{})),N=OH([{fieldPrefix:"min-max"===d?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===d?"lower_whisker_":"min_",titlePrefix:"Min"}],v,x),T={type:"tick",color:"black",opacity:1,orient:O,invalid:null},I="min-max"===d?N:OH([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,x),D=[].concat(Object(Jc.a)(E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:I})),Object(Jc.a)(E({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:I})),Object(Jc.a)(E({partName:"ticks",mark:T,positionPrefix:"lower_whisker",aria:!1,extraEncoding:I})),Object(Jc.a)(E({partName:"ticks",mark:T,positionPrefix:"upper_whisker",aria:!1,extraEncoding:I}))),F=[].concat(Object(Jc.a)("tukey"!==d?D:[]),Object(Jc.a)(C({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:k,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:N})),Object(Jc.a)(A({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},gz(a.boxplot.median)&&a.boxplot.median.color?{color:a.boxplot.median.color}:{}),f?{size:f}:{}),{orient:O,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:N})));if("min-max"!==d){var M='datum["lower_box_'.concat(v.field,'"]'),R='datum["upper_box_'.concat(v.field,'"]'),z="(".concat(R," - ").concat(M,")"),L="".concat(M," - ").concat(l," * ").concat(z),P="".concat(R," + ").concat(l," * ").concat(z),B='datum["'.concat(v.field,'"]'),W={joinaggregate:IH(v.field),groupby:b},U=void 0;"tukey"===d&&(U={transform:[{filter:"(".concat(L," <= ").concat(B,") && (").concat(B," <= ").concat(P,")")},{aggregate:[{op:"min",field:v.field,as:"lower_whisker_"+v.field},{op:"max",field:v.field,as:"upper_whisker_"+v.field},{op:"min",field:"lower_box_"+v.field,as:"lower_box_"+v.field},{op:"max",field:"upper_box_"+v.field,as:"upper_box_"+v.field}].concat(Object(Jc.a)(y)),groupby:b}],layer:D});_.tooltip;var V=Iz(_,["tooltip"]),q=v.scale,H=v.axis,G=kH(v),K=jH(c,"outliers",a.boxplot,!0,{transform:[{filter:"(".concat(B," < ").concat(L,") || (").concat(B," > ").concat(P,")")}],mark:"point",encoding:Object.assign(Object.assign(Object(vt.a)({},m,Object.assign(Object.assign(Object.assign({field:v.field,type:v.type},void 0!==G?{title:G}:{}),void 0!==q?{scale:q}:{}),void 0!==H?{axis:H}:{})),V),w?{tooltip:w}:{})})[0];K&&U?s={transform:[W],layer:[K,U]}:K?(s=K).transform.unshift(W):U&&(s=U).transform.unshift(W)}return s?Object.assign(Object.assign({},u),{layer:[s,{transform:p,layer:F}]}):Object.assign(Object.assign({},u),{transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(p),layer:F})}function IH(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}var DH="errorbar",FH=new iP(DH,MH);function MH(e,t){var n=t.config,r=zH(e,DH,n),a=r.transform,i=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,c=r.ticksOrient,s=r.markDef,l=r.outerSpec,f=r.tooltipEncoding,d=wH(s,o,i,u,n.errorbar),h={type:"tick",orient:c},p=[].concat(Object(Jc.a)(d({partName:"ticks",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:f})),Object(Jc.a)(d({partName:"ticks",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:f})),Object(Jc.a)(d({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f})));return Object.assign(Object.assign(Object.assign({},l),{transform:a}),p.length>1?{layer:p}:Object.assign({},p[0]))}function RH(e,t){var n=e.encoding;if(function(e){return(kq(e.x)||kq(e.y))&&!kq(e.x2)&&!kq(e.y2)&&!kq(e.xError)&&!kq(e.xError2)&&!kq(e.yError)&&!kq(e.yError2)}(n))return{orient:EH(e,t),inputType:"raw"};var r=function(e){return kq(e.x2)||kq(e.y2)}(n),a=function(e){return kq(e.xError)||kq(e.xError2)||kq(e.yError)||kq(e.yError2)}(n),i=n.x,o=n.y;if(r){if(a)throw new Error("".concat(t," cannot be both type aggregated-upper-lower and aggregated-error"));var u=n.x2,c=n.y2;if(kq(u)&&kq(c))throw new Error("".concat(t," cannot have both x2 and y2"));if(kq(u)){if(xq(i))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(t))}if(kq(c)){if(xq(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(t))}throw new Error("No ranged axis")}var s=n.xError,l=n.xError2,f=n.yError,d=n.yError2;if(kq(l)&&!kq(s))throw new Error("".concat(t," cannot have xError2 without xError"));if(kq(d)&&!kq(f))throw new Error("".concat(t," cannot have yError2 without yError"));if(kq(s)&&kq(f))throw new Error("".concat(t," cannot have both xError and yError with both are quantiative"));if(kq(s)){if(xq(i))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(kq(f)){if(xq(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}function zH(e,t,n){var r,a=e.mark,i=e.encoding,o=e.selection,u=(e.projection,Iz(e,["mark","encoding","selection","projection"])),c=QL(a)?a:{type:a};o&&uU(g.selectionNotSupported(t));var s=RH(e,t),l=s.orient,f=s.inputType,d=_H(e,l,t),h=d.continuousAxisChannelDef,p=d.continuousAxisChannelDef2,v=d.continuousAxisChannelDefError,m=d.continuousAxisChannelDefError2,b=d.continuousAxis,y=function(e,t,n,r,a,i,o,u){var c,s=[],l=[],f=t.field,d=!1;if("raw"===i){var h,p,v,m=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":u.errorbar.center,b=e.extent?e.extent:"mean"===m?"stderr":"iqr";if("median"===m!==("iqr"===b)&&uU(g.errorBarCenterIsUsedWithWrongExtent(m,b,o)),"stderr"===b||"stdev"===b)s=[{op:b,field:f,as:"extent_"+f},{op:m,field:f,as:"center_"+f}],l=[{calculate:'datum["center_'.concat(f,'"] + datum["extent_').concat(f,'"]'),as:"upper_"+f},{calculate:'datum["center_'.concat(f,'"] - datum["extent_').concat(f,'"]'),as:"lower_"+f}],c=[{fieldPrefix:"center_",titlePrefix:hL(m)},{fieldPrefix:"upper_",titlePrefix:LH(m,b,"+")},{fieldPrefix:"lower_",titlePrefix:LH(m,b,"-")}],d=!0;else e.center&&e.extent&&uU(g.errorBarCenterIsNotNeeded(e.extent,o)),"ci"===b?(h="mean",p="ci0",v="ci1"):(h="median",p="q1",v="q3"),s=[{op:p,field:f,as:"lower_"+f},{op:v,field:f,as:"upper_"+f},{op:h,field:f,as:"center_"+f}],c=[{fieldPrefix:"upper_",titlePrefix:Lq({field:f,aggregate:v,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Lq({field:f,aggregate:p,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Lq({field:f,aggregate:h,type:"quantitative"},u,{allowDisabling:!1})}]}else{(e.center||e.extent)&&uU(g.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),"aggregated-upper-lower"===i?(c=[],l=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_"+f},{calculate:'datum["'.concat(f,'"]'),as:"lower_"+f}]):"aggregated-error"===i&&(c=[{fieldPrefix:"",titlePrefix:f}],l=[{calculate:'datum["'.concat(f,'"] + datum["').concat(r.field,'"]'),as:"upper_"+f}],a?l.push({calculate:'datum["'.concat(f,'"] + datum["').concat(a.field,'"]'),as:"lower_"+f}):l.push({calculate:'datum["'.concat(f,'"] - datum["').concat(r.field,'"]'),as:"lower_"+f}));var y,x=Object(mo.a)(l);try{for(x.s();!(y=x.n()).done;){var O=y.value;c.push({fieldPrefix:O.as.substring(0,6),titlePrefix:gL(gL(O.calculate,'datum["',""),'"]',"")})}}catch(k){x.e(k)}finally{x.f()}}return{postAggregateCalculates:l,errorBarSpecificAggregate:s,tooltipSummary:c,tooltipTitleWithFieldName:d}}(c,h,p,v,m,f,t,n),x=y.errorBarSpecificAggregate,O=y.postAggregateCalculates,k=y.tooltipSummary,w=y.tooltipTitleWithFieldName,j=i,_=b,S=(j[_],"x"===b?"x2":"y2"),E=(j[S],"x"===b?"xError":"yError"),C=(j[E],"x"===b?"xError2":"yError2"),A=(j[C],vH(Iz(j,["symbol"===typeof _?_:_+"","symbol"===typeof S?S:S+"","symbol"===typeof E?E:E+"","symbol"===typeof C?C:C+""]),n)),N=A.bins,T=A.timeUnits,I=A.aggregate,D=A.groupby,F=A.encoding,M=[].concat(Object(Jc.a)(I),Object(Jc.a)(x)),R="raw"!==f?[]:D,z=OH(k,h,F,w);return{transform:[].concat(Object(Jc.a)(null!==(r=u.transform)&&void 0!==r?r:[]),Object(Jc.a)(N),Object(Jc.a)(T),Object(Jc.a)(0===M.length?[]:[{aggregate:M,groupby:R}]),Object(Jc.a)(O)),groupby:R,continuousAxisChannelDef:h,continuousAxis:b,encodingWithoutContinuousAxis:F,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:c,outerSpec:u,tooltipEncoding:z}}function LH(e,t,n){return hL(e)+" "+n+" "+t}var PH="errorband",BH=new iP(PH,WH);function WH(e,t){var n=t.config,r=zH(e,PH,n),a=r.transform,i=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,c=r.markDef,s=r.outerSpec,l=r.tooltipEncoding,f=c,d=wH(f,o,i,u,n.errorband),h=void 0!==e.encoding.x&&void 0!==e.encoding.y,p={type:h?"area":"rect"},v={type:h?"line":"rule"},m=Object.assign(Object.assign({},f.interpolate?{interpolate:f.interpolate}:{}),f.tension&&f.interpolate?{tension:f.tension}:{});return h?(p=Object.assign(Object.assign(Object.assign({},p),m),{ariaRoleDescription:"errorband"}),v=Object.assign(Object.assign({},v),m)):f.interpolate?uU(g.errorBand1DNotSupport("interpolate")):f.tension&&uU(g.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},s),{transform:a,layer:[].concat(Object(Jc.a)(d({partName:"band",mark:p,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})),Object(Jc.a)(d({partName:"borders",mark:v,positionPrefix:"lower",aria:!1,extraEncoding:l})),Object(Jc.a)(d({partName:"borders",mark:v,positionPrefix:"upper",aria:!1,extraEncoding:l})))})}var UH={};function VH(e,t,n){var r=new iP(e,t);UH[e]={normalizer:r,parts:n}}VH(CH,TH,["box","median","outliers","rule","ticks"]),VH(DH,MH,["ticks","rule"]),VH(PH,WH,["band","borders"]);var qH=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],HH=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],GH={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},KH={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},XH=(oL(KH),"_vgsid_"),YH={single:{on:"click",fields:[XH],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[XH],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function $H(e){return!!e&&("legend"===e||!!e.legend)}function JH(e){return $H(e)&&gz(e)}function QH(e){return"concat"in e}function ZH(e){return"vconcat"in e}function eG(e){return"hconcat"in e}function tG(e){return gz(e)&&void 0!==e.step}function nG(e){return e.view||e.width||e.height}var rG=oL({align:1,bounds:1,center:1,columns:1,spacing:1});function aG(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function iG(e,t){var n=oG(e,t);return tG(n)?n.step:uG}function oG(e,t){var n;return OL(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}var uG=20;var cG={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:uG},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:nP,circle:{},geoshape:{},image:{},line:{},point:{},rect:rP,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:YH,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},sG=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],lG={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},fG={blue:sG[0],orange:sG[1],red:sG[2],teal:sG[3],green:sG[4],yellow:sG[5],purple:sG[6],pink:sG[7],brown:sG[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function dG(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:gz(e)?Object.assign(Object.assign({},fG),e):fG}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function hG(e){return{signals:[{name:"fontSize",value:gz(e)?Object.assign(Object.assign({},lG),e):lG}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function pG(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function vG(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.color,n=e.font,r=e.fontSize,a=Iz(e,["color","font","fontSize"]);return xz({},cG,n?pG(n):{},t?dG(t):{},r?hG(r):{},a||{})}var mG=["view"].concat(Object(Jc.a)(JL)),bG=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],gG=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function yG(e){e=Hz(e);var t,n=Object(mo.a)(bG);try{for(n.s();!(t=n.n()).done;){delete e[t.value]}}catch(w){n.e(w)}finally{n.f()}if(e.axis)for(var r in e.axis)CL(e.axis[r])&&delete e.axis[r];if(e.legend){var a,i=Object(mo.a)(qH);try{for(i.s();!(a=i.n()).done;){var o=a.value;delete e.legend[o]}}catch(w){i.e(w)}finally{i.f()}}if(e.mark){var u,c=Object(mo.a)(eP);try{for(c.s();!(u=c.n()).done;){var s=u.value;delete e.mark[s]}}catch(w){c.e(w)}finally{c.f()}e.mark.tooltip&&gz(e.mark.tooltip)&&delete e.mark.tooltip}var l,f=Object(mo.a)(mG);try{for(f.s();!(l=f.n()).done;){var d,h=l.value,p=Object(mo.a)(eP);try{for(p.s();!(d=p.n()).done;){var v=d.value;delete e[h][v]}}catch(w){p.e(w)}finally{p.f()}var m=gG[h];if(m){var b,g=Object(mo.a)(m);try{for(g.s();!(b=g.n()).done;){var y=b.value;delete e[h][y]}}catch(w){g.e(w)}finally{g.f()}}xG(e,h)}}catch(w){f.e(w)}finally{f.f()}var x,O=Object(mo.a)(oL(UH));try{for(O.s();!(x=O.n()).done;){delete e[x.value]}}catch(w){O.e(w)}finally{O.f()}for(var k in function(e){var t=Zq(e.title),n=t.titleMarkConfig,r=t.subtitleMarkConfig,a=t.subtitle;iL(n)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),n));iL(r)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),r));iL(a)?delete e.title:e.title=a}(e),e)gz(e[k])&&iL(e[k])&&delete e[k];return iL(e)?void 0:e}function xG(e,t,n,r){var a=r?e[t][r]:e[t];"view"===t&&(n="cell");var i=Object.assign(Object.assign({},a),e.style[null!==n&&void 0!==n?n:t]);iL(i)||(e.style[null!==n&&void 0!==n?n:t]=i),r||delete e[t]}function OG(e){return"layer"in e}var kG=n(25),wG=n(23),jG=n(14),_G=n(15),SG=function(){function e(){Object(iO.a)(this,e)}return Object(oO.a)(e,[{key:"map",value:function(e,t){return sq(e)?this.mapFacet(e,t):function(e){return"repeat"in e}(e)?this.mapRepeat(e,t):eG(e)?this.mapHConcat(e,t):ZH(e)?this.mapVConcat(e,t):QH(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}},{key:"mapLayerOrUnit",value:function(e,t){if(OG(e))return this.mapLayer(e,t);if(aP(e))return this.mapUnit(e,t);throw new Error(g.invalidSpec(e))}},{key:"mapLayer",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{layer:e.layer.map((function(e){return n.mapLayerOrUnit(e,t)}))})}},{key:"mapHConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map((function(e){return n.map(e,t)}))})}},{key:"mapVConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map((function(e){return n.map(e,t)}))})}},{key:"mapConcat",value:function(e,t){var n=this,r=e.concat,a=Iz(e,["concat"]);return Object.assign(Object.assign({},a),{concat:r.map((function(e){return n.map(e,t)}))})}},{key:"mapFacet",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}},{key:"mapRepeat",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}]),e}(),EG={zero:1,center:1,normalize:1};function CG(e){return e in EG}var AG=new Set([ML,zL,RL,UL,BL,GL,KL,PL,VL,qL]),NG=new Set([zL,RL,ML]);function TG(e,t){var n,r,a="x"===t?"y":"radius",i=e[t],o=e[a];if(bq(i)&&bq(o))if("quantitative"===gq(i)&&"quantitative"===gq(o)){if(i.stack)return t;if(o.stack)return a;var u=bq(i)&&!!i.aggregate;if(u!==(bq(o)&&!!o.aggregate))return u?t:a;var c=null===(n=i.scale)||void 0===n?void 0:n.type,s=null===(r=o.scale)||void 0===r?void 0:r.type;if(c&&"linear"!==c)return a;if(s&&"linear"!==s)return t}else{if("quantitative"===gq(i))return t;if("quantitative"===gq(o))return a}else{if("quantitative"===gq(i))return t;if("quantitative"===gq(o))return a}}function IG(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function DG(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=QL(e)?e.type:e;if(!AG.has(r))return null;var a=TG(t,"x")||TG(t,"theta");if(!a)return null;var i=t[a],o=bq(i)?Nq(i,{}):void 0,u=IG(a),c=t[u],s=bq(c)?Nq(c,{}):void 0;s===o&&(s=void 0,c=void 0,u=void 0);var l,f=vB.reduce((function(e,n){if("tooltip"!==n&&hH(t,n)){var r,a=t[n],i=Object(mo.a)(wz(a));try{for(i.s();!(r=i.n()).done;){var o=Uq(r.value);if(!o.aggregate){var u=Nq(o,{});u&&u===s||e.push({channel:n,fieldDef:o})}}}catch(c){i.e(c)}finally{i.f()}}return e}),[]);if(void 0!==i.stack?l=Ez(i.stack)?i.stack?"zero":null:i.stack:f.length>0&&NG.has(r)&&(l="zero"),!l||!CG(l))return null;if(pH(t)&&0===f.length)return null;if(i.scale&&i.scale.type&&i.scale.type!==eV){if(n.disallowNonLinearStack)return null;uU(g.cannotStackNonLinearScale(i.scale.type))}return kq(t[dB(a)])?(void 0!==i.stack&&uU(g.cannotStackRangedMark(a)),null):(bq(i)&&i.aggregate&&!Jz(hP,i.aggregate)&&uU(g.stackNonSummativeAggregate(i.aggregate)),{groupbyChannel:c?u:void 0,groupbyField:s,fieldChannel:a,impute:null!==i.impute&&YL(r),stackBy:f,offset:l})}function FG(e){e.point,e.line;var t=Iz(e,["point","line"]);return oL(t).length>1?t:t.type}function MG(e){for(var t=0,n=["line","area","rule","trail"];t<n.length;t++){var r=n[t];e[r]&&(e=Object.assign(Object.assign({},e),Object(vt.a)({},r,Kz(e[r],["point","line"]))))}return e}function RG(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===e.point?{opacity:0}:e.point?gz(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?gz(t.point)?t.point:{}:void 0}function zG(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}var LG=function(){function e(){Object(iO.a)(this,e),this.name="path-overlay"}return Object(oO.a)(e,[{key:"hasMatchingType",value:function(e,t){if(aP(e)){var n=e.mark,r=e.encoding,a=QL(n)?n:{type:n};switch(a.type){case"line":case"rule":case"trail":return!!RG(a,t[a.type],r);case"area":return!!RG(a,t[a.type],r)||!!zG(a,t[a.type])}}return!1}},{key:"run",value:function(e,t,n){var r=t.config,a=e.selection,i=e.projection,o=e.encoding,u=e.mark,c=Iz(e,["selection","projection","encoding","mark"]),s=QL(u)?u:{type:u},l=RG(s,r[s.type],o),f="area"===s.type&&zG(s,r[s.type]),d=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:FG(Object.assign(Object.assign({},"area"===s.type&&void 0===s.opacity&&void 0===s.fillOpacity?{opacity:.7}:{}),s)),encoding:Kz(o,["shape"])})],h=DG(s,o),p=o;if(h){var v=h.fieldChannel,m=h.offset;p=Object.assign(Object.assign({},o),Object(vt.a)({},v,Object.assign(Object.assign({},o[v]),m?{stack:m}:{})))}return f&&d.push(Object.assign(Object.assign({},i?{projection:i}:{}),{mark:Object.assign(Object.assign({type:"line"},Gz(s,["clip","interpolate","tension","tooltip"])),f),encoding:p})),l&&d.push(Object.assign(Object.assign({},i?{projection:i}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Gz(s,["clip","tooltip"])),l),encoding:p})),n(Object.assign(Object.assign({},c),{layer:d}),Object.assign(Object.assign({},t),{config:MG(r)}))}}]),e}(),PG=function(){function e(){Object(iO.a)(this,e),this.name="RangeStep"}return Object(oO.a)(e,[{key:"hasMatchingType",value:function(e){var t;if(aP(e)&&e.encoding){var n,r=Object(mo.a)(bB);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=e.encoding[a];if(i&&kq(i)&&(null===(t=null===i||void 0===i?void 0:i.scale)||void 0===t?void 0:t.rangeStep))return!0}}catch(o){r.e(o)}finally{r.f()}}return!1}},{key:"run",value:function(e){var t,n,r={},a=Object.assign({},e.encoding),i=Object(mo.a)(bB);try{for(i.s();!(n=i.n()).done;){var o=n.value,u=hB(o),c=a[o];if(c&&kq(c)&&(null===(t=null===c||void 0===c?void 0:c.scale)||void 0===t?void 0:t.rangeStep)){var s=c.scale,l=Iz(c,["scale"]),f=s,d=(f.rangeStep,Iz(f,["rangeStep"]));r[u]={step:s.rangeStep},uU(g.RANGE_STEP_DEPRECATED),a=Object.assign(Object.assign({},a),Object(vt.a)({},o,Object.assign(Object.assign({},l),iL(d)?{}:{scale:d})))}}}catch(h){i.e(h)}finally{i.f()}return Object.assign(Object.assign(Object.assign({},r),e),{encoding:a})}}]),e}();function BG(e,t){return t?uq(e)?GG(e,t):VG(e,t):e}function WG(e,t){return t?GG(e,t):e}function UG(e,t,n){var r,a=t[e];return(r=a)&&!Az(r)&&"repeat"in r?a.repeat in n?Object.assign(Object.assign({},t),Object(vt.a)({},e,n[a.repeat])):void uU(g.noSuchRepeatedValue(a.repeat)):t}function VG(e,t){if(void 0!==(e=UG("field",e,t))){if(null===e)return null;if(fq(e)&&iq(e.sort)){var n=UG("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function qG(e,t){if(bq(e))return VG(e,t);var n=UG("datum",e,t);return n===e||n.type||(n.type="nominal"),n}function HG(e,t){if(!kq(e)){if(mq(e)){var n=qG(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});e.condition;return Iz(e,["condition"])}return e}var r=qG(e,t);return r||(pq(e)?{condition:e.condition}:void 0)}function GG(e,t){var n={};for(var r in e)if(Sz(e,r)){var a=e[r];if(bz(a))n[r]=a.map((function(e){return HG(e,t)})).filter((function(e){return e}));else{var i=HG(a,t);void 0!==i&&(n[r]=i)}}return n}var KG=function(){function e(){Object(iO.a)(this,e),this.name="RuleForRangedLine"}return Object(oO.a)(e,[{key:"hasMatchingType",value:function(e){if(aP(e)){var t=e.encoding;if("line"===e.mark){var n,r=Object(mo.a)(cB);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=t[lB(a)];if(t[a]&&(bq(i)&&!DB(i.bin)||yq(i)))return!0}}catch(o){r.e(o)}finally{r.f()}}}return!1}},{key:"run",value:function(e,t,n){var r=e.encoding;return uU(g.lineWithRange(!!r.x2,!!r.y2)),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}]),e}();function XG(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var r=oL(t).reduce((function(e,t){return n[t]&&e.push(t),e}),[]);r.length>0&&uU(g.encodingOverridden(r))}var a=Object.assign(Object.assign({},null!==t&&void 0!==t?t:{}),null!==n&&void 0!==n?n:{});return iL(a)?void 0:a}function YG(e){var t=e.parentProjection,n=e.projection;return t&&n&&uU(g.projectionOverridden({parentProjection:t,projection:n})),null!==n&&void 0!==n?n:t}function $G(e,t){void 0===t&&(t=vG(e.config));var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return JG.map(e,{config:t})}(e,t),r=function(e,t,n){var r=t.width,a=t.height,i=aP(e)||OG(e),o={};i?"container"==r&&"container"==a?(o.type="fit",o.contains="padding"):"container"==r?(o.type="fit-x",o.contains="padding"):"container"==a&&(o.type="fit-y",o.contains="padding"):("container"==r&&(uU(g.containerSizeNonSingle("width")),r=void 0),"container"==a&&(uU(g.containerSizeNonSingle("height")),a=void 0));var u=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?QG(n.autosize):{}),QG(e.autosize));"fit"!==u.type||i||(uU(g.FIT_NON_SINGLE),u.type="pad");"container"==r&&"fit"!=u.type&&"fit-x"!=u.type&&uU(g.containerSizeNotCompatibleWithAutosize("width"));"container"==a&&"fit"!=u.type&&"fit-y"!=u.type&&uU(g.containerSizeNotCompatibleWithAutosize("height"));if(qz(u,{type:"pad"}))return;return u}(n,{width:e.width,height:e.height,autosize:e.autosize},t);return Object.assign(Object.assign({},n),r?{autosize:r}:{})}var JG=new(function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){var e;return Object(iO.a)(this,n),(e=t.apply(this,arguments)).nonFacetUnitNormalizers=[AH,FH,BH,new LG,new KG,new PG],e}return Object(oO.a)(n,[{key:"map",value:function(e,t){if(aP(e)){var r=hH(e.encoding,vP),a=hH(e.encoding,mP),i=hH(e.encoding,bP);if(r||a||i)return this.mapFacetedUnit(e,t)}return Object(kG.a)(Object(wG.a)(n.prototype),"map",this).call(this,e,t)}},{key:"mapUnit",value:function(e,t){var n=t.parentEncoding,r=t.parentProjection,a=Object.assign(Object.assign({},e),{encoding:WG(e.encoding,t.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(a,t);var i,o=this.mapLayerOrUnit.bind(this),u=Object(mo.a)(this.nonFacetUnitNormalizers);try{for(u.s();!(i=u.n()).done;){var c=i.value;if(c.hasMatchingType(a,t.config))return c.run(a,t,o)}}catch(s){u.e(s)}finally{u.f()}return a}},{key:"mapRepeat",value:function(e,t){return function(e){return!bz(e.repeat)&&e.repeat.layer}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}},{key:"mapLayerRepeat",value:function(e,t){var n=this,r=e.repeat,a=e.spec,i=Iz(e,["repeat","spec"]),o=r.row,u=r.column,c=r.layer,s=t.repeater,l=void 0===s?{}:s,f=t.repeaterPrefix,d=void 0===f?"":f;return o||u?this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),u?{column:u}:{}),spec:{repeat:{layer:c},spec:a}}),t):Object.assign(Object.assign({},i),{layer:c.map((function(e){var r=Object.assign(Object.assign({},l),{layer:e}),i=(a.name||"")+d+"child__layer_".concat(lL(e)),o=n.mapLayerOrUnit(a,Object.assign(Object.assign({},t),{repeater:r,repeaterPrefix:i}));return o.name=i,o}))})}},{key:"mapNonLayerRepeat",value:function(e,t){var n,r=e,a=r.repeat,i=r.spec,o=r.data,u=Iz(e,["repeat","spec","data"]);!bz(a)&&e.columns&&(e=Kz(e,["columns"]),uU(g.columnsNotSupportByRowCol("repeat")));var c,s=[],l=t.repeater,f=void 0===l?{}:l,d=t.repeaterPrefix,h=void 0===d?"":d,p=!bz(a)&&a.row||[f?f.row:null],v=!bz(a)&&a.column||[f?f.column:null],m=bz(a)&&a||[f?f.repeat:null],b=Object(mo.a)(m);try{for(b.s();!(c=b.n()).done;){var y,x=c.value,O=Object(mo.a)(p);try{for(O.s();!(y=O.n()).done;){var k,w=y.value,j=Object(mo.a)(v);try{for(j.s();!(k=j.n()).done;){var _=k.value,S={repeat:x,row:w,column:_,layer:f.layer},E=(i.name||"")+h+"child__"+(bz(a)?"".concat(lL(x)):(a.row?"row_".concat(lL(w)):"")+(a.column?"column_".concat(lL(_)):"")),C=this.map(i,Object.assign(Object.assign({},t),{repeater:S,repeaterPrefix:E}));C.name=E,s.push(Kz(C,["data"]))}}catch(N){j.e(N)}finally{j.f()}}}catch(N){O.e(N)}finally{O.f()}}}catch(N){b.e(N)}finally{b.f()}var A=bz(a)?e.columns:a.column?a.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:o,align:"all"},u),{columns:A,concat:s})}},{key:"mapFacet",value:function(e,t){return uq(e.facet)&&e.columns&&(e=Kz(e,["columns"]),uU(g.columnsNotSupportByRowCol("facet"))),Object(kG.a)(Object(wG.a)(n.prototype),"mapFacet",this).call(this,e,t)}},{key:"mapUnitWithParentEncodingOrProjection",value:function(e,t){var n=e.encoding,r=e.projection,a=t.parentEncoding,i=t.parentProjection,o=t.config,u=YG({parentProjection:i,projection:r}),c=XG({parentEncoding:a,encoding:WG(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),u?{projection:u}:{}),c?{encoding:c}:{}),{config:o})}},{key:"mapFacetedUnit",value:function(e,t){var n=e.encoding,r=n.row,a=n.column,i=n.facet,o=Iz(n,["row","column","facet"]),u=e.mark,c=e.width,s=e.projection,l=e.height,f=e.view,d=e.selection,h=(e.encoding,Iz(e,["mark","width","projection","height","view","selection","encoding"])),p=this.getFacetMappingAndLayout({row:r,column:a,facet:i},t),v=p.facetMapping,m=p.layout,b=WG(o,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},h),m),{facet:v,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},c?{width:c}:{}),l?{height:l}:{}),f?{view:f}:{}),s?{projection:s}:{}),{mark:u,encoding:b}),d?{selection:d}:{})}),t)}},{key:"getFacetMappingAndLayout",value:function(e,t){var n,r=e.row,a=e.column,i=e.facet;if(r||a){i&&uU(g.facetChannelDropped([].concat(Object(Jc.a)(r?[vP]:[]),Object(Jc.a)(a?[mP]:[]))));for(var o={},u={},c=0,s=[vP,mP];c<s.length;c++){var l=s[c],f=e[l];if(f){f.align,f.center,f.spacing,f.columns;var d=Iz(f,["align","center","spacing","columns"]);o[l]=d;for(var h=0,p=["align","center","spacing"];h<p.length;h++){var v=p[h];void 0!==f[v]&&(u[v]=null!==(n=u[v])&&void 0!==n?n:{},u[v][l]=f[v])}}}return{facetMapping:o,layout:u}}var m=i.align,b=i.center,y=i.spacing,x=i.columns;return{facetMapping:BG(Iz(i,["align","center","spacing","columns"]),t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},m?{align:m}:{}),b?{center:b}:{}),y?{spacing:y}:{}),x?{columns:x}:{})}}},{key:"mapLayer",value:function(e,t){var r=t.parentEncoding,a=t.parentProjection,i=Iz(t,["parentEncoding","parentProjection"]),o=e.encoding,u=e.projection,c=Iz(e,["encoding","projection"]),s=Object.assign(Object.assign({},i),{parentEncoding:XG({parentEncoding:r,encoding:o}),parentProjection:YG({parentProjection:a,projection:u})});return Object(kG.a)(Object(wG.a)(n.prototype),"mapLayer",this).call(this,c,s)}}]),n}(SG));function QG(e){return Az(e)?{type:e}:null!==e&&void 0!==e?e:{}}var ZG=["background","padding"];function eK(e){return ZG.reduce((function(t,n){return e&&void 0!==e[n]&&(t[n]=e[n]),t}),{})}var tK=n(43),nK=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(iO.a)(this,e),this.explicit=t,this.implicit=n}return Object(oO.a)(e,[{key:"clone",value:function(){return new e(Hz(this.explicit),Hz(this.implicit))}},{key:"combine",value:function(){return Object.assign(Object.assign({},this.explicit),this.implicit)}},{key:"get",value:function(e){return OL(this.explicit[e],this.implicit[e])}},{key:"getWithExplicit",value:function(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}},{key:"setWithExplicit",value:function(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}},{key:"set",value:function(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}},{key:"copyKeyFromSplit",value:function(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}},{key:"copyKeyFromObject",value:function(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}},{key:"copyAll",value:function(e){var t,n=Object(mo.a)(oL(e.combine()));try{for(n.s();!(t=n.n()).done;){var r=t.value,a=e.getWithExplicit(r);this.setWithExplicit(r,a)}}catch(i){n.e(i)}finally{n.f()}}}]),e}();function rK(e){return{explicit:!0,value:e}}function aK(e){return{explicit:!1,value:e}}function iK(e){return function(t,n,r,a){var i=e(t.value,n.value);return i>0?t:i<0?n:oK(t,n,r,a)}}function oK(e,t,n,r){return e.explicit&&t.explicit&&uU(g.mergeConflictingProperty(n,r,e.value,t.value)),e}function uK(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:oK;return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:qz(e.value,t.value)?e:a(e,t,n,r)}var cK=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(iO.a)(this,n),(e=t.call(this,r,a)).explicit=r,e.implicit=a,e.parseNothing=i,e}return Object(oO.a)(n,[{key:"clone",value:function(){var e=Object(kG.a)(Object(wG.a)(n.prototype),"clone",this).call(this);return e.parseNothing=this.parseNothing,e}}]),n}(nK);function sK(e){return"url"in e}function lK(e){return"values"in e}function fK(e){return"name"in e&&!sK(e)&&!lK(e)&&!dK(e)}function dK(e){return e&&(hK(e)||pK(e)||vK(e))}function hK(e){return"sequence"in e}function pK(e){return"sphere"in e}function vK(e){return"graticule"in e}var mK="main",bK="raw";function gK(e){return"filter"in e}function yK(e){return"lookup"in e}function xK(e){return"pivot"in e}function OK(e){return"density"in e}function kK(e){return"quantile"in e}function wK(e){return"regression"in e}function jK(e){return"loess"in e}function _K(e){return"sample"in e}function SK(e){return"window"in e}function EK(e){return"joinaggregate"in e}function CK(e){return"flatten"in e}function AK(e){return"calculate"in e}function NK(e){return"bin"in e}function TK(e){return"impute"in e}function IK(e){return"timeUnit"in e}function DK(e){return"aggregate"in e}function FK(e){return"stack"in e}function MK(e){return"fold"in e}function RK(e,t,n,r){var a=pq(t)&&t.condition,i=r(t);if(a){var o=wz(a).map((function(t){var n=r(t),a=function(e){return e.selection}(t)?E$(e,t.selection):A$(e,t.test);return Object.assign({test:a},n)}));return Object(vt.a)({},n,[].concat(Object(Jc.a)(o),Object(Jc.a)(void 0!==i?[i]:[])))}return void 0!==i?Object(vt.a)({},n,i):{}}function zK(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=e.encoding[t];return RK(e,n,t,(function(t){return LK(t,e.config)}))}function LK(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(e){if(jq(e))return tH(e.value);if(kq(e)){var r=Wq(e),a=r.format,i=r.formatType;return GV({fieldOrDatumDef:e,format:a,formatType:i,expr:n,config:t})}}}function PK(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.encoding,r=e.markDef,a=e.config,i=e.stack,o=n.tooltip;if(bz(o))return{tooltip:WK({tooltip:o},i,a,t)};var u=t.reactiveGeom?"datum.datum":"datum";return RK(e,o,"tooltip",(function(e){var o=LK(e,a,u);if(o)return o;if(null!==e){var c=iH("tooltip",r,a);return!0===c&&(c={content:"encoding"}),Az(c)?{value:c}:gz(c)?"encoding"===c.content?WK(n,i,a,t):{signal:u}:void 0}}))}function BK(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.reactiveGeom,i={},o=a?"datum.datum":"datum",u=[];function c(r,a){var c,s=lB(a),l=wq(r)?r:Object.assign(Object.assign({},r),{type:e[s].type}),f=wz(Lq(l,n,{allowDisabling:!1})).join(", ");if(gB(a)){var d="x"===a?"x2":"y2",h=Uq(e[d]);if(DB(l.bin)&&h){var p=Nq(l,{expr:o}),v=Nq(h,{expr:o}),m=Wq(l);c=eq(p,v,m.format,m.formatType,n),i[d]=!0}else if(t&&t.fieldChannel===a&&"normalize"===t.offset){var b=Wq(l);c=GV({fieldOrDatumDef:l,format:b.format,formatType:b.formatType,expr:o,config:n,normalizeStack:!0}).signal}}c=null!==c&&void 0!==c?c:LK(l,n,o).signal,u.push({channel:a,key:f,value:c})}gH(e,(function(e,t){bq(e)?c(e,t):vq(e)&&c(e.condition,t)}));for(var s={},l=0,f=u;l<f.length;l++){var d=f[l],h=d.channel,p=d.key,v=d.value;i[h]||s[p]||(s[Nz(p)]=v)}return s}function WK(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.reactiveGeom,i=BK(e,t,n,{reactiveGeom:a}),o=cL(i).map((function(e){var t=e.key,n=e.value;return"".concat(t,": ").concat(n)}));return o.length>0?{signal:"{".concat(o.join(", "),"}")}:void 0}function UK(e){var t=iH("aria",e.markDef,e.config);return!1===t?{}:Object.assign(Object.assign(Object.assign({},t?{aria:t}:{}),function(e){var t=e.mark,n=e.markDef,r=e.config;if(!1===r.aria)return{};var a=iH("ariaRoleDescription",n,r);if(null!=a)return{ariaRoleDescription:{value:a}};return t in TU?{}:{ariaRoleDescription:{value:t}}}(e)),function(e){var t=e.encoding,n=e.markDef,r=e.config,a=e.stack,i=t.description;if(i)return RK(e,i,"description",(function(t){return LK(t,e.config)}));var o=iH("description",n,r);if(null!=o)return{description:tH(o)};if(!1===r.aria)return{};var u=BK(t,a,r);if(iL(u))return;return{description:{signal:cL(u).map((function(e){var t=e.key,n=e.value;return"".concat(t,' + ": " + (').concat(n,")")})).join(' + "; " + ')}}}(e))}function VK(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.markDef,a=t.encoding,i=t.config,o=n.vgChannel,u=n.defaultRef,c=n.defaultValue;void 0===u&&void 0!==(c=null!==c&&void 0!==c?c:iH(e,r,i,{vgChannel:o,ignoreVgConfig:!0}))&&(u=tH(c));var s=a[e];return RK(t,s,null!==o&&void 0!==o?o:e,(function(n){return UV({channel:e,channelDef:n,markDef:r,config:i,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:u})}))}function qK(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0},o=e.markDef,u=e.encoding,c=e.config,s=o.type,l=null!==(t=i.filled)&&void 0!==t?t:iH("filled",o,c),f=Jz(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,d=null!==(r=null!==(n=iH(!0===l?"color":void 0,o,c,{vgChannel:"fill"}))&&void 0!==n?n:c.mark[!0===l&&"color"])&&void 0!==r?r:f,h=null!==(a=iH(!1===l?"color":void 0,o,c,{vgChannel:"stroke"}))&&void 0!==a?a:c.mark[!1===l&&"color"],p=l?"fill":"stroke",v=Object.assign(Object.assign({},d?{fill:tH(d)}:{}),h?{stroke:tH(h)}:{});return o.color&&(l?o.fill:o.stroke)&&uU(g.droppingColor("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},v),VK("color",e,{vgChannel:p,defaultValue:l?d:h})),VK("fill",e,{defaultValue:u.fill?d:void 0})),VK("stroke",e,{defaultValue:u.stroke?h:void 0}))}function HK(e,t){var n=t[function(e){switch(e){case gP:return"xOffset";case yP:return"yOffset";case xP:return"x2Offset";case OP:return"y2Offset";case jP:return"thetaOffset";case kP:return"radiusOffset";case _P:return"theta2Offset";case wP:return"radius2Offset"}}(e)];if(n)return n}function GK(e,t,n){var r=n.defaultPos,a=n.vgChannel,i=n.isMidPoint,o=t.encoding,u=t.markDef,c=t.config,s=t.stack,l=o[e],f=o[dB(e)],d=t.scaleName(e),h=t.getScaleComponent(e),p=HK(e,u),v=KK({model:t,defaultPos:r,channel:e,scaleName:d,scale:h}),m=!l&&gB(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:function(e){var t=e.channel,n=e.channelDef,r=e.isMidPoint,a=e.scaleName,i=e.stack,o=e.offset,u=e.markDef,c=e.config;if(kq(n)&&i&&t===i.fieldChannel){if(bq(n)){var s=dq({channel:t,fieldDef:n,isMidPoint:r,markDef:u,stack:i,config:c});if(void 0!==s)return WV({scaleName:a,fieldOrDatumDef:n,startSuffix:"start",band:s,offset:o})}return BV(n,a,{suffix:"end"},{offset:o})}return RV(e)}({channel:e,channelDef:l,channel2Def:f,markDef:u,config:c,isMidPoint:i,scaleName:d,scale:h,stack:s,offset:p,defaultRef:v});return m?Object(vt.a)({},a||e,m):void 0}function KK(e){var t=e.model,n=e.defaultPos,r=e.channel,a=e.scaleName,i=e.scale,o=t.markDef,u=t.config;return function(){var e=lB(r),c=fB(r),s=iH(r,o,u,{vgChannel:c});if(void 0!==s)return VV(r,s);switch(n){case"zeroOrMin":case"zeroOrMax":if(a){var l=i.get("type");if(Jz([tV,iV,oV],l));else if(i.domainDefinitelyIncludesZero())return{scale:a,value:0}}if("zeroOrMin"===n)return"y"===e?{field:{group:"height"}}:{value:0};switch(e){case"radius":return{signal:"min(".concat(t.width.signal,",").concat(t.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":var f=t[hB(r)];return Object.assign(Object.assign({},f),{mult:.5})}}}var XK={left:"x",center:"xc",right:"x2"},YK={top:"y",middle:"yc",bottom:"y2"};function $K(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle";if("radius"===e||"theta"===e)return fB(e);var a="x"===e?"align":"baseline",i=iH(a,t,n);return"x"===e?XK[i||("top"===r?"left":"center")]:YK[i||r]}function JK(e,t,n){var r=n.defaultPos,a=n.defaultPos2;return n.range?QK(e,t,{defaultPos:r,defaultPos2:a}):GK(e,t,{defaultPos:r})}function QK(e,t,n){var r=n.defaultPos,a=n.defaultPos2,i=t.markDef,o=t.config,u=dB(e),c=hB(e),s=function(e,t,n){var r,a=e.encoding,i=e.mark,o=e.markDef,u=e.stack,c=e.config,s=lB(n),l=hB(n),f=fB(n),d=a[s],h=e.scaleName(s),p=e.getScaleComponent(s),v=HK(n in a||n in o?n:s,e.markDef);if(!d&&("x2"===n||"y2"===n)&&(a.latitude||a.longitude))return Object(vt.a)({},f,{field:e.getName(n)});var m=function(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,a=e.markDef,i=e.config,o=e.scaleName,u=e.scale,c=e.stack,s=e.offset,l=e.defaultRef;if(kq(n)&&c&&t.charAt(0)===c.fieldChannel.charAt(0))return BV(n,o,{suffix:"start"},{offset:s});return RV({channel:t,channelDef:r,scaleName:o,scale:u,stack:c,markDef:a,config:i,offset:s,defaultRef:l})}({channel:n,channelDef:d,channel2Def:a[n],markDef:o,config:c,scaleName:h,scale:p,stack:u,offset:v,defaultRef:void 0});if(void 0!==m)return Object(vt.a)({},f,m);return ZK(n,o)||ZK(n,(r={},Object(vt.a)(r,n,uH(n,o,c.style)),Object(vt.a)(r,l,uH(l,o,c.style)),r))||ZK(n,c[i])||ZK(n,c.mark)||Object(vt.a)({},f,KK({model:e,defaultPos:t,channel:n,scaleName:h,scale:p})())}(t,a,u),l=s[c]?$K(e,i,o):fB(e);return Object.assign(Object.assign({},GK(e,t,{defaultPos:r,vgChannel:l})),s)}function ZK(e,t){var n=hB(e),r=fB(e);return void 0!==t[r]?Object(vt.a)({},r,VV(e,t[r])):void 0!==t[e]?Object(vt.a)({},r,VV(e,t[e])):t[n]?Object(vt.a)({},n,VV(e,t[n])):void 0}function eX(e,t,n){var r,a,i,o,u=e.config,c=e.encoding,s=e.markDef,l=e.stack,f=dB(t),d=hB(t),h=c[t],p=c[f],v=e.getScaleComponent(t),m=v?v.get("type"):void 0,b=e.scaleName(t),y=s.orient,x=null!==(a=null!==(r=c[d])&&void 0!==r?r:c.size)&&void 0!==a?a:iH("size",s,u,{vgChannel:d}),O="bar"===n&&("x"===t?"vertical"===y:"horizontal"===y);if(bq(h)&&(IB(h.bin)||DB(h.bin)||h.timeUnit&&!p)&&!x&&!wV(m)){var k=dq({channel:t,fieldDef:h,stack:l,markDef:s,config:u}),w=null===(i=e.component.axes[t])||void 0===i?void 0:i[0];return function(e){var t,n=e.fieldDef,r=e.fieldDef2,a=e.channel,i=e.band,o=e.scaleName,u=e.markDef,c=e.spacing,s=void 0===c?0:c,l=e.axisTranslate,f=e.reverse,d=e.config,h=dB(a),p=fB(a),v=fB(h),m=HK(a,u);if(IB(n.bin)||n.timeUnit)return t={},Object(vt.a)(t,v,nX({channel:a,fieldDef:n,scaleName:o,markDef:u,band:(1-i)/2,offset:tX(h,s,f,l,m),config:d})),Object(vt.a)(t,p,nX({channel:a,fieldDef:n,scaleName:o,markDef:u,band:1-(1-i)/2,offset:tX(a,s,f,l,m),config:d})),t;if(DB(n.bin)){var b,y,x=BV(n,o,{},{offset:tX(h,s,f,l,m)});if(bq(r))return b={},Object(vt.a)(b,v,x),Object(vt.a)(b,p,BV(r,o,{},{offset:tX(a,s,f,l,m)})),b;if(FB(n.bin)&&n.bin.step)return y={},Object(vt.a)(y,v,x),Object(vt.a)(y,p,{signal:'scale("'.concat(o,'", ').concat(Nq(n,{expr:"datum"})," + ").concat(n.bin.step,")"),offset:tX(a,s,f,l,m)}),y}return void uU(g.channelRequiredForBinned(h))}({fieldDef:h,fieldDef2:p,channel:t,markDef:s,scaleName:b,band:k,axisTranslate:null!==(o=null===w||void 0===w?void 0:w.get("translate"))&&void 0!==o?o:.5,spacing:gB(t)?iH("binSpacing",s,u):void 0,reverse:v.get("reverse"),config:u})}return(kq(h)&&wV(m)||O)&&!p?function(e,t,n,r){var a,i,o=r.markDef,u=r.encoding,c=r.config,s=r.stack,l=o.orient,f=r.scaleName(n),d=r.getScaleComponent(n),h=hB(n),p=dB(n),v="horizontal"===l&&"y"===n||"vertical"===l&&"x"===n,m=iH(v?"size":h,o,c,{vgChannel:h});(u.size||void 0!==m)&&(v?i=VK("size",r,{vgChannel:h,defaultValue:m}):uU(g.cannotApplySizeToNonOrientedMark(o.type)));var b=null!==(a=kq(t)?dq({channel:n,fieldDef:t,markDef:o,stack:s,config:c}):void 0)&&void 0!==a?a:1;i=i||Object(vt.a)({},h,function(e,t,n,r,a,i){if(r){var o=r.get("type");if("point"===o||"band"===o){if(void 0!==a[e].discreteBandSize)return{value:a[e].discreteBandSize};if(o===lV){var u=r.get("range");return CU(u)&&Cz(u.step)?{value:u.step-2}:{value:uG-2}}return{scale:n,band:i}}return{value:a[e].continuousBandSize}}var c=iG(a.view,t),s=OL(a[e].discreteBandSize,c-2);return void 0!==s?{value:s}:void 0}(e,h,f,d,c,b));var y="band"!==(null===d||void 0===d?void 0:d.get("type"))||!("band"in i[h]),x=$K(n,o,c,y?"middle":"top"),O=HK(n,o),k=RV({channel:n,channelDef:t,markDef:o,config:c,scaleName:f,scale:d,stack:s,offset:O,defaultRef:KK({model:r,defaultPos:"mid",channel:n,scaleName:f,scale:d}),band:y?.5:(1-b)/2});if(h)return Object.assign(Object(vt.a)({},x,k),i);var w,j=fB(p),_=i[h],S=O?Object.assign(Object.assign({},_),{offset:O}):_;return w={},Object(vt.a)(w,x,k),Object(vt.a)(w,j,bz(k)?[k[0],Object.assign(Object.assign({},k[1]),{offset:S})]:Object.assign(Object.assign({},k),{offset:S})),w}(n,h,t,e):QK(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function tX(e,t,n,r,a){if($P(e))return 0;var i="x"===e||"y2"===e?-t/2:t/2;if(EU(n)){var o=rH(a);return{signal:"".concat(n.signal," ? ").concat(r-i).concat(o?"-"+o:""," : ").concat(r+i).concat(o?"+"+o:"")}}if(EU(a)){var u=r+(n?-i:i);return{signal:"".concat(u||"").concat(n?" - ":u?" + ":"").concat(a.signal)}}return a=a||0,r+(n?-a-i:+a+i)}function nX(e){var t=e.channel,n=e.fieldDef,r=e.scaleName,a=e.markDef,i=e.band,o=e.offset,u=e.config;return zV({fieldDef:n,channel:t,markDef:a,ref:WV({scaleName:r,fieldOrDatumDef:n,band:i,offset:o}),config:u})}var rX=new Set(["aria"]);function aX(e,t){var n="include"===t.color?qK(e):{},r=n.fill,a=void 0===r?void 0:r,i=n.stroke,o=void 0===i?void 0:i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return NU.reduce((function(n,r){return rX.has(r)||void 0===e[r]||"ignore"===t[r]||(n[r]=tH(e[r])),n}),{})}(e.markDef,t)),iX(e,"fill",a)),iX(e,"stroke",o)),VK("opacity",e)),VK("fillOpacity",e)),VK("strokeOpacity",e)),VK("strokeWidth",e)),VK("strokeDash",e)),PK(e)),zK(e,"href")),UK(e))}function iX(e,t,n){var r=e.config,a=e.mark;if("hide"===iH("invalid",e.markDef,r)&&n&&!YL(a)){var i=function(e,t){var n=t.invalid,r=void 0!==n&&n,a=t.channels.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var a=r.get("type"),i=e.vgField(n,{expr:"datum"});i&&jV(a)&&(t[i]=!0)}return t}),{}),i=oL(a);if(i.length>0){var o=r?"||":"&&";return i.map((function(e){return PV(e,r)})).join(" ".concat(o," "))}return}(e,{invalid:!0,channels:_B});if(i)return Object(vt.a)({},t,[{test:i,value:null}].concat(Object(Jc.a)(wz(n))))}return n?Object(vt.a)({},t,n):{}}function oX(e){var t=e.config;if(iH("invalid",e.markDef,t)){var n=function(e,t){var n=t.invalid,r=void 0!==n&&n,a=t.channels.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var a=r.get("type"),i=e.vgField(n,{expr:"datum"});i&&jV(a)&&(t[i]=!0)}return t}),{}),i=oL(a);if(i.length>0){var o=r?"||":"&&";return i.map((function(e){return PV(e,r)})).join(" ".concat(o," "))}return}(e,{channels:bB});if(n)return{defined:{signal:n}}}return{}}function uX(e,t){if(void 0!==t)return Object(vt.a)({},e,tH(t))}var cX="voronoi",sX={has:function(e){return"interval"!==e.type&&e.nearest},parse:function(e,t){if(t.events){var n,r=Object(mo.a)(t.events);try{for(r.s();!(n=r.n()).done;){n.value.markname=e.getName(cX)}}catch(a){r.e(a)}finally{r.f()}}},marks:function(e,t,n){var r=t.project.hasChannel,a=r.x,i=r.y,o=e.mark;if(YL(o))return uU(g.nearestNotSupportForContinuous(o)),n;var u={name:e.getName(cX),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},PK(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:a||!i?"datum.datum.x || 0":"0"},y:{expr:i||!a?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]},c=0,s=!1;return n.forEach((function(t,n){var r,a=null!==(r=t.name)&&void 0!==r?r:"";a===e.component.mark[0].name?c=n:a.indexOf(cX)>=0&&(s=!0)})),s||n.splice(c+1,0,u),n}},lX=function(){function e(t,n){Object(iO.a)(this,e),this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}return Object(oO.a)(e,[{key:"clone",value:function(){throw new Error("Cannot clone node")}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e,e&&e.addChild(this)}},{key:"children",get:function(){return this._children}},{key:"numChildren",value:function(){return this._children.length}},{key:"addChild",value:function(e,t){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);return this._children.splice(t,1),t}},{key:"remove",value:function(){var e,t=this._parent.removeChild(this),n=Object(mo.a)(this._children);try{for(n.s();!(e=n.n()).done;){var r=e.value;r._parent=this._parent,this._parent.addChild(r,t++)}}catch(a){n.e(a)}finally{n.f()}}},{key:"insertAsParentOf",value:function(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}},{key:"swapWithParent",value:function(){var e,t=this._parent,n=t.parent,r=Object(mo.a)(this._children);try{for(r.s();!(e=r.n()).done;){e.value.parent=t}}catch(a){r.e(a)}finally{r.f()}this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}]),e}(),fX=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a,i){var o;return Object(iO.a)(this,n),(o=t.call(this,e,r)).type=a,o.refCounts=i,o._source=o._name=r,o.refCounts&&!(o._name in o.refCounts)&&(o.refCounts[o._name]=0),o}return Object(oO.a)(n,[{key:"clone",value:function(){var e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return void 0===this._hash&&(this._hash="Output ".concat(wL())),this._hash}},{key:"getSource",value:function(){return this.refCounts[this._name]++,this._source}},{key:"isRequired",value:function(){return!!this.refCounts[this._name]}},{key:"setSource",value:function(e){this._source=e}}]),n}(lX),dX=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).formula=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.formula))}},{key:"merge",value:function(e){for(var t in this.formula=Object.assign({},this.formula),e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);var n,r=Object(mo.a)(e.children);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.removeChild(a),a.parent=this}}catch(i){r.e(i)}finally{r.f()}e.remove()}},{key:"producedFields",value:function(){return new Set(uL(this.formula).map((function(e){return e.as})))}},{key:"dependentFields",value:function(){return new Set(uL(this.formula).map((function(e){return e.field})))}},{key:"hash",value:function(){return"TimeUnit ".concat(Yz(this.formula))}},{key:"assemble",value:function(){var e,t=[],n=Object(mo.a)(uL(this.formula));try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.field,i=r.as,o=_U(r.timeUnit),u=o.unit,c=o.utc,s=Iz(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:bL(a),type:"timeunit"},u?{units:OU(u)}:{}),c?{timezone:"utc"}:{}),s),{as:[i,"".concat(i,"_end")]}))}}catch(l){n.e(l)}finally{n.f()}return t}}],[{key:"makeFromEncoding",value:function(e,t){var r=t.reduceFieldDef((function(e,n,r){var a=n.field,i=n.timeUnit,o=uZ(t)?t.encoding[dB(r)]:void 0,u=uZ(t)&&hq(r,n,o,t.stack,t.markDef,t.config);if(i){var c=Nq(n,{forAs:!0});e[Yz({as:c,field:a,timeUnit:i})]=Object.assign({as:c,field:a,timeUnit:i},u?{band:!0}:{})}return e}),{});return iL(r)?null:new n(e,r)}},{key:"makeFromTransform",value:function(e,t){var r=Object.assign({},t),a=r.timeUnit,i=Iz(r,["timeUnit"]),o=_U(a),u=Object.assign(Object.assign({},i),{timeUnit:o});return new n(e,Object(vt.a)({},Yz(u),u))}}]),n}(lX),hX="_tuple_fields",pX=function e(){Object(iO.a)(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.items=n,this.hasChannel={},this.hasField={}},vX={has:function(e){return"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!$H(e.bind)},parse:function(e,t,n,r){r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:function(e,t,n){var r=t.name,a=t.project,i=t.bind,o=t.init&&t.init[0],u=sX.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return a.items.forEach((function(e,a){var c,s,l=lL("".concat(r,"_").concat(e.field));n.filter((function(e){return e.name===l})).length||n.unshift(Object.assign(Object.assign({name:l},o?{init:DX(o[a])}:{value:null}),{on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(u,"[").concat(Nz(e.field),"] : null")}]:[],bind:null!==(s=null!==(c=i[e.field])&&void 0!==c?c:i[e.channel])&&void 0!==s?s:i}))})),n},signals:function(e,t,n){var r=t.name,a=t.project,i=n.filter((function(e){return e.name===r+qX}))[0],o=r+hX,u=a.items.map((function(e){return lL("".concat(r,"_").concat(e.field))})),c=u.map((function(e){return"".concat(e," !== null")})).join(" && ");return u.length&&(i.update="".concat(c," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null")),delete i.value,delete i.on,n}},mX="_toggle",bX={has:function(e){return"multi"===e.type&&!!e.toggle},signals:function(e,t,n){return n.concat({name:t.name+mX,value:!1,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t){var n=t.name+qX,r=t.name+mX;return"".concat(r," ? null : ").concat(n,", ")+("global"===t.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat($X(e),"}, "))+"".concat(r," ? ").concat(n," : null")}},gX={has:function(e){return void 0!==e.clear&&!1!==e.clear},parse:function(e,t,n){n.clear&&(t.clear=Az(n.clear)?cD(n.clear,"scope"):n.clear)},topLevelSignals:function(e,t,n){if(vX.has(t)){var r,a=Object(mo.a)(t.project.items);try{var i=function(){var e=r.value,a=n.findIndex((function(n){return n.name===lL("".concat(t.name,"_").concat(e.field))}));-1!==a&&n[a].on.push({events:t.clear,update:"null"})};for(a.s();!(r=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}}return n},signals:function(e,t,n){function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}if("interval"===t.type){var a,i=Object(mo.a)(t.project.items);try{var o=function(){var e=a.value,t=n.findIndex((function(t){return t.name===e.signals.visual}));(r(t,"[0, 0]"),-1===t)&&r(n.findIndex((function(t){return t.name===e.signals.data})),"null")};for(i.s();!(a=i.n()).done;)o()}catch(c){i.e(c)}finally{i.f()}}else{var u=n.findIndex((function(e){return e.name===t.name+qX}));r(u,"null"),bX.has(t)&&r(u=n.findIndex((function(e){return e.name===t.name+mX})),"false")}return n}},yX={has:function(e){return"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind},parse:function(e,t){var n,r=t.scales=[],a=Object(mo.a)(t.project.items);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=i.channel;if(SB(o)){var u=e.getScaleComponent(o),c=u?u.get("type"):void 0;if(u&&jV(c)){var s={selection:t.name,field:i.field};u.set("selectionExtent",s,!0),r.push(i)}else uU(g.SCALE_BINDINGS_CONTINUOUS)}}}catch(l){a.e(l)}finally{a.f()}},topLevelSignals:function(e,t,n){var r=t.scales.filter((function(e){return 0===n.filter((function(t){return t.name===e.signals.data})).length}));if(!e.parent||OX(e)||0===r.length)return n;var a=n.filter((function(e){return e.name===t.name}))[0],i=a.update;if(i.indexOf(GX)>=0)a.update="{".concat(r.map((function(e){return"".concat(Nz(e.field),": ").concat(e.signals.data)})).join(", "),"}");else{var o,u=Object(mo.a)(r);try{for(u.s();!(o=u.n()).done;){var c=o.value,s="".concat(Nz(c.field),": ").concat(c.signals.data);i.indexOf(s)<0&&(i="".concat(i.substring(0,i.length-1),", ").concat(s,"}"))}}catch(l){u.e(l)}finally{u.f()}a.update=i}return n.concat(r.map((function(e){return{name:e.signals.data}})))},signals:function(e,t,n){if(e.parent&&!OX(e)){var r,a=Object(mo.a)(t.scales);try{var i=function(){var e=r.value,t=n.filter((function(t){return t.name===e.signals.data}))[0];t.push="outer",delete t.value,delete t.update};for(a.s();!(r=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}}return n}};function xX(e,t){var n=Nz(e.scaleName(t));return"domain(".concat(n,")")}function OX(e){var t;return e.parent&&lZ(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:OX(e.parent.parent))}var kX={has:function(e){var t="global"===e.resolve&&e.bind&&$H(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==XH;return t&&!n&&uU(g.LEGEND_BINDINGS_PROJECT_LENGTH),t&&n},parse:function(e,t,n,r){var a;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){var i,o='event.item && indexof(event.item.mark.role, "legend") < 0',u=Object(mo.a)(t.events);try{for(u.s();!(i=u.n()).done;){var c=i.value;c.filter=wz(null!==(a=c.filter)&&void 0!==a?a:[]),c.filter.indexOf(o)<0&&c.filter.push(o)}}catch(f){u.e(f)}finally{u.f()}}var s=JH(t.bind)?t.bind.legend:"click",l=Az(s)?cD(s,"view"):wz(s);t.bind={legend:{merge:l}}},topLevelSignals:function(e,t,n){var r,a=t.name,i=JH(t.bind)&&t.bind.legend,o=function(e){return function(t){var n=Hz(t);return n.markname=e,n}},u=Object(mo.a)(t.project.items);try{var c=function(){var e=r.value;if(!e.hasLegend)return"continue";var u="".concat(lL(e.field),"_legend"),c="".concat(a,"_").concat(u);if(0===n.filter((function(e){return e.name===c})).length){var s=i.merge.map(o("".concat(u,"_symbols"))).concat(i.merge.map(o("".concat(u,"_labels")))).concat(i.merge.map(o("".concat(u,"_entries"))));n.unshift(Object.assign(Object.assign({name:c},t.init?{}:{value:null}),{on:[{events:s,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : ".concat(c),force:!0}]}))}};for(u.s();!(r=u.n()).done;)c()}catch(s){u.e(s)}finally{u.f()}return n},signals:function(e,t,n){var r=t.name,a=t.project,i=n.find((function(e){return e.name===r+qX})),o=r+hX,u=a.items.filter((function(e){return e.hasLegend})).map((function(e){return lL("".concat(r,"_").concat(lL(e.field),"_legend"))})),c=u.map((function(e){return"".concat(e," !== null")})).join(" && "),s="".concat(c," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null");t.events&&u.length>0?i.on.push({events:u.map((function(e){return{signal:e}})),update:s}):u.length>0&&(i.update=s,delete i.value,delete i.on);var l=n.find((function(e){return e.name===r+mX})),f=JH(t.bind)&&t.bind.legend;return l&&(t.events?l.on.push(Object.assign(Object.assign({},l.on[0]),{events:f})):l.on[0].events=f),n}};var wX="_translate_anchor",jX="_translate_delta",_X={has:function(e){return"interval"===e.type&&e.translate},signals:function(e,t,n){var r=t.name,a=yX.has(t),i=r+wX,o=t.project.hasChannel,u=o.x,c=o.y,s=cD(t.translate,"scope");return a||(s=s.map((function(e){return e.between[0].markname=r+RX,e}))),n.push({name:i,value:{},on:[{events:s.map((function(e){return e.between[0]})),update:"{x: x(unit), y: y(unit)"+(void 0!==u?", extent_x: "+(a?xX(e,gP):"slice(".concat(u.signals.visual,")")):"")+(void 0!==c?", extent_y: "+(a?xX(e,yP):"slice(".concat(c.signals.visual,")")):"")+"}"}]},{name:r+jX,value:{},on:[{events:s,update:"{x: ".concat(i,".x - x(unit), y: ").concat(i,".y - y(unit)}")}]}),void 0!==u&&SX(e,t,u,"width",n),void 0!==c&&SX(e,t,c,"height",n),n}};function SX(e,t,n,r,a){var i,o=t.name,u=o+wX,c=o+jX,s=n.channel,l=yX.has(t),f=a.filter((function(e){return e.name===n.signals[l?"data":"visual"]}))[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(s),p=h.get("type"),v=l&&s===gP?"-":"",m="".concat(u,".extent_").concat(s),b="".concat(v).concat(c,".").concat(s," / ")+(l?"".concat(d):"span(".concat(m,")")),g="".concat(l?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear","(").concat(m,", ").concat(b)+(l&&"pow"===p?", ".concat(null!==(i=h.get("exponent"))&&void 0!==i?i:1):"")+")";f.on.push({events:{signal:c},update:l?g:"clampRange(".concat(g,", 0, ").concat(d,")")})}var EX="_zoom_anchor",CX="_zoom_delta",AX={has:function(e){return"interval"===e.type&&e.zoom},signals:function(e,t,n){var r=t.name,a=yX.has(t),i=r+CX,o=t.project.hasChannel,u=o.x,c=o.y,s=Nz(e.scaleName(gP)),l=Nz(e.scaleName(yP)),f=cD(t.zoom,"scope");return a||(f=f.map((function(e){return e.markname=r+RX,e}))),n.push({name:r+EX,on:[{events:f,update:a?"{"+[s?"x: invert(".concat(s,", x(unit))"):"",l?"y: invert(".concat(l,", y(unit))"):""].filter((function(e){return!!e})).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:i,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==u&&NX(e,t,u,"width",n),void 0!==c&&NX(e,t,c,"height",n),n}};function NX(e,t,n,r,a){var i,o=t.name,u=n.channel,c=yX.has(t),s=a.filter((function(e){return e.name===n.signals[c?"data":"visual"]}))[0],l=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(u),d=f.get("type"),h=c?xX(e,u):s.name,p=o+CX,v="".concat(o).concat(EX,".").concat(u),m="".concat(c?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear","(").concat(h,", ").concat(v,", ").concat(p)+(c&&"pow"===d?", ".concat(null!==(i=f.get("exponent"))&&void 0!==i?i:1):"")+")";s.on.push({events:{signal:p},update:c?m:"clampRange(".concat(m,", 0, ").concat(l,")")})}var TX=[{has:function(){return!0},parse:function(e,t,n){var r,a,i,o=t.name,u=null!==(r=t.project)&&void 0!==r?r:t.project=new pX,c={},s={},l=new Set,f=function(e,t){for(var n="visual"===t?e.channel:e.field,r=lL("".concat(o,"_").concat(n)),a=1;l.has(r);a++)r=lL("".concat(o,"_").concat(n,"_").concat(a));return l.add(r),Object(vt.a)({},t,r)};if(!n.fields&&!n.encodings){var d=e.config.selection[n.type];if(n.init){var h,p=Object(mo.a)(wz(n.init));try{for(p.s();!(h=p.n()).done;){var v,m=h.value,b=Object(mo.a)(oL(m));try{for(b.s();!(v=b.n()).done;){var y=v.value;oB[y]?(n.encodings||(n.encodings=[])).push(y):"interval"===n.type?(uU('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(y)}}catch(F){b.e(F)}finally{b.f()}}}catch(F){p.e(F)}finally{p.f()}}else n.encodings=d.encodings,n.fields=d.fields}var x,O=Object(mo.a)(null!==(a=n.fields)&&void 0!==a?a:[]);try{for(O.s();!(x=O.n()).done;){var k=x.value,w={type:"E",field:k};w.signals=Object.assign({},f(w,"data")),u.items.push(w),u.hasField[k]=w}}catch(F){O.e(F)}finally{O.f()}var j,_=Object(mo.a)(null!==(i=n.encodings)&&void 0!==i?i:[]);try{for(_.s();!(j=_.n()).done;){var S=j.value,E=e.fieldDef(S);if(E){var C=E.field;if(E.aggregate){uU(g.cannotProjectAggregate(S,E.aggregate));continue}if(!C){uU(g.cannotProjectOnChannelWithoutField(S));continue}if(E.timeUnit){C=e.vgField(S);var A={timeUnit:E.timeUnit,as:C,field:E.field};s[Yz(A)]=A}if(!c[C]){var N="E";if("interval"===t.type)jV(e.getScaleComponent(S).get("type"))&&(N="R");else E.bin&&(N="R-RE");var T={field:C,channel:S,type:N};T.signals=Object.assign(Object.assign({},f(T,"data")),f(T,"visual")),u.items.push(c[C]=T),u.hasField[C]=u.hasChannel[S]=c[C]}}else uU(g.cannotProjectOnChannelWithoutField(S))}}catch(F){_.e(F)}finally{_.f()}if(n.init){var I=function(e){return u.items.map((function(t){return void 0!==e[t.channel]?e[t.channel]:e[t.field]}))};if("interval"===n.type)t.init=I(n.init);else{var D=wz(n.init);t.init=D.map(I)}}iL(s)||(u.timeUnit=new dX(null,s))},signals:function(e,t,n){var r=t.name+hX;return n.filter((function(e){return e.name===r})).length>0?n:n.concat({name:r,value:t.project.items.map((function(e){e.signals,e.hasLegend;var t=Iz(e,["signals","hasLegend"]);return t.field=bL(t.field),t}))})}},bX,yX,kX,_X,AX,vX,sX,gX];function IX(e,t){var n,r=Object(mo.a)(TX);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.has(e)&&t(a)}}catch(i){r.e(i)}finally{r.f()}}function DX(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vz;if(bz(e)){var r=e.map((function(e){return DX(e,t,n)}));return t?"[".concat(r.join(", "),"]"):r}return cU(e)?n(t?pU(e):mU(e)):t?n(JSON.stringify(e)):e}function FX(e,t){return XX(e,(function(n,r){t=r.marks?r.marks(e,n,t):t,IX(n,(function(r){r.marks&&(t=r.marks(e,n,t))}))})),t}function MX(e){return e.map((function(e){return e.on&&!e.on.length&&delete e.on,e}))}var RX="_brush",zX="_scale_trigger",LX={signals:function(e,t){var n=t.name,r=n+hX,a=yX.has(t),i=[],o=[],u=[];if(t.translate&&!a){var c="!event.item || event.item.mark.name !== ".concat(Nz(n+RX));PX(t,(function(e,t){var n,r=wz(null!==(n=t.between[0].filter)&&void 0!==n?n:t.between[0].filter=[]);return r.indexOf(c)<0&&r.push(c),e}))}t.project.items.forEach((function(n,r){var a=n.channel;if(a===gP||a===yP){var c=t.init?t.init[r]:null,s=function(e,t,n,r){var a=n.channel,i=n.signals.visual,o=n.signals.data,u=yX.has(t),c=Nz(e.scaleName(a)),s=e.getScaleComponent(a),l=s?s.get("type"):void 0,f=function(e){return"scale(".concat(c,", ").concat(e,")")},d=e.getSizeSignalRef(a===gP?"width":"height").signal,h="".concat(a,"(unit)"),p=PX(t,(function(e,t){return[].concat(Object(Jc.a)(e),[{events:t.between[0],update:"[".concat(h,", ").concat(h,"]")},{events:t,update:"[".concat(i,"[0], clamp(").concat(h,", 0, ").concat(d,")]")}])}));return p.push({events:{signal:t.name+zX},update:jV(l)?"[".concat(f("".concat(o,"[0]")),", ").concat(f("".concat(o,"[1]")),"]"):"[0, 0]"}),u?[{name:o,on:[]}]:[Object.assign(Object.assign({name:i},r?{init:DX(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:DX(r)}:{}),{on:[{events:{signal:i},update:"".concat(i,"[0] === ").concat(i,"[1] ? null : invert(").concat(c,", ").concat(i,")")}]})]}(e,t,n,c),l=n.signals.data,f=n.signals.visual,d=Nz(e.scaleName(a)),h=jV(e.getScaleComponent(a).get("type"))?"+":"";i.push.apply(i,Object(Jc.a)(s)),o.push(l),u.push({scaleName:e.scaleName(a),expr:"(!isArray(".concat(l,") || ")+"(".concat(h,"invert(").concat(d,", ").concat(f,")[0] === ").concat(h).concat(l,"[0] && ")+"".concat(h,"invert(").concat(d,", ").concat(f,")[1] === ").concat(h).concat(l,"[1]))")})}else uU("Interval selections only support x and y encoding channels.")})),a||i.push({name:n+zX,value:{},on:[{events:u.map((function(e){return{scale:e.scaleName}})),update:u.map((function(e){return e.expr})).join(" && ")+" ? ".concat(n+zX," : {}")}]});var s=t.init,l="unit: ".concat($X(e),", fields: ").concat(r,", values");return i.concat(Object.assign(Object.assign({name:n+qX},s?{init:"{".concat(l,": ").concat(DX(s),"}")}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+" ? {".concat(l,": [").concat(o,"]} : null")}]}))},modifyExpr:function(e,t){return t.name+qX+", "+("global"===t.resolve?"true":"{unit: ".concat($X(e),"}"))},marks:function(e,t,n){var r=t.name,a=t.project.hasChannel,i=a.x,o=a.y,u=i&&i.signals.visual,c=o&&o.signals.visual,s="data(".concat(Nz(t.name+VX),")");if(yX.has(t))return n;var l={x:void 0!==i?{signal:"".concat(u,"[0]")}:{value:0},y:void 0!==o?{signal:"".concat(c,"[0]")}:{value:0},x2:void 0!==i?{signal:"".concat(u,"[1]")}:{field:{group:"width"}},y2:void 0!==o?{signal:"".concat(c,"[1]")}:{field:{group:"height"}}};if("global"===t.resolve){var f,d=Object(mo.a)(oL(l));try{for(d.s();!(f=d.n()).done;){var h=f.value;l[h]=[Object.assign({test:"".concat(s,".length && ").concat(s,"[0].unit === ").concat($X(e))},l[h]),{value:0}]}}catch(x){d.e(x)}finally{d.f()}}var p=t.mark,v=p.fill,m=p.fillOpacity,b=p.cursor,g=Iz(p,["fill","fillOpacity","cursor"]),y=oL(g).reduce((function(e,t){return e[t]=[{test:[void 0!==i&&"".concat(u,"[0] !== ").concat(u,"[1]"),void 0!==o&&"".concat(c,"[0] !== ").concat(c,"[1]")].filter((function(e){return e})).join(" && "),value:g[t]},{value:null}],e}),{});return[{name:r+RX+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:v},fillOpacity:{value:m}},update:l}}].concat(Object(Jc.a)(n),[{name:r+RX,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},b?{cursor:{value:b}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),y)}}])}};function PX(e,t){return e.events.reduce((function(e,n){return n.between?t(e,n):(uU("".concat(n," is not an ordered event stream for interval selections.")),e)}),[])}function BX(e,t){var n=t.name,r=n+hX,a=t.project,i="(item().isVoronoi ? datum.datum : datum)",o=a.items.map((function(t){var n=e.fieldDef(t.channel);return n&&n.bin?"[".concat(i,"[").concat(Nz(e.vgField(t.channel,{})),"], ")+"".concat(i,"[").concat(Nz(e.vgField(t.channel,{binSuffix:"end"})),"]]"):"".concat(i,"[").concat(Nz(t.field),"]")})).join(", "),u="unit: ".concat($X(e),", fields: ").concat(r,", values"),c=t.events;return[{name:n+qX,on:c?[{events:c,update:"datum && item().mark.marktype !== 'group' ? {".concat(u,": [").concat(o,"]} : null"),force:!0}]:[]}]}var WX={signals:BX,modifyExpr:function(e,t){return t.name+qX+", "+("global"===t.resolve?"null":"{unit: ".concat($X(e),"}"))}},UX={signals:BX,modifyExpr:function(e,t){return t.name+qX+", "+("global"===t.resolve?"true":"{unit: ".concat($X(e),"}"))}},VX="_store",qX="_tuple",HX="_modify",GX="vlSelectionResolve",KX={single:UX,multi:WX,interval:LX};function XX(e,t){var n=e.component.selection;if(n){var r,a=Object(mo.a)(uL(n));try{for(a.s();!(r=a.n()).done;){var i=r.value;if(!0===t(i,KX[i.type]))break}}catch(o){a.e(o)}finally{a.f()}}}function YX(e){for(var t=e.parent;t&&!cZ(t);)t=t.parent;return t}function $X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0},n=t.escape,r=n?Nz(e.name):e.name,a=YX(e);if(a){var i,o=a.facet,u=Object(mo.a)(nB);try{for(u.s();!(i=u.n()).done;){var c=i.value;o[c]&&(r+=" + '__facet_".concat(c,"_' + (facet[").concat(Nz(a.vgField(c)),"])"))}}catch(s){u.e(s)}finally{u.f()}}return r}function JX(e){var t=!1;return XX(e,(function(e){t=t||e.project.items.some((function(e){return e.field===XH}))})),t}var QX,ZX,eY,tY,nY,rY="RawCode",aY="Literal",iY="Property",oY="Identifier",uY="ArrayExpression",cY="BinaryExpression",sY="CallExpression",lY="ConditionalExpression",fY="LogicalExpression",dY="MemberExpression",hY="ObjectExpression",pY="UnaryExpression";function vY(e){this.type=e}vY.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case uY:return e.elements;case cY:case fY:return[e.left,e.right];case sY:return[e.callee].concat(e.arguments);case lY:return[e.test,e.consequent,e.alternate];case dY:return[e.object,e.property];case hY:return e.properties;case iY:return[e.key,e.value];case pY:return[e.argument];case oY:case aY:case rY:default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(QX={})[1]="Boolean",QX[2]="<end>",QX[3]="Identifier",QX[4]="Keyword",QX[5]="Null",QX[6]="Numeric",QX[7]="Punctuator",QX[8]="String",QX[9]="RegularExpression";var mY="Identifier",bY="Unexpected token %0",gY="Invalid regular expression",yY="Invalid regular expression: missing /",xY="Octal literals are not allowed in strict mode.",OY="ILLEGAL",kY="Disabled.",wY=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),jY=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function _Y(e,t){if(!e)throw new Error("ASSERT: "+t)}function SY(e){return e>=48&&e<=57}function EY(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function CY(e){return"01234567".indexOf(e)>=0}function AY(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function NY(e){return 10===e||13===e||8232===e||8233===e}function TY(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&wY.test(String.fromCharCode(e))}function IY(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&jY.test(String.fromCharCode(e))}var DY={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function FY(){for(var e;eY<tY&&(AY(e=ZX.charCodeAt(eY))||NY(e));)++eY}function MY(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t)eY<tY&&EY(ZX[eY])?(r=ZX[eY++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):JY({},bY,OY);return String.fromCharCode(a)}function RY(){var e,t,n,r;for(t=0,"}"===(e=ZX[eY])&&JY({},bY,OY);eY<tY&&EY(e=ZX[eY++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&JY({},bY,OY),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function zY(){var e,t;for(e=ZX.charCodeAt(eY++),t=String.fromCharCode(e),92===e&&(117!==ZX.charCodeAt(eY)&&JY({},bY,OY),++eY,(e=MY("u"))&&"\\"!==e&&TY(e.charCodeAt(0))||JY({},bY,OY),t=e);eY<tY&&IY(e=ZX.charCodeAt(eY));)++eY,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==ZX.charCodeAt(eY)&&JY({},bY,OY),++eY,(e=MY("u"))&&"\\"!==e&&IY(e.charCodeAt(0))||JY({},bY,OY),t+=e);return t}function LY(){var e,t;return e=eY,{type:1===(t=92===ZX.charCodeAt(eY)?zY():function(){var e,t;for(e=eY++;eY<tY;){if(92===(t=ZX.charCodeAt(eY)))return eY=e,zY();if(!IY(t))break;++eY}return ZX.slice(e,eY)}()).length?3:DY.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:eY}}function PY(){var e,t,n,r,a=eY,i=ZX.charCodeAt(eY),o=ZX[eY];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++eY,{type:7,value:String.fromCharCode(i),start:a,end:eY};default:if(61===(e=ZX.charCodeAt(eY+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return eY+=2,{type:7,value:String.fromCharCode(i)+String.fromCharCode(e),start:a,end:eY};case 33:case 61:return eY+=2,61===ZX.charCodeAt(eY)&&++eY,{type:7,value:ZX.slice(a,eY),start:a,end:eY}}}return">>>="===(r=ZX.substr(eY,4))?{type:7,value:r,start:a,end:eY+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:a,end:eY+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:7,value:t,start:a,end:eY+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:a,end:++eY}:void JY({},bY,OY)}function BY(){var e,t,n;if(_Y(SY((n=ZX[eY]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=eY,e="","."!==n){if(e=ZX[eY++],n=ZX[eY],"0"===e){if("x"===n||"X"===n)return++eY,function(e){for(var t="";eY<tY&&EY(ZX[eY]);)t+=ZX[eY++];return 0===t.length&&JY({},bY,OY),TY(ZX.charCodeAt(eY))&&JY({},bY,OY),{type:6,value:parseInt("0x"+t,16),start:e,end:eY}}(t);if(CY(n))return function(e){for(var t="0"+ZX[eY++];eY<tY&&CY(ZX[eY]);)t+=ZX[eY++];return(TY(ZX.charCodeAt(eY))||SY(ZX.charCodeAt(eY)))&&JY({},bY,OY),{type:6,value:parseInt(t,8),octal:!0,start:e,end:eY}}(t);n&&SY(n.charCodeAt(0))&&JY({},bY,OY)}for(;SY(ZX.charCodeAt(eY));)e+=ZX[eY++];n=ZX[eY]}if("."===n){for(e+=ZX[eY++];SY(ZX.charCodeAt(eY));)e+=ZX[eY++];n=ZX[eY]}if("e"===n||"E"===n)if(e+=ZX[eY++],"+"!==(n=ZX[eY])&&"-"!==n||(e+=ZX[eY++]),SY(ZX.charCodeAt(eY)))for(;SY(ZX.charCodeAt(eY));)e+=ZX[eY++];else JY({},bY,OY);return TY(ZX.charCodeAt(eY))&&JY({},bY,OY),{type:6,value:parseFloat(e),start:t,end:eY}}function WY(){var e,t,n,r;return nY=null,FY(),e=eY,t=function(){var e,t,n,r;for(_Y("/"===(e=ZX[eY]),"Regular expression literal must start with a slash"),t=ZX[eY++],n=!1,r=!1;eY<tY;)if(t+=e=ZX[eY++],"\\"===e)NY((e=ZX[eY++]).charCodeAt(0))&&JY({},yY),t+=e;else if(NY(e.charCodeAt(0)))JY({},yY);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||JY({},yY),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";eY<tY&&IY((e=ZX[eY]).charCodeAt(0));)++eY,"\\"===e&&eY<tY?JY({},bY,OY):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&JY({},gY,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";JY({},gY)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){JY({},gY)}try{return new RegExp(e,t)}catch(a){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:eY}}function UY(){var e;return FY(),eY>=tY?{type:2,start:eY,end:eY}:TY(e=ZX.charCodeAt(eY))?LY():40===e||41===e||59===e?PY():39===e||34===e?function(){var e,t,n,r,a="",i=!1;for(_Y("'"===(e=ZX[eY])||'"'===e,"String literal must starts with a quote"),t=eY,++eY;eY<tY;){if((n=ZX[eY++])===e){e="";break}if("\\"===n)if((n=ZX[eY++])&&NY(n.charCodeAt(0)))"\r"===n&&"\n"===ZX[eY]&&++eY;else switch(n){case"u":case"x":"{"===ZX[eY]?(++eY,a+=RY()):a+=MY(n);break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;default:CY(n)?(0!==(r="01234567".indexOf(n))&&(i=!0),eY<tY&&CY(ZX[eY])&&(i=!0,r=8*r+"01234567".indexOf(ZX[eY++]),"0123".indexOf(n)>=0&&eY<tY&&CY(ZX[eY])&&(r=8*r+"01234567".indexOf(ZX[eY++]))),a+=String.fromCharCode(r)):a+=n}else{if(NY(n.charCodeAt(0)))break;a+=n}}return""!==e&&JY({},bY,OY),{type:8,value:a,octal:i,start:t,end:eY}}():46===e?SY(ZX.charCodeAt(eY+1))?BY():PY():SY(e)?BY():PY()}function VY(){var e;return eY=(e=nY).end,nY=UY(),eY=e.end,e}function qY(){var e;e=eY,nY=UY(),eY=e}function HY(e,t,n){var r=new vY("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function GY(e,t){var n=new vY("CallExpression");return n.callee=e,n.arguments=t,n}function KY(e){var t=new vY(mY);return t.name=e,t}function XY(e){var t=new vY("Literal");return t.value=e.value,t.raw=ZX.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function YY(e,t,n){var r=new vY("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function $Y(e,t,n){var r=new vY("Property");return r.key=t,r.value=n,r.kind=e,r}function JY(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return _Y(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=eY,n.description=a,n}function QY(e){2===e.type&&JY(e,"Unexpected end of input"),6===e.type&&JY(e,"Unexpected number"),8===e.type&&JY(e,"Unexpected string"),3===e.type&&JY(e,"Unexpected identifier"),4===e.type&&JY(e,"Unexpected reserved word"),JY(e,bY,e.value)}function ZY(e){var t=VY();7===t.type&&t.value===e||QY(t)}function e$(e){return 7===nY.type&&nY.value===e}function t$(e){return 4===nY.type&&nY.value===e}function n$(){var e=[];for(eY=nY.start,ZY("[");!e$("]");)e$(",")?(VY(),e.push(null)):(e.push(p$()),e$("]")||ZY(","));return VY(),function(e){var t=new vY("ArrayExpression");return t.elements=e,t}(e)}function r$(){var e;return eY=nY.start,8===(e=VY()).type||6===e.type?(e.octal&&JY(e,xY),XY(e)):KY(e.value)}function a$(){var e,t,n;return eY=nY.start,3===(e=nY).type?(n=r$(),ZY(":"),$Y("init",n,p$())):2!==e.type&&7!==e.type?(t=r$(),ZY(":"),$Y("init",t,p$())):void QY(e)}function i$(){var e,t,n=[],r={},a=String;for(eY=nY.start,ZY("{");!e$("}");)t="$"+((e=a$()).key.type===mY?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?JY({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),e$("}")||ZY(",");return ZY("}"),function(e){var t=new vY("ObjectExpression");return t.properties=e,t}(n)}var o$={if:1};function u$(){var e,t,n;if(e$("("))return function(){var e;return ZY("("),e=v$(),ZY(")"),e}();if(e$("["))return n$();if(e$("{"))return i$();if(e=nY.type,eY=nY.start,3===e||o$[nY.value])n=KY(VY().value);else if(8===e||6===e)nY.octal&&JY(nY,xY),n=XY(VY());else{if(4===e)throw new Error(kY);1===e?((t=VY()).value="true"===t.value,n=XY(t)):5===e?((t=VY()).value=null,n=XY(t)):e$("/")||e$("/=")?(n=XY(WY()),qY()):QY(VY())}return n}function c$(){var e=[];if(ZY("("),!e$(")"))for(;eY<tY&&(e.push(p$()),!e$(")"));)ZY(",");return ZY(")"),e}function s$(){return ZY("."),function(){var e;return eY=nY.start,function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e=VY())||QY(e),KY(e.value)}()}function l$(){var e;return ZY("["),e=v$(),ZY("]"),e}function f$(){var e=function(){var e;for(e=u$();;)if(e$("."))e=YY(".",e,s$());else if(e$("("))e=GY(e,c$());else{if(!e$("["))break;e=YY("[",e,l$())}return e}();if(7===nY.type&&(e$("++")||e$("--")))throw new Error(kY);return e}function d$(){var e,t;if(7!==nY.type&&4!==nY.type)t=f$();else{if(e$("++")||e$("--"))throw new Error(kY);if(e$("+")||e$("-")||e$("~")||e$("!"))e=VY(),t=d$(),t=function(e,t){var n=new vY("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(t$("delete")||t$("void")||t$("typeof"))throw new Error(kY);t=f$()}}return t}function h$(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function p$(){var e,t;return e=function(){var e,t,n,r,a,i,o,u,c,s;if(e=nY,c=d$(),0===(a=h$(r=nY)))return c;for(r.prec=a,VY(),t=[e,nY],i=[c,r,o=d$()];(a=h$(nY))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),u=i.pop().value,c=i.pop(),t.pop(),n=HY(u,c,o),i.push(n);(r=VY()).prec=a,i.push(r),t.push(nY),n=d$(),i.push(n)}for(n=i[s=i.length-1],t.pop();s>1;)t.pop(),n=HY(i[s-1].value,i[s-2],n),s-=2;return n}(),e$("?")&&(VY(),t=p$(),ZY(":"),e=function(e,t,n){var r=new vY("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,p$())),e}function v$(){var e=p$();if(e$(","))throw new Error(kY);return e}function m$(e,t,n){return e.fields=t||[],e.fname=n,e}function b$(e){return 1===e.length?g$(e[0]):y$(e)}var g$=function(e){return function(t){return t[e]}},y$=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function x$(e){throw Error(e)}function O$(e){var t,n,r,a=[],i=e.length,o=null,u=0,c="";function s(){a.push(c+e.substring(t,n)),c="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))c+=e.substring(t,n),c+=e.substring(++n,++n),t=n;else if(r===o)s(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&s(),u=t=n+1):"]"===r&&(u||x$("Access path missing open bracket: "+e),u>0&&s(),u=0,t=n+1):n>t?s():t=n+1}return u&&x$("Access path missing closing bracket: "+e),o&&x$("Access path missing closing quote: "+e),n>t&&(n++,s()),a}function k$(e,t,n){var r=O$(e);return e=1===r.length?r[0]:e,m$((n&&n.get||b$)(r),[e],t||e)}k$("id"),m$((function(e){return e}),[],"identity"),m$((function(){return 0}),[],"zero"),m$((function(){return 1}),[],"one"),m$((function(){return!0}),[],"true"),m$((function(){return!1}),[],"false");Array.isArray;Object.prototype.hasOwnProperty;function w$(e){var t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push.apply(t,Object(Jc.a)(w$(e.object))),t.push.apply(t,Object(Jc.a)(w$(e.property)))),t)}function j$(e){return"MemberExpression"===e.object.type?j$(e.object):"datum"===e.object.name}function _$(e){var t=function(e){eY=0,tY=(ZX=e).length,nY=null,qY();var t=v$();if(2!==nY.type)throw new Error("Unexpect token after expression.");return t}(e),n=new Set;return t.visit((function(e){"MemberExpression"===e.type&&j$(e)&&n.add(w$(e).slice(1).join("."))})),n}var S$=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a){var i;return Object(iO.a)(this,n),(i=t.call(this,e)).model=r,i.filter=a,i.expr=A$(i.model,i.filter,Object(tK.a)(i)),i._dependentFields=_$(i.expr),i}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,this.model,Hz(this.filter))}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"producedFields",value:function(){return new Set}},{key:"assemble",value:function(){return{type:"filter",expr:this.expr}}},{key:"hash",value:function(){return"Filter ".concat(this.expr)}}]),n}(lX);function E$(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum",a=[];function i(t){var i=lL(t),o=e.getSelectionComponent(i,t),u=Nz(i+VX);if(o.project.timeUnit){var c=null!==n&&void 0!==n?n:e.component.data.raw,s=o.project.timeUnit.clone();c.parent?s.insertAsParentOf(c):c.parent=s}return"none"!==o.empty&&a.push(u),"vlSelectionTest(".concat(u,", ").concat(r)+("global"===o.resolve?")":", ".concat(Nz(o.resolve),")"))}var o=fL(t,i);return(a.length?"!("+a.map((function(e){return"length(data(".concat(e,"))")})).join(" || ")+") || ":"")+"(".concat(o,")")}function C$(e,t){var n=t.encoding,r=t.field;if(n||r){if(n&&!r){var a=e.project.items.filter((function(e){return e.channel===n}));!a.length||a.length>1?(r=e.project.items[0].field,uU((a.length?"Multiple ":"No ")+"matching ".concat(Nz(n)," encoding found for selection ").concat(Nz(t.selection),". ")+'Using "field": '.concat(Nz(r),"."))):r=a[0].field}}else r=e.project.items[0].field,e.project.items.length>1&&uU('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(Nz(r),"."));return"".concat(e.name,"[").concat(Nz(r),"]")}function A$(e,t,n){return fL(t,(function(t){return Az(t)?t:function(e){return null===e||void 0===e?void 0:e.selection}(t)?E$(e,t.selection,n):qU(t)}))}function N$(e,t){if(e)return bz(e)&&!eH(e)?e.map((function(e){return Bq(e,t)})).join(", "):e}function T$(e,t,n,r){var a,i,o;e.encode=null!==(a=e.encode)&&void 0!==a?a:{},e.encode[t]=null!==(i=e.encode[t])&&void 0!==i?i:{},e.encode[t].update=null!==(o=e.encode[t].update)&&void 0!==o?o:{},e.encode[t].update[n]=r}function I$(e,t,n){var r,a,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1},o=e.combine(),u=o.disable,c=o.orient,s=o.scale,l=o.labelExpr,f=o.title,d=o.zindex,h=Iz(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!u){for(var p in h){var v=NL[p],m=h[p];if(v&&v!==t&&"both"!==v)delete h[p];else if(CL(m)){var b=m.condition,g=Iz(m,["condition"]),y=wz(b),x=EL[p];if(x){var O=x.vgProp,k=x.part,w=[].concat(Object(Jc.a)(y.map((function(e){var t=e.test,n=Iz(e,["test"]);return Object.assign({test:A$(null,t)},n)}))),[g]);T$(h,k,O,w),delete h[p]}else if(null===x){var j={signal:y.map((function(e){var t=e.test,n=Iz(e,["test"]);return"".concat(A$(null,t)," ? ").concat(nH(n)," : ")})).join("")+nH(g)};h[p]=j}}else if(EU(m)){var _=EL[p];if(_){var S=_.vgProp,E=_.part;T$(h,E,S,m),delete h[p]}}}if("grid"===t){if(!h.grid)return;if(h.encode){var C=h.encode.grid;h.encode=Object.assign({},C?{grid:C}:{}),iL(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:s,orient:c},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:OL(d,0)})}if(i.header||!e.mainExtracted){if(void 0!==l){var A=l;(null===(a=null===(r=h.encode)||void 0===r?void 0:r.labels)||void 0===a?void 0:a.update)&&EU(h.encode.labels.update.text)&&(A=gL(l,"datum.label",h.encode.labels.update.text.signal)),T$(h,"labels","text",{signal:A})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){var N,T=Object(mo.a)(AL);try{for(T.s();!(N=T.n()).done;){var I=N.value;e.hasAxisPart(I)||delete h.encode[I]}}catch(F){T.e(F)}finally{T.f()}iL(h.encode)&&delete h.encode}var D=N$(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:s,orient:c,grid:!1},D?{title:D}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:OL(d,0)})}}}function D$(e){var t,n=e.component.axes,r=[],a=Object(mo.a)(bB);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(n[i]){var o,u=Object(mo.a)(n[i]);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(!c.get("disable")&&!c.get("gridScale")){var s="x"===i?"height":"width",l=e.getSizeSignalRef(s).signal;s!==l&&r.push({name:s,update:l})}}}catch(f){u.e(f)}finally{u.f()}}}}catch(f){a.e(f)}finally{a.f()}return r}var F$={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},M$={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},R$=oL(F$),z$=oL(M$);function L$(e,t,n,r){return Object.assign.apply(null,[{}].concat(Object(Jc.a)(e.map((function(e){if("axisOrient"===e){var a,i="x"===n?"bottom":"left",o=t["x"===n?"axisBottom":"axisLeft"]||{},u=t["x"===n?"axisTop":"axisRight"]||{},c=new Set([].concat(Object(Jc.a)(oL(o)),Object(Jc.a)(oL(u)))),s={},l=Object(mo.a)(c.values());try{for(l.s();!(a=l.n()).done;){var f=a.value;s[f]={signal:"".concat(r.signal,' === "').concat(i,'" ? ').concat(rH(o[f])," : ").concat(rH(u[f]))}}}catch(d){l.e(d)}finally{l.f()}return s}return t[e]})))))}function P$(e,t,n,r){var a="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:t in yV?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],i="x"===e?"axisX":"axisY",o=EU(n)?"axisOrient":"axis"+hL(n),u=[].concat(a,Object(Jc.a)(a.map((function(e){return i+e.substr(4)})))),c=["axis",o,i];return{vlOnlyAxisConfig:L$(u,r,e,n),vgAxisConfig:L$(c,r,e,n),axisConfigStyle:B$([].concat(c,Object(Jc.a)(u)),r)}}function B$(e,t){var n,r,a=[{}],i=Object(mo.a)(e);try{for(i.s();!(r=i.n()).done;){var o=null===(n=t[r.value])||void 0===n?void 0:n.style;if(o){o=wz(o);var u,c=Object(mo.a)(o);try{for(c.s();!(u=c.n()).done;){var s=u.value;a.push(t.style[s])}}catch(l){c.e(l)}finally{c.f()}}}}catch(l){i.e(l)}finally{i.f()}return Object.assign.apply(null,a)}function W$(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=cH(e,n,t.style);if(void 0!==i)return{configFrom:"style",configValue:i};for(var o=0,u=["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"];o<u.length;o++){var c=u[o];if(void 0!==(null===(r=a[c])||void 0===r?void 0:r[e]))return{configFrom:c,configValue:a[c][e]}}return{}}var U$={scale:function(e){var t=e.model,n=e.channel;return t.scaleName(n)},format:function(e){var t=e.fieldOrDatumDef,n=e.config,r=e.axis,a=r.format,i=r.formatType;return YV(t,t.type,a,i,n,!0)},formatType:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.scaleType,a=t.formatType;return $V(a,n,r)},grid:function(e){var t,n=e.fieldOrDatumDef,r=e.axis,a=e.scaleType;return(!bq(n)||!DB(n.bin))&&(null!==(t=r.grid)&&void 0!==t?t:function(e,t){return!wV(e)&&bq(t)&&!IB(null===t||void 0===t?void 0:t.bin)}(a,n))},gridScale:function(e){return function(e,t){var n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n);return}(e.model,e.channel)},labelAlign:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,a=e.channel;return t.labelAlign||H$(n,r,a)},labelAngle:function(e){return e.labelAngle},labelBaseline:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,a=e.channel;return t.labelBaseline||q$(n,r,a)},labelFlush:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.channel;return null!==(t=n.labelFlush)&&void 0!==t?t:function(e,t){if("x"===t&&Jz(["quantitative","temporal"],e))return!0;return}(r.type,a)},labelOverlap:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.scaleType;return null!==(t=n.labelOverlap)&&void 0!==t?t:function(e,t){if("nominal"!==e)return"log"!==t||"greedy";return}(r.type,a)},orient:function(e){return e.orient},tickCount:function(e){var t,n=e.channel,r=e.model,a=e.axis,i=e.fieldOrDatumDef,o=e.scaleType,u="x"===n?"width":"y"===n?"height":void 0,c=u?r.getSizeSignalRef(u):void 0;return null!==(t=a.tickCount)&&void 0!==t?t:function(e){var t,n=e.fieldOrDatumDef,r=e.scaleType,a=e.size;if(!e.values&&!wV(r)&&"log"!==r){if(bq(n)){if(IB(n.bin))return{signal:"ceil(".concat(a.signal,"/10)")};if(n.timeUnit&&Jz(["month","hours","day","quarter"],null===(t=_U(n.timeUnit))||void 0===t?void 0:t.unit))return}return{signal:"ceil(".concat(a.signal,"/40)")}}return}({fieldOrDatumDef:i,scaleType:o,size:c,values:a.values})},title:function(e){var t=e.axis,n=e.model,r=e.channel;if(void 0!==t.title)return t.title;var a=G$(n,r);if(void 0!==a)return a;var i=n.typedFieldDef(r),o="x"===r?"x2":"y2",u=n.fieldDef(o);return lH(i?[lq(i)]:[],bq(u)?[lq(u)]:[])},values:function(e){return function(e,t){var n=e.values;if(bz(n))return Jq(t,n);if(EU(n))return n;return}(e.axis,e.fieldOrDatumDef)},zindex:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.mark;return null!==(t=n.zindex)&&void 0!==t?t:function(e,t){if("rect"===e&&Tq(t))return 1;return 0}(a,r)}};function V$(e){return"(((".concat(e.signal," % 360) + 360) % 360)")}function q$(e,t,n,r){if(void 0!==e){if("x"===n){if(EU(e)){var a=V$(e),i=EU(t)?"(".concat(t.signal,' === "top")'):"top"===t;return{signal:"(45 < ".concat(a," && ").concat(a," < 135) || (225 < ").concat(a," && ").concat(a,' < 315) ? "middle" :')+"(".concat(a," <= 45 || 315 <= ").concat(a,") === ").concat(i,' ? "bottom" : "top"')}}if(45<e&&e<135||225<e&&e<315)return"middle";if(EU(t)){var o=e<=45||315<=e?"===":"!==";return{signal:"".concat(t.signal," ").concat(o,' "top" ? "bottom" : "top"')}}return(e<=45||315<=e)===("top"===t)?"bottom":"top"}if(EU(e)){var u=V$(e),c=EU(t)?"(".concat(t.signal,' === "left")'):"left"===t,s=r?'"middle"':"null";return{signal:"".concat(u," <= 45 || 315 <= ").concat(u," || (135 <= ").concat(u," && ").concat(u," <= 225) ? ").concat(s," : (45 <= ").concat(u," && ").concat(u," <= 135) === ").concat(c,' ? "top" : "bottom"')}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(EU(t)){var l=45<=e&&e<=135?"===":"!==";return{signal:"".concat(t.signal," ").concat(l,' "left" ? "top" : "bottom"')}}return(45<=e&&e<=135)===("left"===t)?"top":"bottom"}}function H$(e,t,n){if(void 0!==e){var r="x"===n,a=r?0:90,i=r?"bottom":"left";if(EU(e)){var o=V$(e),u=EU(t)?"(".concat(t.signal,' === "').concat(i,'")'):t===i;return{signal:"(".concat(a?"("+o+" + 90)":o," % 180 === 0) ? ").concat(r?null:'"center"'," :")+"(".concat(a," < ").concat(o," && ").concat(o," < ").concat(180+a,") === ").concat(u,' ? "left" : "right"')}}if((e+a)%180===0)return r?null:"center";if(EU(t)){var c=a<e&&e<180+a?"===":"!==",s="".concat(t.signal," ").concat(c,' "').concat(i,'"');return{signal:"".concat(s,' ? "left" : "right"')}}return(a<e&&e<180+a)===(t===i)?"left":"right"}}function G$(e,t){var n="x"===t?"x2":"y2",r=e.fieldDef(t),a=e.fieldDef(n),i=r?r.title:void 0,o=a?a.title:void 0;return i&&o?fH(i,o):i||(o||(void 0!==i?i:void 0!==o?o:void 0))}var K$=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a._dependentFields=_$(a.transform.calculate),a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"producedFields",value:function(){return new Set([this.transform.as])}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"assemble",value:function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}},{key:"hash",value:function(){return"Calculate ".concat(Yz(this.transform))}}],[{key:"parseAllForSortIndex",value:function(e,t){return t.forEachFieldDef((function(t,r){if(_q(t)&&oq(t.sort)){var a=t.field,i=t.timeUnit,o=t.sort,u=o.map((function(e,t){return"".concat(qU({field:a,timeUnit:i,equal:e})," ? ").concat(t," : ")})).join("")+o.length;e=new n(e,{calculate:u,as:X$(t,r,{forAs:!0})})}})),e}}]),n}(lX);function X$(e,t,n){return Nq(e,Object.assign({prefix:t,suffix:"sort_index"},null!==n&&void 0!==n?n:{}))}function Y$(e,t){return Jz(["top","bottom"],t)?"column":Jz(["left","right"],t)||"row"===e?"row":"column"}function $$(e,t,n,r){var a="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return OL(((null===t||void 0===t?void 0:t.header)||{})[e],a[e],n.header[e])}function J$(e,t,n,r){var a,i={},o=Object(mo.a)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value,c=$$(u,t,n,r);void 0!==c&&(i[u]=c)}}catch(s){o.e(s)}finally{o.f()}return i}var Q$=["row","column"],Z$=["header","footer"];function eJ(e,t){var n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,a=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,i=J$(["titleAnchor","titleAngle","titleOrient"],a,r,t),o=i.titleAnchor,u=i.titleAngle,c=Y$(t,i.titleOrient),s=_L(u);return{name:"".concat(t,"-title"),type:"group",role:"".concat(c,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),nJ(s,c)),tJ(c,s,o)),sJ(r,a,t,R$,F$))}}function tJ(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle";switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}var r=H$(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function nJ(e,t){var n=q$(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function rJ(e,t){var n,r=e.component.layoutHeaders[t],a=[],i=Object(mo.a)(Z$);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(r[o]){var u,c=Object(mo.a)(r[o]);try{for(c.s();!(u=c.n()).done;){var s=oJ(e,t,o,r,u.value);null!=s&&a.push(s)}}catch(l){c.e(l)}finally{c.f()}}}}catch(l){i.e(l)}finally{i.f()}return a}function aJ(e,t){var n,r=e.sort;return iq(r)?{field:Nq(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:bz(r)?{field:X$(e,t,{expr:"datum"}),order:"ascending"}:{field:Nq(e,{expr:"datum"}),order:null!==r&&void 0!==r?r:"ascending"}}function iJ(e,t,n){var r=J$(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),a=r.format,i=r.formatType,o=r.labelAngle,u=r.labelAnchor,c=r.labelOrient,s=r.labelExpr,l=GV({fieldOrDatumDef:e,format:a,formatType:i,expr:"parent",config:n}).signal,f=Y$(t,c);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:s?gL(gL(s,"datum.label",l),"datum.value",Nq(e,{expr:"parent"})):l}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),nJ(o,f)),tJ(f,o,u)),sJ(n,e,t,z$,M$))}function oJ(e,t,n,r,a){if(a){var i=null,o=r.facetFieldDef,u=e.config?e.config:void 0;if(o&&a.labels){var c=J$(["labelOrient"],o,u,t).labelOrient;("row"===t&&!Jz(["top","bottom"],c)||"column"===t&&!Jz(["left","right"],c))&&(i=iJ(o,t,u))}var s=cZ(e)&&!uq(e.facet),l=a.axes,f=(null===l||void 0===l?void 0:l.length)>0;if(i||f){var d="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("".concat(t,"_").concat(n)),type:"group",role:"".concat(t,"-").concat(n)},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:aJ(o,t)}:{}),f&&s?{from:{data:e.getName("facet_domain_".concat(t))}}:{}),i?{title:i}:{}),a.sizeSignal?{encode:{update:Object(vt.a)({},d,a.sizeSignal)}}:{}),f?{axes:l}:{})}}return null}var uJ={column:{start:0,end:1},row:{start:1,end:0}};function cJ(e,t){return uJ[t][e]}function sJ(e,t,n,r,a){var i,o={},u=Object(mo.a)(r);try{for(u.s();!(i=u.n()).done;){var c=i.value;if(a[c]){var s=$$(c,t,e,n);void 0!==s&&(o[a[c]]=s)}}}catch(l){u.e(l)}finally{u.f()}return o}function lJ(e){return[].concat(Object(Jc.a)(fJ(e,"width")),Object(Jc.a)(fJ(e,"height")),Object(Jc.a)(fJ(e,"childWidth")),Object(Jc.a)(fJ(e,"childHeight")))}function fJ(e,t){var n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];var a=e.getSizeSignalRef(t).signal;if("step"===r){var i=e.getScaleComponent(n);if(i){var o=i.get("type"),u=i.get("range");if(wV(o)&&CU(u)){var c=e.scaleName(n);if(cZ(e.parent))if("independent"===e.parent.component.resolve.scale[n])return[dJ(c,u)];return[dJ(c,u),{name:a,update:hJ(c,i,"domain('".concat(c,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){var s=a.endsWith("width"),l=s?"containerSize()[0]":"containerSize()[1]",f=aG(e.config.view,s?"width":"height"),d="isFinite(".concat(l,") ? ").concat(l," : ").concat(f);return[{name:a,init:d,on:[{update:d,events:"window:resize"}]}]}return[{name:a,value:r}]}function dJ(e,t){return{name:e+"_step",value:t.step}}function hJ(e,t,n){var r=t.get("type"),a=t.get("padding"),i=OL(t.get("paddingOuter"),a),o=t.get("paddingInner");return o="band"===r?void 0!==o?o:a:1,"bandspace(".concat(n,", ").concat(o,", ").concat(i,") * ").concat(e,"_step")}function pJ(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function vJ(e,t){return oL(e).reduce((function(n,r){var a=e[r];return Object.assign(Object.assign({},n),RK(t,a,r,(function(e){return EU(e)?e:{value:e.value}})))}),{})}function mJ(e,t){if(lZ(t)||cZ(t))return"shared";if(sZ(t))return gB(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function bJ(e,t){var n=e.scale[t],r=gB(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&uU(g.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}var gJ=Object.assign(Object.assign({},KH),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),yJ=oL(gJ),xJ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return n}(nK),OJ={symbols:function(e,t){var n,r,a,i,o,u=t.fieldOrDatumDef,c=t.model,s=t.channel,l=t.legendCmpt;if("symbol"!==t.legendType)return;var f=c.markDef,d=c.encoding,h=c.config,p=c.mark,v=f.filled&&"trail"!==p,m=Object.assign(Object.assign({},function(e,t,n){var r,a=Object(mo.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=oH(i,t.markDef,t.config);void 0!==o&&(e[i]=tH(o))}}catch(u){a.e(u)}finally{a.f()}return e}({},c,ZL)),qK(c,{filled:v})),b=null!==(n=kJ(d.opacity))&&void 0!==n?n:f.opacity;if(m.fill)if("fill"===s||v&&s===NP)delete m.fill;else if(m.fill.field)l.get("symbolFillColor")?delete m.fill:(m.fill=tH(null!==(r=h.legend.symbolBaseFillColor)&&void 0!==r?r:"black"),m.fillOpacity=tH(null!==b&&void 0!==b?b:1));else if(bz(m.fill)){var g=null!==(o=null!==(i=wJ(null!==(a=d.fill)&&void 0!==a?a:d.color))&&void 0!==i?i:f.fill)&&void 0!==o?o:v&&f.color;g&&(m.fill=tH(g))}if(m.stroke)if("stroke"===s||!v&&s===NP)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(bz(m.stroke)){var y=OL(wJ(d.stroke||d.color),f.stroke,v?f.color:void 0);y&&(m.stroke={value:y})}if(s!==RP){var x=bq(u)&&_J(c,l,u);x?m.opacity=[Object.assign({test:x},tH(null!==b&&void 0!==b?b:1)),tH(h.legend.unselectedOpacity)]:b&&(m.opacity=tH(b))}return iL(m=Object.assign(Object.assign({},m),e))?void 0:m},gradient:function(e,t){var n=t.model;if("gradient"!==t.legendType)return;var r={},a=kJ(n.encoding.opacity)||n.markDef.opacity;a&&(r.opacity=tH(a));return iL(r=Object.assign(Object.assign({},r),e))?void 0:r},labels:function(e,t){var n=t.fieldOrDatumDef,r=t.model,a=t.channel,i=t.legendCmpt,o=r.legend(a)||{},u=r.config,c=bq(n)?_J(r,i,n):void 0,s=c?[{test:c,value:1},{value:u.legend.unselectedOpacity}]:void 0,l=o.format,f=o.formatType,d=qV(f)?XV({fieldOrDatumDef:n,field:"datum.value",format:l,formatType:f,config:u}):void 0,h=Object.assign(Object.assign(Object.assign({},s?{opacity:s}:{}),d?{text:d}:{}),e);return iL(h)?void 0:h},entries:function(e,t){var n=t.legendCmpt.get("selections");return(null===n||void 0===n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function kJ(e){return jJ(e,(function(e,t){return Math.max(e,t.value)}))}function wJ(e){return jJ(e,(function(e,t){return OL(e,t.value)}))}function jJ(e,t){return function(e){var t=e&&e.condition;return!!t&&(bz(t)||jq(t))}(e)?wz(e.condition).reduce(t,e.value):jq(e)?e.value:void 0}function _J(e,t,n){var r=t.get("selections");if(null===r||void 0===r?void 0:r.length){var a=Nz(n.field);return r.map((function(e){var t=Nz(lL(e)+VX);return"(!length(data(".concat(t,")) || (").concat(e,"[").concat(a,"] && indexof(").concat(e,"[").concat(a,"], datum.value) >= 0))")})).join(" || ")}}var SJ={direction:function(e){return e.direction},format:function(e){var t=e.fieldOrDatumDef,n=e.legend,r=e.config,a=n.format,i=n.formatType;return YV(t,t.type,a,i,r,!1)},formatType:function(e){var t=e.legend,n=e.fieldOrDatumDef,r=e.scaleType,a=t.formatType;return $V(a,n,r)},gradientLength:function(e){var t,n,r=e.legend,a=e.legendConfig;return null!==(n=null!==(t=r.gradientLength)&&void 0!==t?t:a.gradientLength)&&void 0!==n?n:function(e){var t=e.legendConfig,n=e.model,r=e.direction,a=e.orient,i=e.scaleType,o=t.gradientHorizontalMaxLength,u=t.gradientHorizontalMinLength,c=t.gradientVerticalMaxLength,s=t.gradientVerticalMinLength;if(_V(i))return"horizontal"===r?"top"===a||"bottom"===a?AJ(n,"width",u,o):u:AJ(n,"height",s,c);return}(e)},labelOverlap:function(e){var t,n,r=e.legend,a=e.legendConfig,i=e.scaleType;return null!==(n=null!==(t=r.labelOverlap)&&void 0!==t?t:a.labelOverlap)&&void 0!==n?n:function(e){if(Jz(["quantile","threshold","log"],e))return"greedy";return}(i)},symbolType:function(e){var t,n=e.legend,r=e.markDef,a=e.channel,i=e.encoding;return null!==(t=n.symbolType)&&void 0!==t?t:function(e,t,n,r){var a;if("shape"!==t){var i=null!==(a=wJ(n))&&void 0!==a?a:r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(r.type,a,i.shape,r.shape)},title:function(e){return Lq(e.fieldOrDatumDef,e.config,{allowDisabling:!0})},type:function(e){var t=e.legendType,n=e.scaleType;if(eB(e.channel)&&_V(n)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:function(e){var t=e.fieldOrDatumDef;return function(e,t){var n=e.values;if(bz(n))return Jq(t,n);if(EU(n))return n;return}(e.legend,t)}};function EJ(e){return OL(e.legend.type,function(e){var t=e.channel,n=e.timeUnit,r=e.scaleType;if(eB(t)){if(Jz(["quarter","month","day"],n))return"symbol";if(_V(r))return"gradient"}return"symbol"}(e))}function CJ(e){var t,n,r=e.legendConfig,a=e.legendType,i=e.orient;return null!==(n=null!==(t=e.legend.direction)&&void 0!==t?t:r[a?"gradientDirection":"symbolDirection"])&&void 0!==n?n:function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(i,a)}function AJ(e,t,n,r){var a=e.getSizeSignalRef(t).signal;return{signal:"clamp(".concat(a,", ").concat(n,", ").concat(r,")")}}function NJ(e){var t=uZ(e)?function(e){for(var t=e.encoding,n={},r=0,a=[NP].concat(Object(Jc.a)(HH));r<a.length;r++){var i=a[r],o=Vq(t[i]);o&&e.getScaleComponent(i)&&(i===DP&&bq(o)&&o.type===QU||(n[i]=IJ(e,i)))}return n}(e):function(e){var t,n=e.component,r=n.legends,a=n.resolve,i=Object(mo.a)(e.children);try{for(i.s();!(t=i.n()).done;){var o=t.value;NJ(o);var u,c=Object(mo.a)(oL(o.component.legends));try{for(c.s();!(u=c.n()).done;){var s=u.value;a.legend[s]=bJ(e.component.resolve,s),"shared"===a.legend[s]&&(r[s]=DJ(r[s],o.component.legends[s]),r[s]||(a.legend[s]="independent",delete r[s]))}}catch(m){c.e(m)}finally{c.f()}}}catch(m){i.e(m)}finally{i.f()}var l,f=Object(mo.a)(oL(r));try{for(f.s();!(l=f.n()).done;){var d,h=l.value,p=Object(mo.a)(e.children);try{for(p.s();!(d=p.n()).done;){var v=d.value;v.component.legends[h]&&("shared"===a.legend[h]&&delete v.component.legends[h])}}catch(m){p.e(m)}finally{p.f()}}}catch(m){f.e(m)}finally{f.f()}return r}(e);return e.component.legends=t,t}function TJ(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!(null===n||void 0===n?void 0:n.values);case"title":if("title"===t&&e===(null===r||void 0===r?void 0:r.title))return!0}return e===(n||{})[t]}function IJ(e,t){var n,r,a,i=e.legend(t),o=e.markDef,u=e.encoding,c=e.config,s=c.legend,l=new xJ({},function(e,t){var n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:Object(vt.a)({},t,n)}(e,t));!function(e,t,n){var r,a=null===(r=e.fieldDef(t))||void 0===r?void 0:r.field;XX(e,(function(e){var r,i,o=null!==(r=e.project.hasField[a])&&void 0!==r?r:e.project.hasChannel[t];if(o&&kX.has(e)){var u=null!==(i=n.get("selections"))&&void 0!==i?i:[];u.push(e.name),n.set("selections",u,!1),o.hasLegend=!0}}))}(e,t,l);var f=void 0!==i?!i:s.disable;if(l.set("disable",f,void 0!==i),f)return l;i=i||{};var d,h=e.getScaleComponent(t).get("type"),p=Vq(u[t]),v=bq(p)?null===(n=_U(p.timeUnit))||void 0===n?void 0:n.unit:void 0,m=i.orient||c.legend.orient||"right",b=EJ({legend:i,channel:t,timeUnit:v,scaleType:h}),g={legend:i,channel:t,model:e,markDef:o,encoding:u,fieldOrDatumDef:p,legendConfig:s,config:c,scaleType:h,orient:m,legendType:b,direction:CJ({legend:i,legendType:b,orient:m,legendConfig:s})},y=Object(mo.a)(yJ);try{for(y.s();!(d=y.n()).done;){var x=d.value,O=x in SJ?SJ[x](g):i[x];if(void 0!==O){var k=TJ(O,x,i,e.fieldDef(t));(k||void 0===c.legend[x])&&l.set(x,O,k)}}}catch(I){y.e(I)}finally{y.f()}for(var w=null!==(r=null===i||void 0===i?void 0:i.encoding)&&void 0!==r?r:{},j=l.get("selections"),_={},S={fieldOrDatumDef:p,model:e,channel:t,legendCmpt:l,legendType:b},E=0,C=["labels","legend","title","symbols","gradient","entries"];E<C.length;E++){var A=C[E],N=vJ(null!==(a=w[A])&&void 0!==a?a:{},e),T=A in OJ?OJ[A](N,S):N;void 0===T||iL(T)||(_[A]=Object.assign(Object.assign(Object.assign({},(null===j||void 0===j?void 0:j.length)&&bq(p)?{name:"".concat(lL(p.field),"_legend_").concat(A)}:{}),(null===j||void 0===j?void 0:j.length)?{interactive:!!j}:{}),{update:T}))}return iL(_)||l.set("encode",_,!!(null===i||void 0===i?void 0:i.encoding)),l}function DJ(e,t){var n,r,a,i;if(!e)return t.clone();var o=e.getWithExplicit("orient"),u=t.getWithExplicit("orient");if(!o.explicit||!u.explicit||o.value===u.value){var c,s=!1,l=Object(mo.a)(yJ);try{var f=function(){var n=c.value,r=uK(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(function(e,t){switch(n){case"symbolType":return function(e,t){if("circle"===t.value)return t;return e}(e,t);case"title":return dH(e,t);case"type":return s=!0,aK("symbol")}return oK(e,t,n,"legend")}));e.setWithExplicit(n,r)};for(l.s();!(c=l.n()).done;)f()}catch(d){l.e(d)}finally{l.f()}return s&&((null===(r=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&dL(e.implicit,["encode","gradient"]),(null===(i=null===(a=e.explicit)||void 0===a?void 0:a.encode)||void 0===i?void 0:i.gradient)&&dL(e.explicit,["encode","gradient"])),e}}function FJ(e,t,n,r){var a,i,o;e.encode=null!==(a=e.encode)&&void 0!==a?a:{},e.encode[t]=null!==(i=e.encode[t])&&void 0!==i?i:{},e.encode[t].update=null!==(o=e.encode[t].update)&&void 0!==o?o:{},e.encode[t].update[n]=r}function MJ(e){var t,n=e.component.legends,r={},a=Object(mo.a)(oL(n));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=e.getScaleComponent(i),u=Xz(o.get("domains"));if(r[u]){var c,s=Object(mo.a)(r[u]);try{for(s.s();!(c=s.n()).done;){DJ(c.value,n[i])||r[u].push(n[i])}}catch(l){s.e(l)}finally{s.f()}}else r[u]=[n[i].clone()]}}catch(l){a.e(l)}finally{a.f()}return uL(r).flat().map((function(t){return function(e,t){var n,r,a,i=e.combine(),o=i.disable,u=i.labelExpr,c=(i.selections,Iz(i,["disable","labelExpr","selections"]));if(o)return;!1===t.aria&&void 0==c.aria&&(c.aria=!1);if(null===(n=c.encode)||void 0===n?void 0:n.symbols){var s=c.encode.symbols.update;!s.fill||"transparent"===s.fill.value||s.stroke||c.stroke||(s.stroke={value:"transparent"});var f,d=Object(mo.a)(HH);try{for(d.s();!(f=d.n()).done;){var h=f.value;c[h]&&delete s[h]}}catch(l){d.e(l)}finally{d.f()}}c.title||delete c.title;if(void 0!==u){var p=u;(null===(a=null===(r=c.encode)||void 0===r?void 0:r.labels)||void 0===a?void 0:a.update)&&EU(c.encode.labels.update.text)&&(p=gL(u,"datum.label",c.encode.labels.update.text.signal)),FJ(c,"labels","text",{signal:p})}for(var v in c){var m=c[v];if(EU(m)){var b=GH[v];if(b){var g=b.vgProp;FJ(c,b.part,g,m),delete c[v]}}}return c}(t,e.config)})).filter((function(e){return void 0!==e}))}function RJ(e){return lZ(e)||sZ(e)?function(e){return e.children.reduce((function(e,t){return e.concat(t.assembleProjections())}),zJ(e))}(e):zJ(e)}function zJ(e){var t=e.component.projection;if(!t||t.merged)return[];var n=t.combine(),r=n.name;if(t.data){var a={signal:"[".concat(t.size.map((function(e){return e.signal})).join(", "),"]")},i=t.data.reduce((function(t,n){var r=EU(n)?n.signal:"data('".concat(e.lookupDataSource(n),"')");return Jz(t,r)||t.push(r),t}),[]);if(i.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:a,fit:{signal:i.length>1?"[".concat(i.join(", "),"]"):i[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}var LJ=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"],PJ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a,i){var o;return Object(iO.a)(this,n),(o=t.call(this,Object.assign({},r),{name:e})).specifiedProjection=r,o.size=a,o.data=i,o.merged=!1,o}return Object(oO.a)(n,[{key:"isFit",get:function(){return!!this.data}}]),n}(nK);function BJ(e){e.component.projection=uZ(e)?function(e){var t;if(e.hasProjection){var n=e.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),a=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=r?function(e){for(var t=[],n=e.encoding,r=0,a=[[EP,SP],[AP,CP]];r<a.length;r++){var i=a[r];(Vq(n[i[0]])||Vq(n[i[1]]))&&t.push({signal:e.getName("geojson_".concat(t.length))})}e.channelHasField(DP)&&e.typedFieldDef(DP).type===QU&&t.push({signal:e.getName("geojson_".concat(t.length))});0===t.length&&t.push(e.requestDataName(mK));return t}(e):void 0;return new PJ(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=e.config.projection)&&void 0!==t?t:{}),null!==n&&void 0!==n?n:{}),a,i)}return}(e):function(e){if(0===e.children.length)return;var t,n,r=Object(mo.a)(e.children);try{for(r.s();!(n=r.n()).done;){BJ(n.value)}}catch(d){r.e(d)}finally{r.f()}var a=Zz(e.children,(function(e){var n=e.component.projection;if(n){if(t){var r=function(e,t){var n=Zz(LJ,(function(n){return!Sz(e.explicit,n)&&!Sz(t.explicit,n)||!(!Sz(e.explicit,n)||!Sz(t.explicit,n)||Xz(e.get(n))!==Xz(t.get(n)))}));if(Xz(e.size)===Xz(t.size)){if(n)return e;if(Xz(e.explicit)===Xz({}))return t;if(Xz(t.explicit)===Xz({}))return e}return null}(t,n);return r&&(t=r),!!r}return t=n,!0}return!0}));if(t&&a){var i,o=e.projectionName(!0),u=new PJ(o,t.specifiedProjection,t.size,Hz(t.data)),c=Object(mo.a)(e.children);try{for(c.s();!(i=c.n()).done;){var s=i.value,l=s.component.projection;if(l){var f;if(l.isFit)(f=u.data).push.apply(f,Object(Jc.a)(s.component.projection.data));s.renameProjection(l.get("name"),o),l.merged=!0}}}catch(d){c.e(d)}finally{c.f()}return u}return}(e)}var WJ=n(158);function UJ(e,t){return"".concat(TB(e),"_").concat(t)}function VJ(e,t,n){var r,a=UJ(null!==(r=Kq(n,void 0))&&void 0!==r?r:{},t);return e.getName("".concat(a,"_bins"))}function qJ(e,t,n){var r,a;r=function(e){return"as"in e}(e)?Az(e.as)?[e.as,"".concat(e.as,"_end")]:[e.as[0],e.as[1]]:[Nq(e,{forAs:!0}),Nq(e,{binSuffix:"end",forAs:!0})];var i=Object.assign({},Kq(t,void 0)),o=UJ(i,e.field),u=function(e,t){return{signal:e.getName("".concat(t,"_bins")),extentSignal:e.getName("".concat(t,"_extent"))}}(n,o),c=u.signal,s=u.extentSignal;if(MB(i.extent)){var l=i.extent,f=l.selection;a=C$(n.getSelectionComponent(lL(f),f),l),delete i.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:i,field:e.field,as:[r]},c?{signal:c}:{}),s?{extentSignal:s}:{}),a?{span:a}:{})}}var HJ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).bins=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.bins))}},{key:"merge",value:function(e,t){var n,r=Object(mo.a)(oL(e.bins));try{for(r.s();!(n=r.n()).done;){var a=n.value;a in this.bins?(t(e.bins[a].signal,this.bins[a].signal),this.bins[a].as=tL([].concat(Object(Jc.a)(this.bins[a].as),Object(Jc.a)(e.bins[a].as)),Yz)):this.bins[a]=e.bins[a]}}catch(c){r.e(c)}finally{r.f()}var i,o=Object(mo.a)(e.children);try{for(o.s();!(i=o.n()).done;){var u=i.value;e.removeChild(u),u.parent=this}}catch(c){o.e(c)}finally{o.f()}e.remove()}},{key:"producedFields",value:function(){return new Set(uL(this.bins).map((function(e){return e.as})).flat(2))}},{key:"dependentFields",value:function(){return new Set(uL(this.bins).map((function(e){return e.field})))}},{key:"hash",value:function(){return"Bin ".concat(Yz(this.bins))}},{key:"assemble",value:function(){return uL(this.bins).flatMap((function(e){var t=[],n=Object(WJ.a)(e.as),r=n[0],a=n.slice(1),i=e.bin,o=i.extent,u=Iz(i,["extent"]),c=Object.assign(Object.assign(Object.assign({type:"bin",field:bL(e.field),as:r,signal:e.signal},MB(o)?{extent:null}:{extent:o}),e.span?{span:{signal:"span(".concat(e.span,")")}}:{}),u);!o&&e.extentSignal&&(t.push({type:"extent",field:bL(e.field),signal:e.extentSignal}),c.extent={signal:e.extentSignal}),t.push(c);var s,l=Object(mo.a)(a);try{for(l.s();!(s=l.n()).done;)for(var f=s.value,d=0;d<2;d++)t.push({type:"formula",expr:Nq({field:r[d]},{expr:"datum"}),as:f[d]})}catch(h){l.e(h)}finally{l.f()}return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))}}],[{key:"makeFromEncoding",value:function(e,t){var r=t.reduceFieldDef((function(e,n,r){if(wq(n)&&IB(n.bin)){var a=qJ(n,n.bin,t),i=a.key,o=a.binComponent;e[i]=Object.assign(Object.assign(Object.assign({},o),e[i]),function(e,t,n,r){var a,i;if(Qq(t,n)){var o=uZ(e)&&null!==(i=null!==(a=e.axis(n))&&void 0!==a?a:e.legend(n))&&void 0!==i?i:{},u=Nq(t,{expr:"datum"}),c=Nq(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Nq(t,{binSuffix:"range",forAs:!0}),formula:eq(u,c,o.format,o.formatType,r)}}return{}}(t,n,r,t.config))}return e}),{});return iL(r)?null:new n(e,r)}},{key:"makeFromTransform",value:function(e,t,r){var a=qJ(t,t.bin,r),i=a.key,o=a.binComponent;return new n(e,Object(vt.a)({},i,o))}}]),n}(lX),GJ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e){var r,a;if(Object(iO.a)(this,n),r=t.call(this,null),dK(e=null!==e&&void 0!==e?e:{name:"source"})||(a=e.format?Object.assign({},Kz(e.format,["parse"])):{}),lK(e))r._data={values:e.values};else if(sK(e)){if(r._data={url:e.url},!a.type){var i=/(?:\.([^.]+))?$/.exec(e.url)[1];Jz(["json","csv","tsv","dsv","topojson"],i)||(i="json"),a.type=i}}else pK(e)?r._data={values:[{type:"Sphere"}]}:(fK(e)||dK(e))&&(r._data={});return r._generator=dK(e),e.name&&(r._name=e.name),a&&!iL(a)&&(r._data.format=a),r}return Object(oO.a)(n,[{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"data",get:function(){return this._data}},{key:"hasName",value:function(){return!!this._name}},{key:"isGenerator",get:function(){return this._generator}},{key:"dataName",get:function(){return this._name},set:function(e){this._name=e}},{key:"parent",set:function(e){throw new Error("Source nodes have to be roots.")}},{key:"remove",value:function(){throw new Error("Source nodes are roots and cannot be removed.")}},{key:"hash",value:function(){throw new Error("Cannot hash sources")}},{key:"assemble",value:function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}]),n}(lX);function KJ(e){var t,n=Object(mo.a)(e);try{for(n.s();!(t=n.n()).done;){var r,a=t.value,i=Object(mo.a)(a.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.parent!==a)return console.error("Dataflow graph is inconsistent.",a,o),!1}}catch(u){i.e(u)}finally{i.f()}if(!KJ(a.children))return!1}}catch(u){n.e(u)}finally{n.f()}return!0}var XJ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).params=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"hash",value:function(){return"Graticule ".concat(Yz(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}]),n}(lX),YJ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).params=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){var e;return new Set([null!==(e=this.params.as)&&void 0!==e?e:"data"])}},{key:"hash",value:function(){return"Hash ".concat(Yz(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"sequence"},this.params)}}]),n}(lX);function $J(e){return e instanceof GJ||e instanceof XJ||e instanceof YJ}var JJ=function(){function e(){Object(iO.a)(this,e),this._mutated=!1}return Object(oO.a)(e,[{key:"setMutated",value:function(){this._mutated=!0}},{key:"mutatedFlag",get:function(){return this._mutated}}]),e}(),QJ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){var e;return Object(iO.a)(this,n),(e=t.call(this))._continue=!1,e}return Object(oO.a)(n,[{key:"setContinue",value:function(){this._continue=!0}},{key:"continueFlag",get:function(){return this._continue}},{key:"flags",get:function(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}},set:function(e){var t=e.continueFlag,n=e.mutatedFlag;t&&this.setContinue(),n&&this.setMutated()}},{key:"reset",value:function(){}},{key:"optimizeNextFromLeaves",value:function(e){if($J(e))return!1;var t=e.parent;return this.run(e).continueFlag&&this.optimizeNextFromLeaves(t),this.mutatedFlag}}]),n}(JJ),ZJ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return n}(JJ);function eQ(e,t,n,r){var a=uZ(r)?r.encoding[dB(t)]:void 0;if(wq(n)&&uZ(r)&&hq(t,n,a,r.stack,r.markDef,r.config))e.add(Nq(n,{})),e.add(Nq(n,{suffix:"end"})),n.bin&&Qq(n,t)&&e.add(Nq(n,{binSuffix:"range"}));else if(t in JP){var i=function(e){switch(e){case SP:return"y";case CP:return"y2";case EP:return"x";case AP:return"x2"}}(t);e.add(r.getName(i))}else e.add(Nq(n));return e}var tQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a){var i;return Object(iO.a)(this,n),(i=t.call(this,e)).dimensions=r,i.measures=a,i}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,new Set(this.dimensions),Hz(this.measures))}},{key:"groupBy",get:function(){return this.dimensions}},{key:"merge",value:function(e){return function(e,t){if(e.size!==t.size)return!1;var n,r=Object(mo.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!t.has(a))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(this.dimensions,e.dimensions)?(function(e,t){var n,r,a=Object(mo.a)(oL(t));try{for(a.s();!(r=a.n()).done;){var i,o=r.value,u=t[o],c=Object(mo.a)(oL(u));try{for(c.s();!(i=c.n()).done;){var s=i.value;o in e?e[o][s]=new Set([].concat(Object(Jc.a)(null!==(n=e[o][s])&&void 0!==n?n:[]),Object(Jc.a)(u[s]))):e[o]=Object(vt.a)({},s,u[s])}}catch(l){c.e(l)}finally{c.f()}}}catch(l){a.e(l)}finally{a.f()}}(this.measures,e.measures),!0):(function(){var e;(e=aU).debug.apply(e,arguments)}("different dimensions, cannot merge"),!1)}},{key:"addDimensions",value:function(e){e.forEach(this.dimensions.add,this.dimensions)}},{key:"dependentFields",value:function(){return new Set([].concat(Object(Jc.a)(this.dimensions),Object(Jc.a)(oL(this.measures))))}},{key:"producedFields",value:function(){var e,t=new Set,n=Object(mo.a)(oL(this.measures));try{for(n.s();!(e=n.n()).done;){var r,a=e.value,i=Object(mo.a)(oL(this.measures[a]));try{for(i.s();!(r=i.n()).done;){var o=r.value,u=this.measures[a][o];0===u.size?t.add("".concat(o,"_").concat(a)):u.forEach(t.add,t)}}catch(c){i.e(c)}finally{i.f()}}}catch(c){n.e(c)}finally{n.f()}return t}},{key:"hash",value:function(){return"Aggregate ".concat(Yz({dimensions:this.dimensions,measures:this.measures}))}},{key:"assemble",value:function(){var e,t=[],n=[],r=[],a=Object(mo.a)(oL(this.measures));try{for(a.s();!(e=a.n()).done;){var i,o=e.value,u=Object(mo.a)(oL(this.measures[o]));try{for(u.s();!(i=u.n()).done;){var c,s=i.value,l=Object(mo.a)(this.measures[o][s]);try{for(l.s();!(c=l.n()).done;){var f=c.value;r.push(f),t.push(s),n.push("*"===o?null:bL(o))}}catch(d){l.e(d)}finally{l.f()}}}catch(d){u.e(d)}finally{u.f()}}}catch(d){a.e(d)}finally{a.f()}return{type:"aggregate",groupby:Object(Jc.a)(this.dimensions).map(bL),ops:t,fields:n,as:r}}}],[{key:"makeFromEncoding",value:function(e,t){var r=!1;t.forEachFieldDef((function(e){e.aggregate&&(r=!0)}));var a={},i=new Set;return r?(t.forEachFieldDef((function(e,n){var r,o,u,c,s=e.aggregate,l=e.field;if(s)if("count"===s)a["*"]=null!==(r=a["*"])&&void 0!==r?r:{},a["*"].count=new Set([Nq(e,{forAs:!0})]);else{if(cP(s)||sP(s)){var f=cP(s)?"argmin":"argmax",d=s[f];a[d]=null!==(o=a[d])&&void 0!==o?o:{},a[d][f]=new Set([Nq({op:f,field:d},{forAs:!0})])}else a[l]=null!==(u=a[l])&&void 0!==u?u:{},a[l][s]=new Set([Nq(e,{forAs:!0})]);SB(n)&&"unaggregated"===t.scaleDomain(n)&&(a[l]=null!==(c=a[l])&&void 0!==c?c:{},a[l].min=new Set([Nq({field:l,aggregate:"min"},{forAs:!0})]),a[l].max=new Set([Nq({field:l,aggregate:"max"},{forAs:!0})]))}else eQ(i,n,e,t)})),i.size+oL(a).length===0?null:new n(e,i,a)):null}},{key:"makeFromTransform",value:function(e,t){var r,a,i,o,u=new Set,c={},s=Object(mo.a)(t.aggregate);try{for(s.s();!(o=s.n()).done;){var l=o.value,f=l.op,d=l.field,h=l.as;f&&("count"===f?(c["*"]=null!==(r=c["*"])&&void 0!==r?r:{},c["*"].count=new Set([h||Nq(l,{forAs:!0})])):(c[d]=null!==(a=c[d])&&void 0!==a?a:{},c[d][f]=new Set([h||Nq(l,{forAs:!0})])))}}catch(b){s.e(b)}finally{s.f()}var p,v=Object(mo.a)(null!==(i=t.groupby)&&void 0!==i?i:[]);try{for(v.s();!(p=v.n()).done;){var m=p.value;u.add(m)}}catch(b){v.e(b)}finally{v.f()}return u.size+oL(c).length===0?null:new n(e,u,c)}}]),n}(lX),nQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a,i){var o;Object(iO.a)(this,n),(o=t.call(this,e)).model=r,o.name=a,o.data=i;var u,c=Object(mo.a)(nB);try{for(c.s();!(u=c.n()).done;){var s=u.value,l=r.facet[s];if(l){var f=l.bin,d=l.sort;o[s]=Object.assign({name:r.getName("".concat(s,"_domain")),fields:[Nq(l)].concat(Object(Jc.a)(IB(f)?[Nq(l,{binSuffix:"end"})]:[]))},iq(d)?{sortField:d}:bz(d)?{sortIndexField:X$(l,s)}:{})}}}catch(h){c.e(h)}finally{c.f()}return o.childModel=r.child,o}return Object(oO.a)(n,[{key:"hash",value:function(){var e,t="Facet",n=Object(mo.a)(nB);try{for(n.s();!(e=n.n()).done;){var r=e.value;this[r]&&(t+=" ".concat(r.charAt(0),":").concat(Yz(this[r])))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"fields",get:function(){var e,t,n=[],r=Object(mo.a)(nB);try{for(r.s();!(t=r.n()).done;){var a=t.value;(null===(e=this[a])||void 0===e?void 0:e.fields)&&n.push.apply(n,Object(Jc.a)(this[a].fields))}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"dependentFields",value:function(){var e,t=new Set(this.fields),n=Object(mo.a)(nB);try{for(n.s();!(e=n.n()).done;){var r=e.value;this[r]&&(this[r].sortField&&t.add(this[r].sortField.field),this[r].sortIndexField&&t.add(this[r].sortIndexField))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"producedFields",value:function(){return new Set}},{key:"getSource",value:function(){return this.name}},{key:"getChildIndependentFieldsWithStep",value:function(){var e,t={},n=Object(mo.a)(bB);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=this.childModel.component.scales[r];if(a&&!a.merged){var i=a.get("type"),o=a.get("range");if(wV(i)&&CU(o)){var u=BQ(WQ(this.childModel,r));u?t[r]=u:uU("Unknown field for ".concat(r,". Cannot calculate view size."))}}}}catch(c){n.e(c)}finally{n.f()}return t}},{key:"assembleRowColumnHeaderData",value:function(e,t,n){var r={row:"y",column:"x"}[e],a=[],i=[],o=[];n&&n[r]&&(t?(a.push("distinct_".concat(n[r])),i.push("max")):(a.push(n[r]),i.push("distinct")),o.push("distinct_".concat(n[r])));var u=this[e],c=u.sortField,s=u.sortIndexField;if(c){var l=c.op,f=void 0===l?tq:l,d=c.field;a.push(d),i.push(f),o.push(Nq(c,{forAs:!0}))}else s&&(a.push(s),i.push("max"),o.push(s));return{name:this[e].name,source:null!==t&&void 0!==t?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},a.length?{fields:a,ops:i,as:o}:{})]}}},{key:"assembleFacetHeaderData",value:function(e){var t,n,r,a=this.model.layout.columns,i=this.model.component.layoutHeaders,o=[],u={},c=Object(mo.a)(Q$);try{for(c.s();!(r=c.n()).done;){var s,l=r.value,f=Object(mo.a)(Z$);try{for(f.s();!(s=f.n()).done;){var d,h=s.value,p=null!==(t=i[l]&&i[l][h])&&void 0!==t?t:[],v=Object(mo.a)(p);try{for(v.s();!(d=v.n()).done;){if((null===(n=d.value.axes)||void 0===n?void 0:n.length)>0){u[l]=!0;break}}}catch(x){v.e(x)}finally{v.f()}}}catch(x){f.e(x)}finally{f.f()}if(u[l]){var m='length(data("'.concat(this.facet.name,'"))'),b="row"===l?a?{signal:"ceil(".concat(m," / ").concat(a,")")}:1:a?{signal:"min(".concat(m,", ").concat(a,")")}:{signal:m};o.push({name:"".concat(this.facet.name,"_").concat(l),transform:[{type:"sequence",start:0,stop:b}]})}}}catch(x){c.e(x)}finally{c.f()}var g=u.row,y=u.column;return(g||y)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,e)),o}},{key:"assemble",value:function(){var e,t,n=[],r=null,a=this.getChildIndependentFieldsWithStep(),i=this.column,o=this.row,u=this.facet;if(i&&o&&(a.x||a.y)){r="cross_".concat(this.column.name,"_").concat(this.row.name);var c=[].concat(null!==(e=a.x)&&void 0!==e?e:[],null!==(t=a.y)&&void 0!==t?t:[]),s=c.map((function(){return"distinct"}));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:c,ops:s}]})}for(var l=0,f=[mP,vP];l<f.length;l++){var d=f[l];this[d]&&n.push(this.assembleRowColumnHeaderData(d,r,a))}if(u){var h=this.assembleFacetHeaderData(a);h&&n.push.apply(n,Object(Jc.a)(h))}return n}}]),n}(lX);function rQ(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function aQ(e,t){var n=pL(e);if("number"===t)return"toNumber(".concat(n,")");if("boolean"===t)return"toBoolean(".concat(n,")");if("string"===t)return"toString(".concat(n,")");if("date"===t)return"toDate(".concat(n,")");if("flatten"===t)return n;if(0===t.indexOf("date:")){var r=rQ(t.slice(5,t.length));return"timeParse(".concat(n,",'").concat(r,"')")}if(0===t.indexOf("utc:")){var a=rQ(t.slice(4,t.length));return"utcParse(".concat(n,",'").concat(a,"')")}return uU(g.unrecognizedParse(t)),null}function iQ(e){var t={};return Uz(e.filter,(function(e){var n;if(WU(e)){var r=null;DU(e)?r=e.equal:LU(e)?r=e.range[0]:PU(e)&&(r=(null!==(n=e.oneOf)&&void 0!==n?n:e.in)[0]),r&&(cU(r)?t[e.field]="date":Cz(r)?t[e.field]="number":Az(r)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}})),t}function oQ(e){var t={};function n(e){var n;Yq(e)?t[e.field]="date":"quantitative"===e.type&&(n=e.aggregate,Az(n)&&Jz(["min","max"],n))?t[e.field]="number":xL(e.field)>1?e.field in t||(t[e.field]="flatten"):_q(e)&&iq(e.sort)&&xL(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((uZ(e)||cZ(e))&&e.forEachFieldDef((function(t,r){if(wq(t))n(t);else{var a=lB(r),i=e.fieldDef(a);n(Object.assign(Object.assign({},t),{type:i.type}))}})),uZ(e)){var r=e.mark,a=e.markDef,i=e.encoding;if(YL(r)&&!e.encoding.order){var o=i["horizontal"===a.orient?"y":"x"];bq(o)&&"quantitative"===o.type&&!(o.field in t)&&(t[o.field]="number")}}return t}var uQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e))._parse=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this._parse))}},{key:"hash",value:function(){return"Parse ".concat(Yz(this._parse))}},{key:"parse",get:function(){return this._parse}},{key:"merge",value:function(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}},{key:"assembleFormatParse",value:function(){var e,t={},n=Object(mo.a)(oL(this._parse));try{for(n.s();!(e=n.n()).done;){var r=e.value,a=this._parse[r];1===xL(r)&&(t[r]=a)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"producedFields",value:function(){return new Set(oL(this._parse))}},{key:"dependentFields",value:function(){return new Set(oL(this._parse))}},{key:"assembleTransforms",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return oL(this._parse).filter((function(e){return!t||xL(e)>1})).map((function(t){var n=aQ(t,e._parse[t]);return n?{type:"formula",expr:n,as:yL(t)}:null})).filter((function(e){return null!==e}))}}],[{key:"makeExplicit",value:function(e,t,n){var r={},a=t.data;return!dK(a)&&a&&a.format&&a.format.parse&&(r=a.format.parse),this.makeWithAncestors(e,r,{},n)}},{key:"makeWithAncestors",value:function(e,t,r,a){var i,o=Object(mo.a)(oL(r));try{for(o.s();!(i=o.n()).done;){var u=i.value,c=a.getWithExplicit(u);void 0!==c.value&&(c.explicit||c.value===r[u]||"derived"===c.value||"flatten"===r[u]?delete r[u]:uU(g.differentParse(u,r[u],c.value)))}}catch(x){o.e(x)}finally{o.f()}var s,l=Object(mo.a)(oL(t));try{for(l.s();!(s=l.n()).done;){var f=s.value,d=a.get(f);void 0!==d&&(d===t[f]?delete t[f]:uU(g.differentParse(f,t[f],d)))}}catch(x){l.e(x)}finally{l.f()}var h=new nK(t,r);a.copyAll(h);var p,v={},m=Object(mo.a)(oL(h.combine()));try{for(m.s();!(p=m.n()).done;){var b=p.value,y=h.get(b);null!==y&&(v[b]=y)}}catch(x){m.e(x)}finally{m.f()}return 0===oL(v).length||a.parseNothing?null:new n(e,v)}}]),n}(lX),cQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e){return Object(iO.a)(this,n),t.call(this,e)}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set([XH])}},{key:"hash",value:function(){return"Identifier"}},{key:"assemble",value:function(){return{type:"identifier",as:XH}}}]),n}(lX),sQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=tL(this.transform.groupby.concat(e),(function(e){return e}))}},{key:"dependentFields",value:function(){var e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map((function(e){return e.field})).filter((function(e){return void 0!==e})).forEach(e.add,e),e}},{key:"producedFields",value:function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){var t;return null!==(t=e.as)&&void 0!==t?t:Nq(e)}},{key:"hash",value:function(){return"JoinAggregateTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e,t=[],n=[],r=[],a=Object(mo.a)(this.transform.joinaggregate);try{for(a.s();!(e=a.n()).done;){var i=e.value;n.push(i.op),r.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field)}}catch(u){a.e(u)}finally{a.f()}var o=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},void 0!==o?{groupby:o}:{})}}]),n}(lX);var lQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e))._stack=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this._stack))}},{key:"stack",get:function(){return this._stack}},{key:"addDimensions",value:function(e){var t;(t=this._stack.facetby).push.apply(t,Object(Jc.a)(e))}},{key:"dependentFields",value:function(){var e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}},{key:"producedFields",value:function(){return new Set(this._stack.as)}},{key:"hash",value:function(){return"Stack ".concat(Yz(this._stack))}},{key:"getGroupbyFields",value:function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;return t?t.bin?n?[Nq(t,{binSuffix:"mid"})]:[Nq(t,{}),Nq(t,{binSuffix:"end"})]:[Nq(t)]:null!==r&&void 0!==r?r:[]}},{key:"assemble",value:function(){var e=[],t=this._stack,n=t.facetby,r=t.dimensionFieldDef,a=t.stackField,i=t.stackby,o=t.sort,u=t.offset,c=t.impute,s=t.as;if(c&&r){var l=r.band,f=void 0===l?.5:l;r.bin&&e.push({type:"formula",expr:"".concat(f,"*")+Nq(r,{expr:"datum"})+"+".concat(1-f,"*")+Nq(r,{expr:"datum",binSuffix:"end"}),as:Nq(r,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:a,groupby:[].concat(Object(Jc.a)(i),Object(Jc.a)(n)),key:Nq(r,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[].concat(Object(Jc.a)(this.getGroupbyFields()),Object(Jc.a)(n)),field:a,sort:o,as:s,offset:u}),e}}],[{key:"makeFromTransform",value:function(e,t){var r=t.stack,a=t.groupby,i=t.as,o=t.offset,u=void 0===o?"zero":o,c=[],s=[];if(void 0!==t.sort){var l,f=Object(mo.a)(t.sort);try{for(f.s();!(l=f.n()).done;){var d=l.value;c.push(d.field),s.push(OL(d.order,"ascending"))}}catch(h){f.e(h)}finally{f.f()}}return new n(e,{stackField:r,groupby:a,offset:u,sort:{field:c,order:s},facetby:[],as:function(e){return bz(e)&&e.every((function(e){return Az(e)}))&&e.length>1}(i)?i:Az(i)?[i,i+"_end"]:[t.stack+"_start",t.stack+"_end"]})}},{key:"makeFromEncoding",value:function(e,t){var r=t.stack,a=t.encoding;if(!r)return null;var i,o=r.groupbyChannel,u=r.fieldChannel,c=r.offset,s=r.impute;o&&(i=Uq(a[o]));var l,f=function(e){return e.stack.stackBy.reduce((function(e,t){var n=Nq(t.fieldDef);return n&&e.push(n),e}),[])}(t),d=t.encoding.order;return l=bz(d)||bq(d)?sH(d):f.reduce((function(e,t){return e.field.push(t),e.order.push("y"===u?"descending":"ascending"),e}),{field:[],order:[]}),new n(e,{dimensionFieldDef:i,stackField:t.vgField(u),facetby:[],stackby:f,sort:l,offset:c,impute:s,as:[t.vgField(u,{suffix:"start",forAs:!0}),t.vgField(u,{suffix:"end",forAs:!0})]})}}]),n}(lX),fQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=tL(this.transform.groupby.concat(e),(function(e){return e}))}},{key:"dependentFields",value:function(){var e,t,n=new Set;return(null!==(e=this.transform.groupby)&&void 0!==e?e:[]).forEach(n.add,n),(null!==(t=this.transform.sort)&&void 0!==t?t:[]).forEach((function(e){return n.add(e.field)})),this.transform.window.map((function(e){return e.field})).filter((function(e){return void 0!==e})).forEach(n.add,n),n}},{key:"producedFields",value:function(){return new Set(this.transform.window.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){var t;return null!==(t=e.as)&&void 0!==t?t:Nq(e)}},{key:"hash",value:function(){return"WindowTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e,t,n=[],r=[],a=[],i=[],o=Object(mo.a)(this.transform.window);try{for(o.s();!(t=o.n()).done;){var u=t.value;r.push(u.op),a.push(this.getDefaultName(u)),i.push(void 0===u.param?null:u.param),n.push(void 0===u.field?null:u.field)}}catch(b){o.e(b)}finally{o.f()}var c=this.transform.frame,s=this.transform.groupby;if(c&&null===c[0]&&null===c[1]&&r.every((function(e){return lP(e)})))return Object.assign({type:"joinaggregate",as:a,ops:r,fields:n},void 0!==s?{groupby:s}:{});var l=[],f=[];if(void 0!==this.transform.sort){var d,h=Object(mo.a)(this.transform.sort);try{for(h.s();!(d=h.n()).done;){var p=d.value;l.push(p.field),f.push(null!==(e=p.order)&&void 0!==e?e:"ascending")}}catch(b){h.e(b)}finally{h.f()}}var v={field:l,order:f},m=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:a,ops:r,fields:n,sort:v},void 0!==m?{ignorePeers:m}:{}),void 0!==s?{groupby:s}:{}),void 0!==c?{frame:c}:{})}}]),n}(lX),dQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"run",value:function(e){var t=e.parent;if(e instanceof uQ){if($J(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof uQ)this.setMutated(),t.merge(e);else{if(aL(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}]),n}(QJ),hQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"mergeNodes",value:function(e,t){var n,r=t.shift(),a=Object(mo.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.removeChild(i),i.parent=r,i.remove()}}catch(o){a.e(o)}finally{a.f()}}},{key:"run",value:function(e){for(var t=e.children.map((function(e){return e.hash()})),n={},r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);var a,i=Object(mo.a)(oL(n));try{for(i.s();!(a=i.n()).done;){var o=a.value;n[o].length>1&&(this.setMutated(),this.mergeNodes(e,n[o]))}}catch(l){i.e(l)}finally{i.f()}var u,c=Object(mo.a)(e.children);try{for(c.s();!(u=c.n()).done;){var s=u.value;this.run(s)}}catch(l){c.e(l)}finally{c.f()}return this.mutatedFlag}}]),n}(ZJ),pQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"run",value:function(e){return e instanceof fX||e.numChildren()>0||e instanceof nQ||(this.setMutated(),e.remove()),this.flags}}]),n}(QJ),vQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){var e;return Object(iO.a)(this,n),(e=t.apply(this,arguments)).fields=new Set,e.prev=null,e}return Object(oO.a)(n,[{key:"run",value:function(e){if(this.setContinue(),e instanceof dX){var t=e.producedFields();nL(t,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([].concat(Object(Jc.a)(this.fields),Object(Jc.a)(t))),this.prev=e}return this.flags}},{key:"reset",value:function(){this.fields.clear()}}]),n}(QJ),mQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"run",value:function(e){this.setContinue();var t,n=e.parent.children.filter((function(e){return e instanceof dX})),r=n.pop(),a=Object(mo.a)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.setMutated(),r.merge(i)}}catch(o){a.e(o)}finally{a.f()}return this.flags}}]),n}(QJ);function bQ(e){if(e instanceof nQ)if(1!==e.numChildren()||e.children[0]instanceof fX){var t=e.model.component.data.main;gQ(t);var n,r=(u=e,function e(t){if(!(t instanceof nQ)){var n=t.clone();if(n instanceof fX){var r=_Q+n.getSource();n.setSource(r),u.model.component.data.outputNodes[r]=n}else(n instanceof tQ||n instanceof lQ||n instanceof fQ||n instanceof sQ)&&n.addDimensions(u.fields);var a,i=Object(mo.a)(t.children.flatMap(e));try{for(i.s();!(a=i.n()).done;)a.value.parent=n}catch(o){i.e(o)}finally{i.f()}return[n]}return t.children.flatMap(e)}),a=e.children.map(r).flat(),i=Object(mo.a)(a);try{for(i.s();!(n=i.n()).done;){n.value.parent=t}}catch(c){i.e(c)}finally{i.f()}}else{var o=e.children[0];(o instanceof tQ||o instanceof lQ||o instanceof fQ||o instanceof sQ)&&o.addDimensions(e.fields),o.swapWithParent(),bQ(e)}else e.children.map(bQ);var u}function gQ(e){if(e instanceof fX&&e.type===mK&&1===e.numChildren()){var t=e.children[0];t instanceof nQ||(t.swapWithParent(),gQ(e))}}var yQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.call(this)}return Object(oO.a)(n,[{key:"run",value:function(e){e instanceof fX&&!e.isRequired()&&(this.setMutated(),e.remove());var t,n=Object(mo.a)(e.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.run(r)}}catch(a){n.e(a)}finally{n.f()}return this.mutatedFlag}}]),n}(ZJ),xQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e){var r;return Object(iO.a)(this,n),(r=t.call(this)).requiresSelectionId=e&&JX(e),r}return Object(oO.a)(n,[{key:"run",value:function(e){e instanceof cQ&&(this.requiresSelectionId&&($J(e.parent)||e.parent instanceof tQ||e.parent instanceof uQ)||(this.setMutated(),e.remove()));var t,n=Object(mo.a)(e.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.run(r)}}catch(a){n.e(a)}finally{n.f()}return this.mutatedFlag}}]),n}(ZJ),OQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"run",value:function(e){var t=e.parent,n=Object(Jc.a)(t.children),r=t.children.filter((function(e){return e instanceof uQ}));if(t.numChildren()>1&&r.length>=1){var a,i={},o=new Set,u=Object(mo.a)(r);try{for(u.s();!(a=u.n()).done;){var c,s=a.value.parse,l=Object(mo.a)(oL(s));try{for(l.s();!(c=l.n()).done;){var f=c.value;f in i?i[f]!==s[f]&&o.add(f):i[f]=s[f]}}catch(O){l.e(O)}finally{l.f()}}}catch(O){u.e(O)}finally{u.f()}var d,h=Object(mo.a)(o);try{for(h.s();!(d=h.n()).done;){delete i[d.value]}}catch(O){h.e(O)}finally{h.f()}if(!iL(i)){this.setMutated();var p,v=new uQ(t,i),m=Object(mo.a)(n);try{for(m.s();!(p=m.n()).done;){var b=p.value;if(b instanceof uQ){var g,y=Object(mo.a)(oL(i));try{for(y.s();!(g=y.n()).done;){var x=g.value;delete b.parse[x]}}catch(O){y.e(O)}finally{y.f()}}t.removeChild(b),b.parent=v,b instanceof uQ&&0===oL(b.parse).length&&b.remove()}}catch(O){m.e(O)}finally{m.f()}}}return this.setContinue(),this.flags}}]),n}(QJ),kQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"run",value:function(e){var t,n=e.parent,r=n.children.filter((function(e){return e instanceof tQ})),a={},i=Object(mo.a)(r);try{for(i.s();!(t=i.n()).done;){var o=t.value,u=Yz(o.groupBy);u in a||(a[u]=[]),a[u].push(o)}}catch(v){i.e(v)}finally{i.f()}var c,s=Object(mo.a)(oL(a));try{for(s.s();!(c=s.n()).done;){var l=a[c.value];if(l.length>1){var f,d=l.pop(),h=Object(mo.a)(l);try{for(h.s();!(f=h.n()).done;){var p=f.value;d.merge(p)&&(n.removeChild(p),p.parent=d,p.remove(),this.setMutated())}}catch(v){h.e(v)}finally{h.f()}}}}catch(v){s.e(v)}finally{s.f()}return this.setContinue(),this.flags}}]),n}(QJ),wQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e){var r;return Object(iO.a)(this,n),(r=t.call(this)).model=e,r}return Object(oO.a)(n,[{key:"run",value:function(e){var t,n=e.parent,r=!($J(n)||n instanceof S$||n instanceof uQ||n instanceof cQ),a=[],i=[],o=Object(mo.a)(n.children);try{for(o.s();!(t=o.n()).done;){var u=t.value;u instanceof HJ&&(r&&!aL(n.producedFields(),u.dependentFields())?a.push(u):i.push(u))}}catch(m){o.e(m)}finally{o.f()}if(a.length>0){var c,s=a.pop(),l=Object(mo.a)(a);try{for(l.s();!(c=l.n()).done;){var f=c.value;s.merge(f,this.model.renameSignal.bind(this.model))}}catch(m){l.e(m)}finally{l.f()}this.setMutated(),n instanceof HJ?n.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(i.length>1){var d,h=i.pop(),p=Object(mo.a)(i);try{for(p.s();!(d=p.n()).done;){var v=d.value;h.merge(v,this.model.renameSignal.bind(this.model))}}catch(m){p.e(m)}finally{p.f()}this.setMutated()}return this.setContinue(),this.flags}}]),n}(QJ),jQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"run",value:function(e){var t=e.parent,n=Object(Jc.a)(t.children);if(!Qz(n,(function(e){return e instanceof fX}))||t.numChildren()<=1)return this.setContinue(),this.flags;var r,a,i=[],o=Object(mo.a)(n);try{for(o.s();!(a=o.n()).done;){var u=a.value;if(u instanceof fX){for(var c=u;1===c.numChildren();){var s=c.children[0];if(!(s instanceof fX))break;c=s}i.push.apply(i,Object(Jc.a)(c.children)),r?(t.removeChild(u),u.parent=r.parent,r.parent.removeChild(r),r.parent=c,this.setMutated()):r=c}else i.push(u)}}catch(h){o.e(h)}finally{o.f()}if(i.length){this.setMutated();var l,f=Object(mo.a)(i);try{for(f.s();!(l=f.n()).done;){var d=l.value;d.parent.removeChild(d),d.parent=r}}catch(h){f.e(h)}finally{f.f()}}return this.setContinue(),this.flags}}]),n}(QJ),_Q="scale_";function SQ(e){var t=[];function n(e){if(0===e.numChildren())t.push(e);else{var r,a=Object(mo.a)(e.children);try{for(a.s();!(r=a.n()).done;){n(r.value)}}catch(i){a.e(i)}finally{a.f()}}}var r,a=Object(mo.a)(e);try{for(a.s();!(r=a.n()).done;){n(r.value)}}catch(i){a.e(i)}finally{a.f()}return t}function EQ(e){return e}function CQ(e,t){return t.map((function(t){if(e instanceof QJ){var n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)})).some(EQ)}function AQ(e,t){var n=e.sources,r=new Set;return r.add(CQ(new yQ,n)),r.add(CQ(new xQ(t),n)),n=n.filter((function(e){return e.numChildren()>0})),r.add(CQ(new pQ,SQ(n))),n=n.filter((function(e){return e.numChildren()>0})),r.add(CQ(new dQ,SQ(n))),r.add(CQ(new wQ(t),SQ(n))),r.add(CQ(new vQ,SQ(n))),r.add(CQ(new OQ,SQ(n))),r.add(CQ(new kQ,SQ(n))),r.add(CQ(new mQ,SQ(n))),r.add(CQ(new hQ,n)),r.add(CQ(new jQ,SQ(n))),e.sources=n,r.has(!0)}function NQ(e,t){KJ(e.sources);for(var n=0,r=0,a=0;a<5&&AQ(e,t);a++)n++;e.sources.map(bQ);for(var i=0;i<5&&AQ(e,t);i++)r++;KJ(e.sources),5===Math.max(n,r)&&uU("Maximum optimization runs(".concat(5,") reached."))}var TQ=function(){function e(t){Object(iO.a)(this,e),Object.defineProperty(this,"signal",{enumerable:!0,get:t})}return Object(oO.a)(e,null,[{key:"fromName",value:function(t,n){return new e((function(){return t(n)}))}}]),e}();function IQ(e){uZ(e)?function(e){var t,n=e.component.scales,r=Object(mo.a)(oL(n));try{for(r.s();!(t=r.n()).done;){var a=t.value,i=DQ(e,a);if(n[a].setWithExplicit("domains",i),zQ(e,a),e.component.data.isFaceted){for(var o=e;!cZ(o)&&o.parent;)o=o.parent;if("shared"===o.component.resolve.scale[a]){var u,c=Object(mo.a)(i.value);try{for(c.s();!(u=c.n()).done;){var s=u.value;AU(s)&&(s.data=_Q+s.data.replace(_Q,""))}}catch(l){c.e(l)}finally{c.f()}}}}}catch(l){r.e(l)}finally{r.f()}}(e):function(e){var t,n=Object(mo.a)(e.children);try{for(n.s();!(t=n.n()).done;){IQ(t.value)}}catch(h){n.e(h)}finally{n.f()}var r,a=e.component.scales,i=Object(mo.a)(oL(a));try{for(i.s();!(r=i.n()).done;){var o,u=r.value,c=void 0,s=null,l=Object(mo.a)(e.children);try{for(l.s();!(o=l.n()).done;){var f=o.value.component.scales[u];if(f){c=void 0===c?f.getWithExplicit("domains"):uK(c,f.getWithExplicit("domains"),"domains","scale",PQ);var d=f.get("selectionExtent");s&&d&&s.selection!==d.selection&&uU("The same selection must be used to override scale domains in a layered view."),s=d}}}catch(h){l.e(h)}finally{l.f()}a[u].setWithExplicit("domains",c),s&&a[u].set("selectionExtent",s,!0)}}catch(h){i.e(h)}finally{i.f()}}(e)}function DQ(e,t){var n=e.getScaleComponent(t).get("type"),r=e.encoding,a=function(e,t,n,r){if("unaggregated"===e){var a=LQ(t,n),i=a.valid,o=a.reason;if(!i)return void uU(o)}else if(void 0===e&&r.useUnaggregatedDomain&&LQ(t,n).valid)return"unaggregated";return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return a!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:a})),"x"===t&&Vq(r.x2)?Vq(r.x)?uK(MQ(n,a,e,"x"),MQ(n,a,e,"x2"),"domain","scale",PQ):MQ(n,a,e,"x2"):"y"===t&&Vq(r.y2)?Vq(r.y)?uK(MQ(n,a,e,"y"),MQ(n,a,e,"y2"),"domain","scale",PQ):MQ(n,a,e,"y2"):MQ(n,a,e,t)}function FQ(e,t,n){var r,a=null===(r=_U(n))||void 0===r?void 0:r.unit;return"temporal"===t||a?function(e,t,n){return e.map((function(e){var r=$q(e,{timeUnit:n,type:t});return{signal:"{data: ".concat(r,"}")}}))}(e,t,a):[e]}function MQ(e,t,n,r){var a=Vq(n.encoding[r]),i=a.type,o=a.timeUnit;if(function(e){return e&&e.unionWith}(t)){var u=MQ(e,void 0,n,r),c=FQ(t.unionWith,i,o);return rK([].concat(Object(Jc.a)(u.value),Object(Jc.a)(c)))}if(EU(t))return rK([t]);if(t&&"unaggregated"!==t&&!EV(t))return rK(FQ(t,i,o));var s=n.stack;if(s&&r===s.fieldChannel){if("normalize"===s.offset)return aK([[0,1]]);var l=n.requestDataName(mK);return aK([{data:l,field:n.vgField(r,{suffix:"start"})},{data:l,field:n.vgField(r,{suffix:"end"})}])}var f=SB(r)&&bq(a)?function(e,t,n){if(!wV(n))return;var r=e.fieldDef(t),a=r.sort;if(oq(a))return{op:"min",field:X$(r,t),order:"ascending"};var i=e.stack,o=i?[].concat(Object(Jc.a)(i.groupbyField?[i.groupbyField]:[]),Object(Jc.a)(i.stackBy.map((function(e){return e.fieldDef.field})))):void 0;if(iq(a))return RQ(a,i&&!Jz(o,a.field));if(aq(a)){var u=a.encoding,c=a.order,s=e.fieldDef(u),l=s.aggregate,f=s.field,d=i&&!Jz(o,f);if(cP(l)||sP(l))return RQ({field:Nq(s),order:c},d);if(lP(l)||!l)return RQ({op:l,field:f,order:c},d)}else{if("descending"===a)return{op:"min",field:e.vgField(t),order:"descending"};if(Jz(["ascending",void 0],a))return!0}return}(n,r,e):void 0;if(yq(a))return aK(FQ([a.datum],i,o));var d=a;if("unaggregated"===t){var h=n.requestDataName(mK),p=a.field;return aK([{data:h,field:Nq({field:p,aggregate:"min"})},{data:h,field:Nq({field:p,aggregate:"max"})}])}if(IB(d.bin)){if(wV(e))return aK("bin-ordinal"===e?[]:[{data:sL(f)?n.requestDataName(mK):n.requestDataName(bK),field:n.vgField(r,Qq(d,r)?{binSuffix:"range"}:{}),sort:!0!==f&&gz(f)?f:{field:n.vgField(r,{}),op:"min"}}]);var v=d.bin;if(IB(v)){var m=VJ(n,d.field,v);return aK([new TQ((function(){var e=n.getSignalName(m);return"[".concat(e,".start, ").concat(e,".stop]")}))])}return aK([{data:n.requestDataName(mK),field:n.vgField(r,{})}])}if(d.timeUnit&&Jz(["time","utc"],e)&&hq(r,d,uZ(n)?n.encoding[dB(r)]:void 0,n.stack,n.markDef,n.config)){var b=n.requestDataName(mK);return aK([{data:b,field:n.vgField(r)},{data:b,field:n.vgField(r,{suffix:"end"})}])}return aK(f?[{data:sL(f)?n.requestDataName(mK):n.requestDataName(bK),field:n.vgField(r),sort:f}]:[{data:n.requestDataName(mK),field:n.vgField(r)}])}function RQ(e,t){var n=e.op,r=e.field,a=e.order;return Object.assign(Object.assign({op:null!==n&&void 0!==n?n:t?"sum":tq},r?{field:bL(r)}:{}),a?{order:a}:{})}function zQ(e,t){var n,r=e.component.scales[t],a=e.specifiedScales[t].domain,i=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,o=EV(a)&&a,u=FB(i)&&MB(i.extent)&&i.extent;(o||u)&&r.set("selectionExtent",null!==o&&void 0!==o?o:u,!0)}function LQ(e,t){var n=e.aggregate,r=e.type;return n?Az(n)&&!pP[n]?{valid:!1,reason:g.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:g.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:g.unaggregateDomainHasNoEffectForRawField(e)}}function PQ(e,t,n,r){return e.explicit&&t.explicit&&uU(g.mergeConflictingDomainProperty(n,r,e.value,t.value)),{explicit:e.explicit,value:[].concat(Object(Jc.a)(e.value),Object(Jc.a)(t.value))}}function BQ(e){if(AU(e)&&Az(e.field))return e.field;if(function(e){return!bz(e)&&"fields"in e&&!("data"in e)}(e)){var t,n,r=Object(mo.a)(e.fields);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(AU(a)&&Az(a.field))if(t){if(t!==a.field)return uU(g.FACETED_INDEPENDENT_DIFFERENT_SOURCES),t}else t=a.field}}catch(o){r.e(o)}finally{r.f()}return uU(g.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),t}if(function(e){return!bz(e)&&"fields"in e&&"data"in e}(e)){uU(g.FACETED_INDEPENDENT_SAME_SOURCE);var i=e.fields[0];return Az(i)?i:void 0}}function WQ(e,t){return function(e){var t=tL(e.map((function(e){return AU(e)?(e.sort,Iz(e,["sort"])):e})),Yz),n=tL(e.map((function(e){if(AU(e)){var t=e.sort;return void 0===t||sL(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}})).filter((function(e){return void 0!==e})),Yz);if(0!==t.length){if(1===t.length){var r=e[0];if(AU(r)&&n.length>0){var a=n[0];if(n.length>1)uU(g.MORE_THAN_ONE_SORT),a=!0;else if(gz(a)&&"field"in a){var i=a.field;r.field===i&&(a=!a.order||{order:a.order})}return Object.assign(Object.assign({},r),{sort:a})}return r}var o,u=tL(n.map((function(e){return sL(e)||!("op"in e)||e.op in uP?e:(uU(g.domainSortDropped(e)),!0)})),Yz);1===u.length?o=u[0]:u.length>1&&(uU(g.MORE_THAN_ONE_SORT),o=!0);var c=tL(e.map((function(e){return AU(e)?e.data:null})),(function(e){return e}));return 1===c.length&&null!==c[0]?Object.assign({data:c[0],fields:t.map((function(e){return e.field}))},o?{sort:o}:{}):Object.assign({fields:t},o?{sort:o}:{})}}(e.component.scales[t].get("domains").map((function(t){return AU(t)&&(t.data=e.lookupDataSource(t.data)),t})))}function UQ(e){return lZ(e)||sZ(e)?e.children.reduce((function(e,t){return e.concat(UQ(t))}),VQ(e)):VQ(e)}function VQ(e){return oL(e.component.scales).reduce((function(t,n){var r=e.component.scales[n];if(r.merged)return t;var a,i=r.combine(),o=i.name,u=i.type,c=i.selectionExtent,s=(i.domains,i.range,i.reverse),l=Iz(i,["name","type","selectionExtent","domains","range","reverse"]),f=function(e,t,n){if(gB(n)&&CU(e))return{step:{signal:t+"_step"}};return e}(i.range,o,n);c&&(a=function(e,t){var n=t.selection;return{signal:C$(e.getSelectionComponent(n,lL(n)),t)}}(e,c));var d=WQ(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:u},d?{domain:d}:{}),a?{domainRaw:a}:{}),{range:f}),void 0!==s?{reverse:s}:{}),l)),t}),[])}var qQ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,{},{name:e})).merged=!1,a.setWithExplicit("type",r),a}return Object(oO.a)(n,[{key:"domainDefinitelyIncludesZero",value:function(){return!1!==this.get("zero")||Qz(this.get("domains"),(function(e){return bz(e)&&2===e.length&&e[0]<=0&&e[1]>=0}))}}]),n}(nK),HQ=["range","scheme"];function GQ(e){return"x"===e?"width":"y"===e?"height":void 0}function KQ(e,t){var n=e.fieldDef(t);if(n&&n.bin&&IB(n.bin)){var r=VJ(e,n.field,n.bin),a=GQ(t),i=e.getName(a);return new TQ((function(){var t=e.getSignalName(r),n="(".concat(t,".stop - ").concat(t,".start) / ").concat(t,".step");return"".concat(e.getSignalName(i)," / (").concat(n,")")}))}}function XQ(e,t){var n,r=t.specifiedScales[e],a=t.size,i=t.getScaleComponent(e).get("type"),o=Object(mo.a)(HQ);try{for(o.s();!(n=o.n()).done;){var u=n.value;if(void 0!==r[u]){var c=TV(i,u),s=IV(e,u);if(c)if(s)uU(s);else switch(u){case"range":return bz(r.range)&&gB(e)?rK(r.range.map((function(e){if("width"===e||"height"===e){var n=t.getName(e),r=t.getSignalName.bind(t);return TQ.fromName(r,n)}return e}))):rK(r.range);case"scheme":return rK(YQ(r[u]))}else uU(g.scalePropertyNotWorkWithScaleType(i,u,e))}}}catch(d){o.e(d)}finally{o.f()}if(e===gP||e===yP){var l=e===gP?"width":"height",f=a[l];if(tG(f)){if(wV(i))return rK({step:f.step});uU(g.stepDropped(l))}}return aK(function(e,t){var n=t.size,r=t.config,a=t.mark,i=t.encoding,o=t.getSignalName.bind(t),u=Vq(i[e]).type,c=t.getScaleComponent(e).get("type"),s=t.specifiedScales[e],l=s.domain,f=s.domainMid;switch(e){case gP:case yP:if(Jz(["point","band"],c))if(e!==gP||n.width){if(e===yP&&!n.height){var d=oG(r.view,"height");if(tG(d))return d}}else{var h=oG(r.view,"width");if(tG(h))return h}var p=GQ(e),v=t.getName(p);return e===yP&&jV(c)?[TQ.fromName(o,v),0]:[0,TQ.fromName(o,v)];case FP:var m=$Q(a,t.component.scales[e].get("zero"),r),b=function(e,t,n,r){var a={x:KQ(n,"x"),y:KQ(n,"y")};switch(e){case"bar":case"tick":if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;var i=QQ(t,a,r.view);return Cz(i)?i-1:new TQ((function(){return"".concat(i.signal," - 1")}));case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":if(r.scale.maxSize)return r.scale.maxSize;var o=QQ(t,a,r.view);return Cz(o)?Math.pow(JQ*o,2):new TQ((function(){return"pow(".concat(JQ," * ").concat(o.signal,", 2)")}))}throw new Error(g.incompatibleChannel("size",e))}(a,n,t,r);return SV(c)?function(e,t,n){var r=function(){var r=rH(t),a=rH(e),i="(".concat(r," - ").concat(a,") / (").concat(n," - 1)");return"sequence(".concat(a,", ").concat(r," + ").concat(i,", ").concat(i,")")};return EU(t)?new TQ(r):{signal:r()}}(m,b,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&bz(n)?n.length+1:(uU(g.domainRequiredForThresholdScale(r)),3)}}(c,r,l,e)):[m,b];case jP:return[0,2*Math.PI];case MP:return[0,360];case kP:return[0,new TQ((function(){var e=t.getSignalName("width"),n=t.getSignalName("height");return"min(".concat(e,",").concat(n,")/2")}))];case PP:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case BP:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case DP:return"symbol";case NP:case TP:case IP:return"ordinal"===c?"nominal"===u?"category":"ordinal":void 0!==f?"diverging":"rect"===a||"geoshape"===a?"heatmap":"ramp";case RP:case zP:case LP:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel ".concat(e))}(e,t))}function YQ(e){return function(e){return!Az(e)&&!!e.name}(e)?Object.assign({scheme:e.name},Kz(e,["name"])):{scheme:e}}function $Q(e,t,n){if(t)return EU(t)?{signal:"".concat(t.signal," ? 0 : ").concat($Q(e,!1,n))}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(g.incompatibleChannel("size",e))}var JQ=.95;function QQ(e,t,n){var r=tG(e.width)?e.width.step:iG(n,"width"),a=tG(e.height)?e.height.step:iG(n,"height");return t.x||t.y?new TQ((function(){var e=[t.x?t.x.signal:r,t.y?t.y.signal:a];return"min(".concat(e.join(", "),")")})):Math.min(r,a)}function ZQ(e,t){uZ(e)?function(e,t){var n,r=e.component.scales,a=e.config,i=e.encoding,o=e.markDef,u=e.specifiedScales,c=Object(mo.a)(oL(r));try{for(c.s();!(n=c.n()).done;){var s=n.value,l=u[s],f=r[s],d=e.getScaleComponent(s),h=Vq(i[s]),p=l[t],v=d.get("type"),m=d.get("padding"),b=d.get("paddingInner"),y=TV(v,t),x=IV(s,t);if(void 0!==p&&(y?x&&uU(x):uU(g.scalePropertyNotWorkWithScaleType(v,t,s))),y&&void 0===x)if(void 0!==p)f.copyKeyFromObject(t,l);else{var O=t in eZ?eZ[t]({model:e,channel:s,fieldOrDatumDef:h,scaleType:v,scalePadding:m,scalePaddingInner:b,domain:l.domain,markDef:o,config:a}):a.scale[t];void 0!==O&&f.set(t,O,!1)}}}catch(k){c.e(k)}finally{c.f()}}(e,t):nZ(e,t)}var eZ={bins:function(e){var t=e.model,n=e.fieldOrDatumDef;return bq(n)?function(e,t){var n=t.bin;if(IB(n)){var r=VJ(e,t.field,n);return new TQ((function(){return e.getSignalName(r)}))}if(DB(n)&&FB(n)&&void 0!==n.step)return{step:n.step};return}(t,n):void 0},interpolate:function(e){return function(e,t){if(Jz([NP,TP,IP],e)&&"nominal"!==t)return"hcl";return}(e.channel,e.fieldOrDatumDef.type)},nice:function(e){return function(e,t,n){var r;if((null===(r=Uq(n))||void 0===r?void 0:r.bin)||Jz([iV,oV],e))return;return t in mB||void 0}(e.scaleType,e.channel,e.fieldOrDatumDef)},padding:function(e){var t=e.channel,n=e.scaleType,r=e.fieldOrDatumDef,a=e.markDef,i=e.config;return function(e,t,n,r,a,i){if(e in mB){if(_V(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var o=a.type,u=a.orient;if("bar"===o&&(!bq(r)||!r.bin&&!r.timeUnit)&&("vertical"===u&&"x"===e||"horizontal"===u&&"y"===e))return i.continuousBandSize}if(t===lV)return n.pointPadding}return}(t,n,i.scale,r,a,i.bar)},paddingInner:function(e){var t=e.scalePadding,n=e.channel,r=e.markDef,a=e.config;return function(e,t,n,r){if(void 0!==e)return;if(t in mB){var a=r.bandPaddingInner,i=r.barBandPaddingInner,o=r.rectBandPaddingInner;return OL(a,"bar"===n?i:o)}return}(t,n,r.type,a.scale)},paddingOuter:function(e){var t=e.scalePadding,n=e.channel,r=e.scaleType,a=e.markDef,i=e.scalePaddingInner,o=e.config;return function(e,t,n,r,a,i){if(void 0!==e)return;if(t in mB){if(n===fV)return OL(i.bandPaddingOuter,EU(a)?{signal:"".concat(a.signal,"/2")}:a/2)}return}(t,n,r,a.type,i,o.scale)},reverse:function(e){var t=e.fieldOrDatumDef,n=e.scaleType,r=e.channel,a=e.config;return function(e,t,n,r){if("x"===n&&void 0!==r.xReverse)return jV(e)&&"descending"===t?EU(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse;if(jV(e)&&"descending"===t)return!0;return}(n,bq(t)?t.sort:void 0,r,a.scale)},zero:function(e){return function(e,t,n,r,a){if(n&&"unaggregated"!==n&&jV(a)){if(bz(n)){var i=n[0],o=n[n.length-1];if(i<=0&&o>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!SV(a))return!0;if((!bq(t)||!t.bin)&&Jz([].concat(Object(Jc.a)(bB),Object(Jc.a)(xB)),e)){var u=r.orient;return!Jz(["bar","area","line","trail"],r.type)||!("horizontal"===u&&"y"===e||"vertical"===u&&"x"===e)}return!1}(e.channel,e.fieldOrDatumDef,e.domain,e.markDef,e.scaleType)}};function tZ(e){uZ(e)?function(e){var t,n=e.component.scales,r=Object(mo.a)(_B);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=n[a];if(i){var o=XQ(a,e);i.setWithExplicit("range",o)}}}catch(u){r.e(u)}finally{r.f()}}(e):nZ(e,"range")}function nZ(e,t){var n,r=e.component.scales,a=Object(mo.a)(e.children);try{for(a.s();!(n=a.n()).done;){var i=n.value;"range"===t?tZ(i):ZQ(i,t)}}catch(h){a.e(h)}finally{a.f()}var o,u=Object(mo.a)(oL(r));try{for(u.s();!(o=u.n()).done;){var c,s=o.value,l=void 0,f=Object(mo.a)(e.children);try{for(f.s();!(c=f.n()).done;){var d=c.value.component.scales[s];if(d)l=uK(l,d.getWithExplicit(t),t,"scale",iK((function(e,n){switch(t){case"range":return e.step&&n.step?e.step-n.step:0}return 0})))}}catch(h){f.e(h)}finally{f.f()}r[s].setWithExplicit(t,l)}}catch(h){u.e(h)}finally{u.f()}}function rZ(e,t,n,r){var a=function(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(eB(e)||"discrete"===NB(e))return"shape"===e&&"ordinal"===t.type&&uU(g.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(e in mB){if(Jz(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&e in yB)return"band";return void 0!==t.band||Sq(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return eB(e)?"time":"discrete"===NB(e)?(uU(g.discreteChannelCannotEncode(e,"temporal")),"ordinal"):bq(t)&&t.timeUnit&&_U(t.timeUnit).utc?"utc":"time";case"quantitative":return eB(e)?bq(t)&&IB(t.bin)?"bin-ordinal":"linear":"discrete"===NB(e)?(uU(g.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(g.invalidFieldType(t.type))}(t,n,r),i=e.type;return SB(t)?void 0!==i?FV(t,i)?bq(n)&&!DV(i,n.type)?(uU(g.scaleTypeNotWorkWithFieldDef(i,a)),a):i:(uU(g.scaleTypeNotWorkWithChannel(t,i,a)),a):a:null}function aZ(e){uZ(e)?e.component.scales=function(e){var t=e.encoding,n=e.mark;return _B.reduce((function(r,a){var i=Vq(t[a]);if(i&&n===XL&&a===DP&&i.type===QU)return r;var o=i&&i.scale;if(i&&null!==o&&!1!==o){var u=rZ(o=null!==o&&void 0!==o?o:{},a,i,n);r[a]=new qQ(e.scaleName(a+"",!0),{value:u,explicit:o.type===u})}return r}),{})}(e):e.component.scales=function(e){var t,n,r=e.component.scales={},a={},i=e.component.resolve,o=Object(mo.a)(e.children);try{for(o.s();!(n=o.n()).done;){var u=n.value;aZ(u);var c,s=Object(mo.a)(oL(u.component.scales));try{for(s.s();!(c=s.n()).done;){var l=c.value;if(i.scale[l]=null!==(t=i.scale[l])&&void 0!==t?t:mJ(l,e),"shared"===i.scale[l]){var f=a[l],d=u.component.scales[l].getWithExplicit("type");f?pV(f.value,d.value)?a[l]=uK(f,d,"type","scale",iZ):(i.scale[l]="independent",delete a[l]):a[l]=d}}}catch(k){s.e(k)}finally{s.f()}}}catch(k){o.e(k)}finally{o.f()}var h,p=Object(mo.a)(oL(a));try{for(p.s();!(h=p.n()).done;){var v=h.value,m=e.scaleName(v,!0),b=a[v];r[v]=new qQ(m,b);var g,y=Object(mo.a)(e.children);try{for(y.s();!(g=y.n()).done;){var x=g.value,O=x.component.scales[v];O&&(x.renameScale(O.get("name"),m),O.merged=!0)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){p.e(k)}finally{p.f()}return r}(e)}var iZ=iK((function(e,t){return mV(e)-mV(t)}));var oZ=function(){function e(){Object(iO.a)(this,e),this.nameMap={}}return Object(oO.a)(e,[{key:"rename",value:function(e,t){this.nameMap[e]=t}},{key:"has",value:function(e){return void 0!==this.nameMap[e]}},{key:"get",value:function(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}]),e}();function uZ(e){return"unit"===(null===e||void 0===e?void 0:e.type)}function cZ(e){return"facet"===(null===e||void 0===e?void 0:e.type)}function sZ(e){return"concat"===(null===e||void 0===e?void 0:e.type)}function lZ(e){return"layer"===(null===e||void 0===e?void 0:e.type)}var fZ=function(){function e(t,n,r,a,i,o,u){var c,s,l=this;Object(iO.a)(this,e),this.type=n,this.parent=r,this.config=i,this.view=u,this.children=[],this.correctDataNames=function(e){return e.from&&e.from.data&&(e.from.data=l.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=l.lookupDataSource(e.from.facet.data)),e},this.parent=r,this.config=i,this.name=null!==(c=t.name)&&void 0!==c?c:a,this.title=eH(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new oZ,this.projectionNameMap=r?r.projectionNameMap:new oZ,this.signalNameMap=r?r.signalNameMap:new oZ,this.data=t.data,this.description=t.description,this.transforms=(null!==(s=t.transform)&&void 0!==s?s:[]).map((function(e){return gK(e)?{filter:Vz(e.filter,GU)}:e})),this.layout="layer"===n||"unit"===n?{}:function(e,t,n){var r,a,i=n[t],o={},u=i.spacing,c=i.columns;void 0!==u&&(o.spacing=u),void 0!==c&&(sq(e)&&!uq(e.facet)||QH(e))&&(o.columns=c),ZH(e)&&(o.columns=1);var s,l=Object(mo.a)(rG);try{for(l.s();!(s=l.n()).done;){var f=s.value;if(void 0!==e[f])if("spacing"===f){var d=e[f];o[f]=Cz(d)?d:{row:null!==(r=d.row)&&void 0!==r?r:u,column:null!==(a=d.column)&&void 0!==a?a:u}}else o[f]=e[f]}}catch(h){l.e(h)}finally{l.f()}return o}(t,n,i),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:sq(t)||r&&r.component.data.isFaceted&&void 0===t.data},layoutSize:new nK,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Hz(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return Object(oO.a)(e,[{key:"width",get:function(){return this.getSizeSignalRef("width")}},{key:"height",get:function(){return this.getSizeSignalRef("height")}},{key:"parse",value:function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}},{key:"parseScale",value:function(){!function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreRange;aZ(e),IQ(e);var n,r=Object(mo.a)(NV);try{for(r.s();!(n=r.n()).done;){ZQ(e,n.value)}}catch(a){r.e(a)}finally{r.f()}t||tZ(e)}(this)}},{key:"parseProjection",value:function(){BJ(this)}},{key:"renameTopLevelLayoutSizeSignal",value:function(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}},{key:"parseLegends",value:function(){NJ(this)}},{key:"assembleGroupStyle",value:function(){var e,t;if("unit"===this.type||"layer"===this.type)return null!==(t=null===(e=this.view)||void 0===e?void 0:e.style)&&void 0!==t?t:"cell"}},{key:"assembleEncodeFromView",value:function(e){e.style;var t,n=Iz(e,["style"]),r={},a=Object(mo.a)(oL(n));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=n[i];void 0!==o&&(r[i]=tH(o))}}catch(u){a.e(u)}finally{a.f()}return r}},{key:"assembleGroupEncodeEntry",value:function(e){var t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=tH(this.description)),"unit"!==this.type&&"layer"!==this.type)?iL(t)?void 0:t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!==t&&void 0!==t?t:{})}},{key:"assembleLayout",value:function(){if(this.layout){var e=this.layout,t=e.spacing,n=Iz(e,["spacing"]),r=this.component,a=this.config,i=function(e,t){var n,r={},a=Object(mo.a)(nB);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=e[i];if(null===o||void 0===o?void 0:o.facetFieldDef){var u=J$(["titleAnchor","titleOrient"],o.facetFieldDef,t,i),c=u.titleAnchor,s=Y$(i,u.titleOrient),l=cJ(c,s);void 0!==l&&(r[s]=l)}}}catch(f){a.e(f)}finally{a.f()}return iL(r)?void 0:r}(r.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),i?{titleBand:i}:{})}}},{key:"assembleDefaultLayout",value:function(){return{}}},{key:"assembleHeaderMarks",value:function(){var e,t=this.component.layoutHeaders,n=[],r=Object(mo.a)(nB);try{for(r.s();!(e=r.n()).done;){var a=e.value;t[a].title&&n.push(eJ(this,a))}}catch(c){r.e(c)}finally{r.f()}var i,o=Object(mo.a)(Q$);try{for(o.s();!(i=o.n()).done;){var u=i.value;n=n.concat(rJ(this,u))}}catch(c){o.e(c)}finally{o.f()}return n}},{key:"assembleAxes",value:function(){return function(e,t){var n=e.x,r=void 0===n?[]:n,a=e.y,i=void 0===a?[]:a;return[].concat(Object(Jc.a)(r.map((function(e){return I$(e,"grid",t)}))),Object(Jc.a)(i.map((function(e){return I$(e,"grid",t)}))),Object(Jc.a)(r.map((function(e){return I$(e,"main",t)}))),Object(Jc.a)(i.map((function(e){return I$(e,"main",t)})))).filter((function(e){return e}))}(this.component.axes,this.config)}},{key:"assembleLegends",value:function(){return MJ(this)}},{key:"assembleProjections",value:function(){return RJ(this)}},{key:"assembleTitle",value:function(){var e,t,n,r=null!==(e=this.title)&&void 0!==e?e:{},a=r.encoding,i=Iz(r,["encoding"]),o=Object.assign(Object.assign(Object.assign({},Zq(this.config.title).nonMark),i),a?{encode:{update:a}}:{});if(o.text)return Jz(["unit","layer"],this.type)?Jz(["middle",void 0],o.anchor)&&(o.frame=null!==(t=o.frame)&&void 0!==t?t:"group"):o.anchor=null!==(n=o.anchor)&&void 0!==n?n:"start",iL(o)?void 0:o}},{key:"assembleGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);var n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||cZ(this.parent)?UQ(this):[];r.length>0&&(t.scales=r);var a=this.assembleAxes();a.length>0&&(t.axes=a);var i=this.assembleLegends();return i.length>0&&(t.legends=i),t}},{key:"getName",value:function(e){return lL((this.name?this.name+"_":"")+e)}},{key:"requestDataName",value:function(e){var t,n=this.getName(e),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(t=r[n])&&void 0!==t?t:0)+1,n}},{key:"getSizeSignalRef",value:function(e){if(cZ(this.parent)){var t=OB(pJ(e)),n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type"),a=n.get("range");if(wV(r)&&CU(a)){var i=n.get("name"),o=BQ(WQ(this,t));return o?{signal:hJ(i,n,Nq({aggregate:"distinct",field:o},{expr:"datum"}))}:(uU("Unknown field for ".concat(t,". Cannot calculate view size.")),null)}}}return{signal:this.signalNameMap.get(this.getName(e))}}},{key:"lookupDataSource",value:function(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e}},{key:"getSignalName",value:function(e){return this.signalNameMap.get(e)}},{key:"renameSignal",value:function(e,t){this.signalNameMap.rename(e,t)}},{key:"renameScale",value:function(e,t){this.scaleNameMap.rename(e,t)}},{key:"renameProjection",value:function(e,t){this.projectionNameMap.rename(e,t)}},{key:"scaleName",value:function(e,t){return t?this.getName(e):uB(e)&&SB(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}},{key:"projectionName",value:function(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}},{key:"getScaleComponent",value:function(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");var t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}},{key:"getSelectionComponent",value:function(e,t){var n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(g.selectionNotFound(t));return n}},{key:"hasAxisOrientSignalRef",value:function(){var e,t;return(null===(e=this.component.axes.x)||void 0===e?void 0:e.some((function(e){return e.hasOrientSignalRef()})))||(null===(t=this.component.axes.y)||void 0===t?void 0:t.some((function(e){return e.hasOrientSignalRef()})))}}]),e}(),dZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"vgField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.fieldDef(e);if(n)return Nq(n,t)}},{key:"reduceFieldDef",value:function(e,t){return yH(this.getMapping(),(function(t,n,r){var a=Uq(n);return a?e(t,a,r):t}),t)}},{key:"forEachFieldDef",value:function(e,t){gH(this.getMapping(),(function(t,n){var r=Uq(t);r&&e(r,n)}),t)}}]),n}(fZ),hZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a,i,o,u;Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a.transform=Hz(r);var c=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=c[0])&&void 0!==o?o:"value",null!==(u=c[1])&&void 0!==u?u:"density"],a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.density].concat(Object(Jc.a)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"DensityTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.density,n=Iz(e,["density"]);return Object.assign({type:"kde",field:t},n)}}]),n}(lX),pZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).filter=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Object.assign({},this.filter))}},{key:"dependentFields",value:function(){return new Set(oL(this.filter))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"FilterInvalid ".concat(Yz(this.filter))}},{key:"assemble",value:function(){var e=this,t=oL(this.filter).reduce((function(t,n){var r=e.filter[n],a=Nq(r,{expr:"datum"});return null!==r&&("temporal"===r.type?t.push("(isDate(".concat(a,") || (isValid(").concat(a,") && isFinite(+").concat(a,")))")):"quantitative"===r.type&&(t.push("isValid(".concat(a,")")),t.push("isFinite(+".concat(a,")")))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}],[{key:"make",value:function(e,t){var r=t.config,a=t.mark;if("filter"!==iH("invalid",t.markDef,r))return null;var i=t.reduceFieldDef((function(e,n,r){var i=SB(r)&&t.getScaleComponent(r);i&&(jV(i.get("type"))&&"count"!==n.aggregate&&!YL(a)&&(e[n.field]=n));return e}),{});return oL(i).length?new n(e,i):null}}]),n}(lX),vZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a.transform=Hz(r);var i=a.transform,o=i.flatten,u=i.as,c=void 0===u?[]:u;return a.transform.as=o.map((function(e,t){var n;return null!==(n=c[t])&&void 0!==n?n:e})),a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(this.parent,Hz(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.flatten)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FlattenTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"flatten",fields:e.flatten,as:e.as}}}]),n}(lX),mZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a,i,o,u;Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a.transform=Hz(r);var c=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=c[0])&&void 0!==o?o:"key",null!==(u=c[1])&&void 0!==u?u:"value"],a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.fold)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FoldTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"fold",fields:e.fold,as:e.as}}}]),n}(lX),bZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a,i){var o;return Object(iO.a)(this,n),(o=t.call(this,e)).fields=r,o.geojson=a,o.signal=i,o}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.fields),this.geojson,this.signal)}},{key:"dependentFields",value:function(){var e,t=(null!==(e=this.fields)&&void 0!==e?e:[]).filter(Az);return new Set([].concat(Object(Jc.a)(this.geojson?[this.geojson]:[]),Object(Jc.a)(t)))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(Yz(this.fields))}},{key:"assemble",value:function(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}],[{key:"parseAll",value:function(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;for(var r=0,a=0,i=[[EP,SP],[AP,CP]];a<i.length;a++){var o=i[a].map((function(e){var n=Vq(t.encoding[e]);return bq(n)?n.field:yq(n)?{expr:"".concat(n.datum)}:jq(n)?{expr:"".concat(n.value)}:void 0}));(o[0]||o[1])&&(e=new n(e,o,null,t.getName("geojson_".concat(r++))))}if(t.channelHasField(DP)){var u=t.typedFieldDef(DP);u.type===QU&&(e=new n(e,null,u.field,t.getName("geojson_".concat(r++))))}return e}}]),n}(lX),gZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a,i){var o;return Object(iO.a)(this,n),(o=t.call(this,e)).projection=r,o.fields=a,o.as=i,o}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,this.projection,Hz(this.fields),Hz(this.as))}},{key:"dependentFields",value:function(){return new Set(this.fields.filter(Az))}},{key:"producedFields",value:function(){return new Set(this.as)}},{key:"hash",value:function(){return"Geopoint ".concat(this.projection," ").concat(Yz(this.fields)," ").concat(Yz(this.as))}},{key:"assemble",value:function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}],[{key:"parseAll",value:function(e,t){if(!t.projectionName())return e;for(var r=0,a=[[EP,SP],[AP,CP]];r<a.length;r++){var i=a[r],o=i.map((function(e){var n=Vq(t.encoding[e]);return bq(n)?n.field:yq(n)?{expr:"".concat(n.datum)}:jq(n)?{expr:"".concat(n.value)}:void 0})),u=i[0]===AP?"2":"";(o[0]||o[1])&&(e=new n(e,t.projectionName(),o,[t.getName("x"+u),t.getName("y"+u)]))}return e}}]),n}(lX),yZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.impute,this.transform.key].concat(Object(Jc.a)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set([this.transform.impute])}},{key:"processSequence",value:function(e){var t=e.start,n=void 0===t?0:t,r=e.stop,a=e.step,i=[n,r].concat(Object(Jc.a)(a?[a]:[])).join(",");return{signal:"sequence(".concat(i,")")}}},{key:"hash",value:function(){return"Impute ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e,t=this.transform,n=t.impute,r=t.key,a=t.keyvals,i=t.method,o=t.groupby,u=t.value,c=t.frame,s=void 0===c?[null,null]:c,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:n,key:r},a?{keyvals:(e=a,void 0!==(null===e||void 0===e?void 0:e.stop)?this.processSequence(a):a)}:{}),{method:"value"}),o?{groupby:o}:{}),{value:i&&"value"!==i?null:u});return i&&"value"!==i?[l,Object.assign({type:"window",as:["imputed_".concat(n,"_value")],ops:[i],fields:[n],frame:s,ignorePeers:!1},o?{groupby:o}:{}),{type:"formula",expr:"datum.".concat(n," === null ? datum.imputed_").concat(n,"_value : datum.").concat(n),as:n}]:[l]}}],[{key:"makeFromTransform",value:function(e,t){return new n(e,t)}},{key:"makeFromEncoding",value:function(e,t){var r=t.encoding,a=r.x,i=r.y;if(bq(a)&&bq(i)){var o=a.impute?a:i.impute?i:void 0;if(void 0===o)return;var u=a.impute?i:i.impute?a:void 0,c=o.impute,s=c.method,l=c.value,f=c.frame,d=c.keyvals,h=xH(t.mark,r);return new n(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},s?{method:s}:{}),void 0!==l?{value:l}:{}),f?{frame:f}:{}),void 0!==d?{keyvals:d}:{}),h.length?{groupby:h}:{}))}return null}}]),n}(lX),xZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a,i,o,u;Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a.transform=Hz(r);var c=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=c[0])&&void 0!==o?o:r.on,null!==(u=c[1])&&void 0!==u?u:r.loess],a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.loess,this.transform.on].concat(Object(Jc.a)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"LoessTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.loess,n=e.on,r=Iz(e,["loess","on"]);return Object.assign({type:"loess",x:n,y:t},r)}}]),n}(lX),OZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a){var i;return Object(iO.a)(this,n),(i=t.call(this,e)).transform=r,i.secondary=a,i}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform),this.secondary)}},{key:"dependentFields",value:function(){return new Set([this.transform.lookup])}},{key:"producedFields",value:function(){return new Set(this.transform.as?wz(this.transform.as):this.transform.from.fields)}},{key:"hash",value:function(){return"Lookup ".concat(Yz({transform:this.transform,secondary:this.secondary}))}},{key:"assemble",value:function(){var e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:wz(this.transform.as)}:{});else{var t=this.transform.as;Az(t)||(uU(g.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}],[{key:"make",value:function(e,t,r,a){var i=t.component.data.sources,o=r.from,u=null;if(function(e){return"data"in e}(o)){var c=zZ(o.data,i);c||(c=new GJ(o.data),i.push(c));var s=t.getName("lookup_".concat(a));u=new fX(c,s,"lookup",t.component.data.outputNodeRefCounts),t.component.data.outputNodes[s]=u}else if(function(e){return"selection"in e}(o)){var l=o.selection;if(r=Object.assign({as:l},r),!(u=t.getSelectionComponent(lL(l),l).materialized))throw new Error(g.noSameUnitLookup(l))}return new n(e,r,u.getSource())}}]),n}(lX),kZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a,i,o,u;Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a.transform=Hz(r);var c=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=c[0])&&void 0!==o?o:"prob",null!==(u=c[1])&&void 0!==u?u:"value"],a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.quantile].concat(Object(Jc.a)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"QuantileTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.quantile,n=Iz(e,["quantile"]);return Object.assign({type:"quantile",field:t},n)}}]),n}(lX),wZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a,i,o,u;Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a.transform=Hz(r);var c=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=c[0])&&void 0!==o?o:r.on,null!==(u=c[1])&&void 0!==u?u:r.regression],a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.regression,this.transform.on].concat(Object(Jc.a)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"RegressionTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.regression,n=e.on,r=Iz(e,["regression","on"]);return Object.assign({type:"regression",x:n,y:t},r)}}]),n}(lX),jZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"addDimensions",value:function(e){var t;this.transform.groupby=tL((null!==(t=this.transform.groupby)&&void 0!==t?t:[]).concat(e),(function(e){return e}))}},{key:"producedFields",value:function(){}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.pivot,this.transform.value].concat(Object(Jc.a)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"hash",value:function(){return"PivotTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.pivot,n=e.value,r=e.groupby,a=e.limit,i=e.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==a?{limit:a}:{}),void 0!==i?{op:i}:{}),void 0!==r?{groupby:r}:{})}}]),n}(lX),_Z=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r){var a;return Object(iO.a)(this,n),(a=t.call(this,e)).transform=r,a}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(null,Hz(this.transform))}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"SampleTransform ".concat(Yz(this.transform))}},{key:"assemble",value:function(){return{type:"sample",size:this.transform.sample}}}]),n}(lX);function SZ(e){var t=0;return function n(r,a){var i,o,u;if(r instanceof GJ&&(r.isGenerator||sK(r.data)||(e.push(a),a={name:null,source:a.name,transform:[]})),r instanceof uQ&&(r.parent instanceof GJ&&!a.source?(a.format=Object.assign(Object.assign({},null!==(i=a.format)&&void 0!==i?i:{}),{parse:r.assembleFormatParse()}),(o=a.transform).push.apply(o,Object(Jc.a)(r.assembleTransforms(!0)))):(u=a.transform).push.apply(u,Object(Jc.a)(r.assembleTransforms()))),r instanceof nQ){a.name||(a.name="data_".concat(t++)),!a.source||a.transform.length>0?(e.push(a),r.data=a.name):r.data=a.source;var c,s=Object(mo.a)(r.assemble());try{for(s.s();!(c=s.n()).done;){var l=c.value;e.push(l)}}catch(v){s.e(v)}finally{s.f()}}else{var f;if((r instanceof XJ||r instanceof YJ||r instanceof pZ||r instanceof S$||r instanceof K$||r instanceof gZ||r instanceof bZ||r instanceof tQ||r instanceof OZ||r instanceof fQ||r instanceof sQ||r instanceof mZ||r instanceof vZ||r instanceof hZ||r instanceof xZ||r instanceof kZ||r instanceof wZ||r instanceof cQ||r instanceof _Z||r instanceof jZ)&&a.transform.push(r.assemble()),r instanceof HJ||r instanceof dX||r instanceof yZ||r instanceof lQ)(f=a.transform).push.apply(f,Object(Jc.a)(r.assemble()));if(r instanceof fX)if(a.source&&0===a.transform.length)r.setSource(a.source);else if(r.parent instanceof fX)r.setSource(a.name);else{if(a.name||(a.name="data_".concat(t++)),r.setSource(a.name),1===r.numChildren())e.push(a),a={name:null,source:a.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof fX&&(!a.source||a.transform.length>0)&&e.push(a);break;case 1:n(r.children[0],a);break;default:a.name||(a.name="data_".concat(t++));var d=a.name;!a.source||a.transform.length>0?e.push(a):d=a.source;var h,p=Object(mo.a)(r.children);try{for(p.s();!(h=p.n()).done;){n(h.value,{name:null,source:d,transform:[]})}}catch(v){p.e(v)}finally{p.f()}}}}}function EZ(e,t){var n,r,a,i=[],o=SZ(i),u=0,c=Object(mo.a)(e.sources);try{for(c.s();!(a=c.n()).done;){var s=a.value;s.hasName()||(s.dataName="source_".concat(u++));var l=s.assemble();o(s,l)}}catch(A){c.e(A)}finally{c.f()}for(var f=0,d=i;f<d.length;f++){var h=d[f];0===h.transform.length&&delete h.transform}var p,v=0,m=Object(mo.a)(i.entries());try{for(m.s();!(p=m.n()).done;){var b=Object(bo.a)(p.value,2),g=b[0],y=b[1];0!==(null!==(n=y.transform)&&void 0!==n?n:[]).length||y.source||i.splice(v++,0,i.splice(g,1)[0])}}catch(A){m.e(A)}finally{m.f()}for(var x=0,O=i;x<O.length;x++){var k,w=O[x],j=Object(mo.a)(null!==(r=w.transform)&&void 0!==r?r:[]);try{for(j.s();!(k=j.n()).done;){var _=k.value;"lookup"===_.type&&(_.from=e.outputNodes[_.from].getSource())}}catch(A){j.e(A)}finally{j.f()}}for(var S=0,E=i;S<E.length;S++){var C=E[S];C.name in t&&(C.values=t[C.name])}return i}function CZ(e,t){var n,r=e.facet,a=e.config,i=e.child,o=e.component;if(e.channelHasField(t)){var u=r[t],c=$$("title",null,a,t),s=Lq(u,a,{allowDisabling:!0,includeDefault:void 0===c||!!c});i.component.layoutHeaders[t].title&&(s=bz(s)?s.join(", "):s,s+=" / "+i.component.layoutHeaders[t].title,i.component.layoutHeaders[t].title=null);var l=$$("labelOrient",u,a,t),f=OL((null!==(n=u.header)&&void 0!==n?n:{}).labels,a.header.labels,!0),d=Jz(["bottom","right"],l)?"footer":"header";o.layoutHeaders[t]=Object(vt.a)({title:s,facetFieldDef:u},d,"facet"===t?[]:[AZ(e,t,f)])}}function AZ(e,t,n){var r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function NZ(e,t){var n,r,a=e.child;if(a.component.axes[t]){var i=e.component,o=i.layoutHeaders,u=i.resolve;if(u.axis[t]=bJ(u,t),"shared"===u.axis[t]){var c,s="x"===t?"column":"row",l=o[s],f=Object(mo.a)(a.component.axes[t]);try{for(f.s();!(c=f.n()).done;){var d=c.value,h="top"===(r=d.get("orient"))||"left"===r||EU(r)?"header":"footer";l[h]=null!==(n=l[h])&&void 0!==n?n:[AZ(e,s,!1)];var p=I$(d,"main",e.config,{header:!0});p&&l[h][0].axes.push(p),d.mainExtracted=!0}}catch(v){f.e(v)}finally{f.f()}}}}function TZ(e){IZ(e);var t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";DZ(e,t),DZ(e,n)}function IZ(e){var t,n=Object(mo.a)(e.children);try{for(n.s();!(t=n.n()).done;){t.value.parseLayoutSize()}}catch(r){n.e(r)}finally{n.f()}}function DZ(e,t){var n,r,a=pJ(t),i=OB(a),o=e.component.resolve,u=e.component.layoutSize,c=Object(mo.a)(e.children);try{for(c.s();!(r=c.n()).done;){var s=r.value.component.layoutSize.getWithExplicit(a),l=o.scale[i];if("independent"===l&&"step"===s.value){n=void 0;break}if(n){if("independent"===l&&n.value!==s.value){n=void 0;break}n=uK(n,s,a,"")}else n=s}}catch(p){c.e(p)}finally{c.f()}if(n){var f,d=Object(mo.a)(e.children);try{for(d.s();!(f=d.n()).done;){var h=f.value;e.renameSignal(h.getName(a),e.getName(t)),h.component.layoutSize.set(a,"merged",!1)}}catch(p){d.e(p)}finally{d.f()}u.setWithExplicit(t,n)}else u.setWithExplicit(t,{explicit:!1,value:void 0})}function FZ(e,t){var n="width"===t?"x":"y",r=e.config,a=e.getScaleComponent(n);if(a){var i=a.get("type"),o=a.get("range");if(wV(i)){var u=oG(r.view,t);return CU(o)||tG(u)?"step":u}return aG(r.view,t)}if(e.hasProjection||"arc"===e.mark)return aG(r.view,t);var c=oG(r.view,t);return tG(c)?c.step:c}function MZ(e,t,n){return Nq(t,Object.assign({suffix:"by_".concat(Nq(e))},null!==n&&void 0!==n?n:{}))}var RZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a,i){var o;return Object(iO.a)(this,n),(o=t.call(this,e,"facet",r,a,i,e.resolve)).child=f0(e.spec,Object(tK.a)(o),o.getName("child"),void 0,i),o.children=[o.child],o.facet=o.initFacet(e.facet,i),o}return Object(oO.a)(n,[{key:"initFacet",value:function(e,t){return uq(e)?yH(e,(function(e,n,r){return Jz([vP,mP],r)?void 0===n.field?(uU(g.emptyFieldDef(n,r)),e):(e[r]=qq(n,r,t),e):(uU(g.incompatibleChannel(r,"facet")),e)}),{}):{facet:qq(e,"facet",t)}}},{key:"channelHasField",value:function(e){return!!this.facet[e]}},{key:"fieldDef",value:function(e){return this.facet[e]}},{key:"parseData",value:function(){this.component.data=PZ(this),this.child.parseData()}},{key:"parseLayoutSize",value:function(){IZ(this)}},{key:"parseSelections",value:function(){this.child.parseSelections(),this.component.selection=this.child.component.selection}},{key:"parseMarkGroup",value:function(){this.child.parseMarkGroup()}},{key:"parseAxesAndHeaders",value:function(){this.child.parseAxesAndHeaders(),function(e){var t,n=Object(mo.a)(nB);try{for(n.s();!(t=n.n()).done;)CZ(e,t.value)}catch(r){n.e(r)}finally{n.f()}NZ(e,"x"),NZ(e,"y")}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.child.assembleSelectionTopLevelSignals(e)}},{key:"assembleSignals",value:function(){return this.child.assembleSignals(),[]}},{key:"assembleSelectionData",value:function(e){return this.child.assembleSelectionData(e)}},{key:"getHeaderLayoutMixins",value:function(){var e,t,n,r,a={},i=Object(mo.a)(nB);try{for(i.s();!(r=i.n()).done;){var o,u=r.value,c=Object(mo.a)(Z$);try{for(c.s();!(o=c.n()).done;){var s=o.value,l=this.component.layoutHeaders[u],f=l[s],d=l.facetFieldDef;if(d){var h=$$("titleOrient",d,this.config,u);if(Jz(["right","bottom"],h)){var p=Y$(u,h);a.titleAnchor=null!==(e=a.titleAnchor)&&void 0!==e?e:{},a.titleAnchor[p]="end"}}if(null===f||void 0===f?void 0:f[0]){var v="row"===u?"height":"width",m="header"===s?"headerBand":"footerBand";"facet"===u||this.child.component.layoutSize.get(v)||(a[m]=null!==(t=a[m])&&void 0!==t?t:{},a[m][u]=.5),l.title&&(a.offset=null!==(n=a.offset)&&void 0!==n?n:{},a.offset["row"===u?"rowTitle":"columnTitle"]=10)}}}catch(b){c.e(b)}finally{c.f()}}}catch(b){i.e(b)}finally{i.f()}return a}},{key:"assembleDefaultLayout",value:function(){var e=this.facet,t=e.column,n=e.row,r=t?this.columnDistinctSignal():n?1:void 0,a="all";return(n||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(a="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:a})}},{key:"assembleLayoutSignals",value:function(){return this.child.assembleLayoutSignals()}},{key:"columnDistinctSignal",value:function(){if(!(this.parent&&this.parent instanceof n)){var e=this.getName("column_domain");return{signal:"length(data('".concat(e,"'))")}}}},{key:"assembleGroup",value:function(e){return this.parent&&this.parent instanceof n?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Nq(this.facet.column,{prefix:"distinct"})}}}}:{}),Object(kG.a)(Object(wG.a)(n.prototype),"assembleGroup",this).call(this,e)):Object(kG.a)(Object(wG.a)(n.prototype),"assembleGroup",this).call(this,e)}},{key:"getCardinalityAggregateForChild",value:function(){var e=[],t=[],r=[];if(this.child instanceof n){if(this.child.channelHasField("column")){var a=Nq(this.child.facet.column);e.push(a),t.push("distinct"),r.push("distinct_".concat(a))}}else{var i,o=Object(mo.a)(bB);try{for(o.s();!(i=o.n()).done;){var u=i.value,c=this.child.component.scales[u];if(c&&!c.merged){var s=c.get("type"),l=c.get("range");if(wV(s)&&CU(l)){var f=BQ(WQ(this.child,u));f?(e.push(f),t.push("distinct"),r.push("distinct_".concat(f))):uU("Unknown field for ".concat(u,". Cannot calculate view size."))}}}}catch(d){o.e(d)}finally{o.f()}}return{fields:e,ops:t,as:r}}},{key:"assembleFacet",value:function(){var e,t=this.component.data.facetRoot,n=t.name,r=t.data,a=this.facet,i=a.row,o=a.column,u=this.getCardinalityAggregateForChild(),c=u.fields,s=u.ops,l=u.as,f=[],d=Object(mo.a)(nB);try{for(d.s();!(e=d.n()).done;){var h=e.value,p=this.facet[h];if(p){f.push(Nq(p));var v=p.bin,m=p.sort;if(IB(v)&&f.push(Nq(p,{binSuffix:"end"})),iq(m)){var b=m.field,g=m.op,y=void 0===g?tq:g,x=MZ(p,m);i&&o?(c.push(x),s.push("max"),l.push(x)):(c.push(b),s.push(y),l.push(x))}else if(bz(m)){var O=X$(p,h);c.push(O),s.push("max"),l.push(O)}}}}catch(w){d.e(w)}finally{d.f()}var k=!!i&&!!o;return Object.assign({name:n,data:r,groupby:f},k||c.length>0?{aggregate:Object.assign(Object.assign({},k?{cross:k}:{}),c.length?{fields:c,ops:s,as:l}:{})}:{})}},{key:"facetSortFields",value:function(e){var t=this.facet[e];return t?iq(t.sort)?[MZ(t,t.sort,{expr:"datum"})]:bz(t.sort)?[X$(t,e,{expr:"datum"})]:[Nq(t,{expr:"datum"})]:[]}},{key:"facetSortOrder",value:function(e){var t=this.facet[e];if(t){var n=t.sort;return[(iq(n)?n.order:!bz(n)&&n)||"ascending"]}return[]}},{key:"assembleLabelTitle",value:function(){var e=this.facet,t=this.config;if(e.facet)return iJ(e.facet,"facet",t);var n,r={row:["top","bottom"],column:["left","right"]},a=Object(mo.a)(Q$);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e[i]){var o=$$("labelOrient",e[i],t,i);if(Jz(r[i],o))return iJ(e[i],i,t)}}}catch(u){a.e(u)}finally{a.f()}}},{key:"assembleMarks",value:function(){var e=this,t=this.child,n=function(e){var t,n=[],r=SZ(n),a=Object(mo.a)(e.children);try{for(a.s();!(t=a.n()).done;)r(t.value,{source:e.name,name:null,transform:[]})}catch(i){a.e(i)}finally{a.f()}return n}(this.component.data.facetRoot),r=t.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:nB.map((function(t){return e.facetSortFields(t)})).flat(),order:nB.map((function(t){return e.facetSortOrder(t)})).flat()}}),n.length>0?{data:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(function(e,t){if(e.component.selection&&oL(e.component.selection).length){var n=Nz(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:cD("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return MX(t)}(this,[])))]}},{key:"getMapping",value:function(){return this.facet}}]),n}(dZ);function zZ(e,t){var n,r,a,i,o,u,c,s,l,f,d,h=Object(mo.a)(t);try{for(h.s();!(d=h.n()).done;){var p=d.value,v=p.data;if((!e.name||!p.hasName()||e.name===p.dataName)&&((!(null===(n=e.format)||void 0===n?void 0:n.mesh)||!(null===(r=v.format)||void 0===r?void 0:r.feature))&&(!(null===(a=e.format)||void 0===a?void 0:a.feature)&&!(null===(i=v.format)||void 0===i?void 0:i.feature)||(null===(o=e.format)||void 0===o?void 0:o.feature)===(null===(u=v.format)||void 0===u?void 0:u.feature))&&(!(null===(c=e.format)||void 0===c?void 0:c.mesh)&&!(null===(s=v.format)||void 0===s?void 0:s.mesh)||(null===(l=e.format)||void 0===l?void 0:l.mesh)===(null===(f=v.format)||void 0===f?void 0:f.mesh))))if(lK(e)&&lK(v)){if(qz(e.values,v.values))return p}else if(sK(e)&&sK(v)){if(e.url===v.url)return p}else if(fK(e)&&e.name===p.dataName)return p}}catch(m){h.e(m)}finally{h.f()}return null}function LZ(e,t){if(e.data||!e.parent){if(null===e.data){var n=new GJ({values:[]});return t.push(n),n}var r=zZ(e.data,t);if(r)return dK(e.data)||(r.data.format=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];eL(e,null!==o&&void 0!==o?o:{})}return e}({},e.data.format,r.data.format)),!r.hasName()&&e.data.name&&(r.dataName=e.data.name),r;var a=new GJ(e.data);return t.push(a),a}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function PZ(e){var t,n,r,a,i,o,u,c,s,l,f=LZ(e,e.component.data.sources),d=e.component.data,h=d.outputNodes,p=d.outputNodeRefCounts,v=e.parent?e.parent.component.data.ancestorParse.clone():new cK,m=e.data;dK(m)?(hK(m)?f=new YJ(f,m.sequence):vK(m)&&(f=new XJ(f,m.graticule)),v.parseNothing=!0):null===(null===(t=null===m||void 0===m?void 0:m.format)||void 0===t?void 0:t.parse)&&(v.parseNothing=!0),f=null!==(n=uQ.makeExplicit(f,e,v))&&void 0!==n?n:f,f=new cQ(f);var b=e.parent&&lZ(e.parent);(uZ(e)||cZ(e))&&b&&(f=null!==(r=HJ.makeFromEncoding(f,e))&&void 0!==r?r:f),e.transforms.length>0&&(f=function(e,t,n){var r,a,i,o=0,u=Object(mo.a)(t.transforms);try{for(u.s();!(i=u.n()).done;){var c=i.value,s=void 0,l=void 0;if(AK(c))l=e=new K$(e,c),s="derived";else if(gK(c)){var f=iQ(c);l=e=null!==(r=uQ.makeWithAncestors(e,{},f,n))&&void 0!==r?r:e,e=new S$(e,t,c.filter)}else if(NK(c))l=e=HJ.makeFromTransform(e,c,t),s="number";else if(IK(c))s="date",void 0===n.getWithExplicit(c.field).value&&(e=new uQ(e,Object(vt.a)({},c.field,s)),n.set(c.field,s,!1)),l=e=dX.makeFromTransform(e,c);else if(DK(c))l=e=tQ.makeFromTransform(e,c),s="number",JX(t)&&(e=new cQ(e));else if(yK(c))l=e=OZ.make(e,t,c,o++),s="derived";else if(SK(c))l=e=new fQ(e,c),s="number";else if(EK(c))l=e=new sQ(e,c),s="number";else if(FK(c))l=e=lQ.makeFromTransform(e,c),s="derived";else if(MK(c))l=e=new mZ(e,c),s="derived";else if(CK(c))l=e=new vZ(e,c),s="derived";else if(xK(c))l=e=new jZ(e,c),s="derived";else if(_K(c))e=new _Z(e,c);else if(TK(c))l=e=yZ.makeFromTransform(e,c),s="derived";else if(OK(c))l=e=new hZ(e,c),s="derived";else if(kK(c))l=e=new kZ(e,c),s="derived";else if(wK(c))l=e=new wZ(e,c),s="derived";else{if(!jK(c)){uU(g.invalidTransformIgnored(c));continue}l=e=new xZ(e,c),s="derived"}if(l&&void 0!==s){var d,h=Object(mo.a)(null!==(a=l.producedFields())&&void 0!==a?a:[]);try{for(h.s();!(d=h.n()).done;){var p=d.value;n.set(p,s,!1)}}catch(v){h.e(v)}finally{h.f()}}}}catch(v){u.e(v)}finally{u.f()}return e}(f,e,v));var y=function(e){var t={};if(uZ(e)&&e.component.selection){var n,r=Object(mo.a)(oL(e.component.selection));try{for(r.s();!(n=r.n()).done;){var a,i=n.value,o=e.component.selection[i],u=Object(mo.a)(o.project.items);try{for(u.s();!(a=u.n()).done;){var c=a.value;!c.channel&&xL(c.field)>1&&(t[c.field]="flatten")}}catch(s){u.e(s)}finally{u.f()}}}catch(s){r.e(s)}finally{r.f()}}return t}(e),x=oQ(e);f=null!==(a=uQ.makeWithAncestors(f,{},Object.assign(Object.assign({},y),x),v))&&void 0!==a?a:f,uZ(e)&&(f=bZ.parseAll(f,e),f=gZ.parseAll(f,e)),(uZ(e)||cZ(e))&&(b||(f=null!==(i=HJ.makeFromEncoding(f,e))&&void 0!==i?i:f),f=null!==(o=dX.makeFromEncoding(f,e))&&void 0!==o?o:f,f=K$.parseAllForSortIndex(f,e));var O=e.getName(bK),k=new fX(f,O,bK,p);if(h[O]=k,f=k,uZ(e)){var w=tQ.makeFromEncoding(f,e);w&&(f=w,JX(e)&&(f=new cQ(f))),f=null!==(u=yZ.makeFromEncoding(f,e))&&void 0!==u?u:f,f=null!==(c=lQ.makeFromEncoding(f,e))&&void 0!==c?c:f}uZ(e)&&(f=null!==(s=pZ.make(f,e))&&void 0!==s?s:f);var j=e.getName(mK),_=new fX(f,j,mK,p);h[j]=_,f=_,uZ(e)&&function(e,t){XX(e,(function(n){var r=n.name,a=e.getName("lookup_".concat(r));e.component.data.outputNodes[a]=n.materialized=new fX(new S$(t,e,{selection:r}),a,"lookup",e.component.data.outputNodeRefCounts)}))}(e,_);var S=null;if(cZ(e)){var E=e.getName("facet");f=null!==(l=function(e,t){var n=t.row,r=t.column;if(n&&r){for(var a=null,i=0,o=[n,r];i<o.length;i++){var u=o[i];if(iq(u.sort)){var c=u.sort,s=c.field,l=c.op;e=a=new sQ(e,{joinaggregate:[{op:void 0===l?tq:l,field:s,as:MZ(u,u.sort,{forAs:!0})}],groupby:[Nq(u)]})}}return a}return null}(f,e.facet))&&void 0!==l?l:f,S=new nQ(f,e,E,_.getSource()),h[E]=S}return Object.assign(Object.assign({},e.component.data),{outputNodes:h,outputNodeRefCounts:p,raw:k,main:_,facetRoot:S,ancestorParse:v})}var BZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a,i){var o,u,c,s,l;return Object(iO.a)(this,n),o=t.call(this,e,"concat",r,a,i,e.resolve),"shared"!==(null===(c=null===(u=e.resolve)||void 0===u?void 0:u.axis)||void 0===c?void 0:c.x)&&"shared"!==(null===(l=null===(s=e.resolve)||void 0===s?void 0:s.axis)||void 0===l?void 0:l.y)||uU(g.CONCAT_CANNOT_SHARE_AXIS),o.children=o.getChildren(e).map((function(e,t){return f0(e,Object(tK.a)(o),o.getName("concat_"+t),void 0,i)})),o}return Object(oO.a)(n,[{key:"parseData",value:function(){this.component.data=PZ(this);var e,t=Object(mo.a)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseData()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseSelections",value:function(){this.component.selection={};var e,t=Object(mo.a)(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parseSelections();var r,a=Object(mo.a)(oL(n.component.selection));try{for(a.s();!(r=a.n()).done;){var i=r.value;this.component.selection[i]=n.component.selection[i]}}catch(o){a.e(o)}finally{a.f()}}}catch(o){t.e(o)}finally{t.f()}}},{key:"parseMarkGroup",value:function(){var e,t=Object(mo.a)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseMarkGroup()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseAxesAndHeaders",value:function(){var e,t=Object(mo.a)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseAxesAndHeaders()}}catch(n){t.e(n)}finally{t.f()}}},{key:"getChildren",value:function(e){return ZH(e)?e.vconcat:eG(e)?e.hconcat:e.concat}},{key:"parseLayoutSize",value:function(){TZ(this)}},{key:"parseAxisGroup",value:function(){return null}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)}},{key:"assembleSignals",value:function(){return this.children.forEach((function(e){return e.assembleSignals()})),[]}},{key:"assembleLayoutSignals",value:function(){var e,t=lJ(this),n=Object(mo.a)(this.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Jc.a)(r.assembleLayoutSignals()))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"assembleSelectionData",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)}},{key:"assembleMarks",value:function(){return this.children.map((function(e){var t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())}))}},{key:"assembleDefaultLayout",value:function(){var e=this.layout.columns;return Object.assign(Object.assign({},null!=e?{columns:e}:{}),{bounds:"full",align:"each"})}}]),n}(fZ);var WZ=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},TL),{labelExpr:1,encode:1}),UZ=oL(WZ),VZ=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(iO.a)(this,n),(e=t.call(this)).explicit=r,e.implicit=a,e.mainExtracted=i,e}return Object(oO.a)(n,[{key:"clone",value:function(){return new n(Hz(this.explicit),Hz(this.implicit),this.mainExtracted)}},{key:"hasAxisPart",value:function(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}},{key:"hasOrientSignalRef",value:function(){return EU(this.explicit.orient)}}]),n}(nK);var qZ={bottom:"top",top:"bottom",left:"right",right:"left"};function HZ(e,t){if(!e)return t.map((function(e){return e.clone()}));if(e.length===t.length){for(var n=e.length,r=0;r<n;r++){var a=e[r],i=t[r];if(!!a!==!!i)return;if(a&&i){var o=a.getWithExplicit("orient"),u=i.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value)return;e[r]=GZ(a,i)}}return e}}function GZ(e,t){var n,r=Object(mo.a)(UZ);try{var a=function(){var r=n.value,a=uK(e.getWithExplicit(r),t.getWithExplicit(r),r,"axis",(function(e,t){switch(r){case"title":return dH(e,t);case"gridScale":return{explicit:e.explicit,value:OL(e.value,t.value)}}return oK(e,t,r,"axis")}));e.setWithExplicit(r,a)};for(r.s();!(n=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}return e}function KZ(e,t,n,r,a){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(EU(n.labelAngle)?n.labelAngle:_L(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===G$(r,a))return!0}return e===n[t]}var XZ=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function YZ(e,t){var n,r,a,i=t.axis(e),o=new VZ,u=Vq(t.encoding[e]),c=t.mark,s=t.config,l=(null===i||void 0===i?void 0:i.orient)||(null===(n=s["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=s.axis)||void 0===r?void 0:r.orient)||function(e){return"x"===e?"bottom":"left"}(e),f=t.getScaleComponent(e).get("type"),d=P$(e,f,l,t.config),h=void 0!==i?!i:W$("disable",s,null===i||void 0===i?void 0:i.style,d).configValue;if(o.set("disable",h,void 0!==i),h)return o;var p,v=function(e,t,n,r,a){var i=null===t||void 0===t?void 0:t.labelAngle;if(void 0!==i)return EU(i)?i:_L(i);var o=W$("labelAngle",e.config,null===t||void 0===t?void 0:t.style,a).configValue;return void 0!==o?_L(o):n===gP&&Jz([JU,YU],r.type)?270:void 0}(t,i=i||{},e,u,d),m={fieldOrDatumDef:u,axis:i,channel:e,model:t,scaleType:f,orient:l,labelAngle:v,mark:c,config:s},b=Object(mo.a)(UZ);try{for(b.s();!(p=b.n()).done;){var g=p.value,y=g in U$?U$[g](m):DL(g)?i[g]:void 0,x=void 0!==y,O=KZ(y,g,i,t,e);if(x&&O)o.set(g,y,O);else{var k=DL(g)&&"values"!==g?W$(g,t.config,i.style,d):{},w=k.configValue,j=void 0===w?void 0:w,_=k.configFrom,S=void 0===_?void 0:_,E=void 0!==j;x&&!E?o.set(g,y,O):("vgAxisConfig"!==S||XZ.has(g)&&E||CL(j)||EU(j))&&o.set(g,j,!1)}}}catch(N){b.e(N)}finally{b.f()}var C=null!==(a=i.encoding)&&void 0!==a?a:{},A=AL.reduce((function(n,r){var a;if(!o.hasAxisPart(r))return n;var i=vJ(null!==(a=C[r])&&void 0!==a?a:{},t),u="labels"===r?function(e,t,n){var r,a=e.encoding,i=e.config,o=null!==(r=Vq(a[t]))&&void 0!==r?r:Vq(a[dB(t)]),u=e.axis(t)||{},c=u.format,s=u.formatType;return qV(s)?Object.assign({text:XV({fieldOrDatumDef:o,field:"datum.value",format:c,formatType:s,config:i})},n):n}(t,e,i):i;return void 0===u||iL(u)||(n[r]={update:u}),n}),{});return iL(A)||o.set("encode",A,!!i.encoding||void 0!==i.labelAngle),o}function $Z(e){var t,n=e.encoding,r=e.size,a=Object(mo.a)(bB);try{for(a.s();!(t=a.n()).done;){var i=t.value,o=hB(i);tG(r[o])&&xq(n[i])&&(delete r[o],uU(g.stepDropped(o)))}}catch(u){a.e(u)}finally{a.f()}return r}function JZ(e,t,n,r){var a=r.graticule,i=QL(e)?Object.assign({},e):{type:e},o=iH("orient",i,n);if(i.orient=function(e,t,n){switch(e){case BL:case GL:case KL:case VL:case WL:case LL:return}var r=t.x,a=t.y,i=t.x2,o=t.y2;switch(e){case zL:if(bq(r)&&(DB(r.bin)||bq(a)&&a.aggregate&&!r.aggregate))return"vertical";if(bq(a)&&(DB(a.bin)||bq(r)&&r.aggregate&&!a.aggregate))return"horizontal";if(o||i){if(n)return n;if(!i&&(bq(r)&&r.type===XU&&!IB(r.bin)||Oq(r)))return"horizontal";if(!o&&(bq(a)&&a.type===XU&&!IB(a.bin)||Oq(a)))return"vertical"}case UL:if(i&&(!bq(r)||!DB(r.bin))&&o&&(!bq(a)||!DB(a.bin)))return;case RL:if(o)return bq(a)&&DB(a.bin)?"horizontal":"vertical";if(i)return bq(r)&&DB(r.bin)?"vertical":"horizontal";if(e===UL){if(r&&!a)return"vertical";if(a&&!r)return"horizontal"}case PL:case qL:var u=xq(r),c=xq(a);if(u&&!c)return"tick"!==e?"horizontal":"vertical";if(!u&&c)return"tick"!==e?"vertical":"horizontal";if(u&&c){var s=r,l=a,f=s.type===$U,d=l.type===$U;return f&&!d?"tick"!==e?"vertical":"horizontal":!f&&d?"tick"!==e?"horizontal":"vertical":!s.aggregate&&l.aggregate?"tick"!==e?"vertical":"horizontal":s.aggregate&&!l.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}return"vertical"}(i.type,t,o),void 0!==o&&o!==i.orient&&uU(g.orientOverridden(i.orient,o)),"bar"===i.type&&i.orient){var u=iH("cornerRadiusEnd",i,n);if(void 0!==u){var c,s="horizontal"===i.orient&&t.x2||"vertical"===i.orient&&t.y2?["cornerRadius"]:tP[i.orient],l=Object(mo.a)(s);try{for(l.s();!(c=l.n()).done;){i[c.value]=u}}catch(f){l.e(f)}finally{l.f()}void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd}}return void 0===iH("opacity",i,n)&&(i.opacity=function(e,t){if(Jz([BL,qL,GL,KL],e)&&!pH(t))return.7;return}(i.type,t)),void 0===i.filled&&(i.filled=!a&&function(e,t){var n=oH("filled",e,t),r=e.type;return OL(n,r!==BL&&r!==PL&&r!==UL)}(i,n)),void 0===iH("cursor",i,n)&&(i.cursor=function(e,t,n){if(t.href||e.href||iH("href",e,n))return"pointer";return e.cursor}(i,t,n)),i}function QZ(e,t){e.config;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),GK("x",e,{defaultPos:"mid"})),GK("y",e,{defaultPos:"mid"})),VK("size",e)),VK("angle",e)),function(e,t,n){if(n)return{shape:{value:n}};return VK("shape",e)}(e,0,t))}function ZZ(e){var t,n=e.config,r=e.markDef,a=r.orient,i="horizontal"===a?"width":"height",o=e.getScaleComponent("horizontal"===a?"x":"y"),u=null!==(t=iH("size",r,n,{vgChannel:i}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==u)return u;var c=o?o.get("range"):void 0;return c&&CU(c)&&Cz(c.step)?3*c.step/4:3*iG(n.view,i)/4}var e0={arc:{vgMark:"arc",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),GK("x",e,{defaultPos:"mid"})),GK("y",e,{defaultPos:"mid"})),eX(e,"radius","arc")),eX(e,"theta","arc"))}},area:{vgMark:"area",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),JK("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),JK("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),oX(e))}},bar:{vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),eX(e,"x","bar")),eX(e,"y","bar"))}},circle:{vgMark:"symbol",encodeEntry:function(e){return QZ(e,"circle")}},geoshape:{vgMark:"shape",encodeEntry:function(e){return Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},t&&bq(t)&&t.type===QU?{field:Nq(t,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),eX(e,"x","image")),eX(e,"y","image")),zK(e,"url"))}},line:{vgMark:"line",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),GK("x",e,{defaultPos:"mid"})),GK("y",e,{defaultPos:"mid"})),VK("size",e,{vgChannel:"strokeWidth"})),oX(e))}},point:{vgMark:"symbol",encodeEntry:function(e){return QZ(e)}},rect:{vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),eX(e,"x","rect")),eX(e,"y","rect"))}},rule:{vgMark:"rule",encodeEntry:function(e){var t=e.markDef.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),JK("x",e,{defaultPos:"horizontal"===t?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==t})),JK("y",e,{defaultPos:"vertical"===t?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==t})),VK("size",e,{vgChannel:"strokeWidth"})):{}}},square:{vgMark:"symbol",encodeEntry:function(e){return QZ(e,"square")}},text:{vgMark:"text",encodeEntry:function(e){var t=e.config;e.encoding;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),GK("x",e,{defaultPos:"mid"})),GK("y",e,{defaultPos:"mid"})),zK(e)),VK("size",e,{vgChannel:"fontSize"})),VK("angle",e)),uX("align",function(e,t,n){if(void 0===iH("align",e,n))return"center";return}(e.markDef,0,t))),uX("baseline",function(e,t,n){if(void 0===iH("baseline",e,n))return"middle";return}(e.markDef,0,t))),GK("radius",e,{defaultPos:null,isMidPoint:!0})),GK("theta",e,{defaultPos:null,isMidPoint:!0}))}},tick:{vgMark:"rect",encodeEntry:function(e){var t=e.config,n=e.markDef,r=n.orient,a="horizontal"===r?"width":"height",i="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),GK("x",e,{defaultPos:"mid",vgChannel:"xc"})),GK("y",e,{defaultPos:"mid",vgChannel:"yc"})),VK("size",e,{defaultValue:ZZ(e),vgChannel:a})),Object(vt.a)({},i,tH(iH("thickness",n,t))))}},trail:{vgMark:"trail",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},aX(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),GK("x",e,{defaultPos:"mid"})),GK("y",e,{defaultPos:"mid"})),VK("size",e)),oX(e))}}};function t0(e){return Jz([PL,RL,HL],e.mark)?function(e){var t=xH(e.mark,e.encoding),n=i0(e,{fromPrefix:t.length>0?n0:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:n0+e.requestDataName(mK),data:e.requestDataName(mK),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(e):Jz([zL],e.mark)?function(e){var t=IU.some((function(t){return iH(t,e.markDef,e.config)}));if(e.stack&&!e.fieldDef("size")&&t){var n,r,a=i0(e,{fromPrefix:r0}),i=Object(bo.a)(a,1)[0],o=e.scaleName(e.stack.fieldChannel),u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.vgField(e.stack.fieldChannel,t)},c=function(e,t){var n=[u({prefix:"min",suffix:"start",expr:t}),u({prefix:"max",suffix:"start",expr:t}),u({prefix:"min",suffix:"end",expr:t}),u({prefix:"max",suffix:"end",expr:t})];return"".concat(e,"(").concat(n.map((function(e){return"scale('".concat(o,"',").concat(e,")")})).join(","),")")};"x"===e.stack.fieldChannel?(n=Object.assign(Object.assign({},Gz(i.encode.update,["y","yc","y2","height"].concat(Object(Jc.a)(IU)))),{x:{signal:c("min","datum")},x2:{signal:c("max","datum")},clip:{value:!0}}),r={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},i.encode.update=Object.assign(Object.assign({},Kz(i.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(n=Object.assign(Object.assign({},Gz(i.encode.update,["x","xc","x2","width"])),{y:{signal:c("min","datum")},y2:{signal:c("max","datum")},clip:{value:!0}}),r={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},i.encode.update=Object.assign(Object.assign({},Kz(i.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));var s,l=Object(mo.a)(IU);try{for(l.s();!(s=l.n()).done;){var f=s.value,d=oH(f,e.markDef,e.config);i.encode.update[f]?(n[f]=i.encode.update[f],delete i.encode.update[f]):d&&(n[f]=tH(d)),d&&(i.encode.update[f]={value:0})}}catch(v){l.e(v)}finally{l.f()}var h=e.fieldDef(e.stack.groupbyChannel),p=Nq(h)?[Nq(h)]:[];return((null===h||void 0===h?void 0:h.bin)||(null===h||void 0===h?void 0:h.timeUnit))&&p.push(Nq(h,{binSuffix:"end"})),(n=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((function(t,n){if(i.encode.update[n])return Object.assign(Object.assign({},t),Object(vt.a)({},n,i.encode.update[n]));var r=oH(n,e.markDef,e.config);return void 0!==r?Object.assign(Object.assign({},t),Object(vt.a)({},n,tH(r))):t}),n)).stroke&&(n.strokeForeground={value:!0},n.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(mK),name:r0+e.requestDataName(mK),groupby:p,aggregate:{fields:[u({suffix:"start"}),u({suffix:"start"}),u({suffix:"end"}),u({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:n},marks:[{type:"group",encode:{update:r},marks:[i]}]}]}return i0(e)}(e):i0(e)}var n0="faceted_path_";var r0="stack_group_";function a0(e){var t=e.encoding,n=e.stack,r=e.mark,a=e.markDef,i=e.config,o=t.order;if(!(!bz(o)&&jq(o)&&$z(o.value)||!o&&$z(iH("order",a,i)))){if((bz(o)||bq(o))&&!n)return sH(o,{expr:"datum"});if(YL(r)){var u="horizontal"===a.orient?"y":"x",c=t[u];if(bq(c)){var s=c.sort;return bz(s)?{field:Nq(c,{prefix:u,suffix:"sort_index",expr:"datum"})}:iq(s)?{field:Nq({aggregate:pH(e.encoding)?s.op:void 0,field:s.field},{expr:"datum"})}:aq(s)?{field:Nq(e.fieldDef(s.encoding),{expr:"datum"}),order:s.order}:null===s?void 0:{field:Nq(c,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}else;}}function i0(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""},n=e.mark,r=e.markDef,a=e.config,i=OL(r.clip,o0(e),u0(e)),o=aH(r),u=e.encoding.key,c=a0(e),s=c0(e),l=iH("aria",r,a),f=e0[n].postEncodingTransform?e0[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:e0[n].vgMark},i?{clip:!0}:{}),o?{style:o}:{}),u?{key:u.field}:{}),c?{sort:c}:{}),s||{}),!1===l?{aria:l}:{}),{from:{data:t.fromPrefix+e.requestDataName(mK)},encode:{update:e0[n].encodeEntry(e)}}),f?{transform:f}:{})]}function o0(e){var t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}function u0(e){var t=e.component.projection;return!(!t||t.isFit)||void 0}function c0(e){if(!e.component.selection)return null;for(var t=oL(e.component.selection).length,n=t,r=e.parent;r&&0===n;)n=oL(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}var s0=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a){var i,o,u,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0;Object(iO.a)(this,n),(i=t.call(this,e,"unit",r,a,s,void 0,nG(e)?e.view:void 0)).specifiedScales={},i.specifiedAxes={},i.specifiedLegends={},i.specifiedProjection={},i.selection={},i.children=[];var l=QL(e.mark)?e.mark.type:e.mark;i.markDef=JZ(e.mark,null!==(o=e.encoding)&&void 0!==o?o:{},s,{graticule:e.data&&vK(e.data)});var f=i.encoding=mH(null!==(u=e.encoding)&&void 0!==u?u:{},i.markDef,s);return i.size=$Z({encoding:f,size:nG(e)?Object.assign(Object.assign(Object.assign({},c),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):c}),i.stack=DG(l,f),i.specifiedScales=i.initScales(l,f),i.specifiedAxes=i.initAxes(f),i.specifiedLegends=i.initLegend(f),i.specifiedProjection=e.projection,i.selection=e.selection,i}return Object(oO.a)(n,[{key:"hasProjection",get:function(){var e=this.encoding,t=this.mark===XL,n=e&&QP.some((function(t){return kq(e[t])}));return t||n}},{key:"scaleDomain",value:function(e){var t=this.specifiedScales[e];return t?t.domain:void 0}},{key:"axis",value:function(e){return this.specifiedAxes[e]}},{key:"legend",value:function(e){return this.specifiedLegends[e]}},{key:"initScales",value:function(e,t){return _B.reduce((function(e,n){var r,a=Vq(t[n]);return a&&(e[n]=null!==(r=a.scale)&&void 0!==r?r:{}),e}),{})}},{key:"initAxes",value:function(e){return bB.reduce((function(t,n){var r=e[n];if(kq(r)||n===gP&&kq(e.x2)||n===yP&&kq(e.y2)){var a=kq(r)?r.axis:void 0;t[n]=a?Object.assign({},a):a}return t}),{})}},{key:"initLegend",value:function(e){return wB.reduce((function(t,n){var r=Vq(e[n]);if(r&&function(e){switch(e){case NP:case TP:case IP:case FP:case DP:case RP:case PP:case BP:return!0;case zP:case LP:case MP:return!1}}(n)){var a=r.legend;t[n]=a?Object.assign({},a):a}return t}),{})}},{key:"parseData",value:function(){this.component.data=PZ(this)}},{key:"parseLayoutSize",value:function(){!function(e){var t,n=e.size,r=e.component,a=Object(mo.a)(bB);try{for(a.s();!(t=a.n()).done;){var i=hB(t.value);if(n[i]){var o=n[i];r.layoutSize.set(i,tG(o)?"step":o,!0)}else{var u=FZ(e,i);r.layoutSize.set(i,u,!1)}}}catch(c){a.e(c)}finally{a.f()}}(this)}},{key:"parseSelections",value:function(){this.component.selection=function(e,t){var n,r,a={},i=e.config.selection,o=Object(mo.a)(oL(null!==t&&void 0!==t?t:{}));try{var u=function(){var o=r.value,u=Hz(t[o]),c=i[u.type],s=(c.fields,c.encodings,Iz(c,["fields","encodings"]));for(var l in s)"encodings"===l&&u.fields||"fields"===l&&u.encodings||("mark"===l&&(u[l]=Object.assign(Object.assign({},s[l]),u[l])),void 0!==u[l]&&!0!==u[l]||(u[l]=null!==(n=s[l])&&void 0!==n?n:u[l]));var f=lL(o),d=a[f]=Object.assign(Object.assign({},u),{name:f,events:Az(u.on)?cD(u.on,"scope"):Hz(u.on)});IX(d,(function(n){n.has(d)&&n.parse&&n.parse(e,d,u,t[o])}))};for(o.s();!(r=o.n()).done;)u()}catch(c){o.e(c)}finally{o.f()}return a}(this,this.selection)}},{key:"parseMarkGroup",value:function(){this.component.mark=t0(this)}},{key:"parseAxesAndHeaders",value:function(){var e;this.component.axes=(e=this,bB.reduce((function(t,n){return e.component.scales[n]&&(t[n]=[YZ(n,e)]),t}),{}))}},{key:"assembleSelectionTopLevelSignals",value:function(e){return function(e,t){var n=!1;return XX(e,(function(r,a){var i=r.name,o=Nz(i+VX);if(0===t.filter((function(e){return e.name===i})).length){var u="global"===r.resolve?"union":r.resolve,c="multi"===r.type?", true)":")";t.push({name:r.name,update:"".concat(GX,"(").concat(o,", ").concat(Nz(u)).concat(c)})}n=!0,a.topLevelSignals&&(t=a.topLevelSignals(e,r,t)),IX(r,(function(n){n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}))})),n&&0===t.filter((function(e){return"unit"===e.name})).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),MX(t)}(this,e)}},{key:"assembleSignals",value:function(){return[].concat(Object(Jc.a)(D$(this)),Object(Jc.a)((t=[],XX(e=this,(function(n,r){var a,i=n.name,o=r.modifyExpr(e,n);(a=t).push.apply(a,Object(Jc.a)(r.signals(e,n))),IX(n,(function(r){r.signals&&(t=r.signals(e,n,t)),r.modifyExpr&&(o=r.modifyExpr(e,n,o))})),t.push({name:i+HX,on:[{events:{signal:n.name+qX},update:"modify(".concat(Nz(n.name+VX),", ").concat(o,")")}]})})),MX(t))));var e,t}},{key:"assembleSelectionData",value:function(e){return function(e,t){var n=Object(Jc.a)(t);return XX(e,(function(t){var r={name:t.name+VX};if(t.init){var a=t.project.items.map((function(e){return e.signals,Iz(e,["signals"])})),i=t.init.map((function(e){return DX(e,!1)}));r.values="interval"===t.type?[{unit:$X(e,{escape:!1}),fields:a,values:i}]:i.map((function(t){return{unit:$X(e,{escape:!1}),fields:a,values:t}}))}n.filter((function(e){return e.name===t.name+VX})).length||n.push(r)})),n}(this,e)}},{key:"assembleLayout",value:function(){return null}},{key:"assembleLayoutSignals",value:function(){return lJ(this)}},{key:"assembleMarks",value:function(){var e,t=null!==(e=this.component.mark)&&void 0!==e?e:[];return this.parent&&lZ(this.parent)||(t=FX(this,t)),t.map(this.correctDataNames)}},{key:"getMapping",value:function(){return this.encoding}},{key:"mark",get:function(){return this.markDef.type}},{key:"channelHasField",value:function(e){return hH(this.encoding,e)}},{key:"fieldDef",value:function(e){return Uq(this.encoding[e])}},{key:"typedFieldDef",value:function(e){var t=this.fieldDef(e);return wq(t)?t:null}}]),n}(dZ),l0=function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(e,r,a,i,o){var u;Object(iO.a)(this,n),u=t.call(this,e,"layer",r,a,o,e.resolve,e.view);var c=Object.assign(Object.assign(Object.assign({},i),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});return u.children=e.layer.map((function(e,t){if(OG(e))return new n(e,Object(tK.a)(u),u.getName("layer_"+t),c,o);if(aP(e))return new s0(e,Object(tK.a)(u),u.getName("layer_"+t),c,o);throw new Error(g.invalidSpec(e))})),u}return Object(oO.a)(n,[{key:"parseData",value:function(){this.component.data=PZ(this);var e,t=Object(mo.a)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseData()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseLayoutSize",value:function(){var e;IZ(e=this),DZ(e,"width"),DZ(e,"height")}},{key:"parseSelections",value:function(){this.component.selection={};var e,t=Object(mo.a)(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parseSelections();var r,a=Object(mo.a)(oL(n.component.selection));try{for(a.s();!(r=a.n()).done;){var i=r.value;this.component.selection[i]=n.component.selection[i]}}catch(o){a.e(o)}finally{a.f()}}}catch(o){t.e(o)}finally{t.f()}}},{key:"parseMarkGroup",value:function(){var e,t=Object(mo.a)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseMarkGroup()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseAxesAndHeaders",value:function(){!function(e){var t,n,r=e.component,a=r.axes,i=r.resolve,o={top:0,bottom:0,right:0,left:0},u=Object(mo.a)(e.children);try{for(u.s();!(n=u.n()).done;){var c=n.value;c.parseAxesAndHeaders();var s,l=Object(mo.a)(oL(c.component.axes));try{for(l.s();!(s=l.n()).done;){var f=s.value;i.axis[f]=bJ(e.component.resolve,f),"shared"===i.axis[f]&&(a[f]=HZ(a[f],c.component.axes[f]),a[f]||(i.axis[f]="independent",delete a[f]))}}catch(C){l.e(C)}finally{l.f()}}}catch(C){u.e(C)}finally{u.f()}var d,h=Object(mo.a)(bB);try{for(h.s();!(d=h.n()).done;){var p,v=d.value,m=Object(mo.a)(e.children);try{for(m.s();!(p=m.n()).done;){var b=p.value;if(b.component.axes[v]){if("independent"===i.axis[v]){a[v]=(null!==(t=a[v])&&void 0!==t?t:[]).concat(b.component.axes[v]);var g,y=Object(mo.a)(b.component.axes[v]);try{for(y.s();!(g=y.n()).done;){var x=g.value,O=x.getWithExplicit("orient"),k=O.value,w=O.explicit;if(!EU(k)){if(o[k]>0&&!w){var j=qZ[k];o[k]>o[j]&&x.set("orient",j,!1)}o[k]++}}}catch(C){y.e(C)}finally{y.f()}}delete b.component.axes[v]}}}catch(C){m.e(C)}finally{m.f()}if("independent"===i.axis[v]&&a[v]&&a[v].length>1){var _,S=Object(mo.a)(a[v]);try{for(S.s();!(_=S.n()).done;){var E=_.value;E.get("grid")&&!E.explicit.grid&&(E.implicit.grid=!1)}}catch(C){S.e(C)}finally{S.f()}}}}catch(C){h.e(C)}finally{h.f()}}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)}},{key:"assembleSignals",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleSignals())}),D$(this))}},{key:"assembleLayoutSignals",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLayoutSignals())}),lJ(this))}},{key:"assembleSelectionData",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)}},{key:"assembleTitle",value:function(){var e=Object(kG.a)(Object(wG.a)(n.prototype),"assembleTitle",this).call(this);if(e)return e;var t,r=Object(mo.a)(this.children);try{for(r.s();!(t=r.n()).done;){if(e=t.value.assembleTitle())return e}}catch(a){r.e(a)}finally{r.f()}}},{key:"assembleLayout",value:function(){return null}},{key:"assembleMarks",value:function(){return function(e,t){var n,r=Object(mo.a)(e.children);try{for(r.s();!(n=r.n()).done;){var a=n.value;uZ(a)&&(t=FX(a,t))}}catch(i){r.e(i)}finally{r.f()}return t}(this,this.children.flatMap((function(e){return e.assembleMarks()})))}},{key:"assembleLegends",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLegends())}),MJ(this))}}]),n}(fZ);function f0(e,t,n,r,a){if(sq(e))return new RZ(e,t,n,a);if(OG(e))return new l0(e,t,n,r,a);if(aP(e))return new s0(e,t,n,r,a);if(function(e){return ZH(e)||eG(e)||QH(e)}(e))return new BZ(e,t,n,a);throw new Error(g.invalidSpec(e))}function d0(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.logger&&iU(t.logger),t.fieldTitle&&Rq(t.fieldTitle);try{var n=vG(xz(t.config,e.config)),r=$G(e,n),a=f0(r,null,"",void 0,n);a.parse(),NQ(a.component.data,a);var i=p0(a,h0(e,r.autosize,n,a),e.datasets,e.usermeta);return{spec:i,normalized:r}}finally{t.logger&&oU(),t.fieldTitle&&zq()}}function h0(e,t,n,r){var a,i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Az(t)&&(t={type:t}),i&&o&&("fit"===(a=t.type)||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)uU(g.droppingFit()),t.type="pad";else if("step"===i||"step"===o){var u="step"===i?"width":"height";uU(g.droppingFit(OB(u)));var c="width"===u?"height":"width";t.type=function(e){return e?"fit-".concat(OB(e)):"fit"}(c)}return Object.assign(Object.assign(Object.assign({},1===oL(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),eK(n)),eK(e))}function p0(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,a=e.config?yG(e.config):void 0,i=[].concat(e.assembleSelectionData([]),EZ(e.component.data,n)),o=e.assembleProjections(),u=e.assembleTitle(),c=e.assembleGroupStyle(),s=e.assembleGroupEncodeEntry(!0),l=e.assembleLayoutSignals();return l=l.filter((function(e){return"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)})),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),u?{title:u}:{}),c?{style:c}:{}),s?{encode:{update:s}}:{}),{data:i}),o.length>0?{projections:o}:{}),e.assembleGroup([].concat(Object(Jc.a)(l),Object(Jc.a)(e.assembleSelectionTopLevelSignals([]))))),a?{config:a}:{}),r?{usermeta:r}:{})}var v0=new(function(e){Object(jG.a)(n,e);var t=Object(_G.a)(n);function n(){return Object(iO.a)(this,n),t.apply(this,arguments)}return Object(oO.a)(n,[{key:"mapUnit",value:function(e,t){var n=t.config;if(e.encoding){var r=e.encoding,a=e.transform,i=vH(r,n),o=i.bins,u=i.timeUnits,c=i.aggregate,s=i.groupby,l=i.encoding,f=[].concat(Object(Jc.a)(a||[]),Object(Jc.a)(o),Object(Jc.a)(u),Object(Jc.a)(0===c.length?[]:[{aggregate:c,groupby:s}]));return Object.assign(Object.assign(Object.assign({},e),f.length>0?{transform:f}:{}),{encoding:l})}return e}}]),n}(SG));function m0(e,t){return v0.map(e,{config:t})}var b0=oz.version,g0=function(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3),n=Object(bo.a)(t,2);return{library:n[0],version:n[1]}},y0="#fff",x0={background:"#333",title:{color:y0,subtitleColor:y0},style:{"guide-label":{fill:y0},"guide-title":{fill:y0}},axis:{domainColor:y0,gridColor:"#888",tickColor:y0}},O0="#4572a7",k0={background:"#fff",arc:{fill:O0},area:{fill:O0},line:{stroke:O0,strokeWidth:2},path:{stroke:O0},rect:{fill:O0},shape:{stroke:O0},symbol:{fill:O0,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},w0="#30a2da",j0="#cbcbcb",_0="#f0f0f0",S0="#333",E0={arc:{fill:w0},area:{fill:w0},axis:{domainColor:j0,grid:!0,gridColor:j0,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:j0,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:_0,group:{fill:_0},legend:{labelColor:S0,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:S0,titleFontSize:14,titlePadding:10},line:{stroke:w0,strokeWidth:2},path:{stroke:w0,strokeWidth:.5},rect:{fill:w0},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:w0},bar:{binSpacing:2,fill:w0,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},C0="#000",A0={group:{fill:"#e5e5e5"},arc:{fill:C0},area:{fill:C0},line:{stroke:C0},path:{stroke:C0},rect:{fill:C0},shape:{stroke:C0},symbol:{fill:C0,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},N0="Benton Gothic, sans-serif",T0="#82c6df",I0="Benton Gothic Bold, sans-serif",D0="normal",F0={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},M0={background:"#ffffff",title:{anchor:"start",color:"#000000",font:I0,fontSize:22,fontWeight:"normal"},arc:{fill:T0},area:{fill:T0},line:{stroke:T0,strokeWidth:2},path:{stroke:T0},rect:{fill:T0},shape:{stroke:T0},symbol:{fill:T0,size:30},axis:{labelFont:N0,labelFontSize:11.5,labelFontWeight:"normal",titleFont:I0,titleFontSize:13,titleFontWeight:D0},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:N0,labelFontSize:11.5,symbolType:"square",titleFont:I0,titleFontSize:13,titleFontWeight:D0},range:{category:F0["category-6"],diverging:F0["fireandice-6"],heatmap:F0["fire-7"],ordinal:F0["fire-7"],ramp:F0["fire-7"]}},R0="#ab5787",z0="#979797",L0={background:"#f9f9f9",arc:{fill:R0},area:{fill:R0},line:{stroke:R0},path:{stroke:R0},rect:{fill:R0},shape:{stroke:R0},symbol:{fill:R0,size:30},axis:{domainColor:z0,domainWidth:.5,gridWidth:.2,labelColor:z0,tickColor:z0,tickWidth:.2,titleColor:z0},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},P0="#3e5c69",B0={background:"#fff",arc:{fill:P0},area:{fill:P0},line:{stroke:P0},path:{stroke:P0},rect:{fill:P0},shape:{stroke:P0},symbol:{fill:P0},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},W0="#1696d2",U0="#000000",V0="Lato",q0="Lato",H0={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},G0={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:V0},axisX:{domain:!0,domainColor:U0,domainWidth:1,grid:!1,labelFontSize:12,labelFont:q0,labelAngle:0,tickColor:U0,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:V0},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:q0,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:V0,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:q0,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:V0,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:H0["six-groups-cat-1"],diverging:H0["diverging-colors"],heatmap:H0["diverging-colors"],ordinal:H0["six-groups-seq"],ramp:H0["shades-blue"]},area:{fill:W0},rect:{fill:W0},line:{color:W0,stroke:W0,strokeWidth:5},trail:{color:W0,stroke:W0,strokeWidth:0,size:1},path:{stroke:W0,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:W0,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:W0,stroke:null}},arc:{fill:W0},shape:{stroke:W0},symbol:{fill:W0,size:30}},K0="#3366CC",X0="#ccc",Y0="Arial, sans-serif",$0={arc:{fill:K0},area:{fill:K0},path:{stroke:K0},rect:{fill:K0},shape:{stroke:K0},symbol:{stroke:K0},circle:{fill:K0},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Y0,fontSize:12},"guide-title":{font:Y0,fontSize:12},"group-title":{font:Y0,fontSize:12}},title:{font:Y0,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:X0,tickColor:X0,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},J0="2.10.0",Q0="vg-tooltip-element",Z0={offsetX:10,offsetY:10,id:Q0,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function e1(e,t,n){if(Object(ne.B)(e))return"[".concat(e.map((function(e){return t(Object(ne.J)(e)?e:t1(e,n))})).join(", "),"]");if(Object(ne.H)(e)){var r="",a=e,i=a.title,o=a.image,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(a,["title","image"]);i&&(r+="<h2>".concat(t(i),"</h2>")),o&&(r+='<img src="'.concat(t(o),'">'));var c=Object.keys(u);if(c.length>0){r+="<table>";var s,l=Object(mo.a)(c);try{for(l.s();!(s=l.n()).done;){var f=s.value,d=u[f];void 0!==d&&(Object(ne.H)(d)&&(d=t1(d,n)),r+='<tr><td class="key">'.concat(t(f),':</td><td class="value">').concat(t(d),"</td></tr>"))}}catch(h){l.e(h)}finally{l.f()}r+="</table>"}return r||"{}"}return t(e)}function t1(e,t){return JSON.stringify(e,function(e){var t=[];return function(n,r){if("object"!==typeof r||null===r)return r;var a=t.indexOf(this)+1;return t.length=a,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}var n1=function(){function e(t){Object(iO.a)(this,e),this.options=Object.assign(Object.assign({},Z0),t);var n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(Q0,e)}(n);var a=document.head;a.childNodes.length>0?a.insertBefore(r,a.childNodes[0]):a.appendChild(r)}}return Object(oO.a)(e,[{key:"tooltipHandler",value:function(e,t,n,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null!=r&&""!==r){this.el.innerHTML=e1(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));var a=function(e,t,n,r){var a=e.clientX+n;a+t.width>window.innerWidth&&(a=+e.clientX-n-t.width);var i=e.clientY+r;return i+t.height>window.innerHeight&&(i=+e.clientY-r-t.height),{x:a,y:i}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),i=a.x,o=a.y;this.el.setAttribute("style","top: ".concat(o,"px; left: ").concat(i,"px"))}else this.el.classList.remove("visible","".concat(this.options.theme,"-theme"))}}]),e}();function r1(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}c((r=r.apply(e,t||[])).next())}))}function a1(e,t,n){var r=e.open(t),a=new URL(t).origin,i=40;e.addEventListener("message",(function t(n){n.source===r&&(i=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){i<=0||(r.postMessage(n,a),setTimeout(e,250),i-=1)}),250)}var i1,o1='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper {\n    width: 100%;\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function u1(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];c1(e,o)}return e}function c1(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];Object(ne.lb)(e,a,t[a],!0)}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var s1=b,l1=y,f1="undefined"!==typeof window?window:void 0;void 0===l1&&(null===(i1=null===f1||void 0===f1?void 0:f1.vl)||void 0===i1?void 0:i1.compile)&&(l1=f1.vl);var d1={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},h1={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},p1={vega:"Vega","vega-lite":"Vega-Lite"},v1={vega:s1.version,"vega-lite":l1?l1.version:"not available"},m1={vega:function(e){return e},"vega-lite":function(e,t){return l1.compile(e,{config:t}).spec}},b1='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',g1="chart-wrapper";function y1(e){return"function"===typeof e}function x1(e,t,n,r){var a="<html><head>".concat(t,'</head><body><pre><code class="json">'),i="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(a+e+i),o.document.title="".concat(p1[r]," JSON Source")}function O1(e,t){var n;if(e.$schema){var r=g0(e.$schema);t&&t!==r.library&&console.warn("The given visualization spec is written in ".concat(p1[r.library],", but mode argument sets ").concat(null!==(n=p1[t])&&void 0!==n?n:t,"."));var a=r.library;return Object(te.satisfies)(v1[a],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(p1[a]," ").concat(r.version,", but the current version of ").concat(p1[a]," is v").concat(v1[a],".")),a}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!==t&&void 0!==t?t:"vega"}function k1(e){return(t=e)&&"load"in t?e:s1.loader(e);var t}function w1(e){var t;return null!==(t=e.usermeta&&e.usermeta.embedOptions)&&void 0!==t?t:{}}function j1(e,t){var n;return r1(this,void 0,void 0,k.a.mark((function r(){var a,i;return k.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!Object(ne.J)(e.config)){r.next=8;break}return r.t1=JSON,r.next=4,t.load(e.config);case 4:r.t2=r.sent,r.t0=r.t1.parse.call(r.t1,r.t2),r.next=9;break;case 8:r.t0=null!==(n=e.config)&&void 0!==n?n:{};case 9:if(a=r.t0,!Object(ne.J)(e.patch)){r.next=18;break}return r.t4=JSON,r.next=14,t.load(e.patch);case 14:r.t5=r.sent,r.t3=r.t4.parse.call(r.t4,r.t5),r.next=19;break;case 18:r.t3=e.patch;case 19:return i=r.t3,r.abrupt("return",Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),a?{config:a}:{}));case 21:case"end":return r.stop()}}),r)})))}function _1(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}function S1(e,t){var n,r,a,i,o,u,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;return r1(this,void 0,void 0,k.a.mark((function l(){var f,d,h,p,v,m,b,g,y,O,w,j,_,S,E,C,A,N,T,I,D,F,M,R,z,L,P,W,U,V,q,H,G,K,X,Y,$,J,Q;return k.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(Q=function(){P&&document.removeEventListener("click",P),D.finalize()},f=c.theme?Object(ne.P)(x[c.theme],null!==(n=c.config)&&void 0!==n?n:{}):c.config,d=Object(ne.C)(c.actions)?c.actions:u1({},d1,null!==(r=c.actions)&&void 0!==r?r:{}),h=Object.assign(Object.assign({},h1),c.i18n),p=null!==(a=c.renderer)&&void 0!==a?a:"canvas",v=null!==(i=c.logLevel)&&void 0!==i?i:s1.Warn,m=null!==(o=c.downloadFileName)&&void 0!==o?o:"visualization",b="string"===typeof e?document.querySelector(e):e){l.next=10;break}throw new Error("".concat(e," does not exist"));case 10:return!1!==c.defaultStyle&&(g="vega-embed-style",y=_1(b),O=y.root,w=y.rootContainer,O.getElementById(g)||((j=document.createElement("style")).id=g,j.innerText=void 0===c.defaultStyle||!0===c.defaultStyle?o1.toString():c.defaultStyle,w.appendChild(j))),_=O1(t,c.mode),S=m1[_](t,f),"vega-lite"===_&&S.$schema&&(E=g0(S.$schema),Object(te.satisfies)(v1.vega,"^".concat(E.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(E.version,", but current version is v").concat(v1.vega,"."))),b.classList.add("vega-embed"),d&&b.classList.add("has-actions"),b.innerHTML="",C=b,d&&((A=document.createElement("div")).classList.add(g1),b.appendChild(A),C=A),(N=c.patch)&&(S=N instanceof Function?N(S):B(S,N,!0,!1).newDocument),c.formatLocale&&s1.formatLocale(c.formatLocale),c.timeFormatLocale&&s1.timeFormatLocale(c.timeFormatLocale),T=c.ast,I=s1.parse(S,"vega-lite"===_?{}:f,{ast:T}),D=new(c.viewClass||s1.View)(I,Object.assign({loader:s,logLevel:v,renderer:p},T?{expr:s1.expressionInterpreter}:{})),!1!==c.tooltip&&(F=y1(c.tooltip)?c.tooltip:new n1(!0===c.tooltip?{}:c.tooltip).call,D.tooltip(F)),void 0===(M=c.hover)&&(M="vega"===_),M&&(z=(R="boolean"===typeof M?{}:M).hoverSet,L=R.updateSet,D.hover(z,L)),c&&(null!=c.width&&D.width(c.width),null!=c.height&&D.height(c.height),null!=c.padding&&D.padding(c.padding)),l.next=33,D.initialize(C,c.bind).runAsync();case 33:if(!1!==d){if(W=b,!1!==c.defaultStyle&&((U=document.createElement("details")).title=h.CLICK_TO_VIEW_ACTIONS,b.append(U),W=U,(V=document.createElement("summary")).innerHTML=b1,U.append(V),P=function(e){U.contains(e.target)||U.removeAttribute("open")},document.addEventListener("click",P)),q=document.createElement("div"),W.append(q),q.classList.add("vega-actions"),!0===d||!1!==d.export)for(H=function(){var e=K[G];if(!0===d||!0===d.export||d.export[e]){var t=h["".concat(e.toUpperCase(),"_ACTION")],n=document.createElement("a");n.text=t,n.href="#",n.target="_blank",n.download="".concat(m,".").concat(e),n.addEventListener("mousedown",(function(t){return r1(this,void 0,void 0,k.a.mark((function n(){var r;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.preventDefault(),n.next=3,D.toImageURL(e,c.scaleFactor);case 3:r=n.sent,this.href=r;case 5:case"end":return n.stop()}}),n,this)})))})),q.append(n)}},G=0,K=["svg","png"];G<K.length;G++)H();!0!==d&&!1===d.source||((X=document.createElement("a")).text=h.SOURCE_ACTION,X.href="#",X.addEventListener("click",(function(e){var n,r;x1(ee()(t),null!==(n=c.sourceHeader)&&void 0!==n?n:"",null!==(r=c.sourceFooter)&&void 0!==r?r:"",_),e.preventDefault()})),q.append(X)),"vega-lite"!==_||!0!==d&&!1===d.compiled||((Y=document.createElement("a")).text=h.COMPILED_ACTION,Y.href="#",Y.addEventListener("click",(function(e){var t,n;x1(ee()(S),null!==(t=c.sourceHeader)&&void 0!==t?t:"",null!==(n=c.sourceFooter)&&void 0!==n?n:"","vega"),e.preventDefault()})),q.append(Y)),!0!==d&&!1===d.editor||($=null!==(u=c.editorUrl)&&void 0!==u?u:"https://vega.github.io/editor/",(J=document.createElement("a")).text=h.EDITOR_ACTION,J.href="#",J.addEventListener("click",(function(e){a1(window,$,{config:f,mode:_,renderer:p,spec:ee()(t)}),e.preventDefault()})),q.append(J))}return l.abrupt("return",{view:D,spec:t,vgSpec:S,finalize:Q});case 35:case"end":return l.stop()}}),l)})))}t.default=function(e,t){var n,r,a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r1(this,void 0,void 0,k.a.mark((function o(){var u,c,s,l,f,d;return k.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!Object(ne.J)(t)){o.next=9;break}return c=k1(i.loader),o.t0=JSON,o.next=5,c.load(t);case 5:o.t1=o.sent,u=o.t0.parse.call(o.t0,o.t1),o.next=10;break;case 9:u=t;case 10:return s=w1(u).loader,c&&!s||(c=k1(null!==(n=i.loader)&&void 0!==n?n:s)),o.next=14,j1(w1(u),c);case 14:return l=o.sent,o.next=17,j1(i,c);case 17:return f=o.sent,d=Object.assign(Object.assign({},u1(f,l)),{config:Object(ne.P)(null!==(r=f.config)&&void 0!==r?r:{},null!==(a=l.config)&&void 0!==a?a:{})}),o.next=21,S1(e,u,d,c);case 21:return o.abrupt("return",o.sent);case 22:case"end":return o.stop()}}),o)})))}},function(e,t,n){"use strict";n.r(t),n.d(t,"validateUpdateShape",(function(){return i})),n.d(t,"validateInput",(function(){return o})),n.d(t,"calculateShapes",(function(){return u}));var r=n(13),a=n(19);function i(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var u=0;u<n.rank-a;++u)if(n.shape[u+a]!==e[u+r])throw new Error(i+" updates.shape[".concat(u+a,"] (").concat(n.shape[u+a],") != shape[").concat(u+a,"] (").concat(e[u+a],")"))}function o(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}i(n,t,e)}function u(e,t,n){for(var i=t.shape.length,o=i>1?t.shape[i-1]:1,u=n.length,c=1,s=o;s<u;++s)c*=n[s];var l=o<1?1:o;return{sliceRank:o,numUpdates:Object(a.O)(t.shape)/l,sliceSize:c,strides:[].concat(Object(r.a)(Object(a.j)(n.slice(0,o))),[1]),outputSize:Object(a.O)(n)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"assertParamsValid",(function(){return i})),n.d(t,"maskToAxes",(function(){return o})),n.d(t,"computeOutShape",(function(){return u})),n.d(t,"stridesWithElidedDims",(function(){return c})),n.d(t,"getNormalizedAxes",(function(){return f})),n.d(t,"startIndicesWithElidedDims",(function(){return d})),n.d(t,"stopIndicesWithElidedDims",(function(){return h})),n.d(t,"stridesForAxis",(function(){return p})),n.d(t,"startForAxis",(function(){return v})),n.d(t,"stopForAxis",(function(){return m})),n.d(t,"isSliceContinous",(function(){return b})),n.d(t,"computeFlatOffset",(function(){return g})),n.d(t,"parseSliceParams",(function(){return y})),n.d(t,"sliceInfo",(function(){return x}));var r=n(13),a=n(19);function i(e,t,n){var r=e.shape.length;a.b(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),a.b(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var i=function(i){a.b(t[i]+n[i]<=e.shape[i],(function(){return"Error in slice".concat(r,"D: begin[").concat(i,"] + size[").concat(i,"] ")+"(".concat(t[i]+n[i],") would overflow input.shape[").concat(i,"] (").concat(e.shape[i],")")}))},o=0;o<r;++o)i(o)}function o(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function u(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function c(e,t,n,a){for(var i=Object(r.a)(e),o=i.length;o<a.length;o++)i.push(1);for(var u=0;u<n;u++)0===u?i[t]=1:(i.splice(t,0,1),i.pop());return i}function s(e,t,n){return n<=e?n:n-(t-1)}function l(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function f(e,t,n,r,a,i,o,u,s){var l=e.length,f=new Array(l),b=new Array(l),g=new Array(l);if(t.length&&n>0){var y=t[0],x=n+1;f=d(o,y,x,r,e),b=h(u,y,x,a,e),g=c(i,y,x,e)}else for(var O=0;O<l;O++)f[O]=v(o,r,i,e,O,s),b[O]=m(u,a,i,e,O,s),g[O]=p(i,O,s);return{begin:f,end:b,strides:g}}function d(e,t,n,a,i){for(var o=Object(r.a)(i),u=l(n,t),c=0;c<o.length;c++)if(u.indexOf(c)>-1)o[c]=0;else{var f=s(t,n,c),d=a[f];e&1<<f&&(d=0),o[c]=d}return o}function h(e,t,n,i,o){for(var u=Object(r.a)(o),c=l(n,t),f=0;f<u.length;f++)if(c.indexOf(f)>-1)u[f]=Number.MAX_SAFE_INTEGER;else{var d=s(t,n,f),h=i[d];e&1<<d&&(h=Number.MAX_SAFE_INTEGER),u[f]=h}for(var p=0;p<u.length;p++){var v=o[p];u[p]<0&&(u[p]+=v),u[p]=a.i(0,u[p],o[p])}return u}function p(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function v(e,t,n,r,i,o){var u=t[i],c=n[i]||1;(e&1<<i||o&1<<i||null==u)&&(u=c>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return u<0&&(u+=s),u=a.i(0,u,s-1)}function m(e,t,n,r,i,o){var u=t[i],c=n[i]||1;(e&1<<i||o&1<<i||null==u)&&(u=c>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return u<0&&(u+=s),u=c>0?a.i(0,u,s):a.i(-1,u,s-1)}function b(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function g(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function y(e,t,n){var i,o,u=e.shape.length;return(i="number"===typeof t?[t].concat(Object(r.a)(new Array(u-1).fill(0))):t.length<u?t.concat(new Array(u-t.length).fill(0)):t.slice()).forEach((function(e){a.b(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),o=(o=null==n?new Array(u).fill(-1):"number"===typeof n?[n].concat(Object(r.a)(new Array(u-1).fill(-1))):n.length<u?n.concat(new Array(u-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(a.b(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-i[n])})),[i,o]}function x(e,t,n,r,a,i,c,s,l){var d=t.slice(),h=n.slice(),p=r;null==r&&(p=new Array(d.length));var v=o(c);if(v.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==c&&0!==s)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==c&&0!==l)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var m=e.length-d.length,b=o(s),g=e.slice();b.forEach((function(e){d[e]=0,h[e]=1,g.splice(e,0,1)}));var y=f(g,v,m,d,h,p,a,i,c),x=y.begin,O=y.end,k=y.strides;d=x,h=O,p=k;var w=o(l);w.forEach((function(e){h[e]=d[e]+1,p[e]=1}));var j=u(d,h,p),_=j.filter((function(e,t){return-1===w.indexOf(t)}));return{nonStrided:p.every((function(e){return 1===e})),$begin:d,$end:h,$strides:p,size:j,newShape:g,outShape:_}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(11);var s=Object(c.b)({floorDiv_:function(e,t){var n=Object(u.a)(e,"a","floorDiv"),c=Object(u.a)(t,"b","floorDiv"),s=Object(o.makeTypesMatch)(n,c),l=Object(r.a)(s,2),f={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.hb,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12),a=n(7);function i(e,t,n){var i={shape:e,value:t,dtype:n};return r.a.runKernel(a.eb,{},i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(24),c=n(42),s=n(11),l=n(18);var f=Object(s.b)({avgPool_:function(e,t,n,s,f){var d=Object(i.a)(e,"x","avgPool","float32");o.b(c.h(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var h=d,p=!1;3===d.rank&&(p=!0,h=Object(l.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.b(4===h.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(h.rank,".")})),null!=f&&o.b(o.v(s),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(s,".")}));var v={x:h},m={filterSize:t,strides:n,pad:s,dimRoundingMode:f},b=r.a.runKernel(a.o,v,m);return b=Object(u.a)(b,d.dtype),p?Object(l.a)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({cos_:function(e){var t={x:Object(i.a)(e,"x","cos")};return r.a.runKernel(a.I,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Object(i.a)(e,"x","cumsum"),c={x:u},s={axis:t,exclusive:n,reverse:o};return r.a.runKernel(a.L,c,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({elu_:function(e){var t={x:Object(i.a)(e,"x","elu")};return r.a.runKernel(a.W,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({floor_:function(e){var t={x:Object(i.a)(e,"x","floor")};return r.a.runKernel(a.gb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({imag_:function(e){var t={input:Object(i.a)(e,"input","imag")};return r.a.runKernel(a.sb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=Object(i.a)(e,"x","leakyRelu"),o={x:n},u={alpha:t};return r.a.runKernel(a.yb,o,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(11);var l=Object(s.b)({less_:function(e,t){var n=Object(u.a)(e,"a","less"),s=Object(u.a)(t,"b","less"),l=Object(o.makeTypesMatch)(n,s),f=Object(r.a)(l,2);n=f[0],s=f[1],Object(c.a)(n.shape,s.shape);var d={a:n,b:s};return a.a.runKernel(i.zb,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(6),a=n(19),i=n(26),o=n(51),u=n(53),c=n(83),s=n(78),l=n(11),f=n(18),d=n(27),h=n(31);var p=Object(l.b)({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=Object(r.a)(e,"x","logSumExp"),p=Object(a.I)(t,l.shape),v=Object(s.a)(l,p,!0),m=Object(d.a)(l,v),b=Object(u.a)(m),g=Object(h.a)(b,p),y=Object(c.a)(g),x=Object(i.a)(Object(f.a)(v,y.shape),y);if(n){var O=Object(o.e)(x.shape,p);return Object(f.a)(x,O)}return x}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(30),u=n(11);var c=Object(u.b)({logicalOr_:function(e,t){var n=Object(i.a)(e,"a","logicalOr","bool"),u=Object(i.a)(t,"b","logicalOr","bool");Object(o.a)(n.shape,u.shape);var c={a:n,b:u};return r.a.runKernel(a.Hb,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(42),c=n(11),s=n(18);var l=Object(c.b)({maxPool_:function(e,t,n,c,l){var f=Object(i.a)(e,"x","maxPool"),d=f,h=!1;3===f.rank&&(h=!0,d=Object(s.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.b(4===d.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(d.rank,".")})),o.b(u.h(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),null!=l&&o.b(o.v(c),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(c,".")}));var p={x:d},v={filterSize:t,strides:n,pad:c,dimRoundingMode:l},m=r.a.runKernel(a.Jb,p,v);return h?Object(s.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(24),l=n(11);var f=Object(l.b)({minimum_:function(e,t){var n=Object(u.a)(e,"a","minimum"),l=Object(u.a)(t,"b","minimum"),f=Object(o.makeTypesMatch)(n,l),d=Object(r.a)(f,2);n=d[0],l=d[1],"bool"===n.dtype&&(n=Object(s.a)(n,"int32"),l=Object(s.a)(l,"int32")),Object(c.a)(n.shape,l.shape);var h={a:n,b:l};return a.a.runKernel(i.Rb,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(11);var l=Object(s.b)({notEqual_:function(e,t){var n=Object(u.a)(e,"a","notEqual"),s=Object(u.a)(t,"b","notEqual"),l=Object(o.makeTypesMatch)(n,s),f=Object(r.a)(l,2);n=f[0],s=f[1],Object(c.a)(n.shape,s.shape);var d={a:n,b:s};return a.a.runKernel(i.ac,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({prelu_:function(e,t){var n={x:Object(i.a)(e,"x","prelu"),alpha:Object(i.a)(t,"alpha","prelu")};return r.a.runKernel(a.hc,n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({relu6_:function(e){var t={x:Object(i.a)(e,"x","relu6")};return r.a.runKernel(a.oc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(19),o=n(11);var u=Object(o.b)({fft_:function(e){Object(i.b)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.a.runKernel(a.db,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(19),a=n(67),i=n(45),o=n(140),u=n(11),c=n(119),s=n(18),l=n(40),f=n(84),d=n(88),h=n(32),p=n(150);var v=Object(u.b)({rfft_:function(e,t){Object(r.b)("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,u=e.shape[e.shape.length-1],v=e.size/u;if(null!=t&&t<u){var m=e.shape.map((function(e){return 0})),b=e.shape.map((function(e){return e}));b[e.shape.length-1]=t,n=Object(l.a)(e,m,b),u=t}else if(null!=t&&t>u){var g=e.shape.map((function(e){return e}));g[e.shape.length-1]=t-u,n=Object(i.a)([e,Object(d.a)(g)],e.shape.length-1),u=t}else n=e;var y=Object(h.a)(n),x=Object(s.a)(Object(a.a)(n,y),[v,u]),O=Object(p.a)(x),k=Math.floor(u/2)+1,w=Object(c.a)(O),j=Object(o.a)(O),_=Object(f.a)(w,[k,u-k],w.shape.length-1),S=Object(f.a)(j,[k,u-k],j.shape.length-1),E=n.shape.slice();return E[n.shape.length-1]=k,Object(s.a)(Object(a.a)(_[0],S[0]),E)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(30),s=n(11);var l=Object(s.b)({squaredDifference_:function(e,t){var n=Object(u.a)(e,"a","squaredDifference"),s=Object(u.a)(t,"b","squaredDifference"),l=Object(o.makeTypesMatch)(n,s),f=Object(r.a)(l,2);n=f[0],s=f[1],Object(c.a)(n.shape,s.shape);var d={a:n,b:s};return a.a.runKernel(i.Oc,d,{})}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({unsortedSegmentSum_:function(e,t,n){var u=Object(i.a)(e,"x","unsortedSegmentSum"),c=Object(i.a)(t,"segmentIds","unsortedSegmentSum","int32");Object(o.b)(Object(o.v)(n),(function(){return"numSegments must be of dtype int"}));var s={x:u,segmentIds:c},l={numSegments:n};return r.a.runKernel(a.bd,s,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(6),a=n(19),i=n(54),o=n(51),u=n(78),c=n(117),s=n(11),l=n(63),f=n(18),d=n(29),h=n(50),p=n(37),v=n(31);function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return Object(i.a)(e);if(1!==e.rank&&null===n)return m(Object(f.a)(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Object(v.a)(Object(i.a)(e),n);if(t===1/0)return Object(u.a)(Object(i.a)(e),n);if(t===-1/0)return Object(c.a)(Object(i.a)(e),n);if("euclidean"===t||2===t)return Object(h.a)(Object(v.a)(Object(l.a)(Object(i.a)(e),Object(d.a)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return Object(u.a)(Object(v.a)(Object(i.a)(e),n[0]),n[1]-1);if(t===1/0)return Object(u.a)(Object(v.a)(Object(i.a)(e),n[1]),n[0]);if(t===-1/0)return Object(c.a)(Object(v.a)(Object(i.a)(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return Object(h.a)(Object(v.a)(Object(p.a)(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var b=Object(s.b)({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=m(e=Object(r.a)(e,"x","norm"),t,n),c=u.shape;if(i){var s=Object(a.I)(n,e.shape);c=o.e(u.shape,s)}return Object(f.a)(u,c)}})},function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(19),o=n(11),u=n(18);var c=Object(o.b)({conv2DBackpropInput_:function(e,t,n,o,c){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",l=arguments.length>6?arguments[6]:void 0;i.b(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var f=e,d=t,h=!1;3===t.rank&&(h=!0,d=Object(u.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),f=[1,e[0],e[1],e[2]]),i.b(4===f.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(f.length,".")})),i.b(4===d.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(d.rank)})),i.b(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var p="NHWC"===s?f[3]:f[1],v="NHWC"===s?d.shape[3]:d.shape[1];i.b(p===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(p,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),i.b(v===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(v,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=l&&i.b(i.v(c),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(c,".")}));var m={dy:d,filter:n},b={strides:o,pad:c,dataFormat:s,dimRoundingMode:l,inputShape:f},g=r.a.runKernel(a.E,m,b);return h?Object(u.a)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},function(e,t,n){"use strict";n.r(t),n.d(t,"TEST_EPSILON_FLOAT16",(function(){return u})),n.d(t,"expectArraysClose",(function(){return c})),n.d(t,"testEpsilon",(function(){return s})),n.d(t,"expectPromiseToFail",(function(){return f})),n.d(t,"expectArraysEqual",(function(){return d})),n.d(t,"expectNumbersClose",(function(){return h})),n.d(t,"expectValuesInRange",(function(){return v})),n.d(t,"expectArrayBuffersEqual",(function(){return m})),n.d(t,"encodeStrings",(function(){return b}));var r=n(12),a=n(6),i=n(19),o=n(22),u=.1;function c(e,t,n){return null==n&&(n=s()),l(e,t,(function(e,t){return p(e,t,n)}))}function s(){return 32===r.a.backend.floatPrecision()?.001:u}function l(e,t,n){var r=!0;if((Object(i.A)(e)||Object(i.A)(t))&&(r=!1),Object(i.A)(e)&&Object(i.A)(t)&&(r=!0),r){var o=e.constructor.name,u=t.constructor.name;if(o!==u)throw new Error("Arrays are of different type. Actual: ".concat(o,". ")+"Expected: ".concat(u))}if(Array.isArray(e)&&Array.isArray(t)){var c=Object(a.c)(e),s=Object(a.c)(t);if(!Object(i.a)(c,s))throw new Error("Arrays have different shapes. "+"Actual: [".concat(c,"]. Expected: [").concat(s,"]"))}var l=Object(i.A)(e)?e:Object(i.m)(e),f=Object(i.A)(t)?t:Object(i.m)(t);if(l.length!==f.length)throw new Error("Arrays have different lengths actual: ".concat(l.length," vs ")+"expected: ".concat(f.length,".\n")+"Actual:   ".concat(l,".\n")+"Expected: ".concat(f,"."));for(var d=0;d<f.length;++d){var h=l[d],p=f[d];if(!n(h,p))throw new Error("Arrays differ: actual[".concat(d,"] = ").concat(h,", expected[").concat(d,"] = ").concat(p,".\n")+"Actual:   ".concat(l,".\n")+"Expected: ".concat(f,"."))}}function f(e,t){e().then((function(){return t.fail()}),(function(){return t()}))}function d(e,t){var n="string"===typeof t||"number"===typeof t||"boolean"===typeof t?[t]:t;return Object(i.z)(e)||Object(i.z)(e[0])||Object(i.z)(t)||Object(i.z)(t[0])?l(e,n,(function(e,t){return e==t})):l(e,t,(function(e,t){return p(e,t,0)}))}function h(e,t,n){if(null==n&&(n=s()),!p(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t))}function p(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function v(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:".concat(e[r]," low: ").concat(t,", high: ").concat(n))}function m(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}function b(e){for(var t=0;t<e.length;t++){var n=e[t];Array.isArray(n)?b(n):e[t]=Object(o.encodeString)(n)}return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(217),a=n(216),i=n(110),o=n(218);function u(e){return Object(r.a)(e)||Object(a.a)(e)||Object(i.a)(e)||Object(o.a)()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(19),o=n(11),u=n(18);var c=Object(o.b)({conv2DBackpropFilter_:function(e,t,n,o,c){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",l=arguments.length>6?arguments[6]:void 0,f=e;3===e.rank&&(f=Object(u.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var d=t;3===d.rank&&(d=Object(u.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),i.b(4===f.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(f.shape,".")})),i.b(4===d.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(d.shape,".")})),i.b(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var h="NHWC"===s?f.shape[3]:f.shape[1],p="NHWC"===s?d.shape[3]:d.shape[1];i.b(h===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(h,") must ")+"match input depth in filter (".concat(n[2],".")})),i.b(p===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(p,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=l&&i.b(i.v(c),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(c,".")}));var v={x:f,dy:d},m={strides:o,pad:c,dataFormat:s,dimRoundingMode:l,filterShape:n};return r.a.runKernel(a.D,v,m)}})},function(e,t){var n,r,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"===typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&h())}function h(){if(!l){var e=u(d);l=!0;for(var t=s.length;t;){for(c=s,s=[];++f<t;)c&&c[f].run();f=-1,t=s.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new p(e,t)),1!==s.length||l||u(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=v,a.addListener=v,a.once=v,a.off=v,a.removeListener=v,a.removeAllListeners=v,a.emit=v,a.prependListener=v,a.prependOnceListener=v,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,n){"use strict";(function(e){n(12);var t=n(182),r=n(34),a=Object(r.c)();a.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),a.registerFlag("IS_BROWSER",(function(){return t.isBrowser()})),a.registerFlag("IS_NODE",(function(){return"undefined"!==typeof e&&"undefined"!==typeof e.versions&&"undefined"!==typeof e.versions.node})),a.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),a.registerFlag("PROD",(function(){return!1})),a.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return a.getBool("DEBUG")})),a.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),a.registerFlag("IS_TEST",(function(){return!1})),a.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),a.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1}))}).call(this,n(160))},function(e,t,n){"use strict";(function(e){var r=n(334),a=n(335),i=n(336);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return s(this,e,t,n)}function s(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=d(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),a=(e=u(e,r)).write(t,n);a!==r&&(e=e.slice(0,a));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|h(t.length);return 0===(e=u(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(r=t.length)!==r?u(e,0):d(e,t);if("Buffer"===t.type&&i(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=u(e,t<0?0:0|h(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|h(t.length);e=u(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(r)return W(e).length;t=(""+t).toLowerCase(),r=!0}}function v(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return _(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,a){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"===typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,a);if("number"===typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,a){var i,o=1,u=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,u/=2,c/=2,n/=2}function s(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var l=-1;for(i=n;i<u;i++)if(s(e,i)===s(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*o}else-1!==l&&(i-=i-l),l=-1}else for(n+c>u&&(n=u-c),i=n;i>=0;i--){for(var f=!0,d=0;d<c;d++)if(s(e,i+d)!==s(t,d)){f=!1;break}if(f)return i}return-1}function y(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i=t.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var o=0;o<r;++o){var u=parseInt(t.substr(2*o,2),16);if(isNaN(u))return o;e[n+o]=u}return o}function x(e,t,n,r){return V(W(t,e.length-n),e,n,r)}function O(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return O(e,t,n,r)}function w(e,t,n,r){return V(U(t),e,n,r)}function j(e,t,n,r){return V(function(e,t){for(var n,r,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,a=n%256,i.push(a),i.push(r);return i}(t,e.length-n),e,n,r)}function _(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var i,o,u,c,s=e[a],l=null,f=s>239?4:s>223?3:s>191?2:1;if(a+f<=n)switch(f){case 1:s<128&&(l=s);break;case 2:128===(192&(i=e[a+1]))&&(c=(31&s)<<6|63&i)>127&&(l=c);break;case 3:i=e[a+1],o=e[a+2],128===(192&i)&&128===(192&o)&&(c=(15&s)<<12|(63&i)<<6|63&o)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[a+1],o=e[a+2],u=e[a+3],128===(192&i)&&128===(192&o)&&128===(192&u)&&(c=(15&s)<<18|(63&i)<<12|(63&o)<<6|63&u)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),a+=f}return function(e){var t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=E));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return s(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?u(e,t):void 0!==n?"string"===typeof r?u(e,t).fill(n,r):u(e,t).fill(n):u(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var o=e[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,a),a+=o.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):v.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,a){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),u=Math.min(i,o),s=this.slice(r,a),l=e.slice(t,n),f=0;f<u;++f)if(s[f]!==l[f]){i=s[f],o=l[f];break}return i<o?-1:o<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return x(this,e,t,n);case"ascii":return O(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function C(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function N(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=t;i<n;++i)a+=B(e[i]);return a}function T(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function I(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,a,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function F(e,t,n,r){t<0&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-n,2);a<i;++a)e[n+a]=(t&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function M(e,t,n,r){t<0&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-n,4);a<i;++a)e[n+a]=t>>>8*(r?a:3-a)&255}function R(e,t,n,r,a,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(e,t,n,r,i){return i||R(e,0,n,4),a.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,i){return i||R(e,0,n,8),a.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var a=t-e;n=new c(a,void 0);for(var i=0;i<a;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},c.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=t,a=1,i=this[e+--r];r>0&&(a*=256);)i+=this[e+--r]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),a.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),a.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),a.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),a.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);D(this,e,t,n,a-1,-a)}var i=0,o=1,u=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);D(this,e,t,n,a-1,-a)}var i=n-1,o=1,u=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return z(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return z(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a,i=r-n;if(this===e&&n<t&&t<r)for(a=i-1;a>=0;--a)e[a+t]=this[a+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{var o=c.isBuffer(e)?e:W(new c(e,r).toString()),u=o.length;for(i=0;i<n-t;++i)this[i+t]=o[i%u]}return this};var P=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function W(e,t){var n;t=t||1/0;for(var r=e.length,a=null,i=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function U(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(P,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function V(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}}).call(this,n(172))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compose=t.merge=t.$=t.style=t.presets=t.keyframes=t.fontFace=t.insertGlobal=t.insertRule=t.plugins=t.styleSheet=void 0,t.speedy=function(e){return f.speedy(e)},t.simulations=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];v=!!e},t.simulate=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(t=(0,o.default)(t)))return{};if(!v)return m||(console.warn("can't simulate without once calling simulations(true)"),m=!0),b||(console.warn("don't use simulation outside dev"),b=!0),{};return t.reduce((function(e,t){return e["data-simulate-"+y(t)]="",e}),{})},t.cssLabels=function(e){g=!!e},t.isLikeRule=O,t.idFor=k,t.css=q,t.rehydrate=function(e){(0,r.default)(A,e.reduce((function(e,t){return e[t]=!0,e}),{}))},t.flush=function(){A=f.inserted={},N=f.registered={},I={},f.flush(),f.inject()},t.select=G,t.parent=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return q(l({},e+" &",n))},t.media=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return q(l({},"@media "+e,n))},t.pseudo=K,t.active=function(e){return K(":active",e)},t.any=function(e){return K(":any",e)},t.checked=function(e){return K(":checked",e)},t.disabled=function(e){return K(":disabled",e)},t.empty=function(e){return K(":empty",e)},t.enabled=function(e){return K(":enabled",e)},t._default=function(e){return K(":default",e)},t.first=function(e){return K(":first",e)},t.firstChild=function(e){return K(":first-child",e)},t.firstOfType=function(e){return K(":first-of-type",e)},t.fullscreen=function(e){return K(":fullscreen",e)},t.focus=function(e){return K(":focus",e)},t.hover=function(e){return K(":hover",e)},t.indeterminate=function(e){return K(":indeterminate",e)},t.inRange=function(e){return K(":in-range",e)},t.invalid=function(e){return K(":invalid",e)},t.lastChild=function(e){return K(":last-child",e)},t.lastOfType=function(e){return K(":last-of-type",e)},t.left=function(e){return K(":left",e)},t.link=function(e){return K(":link",e)},t.onlyChild=function(e){return K(":only-child",e)},t.onlyOfType=function(e){return K(":only-of-type",e)},t.optional=function(e){return K(":optional",e)},t.outOfRange=function(e){return K(":out-of-range",e)},t.readOnly=function(e){return K(":read-only",e)},t.readWrite=function(e){return K(":read-write",e)},t.required=function(e){return K(":required",e)},t.right=function(e){return K(":right",e)},t.root=function(e){return K(":root",e)},t.scope=function(e){return K(":scope",e)},t.target=function(e){return K(":target",e)},t.valid=function(e){return K(":valid",e)},t.visited=function(e){return K(":visited",e)},t.dir=function(e,t){return K(":dir("+e+")",t)},t.lang=function(e,t){return K(":lang("+e+")",t)},t.not=function(e,t){var n=e.split(",").map((function(e){return e.trim()})).map((function(e){return":not("+e+")"}));if(1===n.length)return K(":not("+e+")",t);return G(n.join(""),t)},t.nthChild=function(e,t){return K(":nth-child("+e+")",t)},t.nthLastChild=function(e,t){return K(":nth-last-child("+e+")",t)},t.nthLastOfType=function(e,t){return K(":nth-last-of-type("+e+")",t)},t.nthOfType=function(e,t){return K(":nth-of-type("+e+")",t)},t.after=function(e){return K("::after",e)},t.before=function(e){return K("::before",e)},t.firstLetter=function(e){return K("::first-letter",e)},t.firstLine=function(e){return K("::first-line",e)},t.selection=function(e){return K("::selection",e)},t.backdrop=function(e){return K("::backdrop",e)},t.placeholder=function(e){return q({"::placeholder":e})},t.cssFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,o.default)(t))?t.map((function(e){var t={label:[]};return L(t,{src:e}),C(x(t),E(t)).join("")})).join(""):""},t.attribsFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=(t=(0,o.default)(t))?t.map((function(e){k(e);var t=Object.keys(e)[0];return t+'="'+(e[t]||"")+'"'})).join(" "):"";return r};var r=s(n(124)),a=n(385),i=n(292),o=s(n(394)),u=n(395),c=s(n(412));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=t.styleSheet=new a.StyleSheet;f.inject();var d=t.plugins=f.plugins=new u.PluginSet([u.prefixes,u.contentWrap,u.fallbacks]);d.media=new u.PluginSet,d.fontFace=new u.PluginSet,d.keyframes=new u.PluginSet([u.prefixes,u.fallbacks]);var h=!1,p="undefined"!==typeof window,v=h,m=!1,b=!1;var g=h;function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function x(e){var t=JSON.stringify(e),n=(0,c.default)(t).toString(36);return e.label&&e.label.length,n}function O(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));return 1===t.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function k(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));if(1!==t.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0]);if(!n)throw new Error("not a rule");return n[1]}var w=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function j(e){if(-1===e.indexOf(","))return[e];for(var t,n=[],r=[],a=0;t=w.exec(e);)switch(t[0]){case"(":a++;break;case")":a--;break;case",":if(a)break;n.push(t.index)}for(t=n.length;t--;)r.unshift(e.slice(n[t]+1)),e=e.slice(0,n[t]);return r.unshift(e),r}function _(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=j(t).map((function(t){return t.indexOf("&")>=0?[t.replace(/\&/gm,".css-"+e),t.replace(/\&/gm,"[data-css-"+e+"]")].join(","):".css-"+e+t+",[data-css-"+e+"]"+t})).join(",");return v&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+y(t)+"],[data-css-"+e+"][data-simulate-"+y(t)+"]"),n}function S(e){var t=e.selector,n=e.style,r=d.transform({selector:t,style:n});return r.selector+"{"+(0,i.createMarkupForStyles)(r.style)+"}"}function E(e){var t=void 0,n=void 0,r=void 0,a=void 0;return Object.keys(e).forEach((function(i){i.indexOf("&")>=0?(n=n||{})[i]=e[i]:0===i.indexOf("@media")?(r=r||{})[i]=E(e[i]):0===i.indexOf("@supports")?(a=a||{})[i]=E(e[i]):"label"===i?e.label.length>0&&((t=t||{}).label=g?e.label.join("."):""):(t=t||{})[i]=e[i]})),{plain:t,selects:n,medias:r,supports:a}}function C(e,t){var n=[],r=t.plain,a=t.selects,i=t.medias,o=t.supports;return r&&n.push(S({style:r,selector:_(e)})),a&&Object.keys(a).forEach((function(t){return n.push(S({style:a[t],selector:_(e,t)}))})),i&&Object.keys(i).forEach((function(t){return n.push(t+"{"+C(e,i[t]).join("")+"}")})),o&&Object.keys(o).forEach((function(t){return n.push(t+"{"+C(e,o[t]).join("")+"}")})),n}var A=f.inserted={};var N=f.registered={};function T(e){N[e.id]||(N[e.id]=e)}var I={};function D(e){if(T(e),function(e){if(!A[e.id]){A[e.id]=!0;var t=E(e.style),n=C(e.id,t);A[e.id]=!!p||n,n.forEach((function(e){return f.insert(e)}))}}(e),I[e.id])return I[e.id];var t=l({},"data-css-"+e.id,g&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),I[e.id]=t,t}function F(e,t){var n=j(e).map((function(e){return e.indexOf("&")>=0?e:"&"+e}));return j(t).map((function(e){return e.indexOf("&")>=0?e:"&"+e})).reduce((function(e,t){return e.concat(n.map((function(e){return t.replace(/\&/g,e)})))}),[]).join(",")}function M(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function R(e){for(var t=[],n=0;n<e.length;n++)t=Array.isArray(e[n])?t.concat(R(e[n])):t.concat(e[n]);return t}var z={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function L(e,t){var n=t.selector,r=void 0===n?"":n,a=t.mq,i=void 0===a?"":a,u=t.supp,c=void 0===u?"":u,s=t.src,l=void 0===s?{}:s;Array.isArray(l)||(l=[l]),(l=R(l)).forEach((function(t){if(O(t)){var n=function(e){if(O(e)){var t=N[k(e)];if(null==t)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}(t);if("css"!==n.type)throw new Error("cannot merge this rule");t=n.style}(t=(0,o.default)(t))&&t.composes&&L(e,{selector:r,mq:i,supp:c,src:t.composes}),Object.keys(t||{}).forEach((function(n){if(function(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),a=0;a<t.length;a++)if(r===t[a]){n=!0;break}return n||e.indexOf("&")>=0}(n))z[n]&&z[n].forEach((function(a){return L(e,{selector:F(r,a),mq:i,supp:c,src:t[n]})})),L(e,{selector:F(r,n),mq:i,supp:c,src:t[n]});else if(function(e){return 0===e.indexOf("@media")}(n))L(e,{selector:r,mq:(o=i,u=n,o?"@media "+o.substring(6)+" and "+u.substring(6):u),supp:c,src:t[n]});else if(function(e){return 0===e.indexOf("@supports")}(n))L(e,{selector:r,mq:i,supp:M(c,n),src:t[n]});else if("composes"===n);else{var a=e;c&&(a[c]=a[c]||{},a=a[c]),i&&(a[i]=a[i]||{},a=a[i]),r&&(a[r]=a[r]||{},a=a[r]),"label"===n?g&&(e.label=e.label.concat(t.label)):a[n]=t[n]}var o,u}))}))}function P(e){var t={label:[]};return L(t,{src:e}),D({id:x(t),style:t,label:g?t.label.join("."):"",type:"css"})}var B={};Object.defineProperty(B,"toString",{enumerable:!1,value:function(){return"css-nil"}});var W="undefined"!==typeof WeakMap?[B,new WeakMap,new WeakMap,new WeakMap]:[B];var U,V="undefined"!==typeof WeakMap?(U=P,function(e){if(W[e.length]){for(var t=W[e.length],n=0;n<e.length-1;)t.has(e[n])||t.set(e[n],new WeakMap),t=t.get(e[n]),n++;if(t.has(e[e.length-1])){var r=t.get(e[n]);if(N[r.toString().substring(4)])return r}}var a=U(e);if(W[e.length]){for(var i=0,o=W[e.length];i<e.length-1;)o=o.get(e[i]),i++;try{o.set(e[i],a)}catch(u){}}return a}):P;function q(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(t=(0,o.default)(t))?V(t):B}q.insert=function(e){var t={id:x(e),css:e,type:"raw"};T(t),A[t.id]||(f.insert(t.css),A[t.id]=!!p||[t.css])};t.insertRule=q.insert;q.global=function(e,t){if(t=(0,o.default)(t))return q.insert(S({selector:e,style:t}))};t.insertGlobal=q.global;q.keyframes=function(e,t){t||(t=e,e="animation");var n={id:x({name:e,kfs:t=(0,o.default)(t)||{}}),type:"keyframes",name:e,keyframes:t};return T(n),function(e){if(!A[e.id]){var t=Object.keys(e.keyframes).map((function(t){var n=d.keyframes.transform({id:e.id,name:t,style:e.keyframes[t]});return n.name+"{"+(0,i.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+e.name+"_"+e.id+"{"+t+"}"}));n.forEach((function(e){return f.insert(e)})),A[e.id]=!!p||n}}(n),e+"_"+n.id},q.fontFace=function(e){var t={id:x(e=(0,o.default)(e)),type:"font-face",font:e};return T(t),function(e){if(!A[e.id]){var t="@font-face{"+(0,i.createMarkupForStyles)(e.font)+"}";f.insert(t),A[e.id]=!!p||[t]}}(t),e.fontFamily};t.fontFace=q.fontFace,t.keyframes=q.keyframes;t.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var H=t.style=q;function G(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?q(l({},e,n)):H(n)}t.$=G;t.merge=q,t.compose=q;function K(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return q(l({},e,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"===typeof e&&r.test(e)};var r=/-webkit-|-moz-|-ms-/;e.exports=t.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(3),a=n(10),i=function(){function e(t,n){Object(r.a)(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return Object(a.a)(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),o=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,[{key:"refCount",value:function(e){return u("refCount")}},{key:"incRef",value:function(e){return u("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return u("time")}},{key:"read",value:function(e){return u("read")}},{key:"readSync",value:function(e){return u("readSync")}},{key:"numDataIds",value:function(){return u("numDataIds")}},{key:"disposeData",value:function(e,t){return u("disposeData")}},{key:"write",value:function(e,t,n){return u("write")}},{key:"move",value:function(e,t,n,r,a){return u("move")}},{key:"memory",value:function(){return u("memory")}},{key:"floatPrecision",value:function(){return u("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return u("dispose")}}]),e}();function u(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({tanh_:function(e){var t={x:Object(i.a)(e,"x","tanh")};return r.a.runKernel(a.Uc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12),a=n(7);function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var o={start:e,stop:t,step:n,dtype:i};return r.a.runKernel(a.jc,{},o)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=1.7580993408473768,a=1.0507009873554805},function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},function(e,t){var n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t,n){(function(t){var n="object"===typeof t&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).NODE_DEBUG&&/\bsemver\b/i.test(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).NODE_DEBUG)?function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).error.apply(e,["SEMVER"].concat(n))}:function(){};e.exports=n}).call(this,n(160))},function(e,t){var n=["includePrerelease","loose","rtl"];e.exports=function(e){return e?"object"!==typeof e?{loose:!0}:n.filter((function(t){return e[t]})).reduce((function(e,t){return e[t]=!0,e}),{}):{}}},function(e,t,n){var r=n(80);e.exports=function(e,t,n){return r(e,t,n)>0}},function(e,t,n){var r=n(98),a=n(99),i=Symbol("SemVer ANY"),o=function(){"use strict";function e(t,n){if(r(this,e),n=u(n),t instanceof e){if(t.loose===!!n.loose)return t;t=t.value}d("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===i?this.value="":this.value=this.operator+this.semver.version,d("comp",this)}return a(e,[{key:"parse",value:function(e){var t=this.options.loose?s[l.COMPARATORLOOSE]:s[l.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: ".concat(e));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new h(n[2],this.options.loose):this.semver=i}},{key:"toString",value:function(){return this.value}},{key:"test",value:function(e){if(d("Comparator.test",e,this.options.loose),this.semver===i||e===i)return!0;if("string"===typeof e)try{e=new h(e,this.options)}catch(t){return!1}return f(e,this.operator,this.semver,this.options)}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Comparator is required");if(n&&"object"===typeof n||(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new p(t.value,n).test(this.value);if(""===t.operator)return""===t.value||new p(this.value,n).test(t.semver);var r=(">="===this.operator||">"===this.operator)&&(">="===t.operator||">"===t.operator),a=("<="===this.operator||"<"===this.operator)&&("<="===t.operator||"<"===t.operator),i=this.semver.version===t.semver.version,o=(">="===this.operator||"<="===this.operator)&&(">="===t.operator||"<="===t.operator),u=f(this.semver,"<",t.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),c=f(this.semver,">",t.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return r||a||i&&o||u||c}}],[{key:"ANY",get:function(){return i}}]),e}();e.exports=o;var u=n(175),c=n(127),s=c.re,l=c.t,f=n(290),d=n(174),h=n(62),p=n(81)},function(e,t,n){var r=n(81);e.exports=function(e,t,n){try{t=new r(t,n)}catch(a){return!1}return t.test(e)}},function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function a(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.assert=r,t.assertShapesMatch=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";r(a(e,t),n+" Shapes ".concat(e," and ").concat(t," must match"))},t.arraysEqual=a,t.DECIMAL_PLACES_TO_CHECK=4},function(e,t,n){"use strict";var r=n(4),a=n(242),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),u=n(179);t.arrayStats=function(e){if(!Array.isArray(e))throw new Error("input must be an array");if(0===e.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};for(var t=e.length,n=-1/0,r=1/0,a=0,i=0,o=0,u=0;u<t;u++){var c=e[u];c>n&&(n=c),c<r&&(r=c),0===c&&(a+=1),isNaN(c)?i+=1:isFinite(c)||(o+=1)}var s={numVals:t,numZeros:a,numNans:i,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s},t.tensorStats=function(e){return i(this,void 0,void 0,r.mark((function t(){var n,i,u,c,s;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.tidy((function(){var t=o.scalar(0,e.dtype);return[e.min(),e.max(),e.equal(t).sum()]})),i=a(n,3),u=i[0],c=i[1],s=i[2],t.abrupt("return",Promise.all([e.data(),u.data(),c.data(),s.data()]).then((function(e){for(var t=a(e,4),n=t[0],r=t[1],i=t[2],o=t[3],u=n.length,c=0,s=0,l=0;l<u;l++){var f=n[l];isNaN(f)?c+=1:isFinite(f)||(s+=1)}var d=r[0],h=i[0];return c===u&&(d=NaN,h=NaN),{numVals:u,numZeros:o[0],numNans:c,min:d,max:h,numInfs:s}})));case 2:case"end":return t.stop()}}),t)})))},t.confusionMatrix=function(e,t,n,c){return i(this,void 0,void 0,r.mark((function i(){var s,l,f;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u.assert(1===e.rank,"labels must be a 1D tensor"),u.assert(1===t.rank,"predictions must be a 1D tensor"),u.assert(e.size===t.size,"labels and predictions must be the same length"),null!=c&&u.assert(c.size===t.size,"labels and predictions must be the same length"),s=e.cast("int32"),l=t.cast("int32"),null==n&&(n=o.tidy((function(){return o.maximum(s.max(),l.max()).cast("int32").dataSync()[0]+1}))),f=Promise.resolve(null),null!=c&&(f=c.data()),r.abrupt("return",Promise.all([s.data(),l.data(),f]).then((function(e){for(var t=a(e,3),r=t[0],i=t[1],o=t[2],u=Array(n).fill(0),c=0;c<n;c++)u[c]=Array(n).fill(0);for(var s=0;s<r.length;s++){var l=r[s],f=i[s];u[l][f]+=null!=o?o[s]:1}return u})));case 10:case"end":return r.stop()}}),i)})))},t.accuracy=function(e,t){return i(this,void 0,void 0,r.mark((function n(){var a,i,c;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u.assertShapesMatch(e.shape,t.shape,"Error computing accuracy."),a=e.equal(t),i=a.mean(),n.next=5,i.data();case 5:return c=n.sent[0],o.dispose([a,i]),n.abrupt("return",c);case 8:case"end":return n.stop()}}),n)})))},t.perClassAccuracy=function(e,t,n){return i(this,void 0,void 0,r.mark((function i(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u.assert(1===e.rank,"labels must be a 1D tensor"),u.assert(1===t.rank,"predictions must be a 1D tensor"),u.assert(e.size===t.size,"labels and predictions must be the same length"),null==n&&(n=o.tidy((function(){return o.maximum(e.max(),t.max()).dataSync()[0]+1}))),r.abrupt("return",Promise.all([e.data(),t.data()]).then((function(e){for(var t=a(e,2),r=t[0],i=t[1],o=Array(n).fill(0),u=Array(n).fill(0),c=0;c<r.length;c++){var s=r[c],l=i[c];o[s]+=1,s===l&&(u[s]+=1)}for(var f=[],d=0;d<o.length;d++)f.push({count:o[d],accuracy:0===o[d]?0:u[d]/o[d]});return f})));case 5:case"end":return r.stop()}}),i)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(86),a=n(433),i=n(163),o=n(82);t.table=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&null==t.headers)throw new Error('Data to render must have a "headers" property');if(t&&null==t.values)throw new Error('Data to render must have a "values" property');var c=o.getDrawArea(e),s=Object.assign({},u,n),l=a.select(c).select("table.tf-table"),f=i.css({fontSize:s.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===l.size()&&((l=a.select(c).append("table")).attr("class"," ".concat(f," tf-table")),l.append("thead").append("tr"),l.append("tbody")),1!==l.size())throw new Error("Error inserting table");var d=i.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),h=l.select("thead").select("tr").selectAll("th").data(t.headers),p=h.enter().append("th").attr("class","".concat(d));h.merge(p).html((function(e){return e})),h.exit().remove();var v=r.format(",.4~f"),m=l.select("tbody").selectAll("tr").data(t.values),b=m.enter().append("tr"),g=i.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),y=m.merge(b).selectAll("td").data((function(e){return e})),x=y.enter().append("td").attr("class","".concat(g));y.merge(x).html((function(e){return"number"===typeof e?v(e):e})),y.exit().remove(),m.exit().remove()};var u={fontSize:14}},function(e,t,n){"use strict";function r(e){if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;var t=e.userAgent||e.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function a(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}n.r(t),n.d(t,"isMobile",(function(){return r})),n.d(t,"isBrowser",(function(){return a}))},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","all","bool"),u={x:o},c={axis:t,keepDims:n};return r.a.runKernel(a.f,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","any","bool"),u={x:o},c={axis:t,keepDims:n};return r.a.runKernel(a.g,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","argMax"),o={x:n},u={axis:t};return r.a.runKernel(a.h,o,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","argMin"),o={x:n},u={axis:t};return r.a.runKernel(a.i,o,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(11);var s=Object(c.b)({atan2_:function(e,t){var n=Object(u.a)(e,"a","atan2"),c=Object(u.a)(t,"b","atan2"),s=Object(o.makeTypesMatch)(n,c),l=Object(r.a)(s,2),f={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.m,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(6),a=n(19),i=n(73),o=n(42),u=n(11),c=n(18);var s=Object(u.b)({conv1d_:function(e,t,n,u){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,f=arguments.length>6?arguments[6]:void 0,d=Object(r.a)(e,"x","conv1d"),h=Object(r.a)(t,"filter","conv1d"),p=d,v=!1;2===d.rank&&(v=!0,p=Object(c.a)(d,[1,d.shape[0],d.shape[1]])),a.b(3===p.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(p.rank,".")})),a.b(3===h.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(h.rank,".")})),null!=f&&a.b(a.v(u),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(u,".")})),a.b(p.shape[2]===h.shape[1],(function(){return"Error in conv1d: depth of input (".concat(p.shape[2],") must match ")+"input depth for filter ".concat(h.shape[1],".")})),a.b(o.h(n,l),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'")})),a.b("NWC"===s,(function(){return"Error in conv1d: got dataFormat of ".concat(s," but only NWC is currently supported.")}));var m=Object(c.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),b=Object(c.a)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),g=[1,n],y=[1,l],x="NHWC",O=Object(i.a)(b,m,g,u,x,y,f);return v?Object(c.a)(O,[O.shape[2],O.shape[3]]):Object(c.a)(O,[O.shape[0],O.shape[2],O.shape[3]])}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6),a=n(156),i=n(11);var o=Object(i.b)({conv2dTranspose_:function(e,t,n,i,o,u){var c=Object(r.a)(e,"x","conv2dTranspose"),s=Object(r.a)(t,"filter","conv2dTranspose");return Object(a.a)(n,c,s,i,o,"NHWC",u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({cosh_:function(e){var t={x:Object(i.a)(e,"x","cosh")};return r.a.runKernel(a.J,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",u=Object(i.a)(e,"x","depthToSpace"),c="NHWC"===n?u.shape[1]:u.shape[2],s="NHWC"===n?u.shape[2]:u.shape[3],l="NHWC"===n?u.shape[3]:u.shape[1];o.b(c*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(u.shape)})),o.b(s*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(t," for depthToSpace with input shape\n        ").concat(u.shape)})),o.b(l%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(l," for depthToSpace with input shape ").concat(u.shape)}));var f={x:u},d={blockSize:t,dataFormat:n};return r.a.runKernel(a.N,f,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11),c=n(18);var s=Object(u.b)({dilation2d_:function(e,t,n,u){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=Object(i.a)(e,"x","dilation2d"),d=Object(i.a)(t,"filter","dilation2d");o.b(3===f.rank||4===f.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(f.rank,".")})),o.b(3===d.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(d.rank,".")})),o.b("NHWC"===l,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)}));var h=f,p=!1;3===f.rank&&(h=Object(c.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]]),p=!0);var v={x:h,filter:d},m={strides:n,pad:u,dilations:s},b=r.a.runKernel(a.S,v,m);return p?Object(c.a)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(8),a=n(35),i=n(6),o=n(28),u=n(105),c=n(11),s=n(49),l=n(32);var f=Object(c.b)({divNoNan_:function(e,t){var n=Object(i.a)(e,"a","div"),c=Object(i.a)(t,"b","div"),f=Object(a.makeTypesMatch)(n,c),d=Object(r.a)(f,2);n=d[0],c=d[1];var h=Object(o.a)(n,c),p=Object(l.a)(h),v=Object(u.a)(c,p);return Object(s.a)(v,p,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(6),a=n(19),i=n(36),o=n(11),u=n(18);var c=Object(o.b)({dot_:function(e,t){var n=Object(r.a)(e,"t1","dot"),o=Object(r.a)(t,"t2","dot");a.b((1===n.rank||2===n.rank)&&(1===o.rank||2===o.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(o.rank,".")}));var c=1===n.rank?n.size:n.shape[1],s=1===o.rank?o.size:o.shape[0];if(a.b(c===s,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(c," and ").concat(s,".")})),1===n.rank&&1===o.rank){var l=Object(u.a)(n,[1,-1]),f=Object(u.a)(o,[-1,1]),d=Object(i.a)(l,f);return Object(u.a)(d,[])}if(1===n.rank&&2===o.rank){var h=Object(u.a)(n,[1,-1]),p=Object(u.a)(o,[o.shape[0],o.shape[1]]),v=Object(i.a)(h,p);return Object(u.a)(v,[v.size])}if(2===n.rank&&1===o.rank){var m=Object(u.a)(o,[-1,1]),b=Object(i.a)(n,m);return Object(u.a)(b,[b.size])}var g=Object(u.a)(o,[o.shape[0],o.shape[1]]);return Object(i.a)(n,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11),c=n(18);var s=Object(u.b)({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,l=Object(i.a)(e,"x","localResponseNormalization");o.b(4===l.rank||3===l.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,".")})),o.b(o.v(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var f=l,d=!1;3===l.rank&&(d=!0,f=Object(c.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));var h={x:f},p={depthRadius:t,bias:n,alpha:u,beta:s},v=r.a.runKernel(a.wb,h,p);return d?Object(c.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({log1p_:function(e){var t={x:Object(i.a)(e,"x","log1p")};return r.a.runKernel(a.Db,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({softplus_:function(e){var t={x:Object(i.a)(e,"x","softplus")};return r.a.runKernel(a.Hc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(6),a=n(30),i=n(68),o=n(107),u=n(144),c=n(11);var s=Object(c.b)({logicalXor_:function(e,t){var n=Object(r.a)(e,"a","logicalXor","bool"),c=Object(r.a)(t,"b","logicalXor","bool");return Object(a.a)(n.shape,c.shape),Object(i.a)(Object(u.a)(e,t),Object(o.a)(Object(i.a)(e,t)))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({mirrorPad_:function(e,t,n){o.b("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var u=Object(i.a)(e,"x","mirrorPad");if(0===u.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.b(t.length===u.rank,(function(){return"Padding doesn't match input. Must be ".concat(u.rank,". ")+"Got ".concat(t.length,".")}));for(var c="reflect"===n?1:0,s=function(e){o.b(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),o.b(t[e][0]>=0&&t[e][0]<=u.shape[e]-c&&t[e][1]>=0&&t[e][1]<=u.shape[e]-c,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(u.shape[e]-c," or less than 0 for input of ")+"shape ".concat(u.shape)}))},l=0;l<u.rank;l++)s(l);var f={paddings:t,mode:n},d={x:u};return r.a.runKernel(a.Sb,d,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(35),u=n(6),c=n(11);var s=Object(c.b)({mod_:function(e,t){var n=Object(u.a)(e,"a","mod"),c=Object(u.a)(t,"b","mod"),s=Object(o.makeTypesMatch)(n,c),l=Object(r.a)(s,2),f={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.Tb,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(8),a=n(6),i=n(19),o=n(135),u=n(103),c=n(42),s=n(145),l=n(11),f=n(18),d=n(108);var h=Object(l.b)({pool_:function(e,t,n,l,h,p){null==h&&(h=[1,1]),null==p&&(p=1),0===l&&(l="valid");var v=Object(a.a)(e,"x","maxPool"),m=v,b=!1;3===v.rank&&(b=!0,m=Object(f.a)(v,[1,v.shape[0],v.shape[1],v.shape[2]])),i.b(c.h(p,h),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(p," and dilations '").concat(h,"'")}));var g,y=c.e(m.shape,t,p,h,l),x=[y.dilationHeight,y.dilationWidth];g="same"===l?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([y.filterHeight,y.filterWidth],x):[[0,0],[0,0]];var O=1===x[0]&&1===x[1],k=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),u=a.map((function(e,t){return e+o[t]})),c=t.map((function(e,t){return[r[t],u[t]]})),s=t.map((function(e,t){return[0,o[t]]}));return[c,s]}([y.inHeight,y.inWidth],x,g),w=Object(r.a)(k,2),j=w[0],_=w[1],S=O?l:"valid",E=O?m:Object(d.a)(m,x,j),C=("avg"===n?function(){return Object(o.a)(E,t,p,S)}:function(){return Object(s.a)(E,t,p,S)})(),A=O?C:Object(u.a)(C,x,_);return b?Object(f.a)(A,[A.shape[1],A.shape[2],A.shape[3]]):A}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(24),u=n(11);var c=Object(u.b)({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=Object(i.a)(e,"x","prod");"bool"===u.dtype&&(u=Object(o.a)(u,"int32"));var c={x:u},s={axis:t,keepDims:n};return r.a.runKernel(a.ic,c,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(57),a=n(11),i=n(113);var o=Object(a.b)({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",o=arguments.length>4?arguments[4]:void 0,u=Object(r.a)(e,a),c=new i.c(t,n,null,o),s=0;s<u.values.length;s++)u.values[s]=c.nextValue();return u.toTensor()}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({rsqrt_:function(e){var t={x:Object(i.a)(e,"x","rsqrt")};return r.a.runKernel(a.xc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({selu_:function(e){var t={x:Object(i.a)(e,"x","selu")};return r.a.runKernel(a.Ac,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(6),a=n(19),i=n(73),o=n(104),u=n(11),c=n(18);var s=Object(u.b)({separableConv2d_:function(e,t,n,u,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",d=Object(r.a)(e,"x","separableConv2d"),h=Object(r.a)(t,"depthwiseFilter","separableConv2d"),p=Object(r.a)(n,"pointwiseFilter","separableConv2d"),v=d,m=!1;if(3===d.rank&&(m=!0,v=Object(c.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===f)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");a.b(4===v.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(v.rank,".")})),a.b(4===h.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(h.rank,".")})),a.b(4===p.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(h.rank,".")})),a.b(1===p.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(p.shape[0],".")})),a.b(1===p.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(p.shape[1],".")}));var b=h.shape[2],g=h.shape[3];a.b(p.shape[2]===b*g,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(b*g,", ")+"but got ".concat(p.shape[2],".")}));var y=Object(o.a)(v,h,u,s,f,l),x=1,O=Object(i.a)(y,p,x,"valid",f);return m?Object(c.a)(O,[O.shape[1],O.shape[2],O.shape[3]]):O}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({sin_:function(e){var t={x:Object(i.a)(e,"x","sin")};return r.a.runKernel(a.Dc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({sinh_:function(e){var t={x:Object(i.a)(e,"x","sinh")};return r.a.runKernel(a.Ec,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(67),a=n(45),i=n(140),o=n(20),u=n(11),c=n(119),s=n(18),l=n(58),f=n(29),d=n(40),h=n(120);var p=Object(u.b)({irfft_:function(e){var t,n=e.shape[e.shape.length-1],u=e.size/n;if(n<=2){var p=Object(s.a)(e,[u,n]);t=Object(h.a)(p)}else{var v=[u,2*(n-1)],m=Object(s.a)(Object(c.a)(e),[u,n]),b=Object(s.a)(Object(i.a)(e),[u,n]),g=Object(l.a)(Object(d.a)(m,[0,1],[u,n-2]),1),y=Object(o.a)(Object(l.a)(Object(d.a)(b,[0,1],[u,n-2]),1),Object(f.a)(-1)),x=Object(a.a)([m,g],1),O=Object(a.a)([b,y],1),k=Object(s.a)(Object(r.a)(x,O),[v[0],v[1]]);t=Object(h.a)(k)}if(t=Object(c.a)(t),3===e.rank&&0!==e.shape[0]){var w=t,j=e.shape[0];t=Object(s.a)(t,[j,t.shape[0]/j,t.shape[1]]),w.dispose()}return t}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6),a=n(19),i=n(60);function o(e,t,n){if(Object(a.d)(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var o=Object(r.c)(e,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Object(i.a)(e,t,o,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(8),a=n(12),i=n(7),o=n(6),u=n(11);var c=Object(u.b)({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=Object(o.a)(e,"x","topk");if(0===u.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var c=u.shape[u.shape.length-1];if(t>c)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(c,") ")+"but got ".concat(t));var s={x:u},l={k:t,sorted:n},f=a.a.runKernel(i.Wc,s,l),d=Object(r.a)(f,2),h=d[0],p=d[1];return{values:h,indices:p}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(8),a=n(12),i=n(7),o=n(6),u=n(19),c=n(11);var s=Object(c.b)({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.a)(e,"x","unique","string_or_numeric");Object(u.b)(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var c={x:n},s={axis:t},l=a.a.runKernel(i.Zc,c,s),f=Object(r.a)(l,2),d=f[0],h=f[1];return{values:d,indices:h}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4),a=n.n(r),i=n(17),o=n(215),u=n(6);function c(){return(c=Object(i.a)(a.a.mark((function e(t){var n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(u.a)(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,i=Object(o.a)(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var s=function(e){return c.apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(57);function a(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);for(var i=Object(r.a)(e,"int32"),o=Object(r.a)([n.length,e.length],"int32"),u=0;u<n.length;u++){var c=i.indexToLoc(n[u]),s=u*e.length;o.values.set(c,s)}return o.toTensor()}},function(e,t,n){"use strict";function r(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(19),o=n(11),u=n(18);var c=Object(o.b)({conv3DBackpropInput_:function(e,t,n,o,c){i.b(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var s=e,l=t,f=!1;4===t.rank&&(f=!0,l=Object(u.a)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);var d=s[4],h=l.shape[4];i.b(5===s.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(s.length,".")})),i.b(5===l.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(l.rank)})),i.b(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),i.b(d===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(d,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),i.b(h===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var p={dy:l,filter:n},v={pad:c,strides:o,inputShape:s},m=r.a.runKernel(a.H,p,v);return f?Object(u.a)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(158),a=n(12),i=n(7),o=n(6),u=n(19),c=n(11),s=n(18);var l=Object(c.b)({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=Object(o.a)(e,"images","resizeNearestNeighbor");u.b(3===l.rank||4===l.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(l.rank,".")})),u.b(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),u.b("float32"===l.dtype||"int32"===l.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),u.b(!1===c||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var f=l,d=!1;3===l.rank&&(d=!0,f=Object(s.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),Object(r.a)(t);var h={images:f},p={alignCorners:n,halfPixelCenters:c,size:t},v=a.a.runKernel(i.sc,h,p);return d?Object(s.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(158),a=n(12),i=n(7),o=n(6),u=n(19),c=n(11),s=n(18);var l=Object(c.b)({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=Object(o.a)(e,"images","resizeBilinear");u.b(3===l.rank||4===l.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(l.rank,".")})),u.b(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),u.b(!1===c||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var f=l,d=!1;3===l.rank&&(d=!0,f=Object(s.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),Object(r.a)(t);var h={images:f},p={alignCorners:n,halfPixelCenters:c,size:t},v=a.a.runKernel(i.qc,h,p);return d?Object(s.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(11),o=n(18);var u=Object(i.b)({depthwiseConv2dNativeBackpropInput_:function(e,t,n,i,u){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,l=t,f=!1;3===t.rank&&(f=!0,l=Object(o.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d={dy:l,filter:n},h={strides:i,pad:u,dimRoundingMode:s,dilations:c,inputShape:e},p=r.a.runKernel(a.Q,d,h);return f?Object(o.a)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(11),o=n(18);var u=Object(i.b)({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,i,u){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],s=arguments.length>6?arguments[6]:void 0,l=e;3===e.rank&&(l=Object(o.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var f=t;3===f.rank&&(f=Object(o.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d={x:l,dy:f},h={strides:i,pad:u,dimRoundingMode:s,dilations:c,filterShape:n};return r.a.runKernel(a.P,d,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(155),a=n(219);function i(e,t,n){return(i=Object(a.a)()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&Object(r.a)(i,n.prototype),i}).apply(null,arguments)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=n(13),a=n(2);function i(t,n){var i,o=n&&n.property?Object(a.u)(n.property):a.y;return!Object(a.H)(t)||(i=t,"function"===typeof e&&Object(a.E)(e.isBuffer)&&e.isBuffer(i))?o(JSON.parse(t)):function(e,t){!Object(a.B)(e)&&Object(a.F)(e)&&(e=Object(r.a)(e));return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(o(t),n)}i.responseType="json"}).call(this,n(162).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.a)({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M193.69 152.84a16 16 0 0129.64 2.56l36.4 121.36 30-59.92a16 16 0 0128.62 0L345.89 272h96.76A213.08 213.08 0 00464 176.65C463.37 114.54 413.54 64 352.92 64c-48.09 0-80 29.54-96.92 51-16.88-21.49-48.83-51-96.92-51C98.46 64 48.63 114.54 48 176.65A211.13 211.13 0 0056.93 240h93.18z"}},{tag:"path",attr:{d:"M321.69 295.16L304 259.78l-33.69 67.38A16 16 0 01256 336q-.67 0-1.38-.06a16 16 0 01-14-11.34l-36.4-121.36-30 59.92A16 16 0 01160 272H69.35q14 29.29 37.27 57.66c18.77 22.88 52.8 59.46 131.39 112.81a31.84 31.84 0 0036 0c78.59-53.35 112.62-89.93 131.39-112.81a316.79 316.79 0 0019-25.66H336a16 16 0 01-14.31-8.84zM464 272h-21.35a260.11 260.11 0 01-18.25 32H464a16 16 0 000-32zM48 240a16 16 0 000 32h21.35a225.22 225.22 0 01-12.42-32z"}}]})(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.a)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M3 2l2.01 18.23C5.13 21.23 5.97 22 7 22h10c1.03 0 1.87-.77 1.99-1.77L21 2H3zm9 17c-1.66 0-3-1.34-3-3 0-2 3-5.4 3-5.4s3 3.4 3 5.4c0 1.66-1.34 3-3 3zm6.33-11H5.67l-.44-4h13.53l-.43 4z"}}]})(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.a)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19,2.01H6c-1.206,0-3,0.799-3,3v3v6v3v2c0,2.201,1.794,3,3,3h15v-2H6.012C5.55,19.998,5,19.815,5,19.01 c0-0.101,0.009-0.191,0.024-0.273c0.112-0.575,0.583-0.717,0.987-0.727H20c0.018,0,0.031-0.009,0.049-0.01H21v-0.99V15V4.01 C21,2.907,20.103,2.01,19,2.01z M19,16.01H5v-2v-6v-3c0-0.806,0.55-0.988,1-1h7v7l2-1l2,1v-7h2V15V16.01z"}}]})(e)}},function(e,t,n){"use strict";var r=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,t){var n,a,i;return t=t||{},n=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),a=""===n?1/0:void 0===t.maxLength?80:t.maxLength,i=t.replacer,function e(t,o,u){var c,s,l,f,d,h,p,v,m,b,g,y;if(t&&"function"===typeof t.toJSON&&(t=t.toJSON()),void 0===(g=JSON.stringify(t,i)))return g;if(p=a-o.length-u,g.length<=p&&(m=g.replace(r,(function(e,t){return t||e+" "}))).length<=p)return m;if(null!=i&&(t=JSON.parse(g),i=void 0),"object"===typeof t&&null!==t){if(v=o+n,l=[],s=0,Array.isArray(t))for(b="[",c="]",p=t.length;s<p;s++)l.push(e(t[s],v,s===p-1?0:1)||"null");else for(b="{",c="}",p=(h=Object.keys(t)).length;s<p;s++)f=h[s],d=JSON.stringify(f)+": ",void 0!==(y=e(t[f],v,d.length+(s===p-1?0:1)))&&l.push(d+y);if(l.length>0)return[b,n+l.join(",\n"+v),c].join("\n"+o)}return g}(e,"",0)}},,,function(e,t){var n=/^[0-9]+$/,r=function(e,t){var r=n.test(e),a=n.test(t);return r&&a&&(e=+e,t=+t),e===t?0:r&&!a?-1:a&&!r?1:e<t?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:function(e,t){return r(t,e)}}},function(e,t,n){var r=n(80);e.exports=function(e,t,n){return 0===r(e,t,n)}},function(e,t,n){var r=n(62);e.exports=function(e,t,n){var a=new r(e,n),i=new r(t,n);return a.compare(i)||a.compareBuild(i)}},function(e,t,n){var r=n(80);e.exports=function(e,t,n){return r(e,t,n)<0}},function(e,t,n){var r=n(80);e.exports=function(e,t,n){return r(e,t,n)>=0}},function(e,t,n){var r=n(80);e.exports=function(e,t,n){return r(e,t,n)<=0}},function(e,t,n){var r=n(366),a=n(367),i=n(240),o=n(368);e.exports=function(e){return r(e)||a(e)||i(e)||o()}},function(e,t,n){var r=n(291);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t,n){var r=n(62),a=n(177),i=a.ANY,o=n(81),u=n(178),c=n(176),s=n(236),l=n(238),f=n(237);e.exports=function(e,t,n,d){var h,p,v,m,b;switch(e=new r(e,d),t=new o(t,d),n){case">":h=c,p=l,v=s,m=">",b=">=";break;case"<":h=s,p=f,v=c,m="<",b="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(u(e,t,d))return!1;for(var g=function(n){var r=t.set[n],o=null,u=null;return r.forEach((function(e){e.semver===i&&(e=new a(">=0.0.0")),o=o||e,u=u||e,h(e.semver,o.semver,d)?o=e:v(e.semver,u.semver,d)&&(u=e)})),o.operator===m||o.operator===b?{v:!1}:u.operator&&u.operator!==m||!p(e,u.semver)?u.operator===b&&v(e,u.semver)?{v:!1}:void 0:{v:!1}},y=0;y<t.set.length;++y){var x=g(y);if("object"===typeof x)return x.v}return!0}},function(e,t,n){var r=n(381),a=n(382),i=n(240),o=n(383);e.exports=function(e,t){return r(e)||a(e,t)||i(e,t)||o()}},function(e,t,n){var r=n(414);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(415),a=n(416),i=n(417);e.exports=function(e){var t=a();return function(){var n,a=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}}},function(e,t,n){"use strict";function r(){}n.r(t),n.d(t,"h",(function(){return u})),n.d(t,"createElement",(function(){return u})),n.d(t,"cloneElement",(function(){return l})),n.d(t,"Component",(function(){return R})),n.d(t,"render",(function(){return z})),n.d(t,"rerender",(function(){return p})),n.d(t,"options",(function(){return a}));var a={},i=[],o=[];function u(e,t){var n,u,c,s,l=o;for(s=arguments.length;s-- >2;)i.push(arguments[s]);for(t&&null!=t.children&&(i.length||i.push(t.children),delete t.children);i.length;)if((u=i.pop())&&void 0!==u.pop)for(s=u.length;s--;)i.push(u[s]);else"boolean"===typeof u&&(u=null),(c="function"!==typeof e)&&(null==u?u="":"number"===typeof u?u=String(u):"string"!==typeof u&&(c=!1)),c&&n?l[l.length-1]+=u:l===o?l=[u]:l.push(u),n=c;var f=new r;return f.nodeName=e,f.children=l,f.attributes=null==t?void 0:t,f.key=null==t?void 0:t.key,void 0!==a.vnode&&a.vnode(f),f}function c(e,t){for(var n in t)e[n]=t[n];return e}var s="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function l(e,t){return u(e.nodeName,c(c({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var f=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function h(e){!e._dirty&&(e._dirty=!0)&&1==d.push(e)&&(a.debounceRendering||s)(p)}function p(){var e,t=d;for(d=[];e=t.pop();)e._dirty&&F(e)}function v(e,t,n){return"string"===typeof t||"number"===typeof t?void 0!==e.splitText:"string"===typeof t.nodeName?!e._componentConstructor&&m(e,t.nodeName):n||e._componentConstructor===t.nodeName}function m(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function b(e){var t=c({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function g(e){var t=e.parentNode;t&&t.removeChild(e)}function y(e,t,n,r,a){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||a)if("style"===t){if(r&&"string"!==typeof r&&"string"!==typeof n||(e.style.cssText=r||""),r&&"object"===typeof r){if("string"!==typeof n)for(var i in n)i in r||(e.style[i]="");for(var i in r)e.style[i]="number"===typeof r[i]&&!1===f.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,x,o):e.removeEventListener(t,x,o),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!a&&t in e)!function(e,t,n){try{e[t]=n}catch(r){}}(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var u=a&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?u?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!==typeof r&&(u?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function x(e){return this._listeners[e.type](a.event&&a.event(e)||e)}var O=[],k=0,w=!1,j=!1;function _(){for(var e;e=O.pop();)a.afterMount&&a.afterMount(e),e.componentDidMount&&e.componentDidMount()}function S(e,t,n,r,a,i){k++||(w=null!=a&&void 0!==a.ownerSVGElement,j=null!=e&&!("__preactattr_"in e));var o=E(e,t,n,r,i);return a&&o.parentNode!==a&&a.appendChild(o),--k||(j=!1,i||_()),o}function E(e,t,n,r,a){var i=e,o=w;if(null!=t&&"boolean"!==typeof t||(t=""),"string"===typeof t||"number"===typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||a)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),C(e,!0))),i.__preactattr_=!0,i;var u=t.nodeName;if("function"===typeof u)return function(e,t,n,r){var a=e&&e._component,i=a,o=e,u=a&&e._componentConstructor===t.nodeName,c=u,s=b(t);for(;a&&!c&&(a=a._parentComponent);)c=a.constructor===t.nodeName;a&&c&&(!r||a._component)?(D(a,s,3,n,r),e=a.base):(i&&!u&&(M(i),e=o=null),a=T(t.nodeName,s,n),e&&!a.nextBase&&(a.nextBase=e,o=null),D(a,s,1,n,r),e=a.base,o&&e!==o&&(o._component=null,C(o,!1)));return e}(e,t,n,r);if(w="svg"===u||"foreignObject"!==u&&w,u=String(u),(!e||!m(e,u))&&(i=function(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}(u,w),e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),C(e,!0)}var c=i.firstChild,s=i.__preactattr_,l=t.children;if(null==s){s=i.__preactattr_={};for(var f=i.attributes,d=f.length;d--;)s[f[d].name]=f[d].value}return!j&&l&&1===l.length&&"string"===typeof l[0]&&null!=c&&void 0!==c.splitText&&null==c.nextSibling?c.nodeValue!=l[0]&&(c.nodeValue=l[0]):(l&&l.length||null!=c)&&function(e,t,n,r,a){var i,o,u,c,s,l=e.childNodes,f=[],d={},h=0,p=0,m=l.length,b=0,y=t?t.length:0;if(0!==m)for(var x=0;x<m;x++){var O=l[x],k=O.__preactattr_;null!=(w=y&&k?O._component?O._component.__key:k.key:null)?(h++,d[w]=O):(k||(void 0!==O.splitText?!a||O.nodeValue.trim():a))&&(f[b++]=O)}if(0!==y)for(x=0;x<y;x++){var w;if(s=null,null!=(w=(c=t[x]).key))h&&void 0!==d[w]&&(s=d[w],d[w]=void 0,h--);else if(!s&&p<b)for(i=p;i<b;i++)if(void 0!==f[i]&&v(o=f[i],c,a)){s=o,f[i]=void 0,i===b-1&&b--,i===p&&p++;break}s=E(s,c,n,r),u=l[x],s&&s!==e&&s!==u&&(null==u?e.appendChild(s):s===u.nextSibling?g(u):e.insertBefore(s,u))}if(h)for(var x in d)void 0!==d[x]&&C(d[x],!1);for(;p<=b;)void 0!==(s=f[b--])&&C(s,!1)}(i,l,n,r,j||null!=s.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||y(e,r,n[r],n[r]=void 0,w);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||y(e,r,n[r],n[r]=t[r],w)}(i,t.attributes,s),w=o,i}function C(e,t){var n=e._component;n?M(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||g(e),A(e))}function A(e){for(e=e.lastChild;e;){var t=e.previousSibling;C(e,!0),e=t}}var N={};function T(e,t,n){var r,a=N[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),R.call(r,t,n)):((r=new R(t,n)).constructor=e,r.render=I),a)for(var i=a.length;i--;)if(a[i].constructor===e){r.nextBase=a[i].nextBase,a.splice(i,1);break}return r}function I(e,t,n){return this.constructor(e,n)}function D(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===a.syncComponentUpdates&&e.base?h(e):F(e,1,i)),e.__ref&&e.__ref(e))}function F(e,t,n,r){if(!e._disable){var i,o,u,s=e.props,l=e.state,f=e.context,d=e.prevProps||s,h=e.prevState||l,p=e.prevContext||f,v=e.base,m=e.nextBase,g=v||m,y=e._component,x=!1;if(v&&(e.props=d,e.state=h,e.context=p,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(s,l,f)?x=!0:e.componentWillUpdate&&e.componentWillUpdate(s,l,f),e.props=s,e.state=l,e.context=f),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!x){i=e.render(s,l,f),e.getChildContext&&(f=c(c({},f),e.getChildContext()));var w,j,E=i&&i.nodeName;if("function"===typeof E){var A=b(i);(o=y)&&o.constructor===E&&A.key==o.__key?D(o,A,1,f,!1):(w=o,e._component=o=T(E,A,f),o.nextBase=o.nextBase||m,o._parentComponent=e,D(o,A,0,f,!1),F(o,1,n,!0)),j=o.base}else u=g,(w=y)&&(u=e._component=null),(g||1===t)&&(u&&(u._component=null),j=S(u,i,f,n||!v,g&&g.parentNode,!0));if(g&&j!==g&&o!==y){var N=g.parentNode;N&&j!==N&&(N.replaceChild(j,g),w||(g._component=null,C(g,!1)))}if(w&&M(w),e.base=j,j&&!r){for(var I=e,R=e;R=R._parentComponent;)(I=R).base=j;j._component=I,j._componentConstructor=I.constructor}}if(!v||n?O.unshift(e):x||(e.componentDidUpdate&&e.componentDidUpdate(d,h,p),a.afterUpdate&&a.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);k||r||_()}}function M(e){a.beforeUnmount&&a.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?M(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,g(t),function(e){var t=e.constructor.name;(N[t]||(N[t]=[])).push(e)}(e),A(t)),e.__ref&&e.__ref(null)}function R(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function z(e,t,n){return S(n,e,{},!1,t,!1)}c(R.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=c({},n)),c(n,"function"===typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),h(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),F(this,2)},render:function(){}});var L={h:u,createElement:u,cloneElement:l,Component:R,render:z,rerender:p,options:a};t.default=L},function(e,t,n){"use strict";var r=n(4),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(86),u=i(n(130)),c=n(100),s=n(180),l=n(181),f={maxBins:12,fontSize:11};function d(e,t,n){var r=o.format(",.4~f"),a=o.format(".4~p"),i=[],u=[];if(null!=e.numVals&&(i.push("Num Vals"),u.push(r(e.numVals))),null!=e.min&&(i.push("Min"),u.push(r(e.min))),null!=e.max&&(i.push("Max"),u.push(r(e.max))),null!=e.numZeros){i.push("# Zeros");var c="";e.numVals&&(c=e.numZeros>0?"(".concat(a(e.numZeros/e.numVals),")"):""),u.push("".concat(r(e.numZeros)," ").concat(c))}if(null!=e.numNans){i.push("# NaNs");var s="";e.numVals&&(s=e.numNans>0?"(".concat(a(e.numNans/e.numVals),")"):""),u.push("".concat(r(e.numNans)," ").concat(s))}if(null!=e.numInfs){i.push("# Infinity");var f="";e.numVals&&(f=e.numInfs>0?"(".concat(a(e.numInfs/e.numVals),")"):""),u.push("".concat(r(e.numInfs)," ").concat(f))}l.table(t,{headers:i,values:[u]},n)}function h(e){if(null==e.length)throw new Error("input data must be an array");if(0===e.length)return[];if("object"===typeof e[0]){if(null==e[0].value)throw new Error("input data must have a value field");return e}for(var t=Array(e.length),n=0;n<e.length;n++)t[n]={value:e[n]};return t}t.histogram=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,void 0,void 0,r.mark((function a(){var i,o,l,p,v,m,b,g,y;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=h(t),o=Object.assign({},f,n),l={actions:!1,mode:"vega-lite",defaultStyle:!1},p=c.subSurface(e,"histogram"),!1!==n.stats&&(v=c.subSurface(e,"stats",{prepend:!0}),d(n.stats?n.stats:s.arrayStats(i.map((function(e){return e.value}))),v,{fontSize:o.fontSize})),0!==i.length){r.next=7;break}return r.abrupt("return",void 0);case 7:for(m=[],b=0;b<i.length;b++)null!=(g=i[b].value)&&isFinite(g)&&m.push(i[b]);return y={width:o.width||c.getDefaultWidth(p),height:o.height||c.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:m},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},encoding:{x:{bin:{maxbins:o.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:o.color||"#001B44"}}},r.abrupt("return",u.default(p,y,l));case 11:case"end":return r.stop()}}),a)})))}},function(e,t,n){"use strict";n.r(t);var r=n(54),a=n(16);Object(a.d)().prototype.abs=function(){return this.throwIfDisposed(),Object(r.a)(this)};var i=n(252);Object(a.d)().prototype.acos=function(){return this.throwIfDisposed(),Object(i.a)(this)};var o=n(253);Object(a.d)().prototype.acosh=function(){return this.throwIfDisposed(),Object(o.a)(this)};var u=n(26);Object(a.d)().prototype.add=function(e){return this.throwIfDisposed(),Object(u.a)(this,e)};var c=n(184);Object(a.d)().prototype.all=function(e,t){return this.throwIfDisposed(),Object(c.a)(this,e,t)};var s=n(185);Object(a.d)().prototype.any=function(e,t){return this.throwIfDisposed(),Object(s.a)(this,e,t)};var l=n(186);Object(a.d)().prototype.argMax=function(e){return this.throwIfDisposed(),Object(l.a)(this,e)};var f=n(187);Object(a.d)().prototype.argMin=function(e){return this.throwIfDisposed(),Object(f.a)(this,e)};var d=n(18),h=n(19);Object(a.d)().prototype.asScalar=function(){return this.throwIfDisposed(),Object(h.b)(1===this.size,(function(){return"The array must have only 1 element."})),Object(d.a)(this,[])};var p=n(24);Object(a.d)().prototype.asType=function(e){return this.throwIfDisposed(),Object(p.a)(this,e)},Object(a.d)().prototype.as1D=function(){return this.throwIfDisposed(),Object(d.a)(this,[this.size])},Object(a.d)().prototype.as2D=function(e,t){return this.throwIfDisposed(),Object(d.a)(this,[e,t])},Object(a.d)().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Object(d.a)(this,[e,t,n])},Object(a.d)().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),Object(d.a)(this,[e,t,n,r])},Object(a.d)().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),Object(d.a)(this,[e,t,n,r,a])};var v=n(255);Object(a.d)().prototype.asin=function(){return this.throwIfDisposed(),Object(v.a)(this)};var m=n(256);Object(a.d)().prototype.asinh=function(){return this.throwIfDisposed(),Object(m.a)(this)};var b=n(257);Object(a.d)().prototype.atan=function(){return this.throwIfDisposed(),Object(b.a)(this)};var g=n(188);Object(a.d)().prototype.atan2=function(e){return this.throwIfDisposed(),Object(g.a)(this,e)};var y=n(258);Object(a.d)().prototype.atanh=function(){return this.throwIfDisposed(),Object(y.a)(this)};var x=n(135);Object(a.d)().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Object(x.a)(this,e,t,n,r)};var O=n(103);Object(a.d)().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Object(O.a)(this,e,t)};var k=n(92);Object(a.d)().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),Object(k.a)(this,e,t,n,r,a)};var w=n(112);Object(a.d)().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Object(w.a)(this,e)},Object(a.d)().prototype.cast=function(e){return this.throwIfDisposed(),Object(p.a)(this,e)};var j=n(261);Object(a.d)().prototype.ceil=function(){return this.throwIfDisposed(),Object(j.a)(this)};var _=n(262);Object(a.d)().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Object(_.a)(this,e,t)};var S=n(13),E=n(45);Object(a.d)().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof a.a&&(e=[e]),Object(E.a)([this].concat(Object(S.a)(e)),t)};var C=n(189);Object(a.d)().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(C.a)(this,e,t,n,r,a,i)};var A=n(190);Object(a.d)().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),Object(A.a)(this,e,t,n,r,a)};var N=n(73);Object(a.d)().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(N.a)(this,e,t,n,r,a,i)};var T=n(136);Object(a.d)().prototype.cos=function(){return this.throwIfDisposed(),Object(T.a)(this)};var I=n(191);Object(a.d)().prototype.cosh=function(){return this.throwIfDisposed(),Object(I.a)(this)};var D=n(137);Object(a.d)().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Object(D.a)(this,e,t,n)};var F=n(192);Object(a.d)().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Object(F.a)(this,e,t)};var M=n(104);Object(a.d)().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(M.a)(this,e,t,n,r,a,i)};var R=n(193);Object(a.d)().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),Object(R.a)(this,e,t,n,r,a)};var z=n(194);Object(a.d)().prototype.divNoNan=function(e){return this.throwIfDisposed(),Object(z.a)(this,e)};var L=n(28);Object(a.d)().prototype.div=function(e){return this.throwIfDisposed(),Object(L.a)(this,e)};var P=n(195);Object(a.d)().prototype.dot=function(e){return this.throwIfDisposed(),Object(P.a)(this,e)};var B=n(138);Object(a.d)().prototype.elu=function(){return this.throwIfDisposed(),Object(B.a)(this)};var W=n(105);Object(a.d)().prototype.equal=function(e){return this.throwIfDisposed(),Object(W.a)(this,e)};var U=n(266);Object(a.d)().prototype.erf=function(){return this.throwIfDisposed(),Object(U.a)(this)};var V=n(53);Object(a.d)().prototype.exp=function(){return this.throwIfDisposed(),Object(V.a)(this)};var q=n(71);Object(a.d)().prototype.expandDims=function(e){return this.throwIfDisposed(),Object(q.a)(this,e)};var H=n(267);Object(a.d)().prototype.expm1=function(){return this.throwIfDisposed(),Object(H.a)(this)};var G=n(150);Object(a.d)().prototype.fft=function(){return this.throwIfDisposed(),Object(G.a)(this)},Object(a.d)().prototype.flatten=function(){return this.throwIfDisposed(),Object(d.a)(this,[this.size])};var K=n(139);Object(a.d)().prototype.floor=function(){return this.throwIfDisposed(),Object(K.a)(this)};var X=n(133);Object(a.d)().prototype.floorDiv=function(e){return this.throwIfDisposed(),Object(X.a)(this,e)};var Y=n(106);Object(a.d)().prototype.gather=function(e,t){return this.throwIfDisposed(),Object(Y.a)(this,e,t)};var $=n(74);Object(a.d)().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Object($.a)(this,e)};var J=n(59);Object(a.d)().prototype.greater=function(e){return this.throwIfDisposed(),Object(J.a)(this,e)};var Q=n(120);Object(a.d)().prototype.ifft=function(){return this.throwIfDisposed(),Object(Q.a)(this)};var Z=n(210);Object(a.d)().prototype.irfft=function(){return this.throwIfDisposed(),Object(Z.a)(this)};var ee=n(268);Object(a.d)().prototype.isFinite=function(){return this.throwIfDisposed(),Object(ee.a)(this)};var te=n(269);Object(a.d)().prototype.isInf=function(){return this.throwIfDisposed(),Object(te.a)(this)};var ne=n(270);Object(a.d)().prototype.isNaN=function(){return this.throwIfDisposed(),Object(ne.a)(this)};var re=n(141);Object(a.d)().prototype.leakyRelu=function(e){return this.throwIfDisposed(),Object(re.a)(this,e)};var ae=n(75);Object(a.d)().prototype.lessEqual=function(e){return this.throwIfDisposed(),Object(ae.a)(this,e)};var ie=n(142);Object(a.d)().prototype.less=function(e){return this.throwIfDisposed(),Object(ie.a)(this,e)};var oe=n(196);Object(a.d)().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),Object(oe.a)(this,e,t,n,r)};var ue=n(272);Object(a.d)().prototype.logSigmoid=function(){return this.throwIfDisposed(),Object(ue.a)(this)};var ce=n(273);Object(a.d)().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Object(ce.a)(this,e)};var se=n(143);Object(a.d)().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Object(se.a)(this,e,t)};var le=n(83);Object(a.d)().prototype.log=function(){return this.throwIfDisposed(),Object(le.a)(this)};var fe=n(197);Object(a.d)().prototype.log1p=function(){return this.throwIfDisposed(),Object(fe.a)(this)};var de=n(68);Object(a.d)().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Object(de.a)(this,e)};var he=n(107);Object(a.d)().prototype.logicalNot=function(){return this.throwIfDisposed(),Object(he.a)(this)};var pe=n(144);Object(a.d)().prototype.logicalOr=function(e){return this.throwIfDisposed(),Object(pe.a)(this,e)};var ve=n(199);Object(a.d)().prototype.logicalXor=function(e){return this.throwIfDisposed(),Object(ve.a)(this,e)};var me=n(36);Object(a.d)().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Object(me.a)(this,e,t,n)};var be=n(145);Object(a.d)().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Object(be.a)(this,e,t,n,r)};var ge=n(78);Object(a.d)().prototype.max=function(e,t){return this.throwIfDisposed(),Object(ge.a)(this,e,t)};var ye=n(102);Object(a.d)().prototype.maximum=function(e){return this.throwIfDisposed(),Object(ye.a)(this,e)};var xe=n(96);Object(a.d)().prototype.mean=function(e,t){return this.throwIfDisposed(),Object(xe.a)(this,e,t)};var Oe=n(117);Object(a.d)().prototype.min=function(e,t){return this.throwIfDisposed(),Object(Oe.a)(this,e,t)};var ke=n(146);Object(a.d)().prototype.minimum=function(e){return this.throwIfDisposed(),Object(ke.a)(this,e)};var we=n(200);Object(a.d)().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),Object(we.a)(this,e,t)};var je=n(201);Object(a.d)().prototype.mod=function(e){return this.throwIfDisposed(),Object(je.a)(this,e)};var _e=n(20);Object(a.d)().prototype.mul=function(e){return this.throwIfDisposed(),Object(_e.a)(this,e)};var Se=n(41);Object(a.d)().prototype.neg=function(){return this.throwIfDisposed(),Object(Se.a)(this)};var Ee=n(154);Object(a.d)().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Object(Ee.a)(this,e,t,n)};var Ce=n(147);Object(a.d)().prototype.notEqual=function(e){return this.throwIfDisposed(),Object(Ce.a)(this,e)};var Ae=n(118);Object(a.d)().prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),Object(Ae.a)(this,e,t,n)};var Ne=n(277);Object(a.d)().prototype.onesLike=function(){return this.throwIfDisposed(),Object(Ne.a)(this)};var Te=n(65);Object(a.d)().prototype.pad=function(e,t){return this.throwIfDisposed(),Object(Te.a)(this,e,t)};var Ie=n(202);Object(a.d)().prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),Object(Ie.a)(this,e,t,n,r,a)};var De=n(63);Object(a.d)().prototype.pow=function(e){return this.throwIfDisposed(),Object(De.a)(this,e)};var Fe=n(148);Object(a.d)().prototype.prelu=function(e){return this.throwIfDisposed(),Object(Fe.a)(this,e)};var Me=n(203);Object(a.d)().prototype.prod=function(e,t){return this.throwIfDisposed(),Object(Me.a)(this,e,t)};var Re=n(278);Object(a.d)().prototype.reciprocal=function(){return this.throwIfDisposed(),Object(Re.a)(this)};var ze=n(89);Object(a.d)().prototype.relu=function(){return this.throwIfDisposed(),Object(ze.a)(this)};var Le=n(149);Object(a.d)().prototype.relu6=function(){return this.throwIfDisposed(),Object(Le.a)(this)},Object(a.d)().prototype.reshapeAs=function(e){return this.throwIfDisposed(),Object(d.a)(this,e.shape)},Object(a.d)().prototype.reshape=function(e){return this.throwIfDisposed(),Object(d.a)(this,e)};var Pe=n(222);Object(a.d)().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),Object(Pe.a)(this,e,t,n)};var Be=n(221);Object(a.d)().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Object(Be.a)(this,e,t,n)};var We=n(58);Object(a.d)().prototype.reverse=function(e){return this.throwIfDisposed(),Object(We.a)(this,e)};var Ue=n(151);Object(a.d)().prototype.rfft=function(){return this.throwIfDisposed(),Object(Ue.a)(this)};var Ve=n(279);Object(a.d)().prototype.round=function(){return this.throwIfDisposed(),Object(Ve.a)(this)};var qe=n(205);Object(a.d)().prototype.rsqrt=function(){return this.throwIfDisposed(),Object(qe.a)(this)};var He=n(206);Object(a.d)().prototype.selu=function(){return this.throwIfDisposed(),Object(He.a)(this)};var Ge=n(207);Object(a.d)().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(Ge.a)(this,e,t,n,r,a,i)};var Ke=n(77);Object(a.d)().prototype.sigmoid=function(){return this.throwIfDisposed(),Object(Ke.a)(this)};var Xe=n(281);Object(a.d)().prototype.sign=function(){return this.throwIfDisposed(),Object(Xe.a)(this)};var Ye=n(208);Object(a.d)().prototype.sin=function(){return this.throwIfDisposed(),Object(Ye.a)(this)};var $e=n(209);Object(a.d)().prototype.sinh=function(){return this.throwIfDisposed(),Object($e.a)(this)};var Je=n(40);Object(a.d)().prototype.slice=function(e,t){return this.throwIfDisposed(),Object(Je.a)(this,e,t)};var Qe=n(282);Object(a.d)().prototype.softmax=function(e){return this.throwIfDisposed(),Object(Qe.a)(this,e)};var Ze=n(198);Object(a.d)().prototype.softplus=function(){return this.throwIfDisposed(),Object(Ze.a)(this)};var et=n(108);Object(a.d)().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Object(et.a)(this,e,t)};var tt=n(84);Object(a.d)().prototype.split=function(e,t){return this.throwIfDisposed(),Object(tt.a)(this,e,t)};var nt=n(50);Object(a.d)().prototype.sqrt=function(){return this.throwIfDisposed(),Object(nt.a)(this)};var rt=n(37);Object(a.d)().prototype.square=function(){return this.throwIfDisposed(),Object(rt.a)(this)};var at=n(152);Object(a.d)().prototype.squaredDifference=function(e){return this.throwIfDisposed(),Object(at.a)(this,e)};var it=n(109);Object(a.d)().prototype.squeeze=function(e){return this.throwIfDisposed(),Object(it.a)(this,e)};var ot=n(69);Object(a.d)().prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof a.a?[this,e]:[this].concat(Object(S.a)(e));return Object(ot.a)(n,t)};var ut=n(90);Object(a.d)().prototype.step=function(e){return this.throwIfDisposed(),Object(ut.a)(this,e)};var ct=n(283);Object(a.d)().prototype.stridedSlice=function(e,t,n,r,a,i,o,u){return this.throwIfDisposed(),Object(ct.a)(this,e,t,n,r,a,i,o,u)};var st=n(27);Object(a.d)().prototype.sub=function(e){return this.throwIfDisposed(),Object(st.a)(this,e)};var lt=n(31);Object(a.d)().prototype.sum=function(e,t){return this.throwIfDisposed(),Object(lt.a)(this,e,t)};var ft=n(284);Object(a.d)().prototype.tan=function(){return this.throwIfDisposed(),Object(ft.a)(this)};var dt=n(166);Object(a.d)().prototype.tanh=function(){return this.throwIfDisposed(),Object(dt.a)(this)};var ht=n(93);Object(a.d)().prototype.tile=function(e){return this.throwIfDisposed(),Object(ht.a)(this,e)},Object(a.d)().prototype.toBool=function(){return this.throwIfDisposed(),Object(p.a)(this,"bool")},Object(a.d)().prototype.toFloat=function(){return this.throwIfDisposed(),Object(p.a)(this,"float32")},Object(a.d)().prototype.toInt=function(){return this.throwIfDisposed(),Object(p.a)(this,"int32")};var pt=n(212);Object(a.d)().prototype.topk=function(e,t){return this.throwIfDisposed(),Object(pt.a)(this,e,t)};var vt=n(61);Object(a.d)().prototype.transpose=function(e){return this.throwIfDisposed(),Object(vt.a)(this,e)};var mt=n(213);Object(a.d)().prototype.unique=function(e){return this.throwIfDisposed(),Object(mt.a)(this,e)};var bt=n(153);Object(a.d)().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Object(bt.a)(this,e,t)};var gt=n(91);Object(a.d)().prototype.unstack=function(e){return this.throwIfDisposed(),Object(gt.a)(this,e)};var yt=n(49);Object(a.d)().prototype.where=function(e,t){return this.throwIfDisposed(),Object(yt.a)(e,this,t)};var xt=n(32);Object(a.d)().prototype.zerosLike=function(){return this.throwIfDisposed(),Object(xt.a)(this)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(21);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},function(e,t,n){var r=n(127);e.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:n(173).SEMVER_SPEC_VERSION,SemVer:n(62),compareIdentifiers:n(233).compareIdentifiers,rcompareIdentifiers:n(233).rcompareIdentifiers,parse:n(128),valid:n(353),clean:n(354),inc:n(355),diff:n(356),major:n(357),minor:n(358),patch:n(359),prerelease:n(360),compare:n(80),rcompare:n(361),compareLoose:n(362),compareBuild:n(235),sort:n(363),rsort:n(364),gt:n(176),lt:n(236),eq:n(234),neq:n(289),gte:n(237),lte:n(238),cmp:n(290),coerce:n(365),Comparator:n(177),Range:n(81),satisfies:n(178),toComparators:n(372),maxSatisfying:n(373),minSatisfying:n(374),minVersion:n(375),validRange:n(376),outside:n(241),gtr:n(377),ltr:n(378),intersects:n(379),simplifyRange:n(380),subset:n(384)}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({acos_:function(e){var t={x:Object(i.a)(e,"x","acos")};return r.a.runKernel(a.b,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({acosh_:function(e){var t={x:Object(i.a)(e,"x","acosh")};return r.a.runKernel(a.c,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({addN_:function(e){o.b(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),o.b(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return Object(i.a)(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!o.a(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var u=t;return r.a.runKernel(a.e,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({asin_:function(e){var t={x:Object(i.a)(e,"x","asin")};return r.a.runKernel(a.j,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({asinh_:function(e){var t={x:Object(i.a)(e,"x","asinh")};return r.a.runKernel(a.k,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({atan_:function(e){var t={x:Object(i.a)(e,"x","atan")};return r.a.runKernel(a.l,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({atanh_:function(e){var t={x:Object(i.a)(e,"x","atanh")};return r.a.runKernel(a.n,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(24),c=n(11),s=n(18);var l=Object(c.b)({avgPool3d_:function(e,t,n,c,l){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",d=Object(i.a)(e,"x","avgPool3d","float32"),h=d,p=!1;4===d.rank&&(p=!0,h=Object(s.a)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),o.b(5===h.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(h.rank,".")})),o.b("NDHWC"===f,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(f)})),null!=l&&o.b(o.v(c),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(c,".")}));var v={x:h},m={filterSize:t,strides:n,pad:c,dimRoundingMode:l,dataFormat:f},b=r.a.runKernel(a.p,v,m);return b=Object(u.a)(b,h.dtype),p?Object(s.a)(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({bincount_:function(e,t,n){var u=Object(i.a)(e,"x","bincount"),c=Object(i.a)(t,"weights","bincount");o.b("int32"===u.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(u.dtype)})),o.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),o.b(c.size===u.size||0===c.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(u.shape,", weights shape: ")+"".concat(c.shape,".")}));var s={x:u,weights:c},l={size:n};return r.a.runKernel(a.u,s,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({ceil_:function(e){var t={x:Object(i.a)(e,"x","ceil")};return r.a.runKernel(a.x,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({clipByValue_:function(e,t,n){var u=Object(i.a)(e,"x","clipByValue");o.b(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")}));var c={x:u},s={clipValueMin:t,clipValueMax:n};return r.a.runKernel(a.y,c,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(42),c=n(11),s=n(18);var l=Object(c.b)({conv3d_:function(e,t,n,c){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],d=Object(i.a)(e,"x","conv3d"),h=Object(i.a)(t,"filter","conv3d"),p=d,v=!1;4===d.rank&&(v=!0,p=Object(s.a)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),o.b(5===p.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(p.rank,".")})),o.b(5===h.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(h.rank,".")})),o.b(p.shape[4]===h.shape[3],(function(){return"Error in conv3d: depth of input (".concat(p.shape[4],") must match ")+"input depth for filter ".concat(h.shape[3],".")})),o.b(Object(u.h)(n,f),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(f,"'")})),o.b("NDHWC"===l,(function(){return"Error in conv3d: got dataFormat of ".concat(l," but only NDHWC is currently supported.")}));var m={x:p,filter:h},b={strides:n,pad:c,dataFormat:l,dilations:f},g=r.a.runKernel(a.F,m,b);return v?Object(s.a)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11);var c=Object(u.b)({denseBincount_:function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(i.a)(e,"x","denseBincount"),s=Object(i.a)(t,"weights","denseBincount");o.b("int32"===c.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(c.dtype)})),o.b(c.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(c.rank,".")})),o.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),o.b(s.size===c.size||0===s.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(c.shape,", weights shape: ")+"".concat(s.shape,".")}));var l={x:c,weights:s},f={size:n,binaryOutput:u};return r.a.runKernel(a.M,l,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var u=n.map((function(e,t){return Object(i.a)(e,"tensors".concat(t),"einsum")})),c={equation:e};return r.a.runKernel(a.V,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(24),c=n(11);var s=Object(c.b)({erf_:function(e){var t=Object(i.a)(e,"x","erf");o.b("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Object(u.a)(t,"float32"));var n={x:t};return r.a.runKernel(a.Z,n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({expm1_:function(e){var t={x:Object(i.a)(e,"x","expm1")};return r.a.runKernel(a.cb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({isFinite_:function(e){var t={x:Object(i.a)(e,"x","isFinite")};return r.a.runKernel(a.tb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({isInf_:function(e){var t={x:Object(i.a)(e,"x","isInf")};return r.a.runKernel(a.ub,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({isNaN_:function(e){var t={x:Object(i.a)(e,"x","isNaN")};return r.a.runKernel(a.vb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12),a=n(7);function i(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var i={start:e,stop:t,num:n};return r.a.runKernel(a.Bb,{},i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(47),a=n(6),i=n(20),o=n(41),u=n(11),c=n(77),s=n(198);var l=Object(u.b)({logSigmoid_:function(e){var t=Object(a.a)(e,"x","logSigmoid");return Object(r.a)((function(e){return{value:Object(o.a)(Object(s.a)(Object(o.a)(e))),gradFunc:function(t){return Object(i.a)(t,Object(c.a)(Object(o.a)(e)))}}}))(t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(8),a=n(47),i=n(6),o=n(24),u=n(53),c=n(83),s=n(78),l=n(20),f=n(11),d=n(27),h=n(31);var p=Object(f.b)({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(i.a)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var f=Object(a.a)((function(e,n){var a=Object(s.a)(e,t,!0),i=Object(d.a)(e,a),f=Object(d.a)(Object(o.a)(i,"float32"),Object(c.a)(Object(h.a)(Object(u.a)(i),t,!0)));n([f]);return{value:f,gradFunc:function(e,n){var a=Object(r.a)(n,1)[0],i=Object(u.a)(a);return Object(d.a)(e,Object(l.a)(Object(h.a)(e,t,!0),i))}}}));return f(n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),a=n(7),i=n(6),o=n(19),u=n(11),c=n(18);var s=Object(u.b)({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",f=Object(i.a)(e,"x","maxPool3d"),d=f,h=!1;4===f.rank&&(h=!0,d=Object(c.a)(f,[1,f.shape[0],f.shape[1],f.shape[2],f.shape[3]])),o.b(5===d.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(d.rank,".")})),o.b("NDHWC"===l,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(l)})),null!=s&&o.b(o.v(u),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(s," but got pad ").concat(u,".")}));var p={x:d},v={filterSize:t,strides:n,pad:u,dimRoundingMode:s,dataFormat:l},m=r.a.runKernel(a.Kb,p,v);return h?Object(c.a)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({maxPoolWithArgmax_:function(e,t,n,o){var u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=Object(i.a)(e,"x","maxPoolWithArgmax"),s={x:c},l={filterSize:t,strides:n,pad:o,includeBatchInIndex:u},f=r.a.runKernel(a.Nb,s,l);return{result:f[0],indexes:f[1]}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(11),u=n(18);var c=Object(o.b)({multinomial_:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(i.a)(e,"logits","multinomial"),s=c.size,l=c.rank;if(s<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(s,"."));if(l>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(l));n=n||Math.random();var f=1===l?Object(u.a)(c,[1,-1]):c,d={logits:f},h={numSamples:t,seed:n,normalized:o},p=r.a.runKernel(a.Ub,d,h);return 1===l?Object(u.a)(p,[p.size]):p}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({onesLike_:function(e){var t={x:Object(i.a)(e,"x","onesLike")};return r.a.runKernel(a.cc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({reciprocal_:function(e){var t={x:Object(i.a)(e,"x","reciprocal")};return r.a.runKernel(a.mc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({round_:function(e){var t={x:Object(i.a)(e,"x","round")};return r.a.runKernel(a.wc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(4),a=n.n(r),i=n(17),o=n(16),u=n(6),c=n(19);function s(){return(s=Object(i.a)(a.a.mark((function e(t,n){var r,i,s,l,f,d,h,p,v,m,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(u.a)(t,"x","setdiff1d"),i=Object(u.a)(n,"y","setdiff1d"),c.b(r.dtype===i.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(i.dtype,").")})),c.b(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),c.b(1===i.rank,(function(){return"y should be 1D tensor, but got y (".concat(i.shape,").")})),e.next=7,r.data();case 7:return s=e.sent,e.next=10,i.data();case 10:for(l=e.sent,f=new Set(l),d=0,h=0;h<s.length;h++)f.has(s[h])||d++;for(p=new o.b([d],r.dtype),v=new o.b([d],"int32"),m=0,b=0;m<s.length;m++)f.has(s[m])||(p.values[b]=s[m],v.values[b]=m,b++);return e.abrupt("return",[p.toTensor(),v.toTensor()]);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var l=function(e,t){return s.apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({sign_:function(e){var t={x:Object(i.a)(e,"x","sign")};return r.a.runKernel(a.Cc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(i.a)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var o={logits:n},u={dim:t};return r.a.runKernel(a.Gc,o,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({stridedSlice_:function(e,t,n,o){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=Object(i.a)(e,"x","stridedSlice"),h={x:d},p={begin:t,end:n,strides:o,beginMask:u,endMask:c,ellipsisMask:s,newAxisMask:l,shrinkAxisMask:f};return r.a.runKernel(a.Qc,h,p)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({tan_:function(e){var t={x:Object(i.a)(e,"x","tan")};return r.a.runKernel(a.Tc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(57),a=n(11),i=n(113);var o=Object(a.b)({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");for(var u=new i.a(t,n,a,!0,o),c=Object(r.a)(e,a),s=0;s<c.values.length;s++)c.values[s]=u.nextValue();return c.toTensor()}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7),i=n(6),o=n(11),u=n(131);var c=Object(o.b)({scatterND_:function(e,t,n){var o=Object(i.a)(e,"indices","scatterND","int32"),c=Object(i.a)(t,"updates","scatterND");u.validateInput(c,o,n);var s={indices:o,updates:c},l={shape:n};return r.a.runKernel(a.yc,s,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(7),i=n(6),o=n(11);var u=Object(o.b)({gatherND_:function(e,t){var n=Object(i.a)(t,"indices","gatherND","int32"),o={params:Object(i.a)(e,"x","gatherND"),indices:n};return r.a.runKernel(a.mb,o)}})},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof e?e:function(e){return e()};function a(){return new Promise((function(e){return r((function(){return e()}))}))}}).call(this,n(348).setImmediate)},function(e,t,n){var r=n(80);e.exports=function(e,t,n){return 0!==r(e,t,n)}},function(e,t,n){var r=n(234),a=n(289),i=n(176),o=n(237),u=n(236),c=n(238);e.exports=function(e,t,n,s){switch(t){case"===":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e===n;case"!==":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,s);case"!=":return a(e,n,s);case">":return i(e,n,s);case">=":return o(e,n,s);case"<":return u(e,n,s);case"<=":return c(e,n,s);default:throw new TypeError("Invalid operator: ".concat(t))}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processStyleName=void 0,t.createMarkupForStyles=function(e,t){var n="";for(var a in e){var i=0===a.indexOf("--");if(e.hasOwnProperty(a)&&"label"!==a){var o=e[a];0,null!=o&&(i?n+=a+":"+o+";":(n+=u(a)+":",n+=(0,r.default)(a,o,t)+";"))}}return n||null};o(n(386));var r=o(n(388)),a=o(n(391)),i=o(n(393));o(n(293));function o(e){return e&&e.__esModule?e:{default:e}}var u=t.processStyleName=(0,i.default)(a.default)},function(e,t,n){"use strict";var r=n(390);e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSurfaceInfo=function(e){return null!=e.name},t.isSurface=function(e){return e.drawArea instanceof HTMLElement}},function(e,t,n){"use strict";var r=n(98),a=n(99);Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(413),u="tfjs-visor-container";t.visor=function(){if("undefined"===typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(u)&&null!=i)return i;var e,t=document.getElementById(u);function n(t,n){var r=null;return e=o.VisorComponent.render(t,e,{ref:function(e){return r=e},surfaceList:Array.from(n.values())}),r}null==t&&((t=document.createElement("div")).id=u,document.body.appendChild(t));var r=new Map,a=n(t,r);return i=new c(a,t,r,n)};var c=function(){function e(t,n,a,i){r(this,e),this.visorComponent=t,this.el=n,this.surfaceList=a,this.renderVisor=i}return a(e,[{key:"surface",value:function(e){var t=e.name,n=null==e.tab?"Visor":e.tab;if(null==t||!("string"===typeof t||t instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");var r=Object.assign({},e,{tab:n}),a="".concat(t,"-").concat(n);return this.surfaceList.has(a)||this.surfaceList.set(a,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(t,n)}},{key:"isFullscreen",value:function(){return this.visorComponent.isFullscreen()}},{key:"isOpen",value:function(){return this.visorComponent.isOpen()}},{key:"close",value:function(){return this.visorComponent.close()}},{key:"open",value:function(){return this.visorComponent.open()}},{key:"toggle",value:function(){return this.visorComponent.toggle()}},{key:"toggleFullScreen",value:function(){return this.visorComponent.toggleFullScreen()}},{key:"bindKeys",value:function(){return this.visorComponent.bindKeys()}},{key:"unbindKeys",value:function(){return this.visorComponent.unbindKeys()}},{key:"setActiveTab",value:function(e){if(!this.visorComponent.state.tabs.has(e))throw new Error("Tab '".concat(e,"' does not exist"));this.visorComponent.setState({activeTab:e})}}]),e}();t.Visor=c},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){"use strict";var r=n(4),a=n(239),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(130)),c=n(100),s=n(179),l=n(82);t.linechart=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r.mark((function i(){var o,d,h,p,v,m,b,g,y,x,O,k,w,j;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(o=Array.isArray(t.values[0])?t.values:[t.values],d=o[0].length,h=t.series?t.series:o.map((function(e,t){return"Series ".concat(t+1)})),s.assert(h.length===o.length,"Must have an equal number of series labels as there are data series"),null!=n.seriesColors&&s.assert(n.seriesColors.length===o.length,"Must have an equal number of series colors as there are data series"),p=[],v=function(e){var t={x:e};h.forEach((function(n,r){var a=o[r][e].y;t[n]=a,t["".concat(n,"-name")]=n})),p.push(t)},m=0;m<d;m++)v(m);return b=Object.assign({},f,n),g=function(){return b.zoomToFit?{zero:!1}:null!=b.yAxisDomain?{domain:b.yAxisDomain}:void 0},y={x:{field:"x",type:b.xType,title:b.xLabel},tooltip:[{field:"x",type:"quantitative"}].concat(a(h.map((function(e){return{field:e,type:"quantitative"}}))))},x=h.map((function(e){return{data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:e,type:b.yType,title:b.yLabel,scale:g()},color:{field:"".concat(e,"-name"),type:"nominal",legend:{values:h,title:null},scale:{range:b.seriesColors}}}}})),O={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},k=l.getDrawArea(e),w={width:b.width||c.getDefaultWidth(k),height:b.height||c.getDefaultHeight(k),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:b.fontSize,titleFontSize:b.fontSize},text:{fontSize:b.fontSize},legend:{labelFontSize:b.fontSize,titleFontSize:b.fontSize}},data:{values:p},encoding:y,layer:[].concat(a(x),[O])},j={actions:!1,mode:"vega-lite",defaultStyle:!1},r.next=18,u.default(k,w,j);case 18:return r.abrupt("return",Promise.resolve());case 19:case"end":return r.stop()}}),i)})))};var f={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(7);function i(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var o=n(6),u=n(11);var c=Object(u.b)({sparseToDense_:function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=Object(o.a)(e,"sparseIndices","sparseToDense","int32"),s=Object(o.a)(t,"sparseValues","sparseToDense"),l=Object(o.a)(u,"defaultValue","sparseToDense",s.dtype);i(c,s,n,l);var f={sparseIndices:c,sparseValues:s,defaultValue:l},d={outputShape:n};return r.a.runKernel(a.Kc,f,d)}})},function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(329)},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n(4),a=n.n(r),i=n(17),o=n(3),u=n(10),c=n(14),s=n(15),l=n(1),f=n(56),d=n(319),h=function(e){Object(c.a)(n,e);var t=Object(s.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"decodeUTF8",value:function(){return new p(this)}}]),n}(f.a),p=function(e){Object(c.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this)).upstream=e,r.impl=new v(e),r}return Object(u.a)(n,[{key:"summary",value:function(){return this.impl.summary()}},{key:"next",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.impl.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(d.a),v=function(t){Object(c.a)(f,t);var r=Object(s.a)(f);function f(e){var t;if(Object(o.a)(this,f),(t=r.call(this)).upstream=e,Object(l.env)().get("IS_BROWSER"))t.decoder=new TextDecoder("utf-8");else{var a=n(350).StringDecoder;t.decoder=new a("utf8")}return t}return Object(u.a)(f,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Utf8")}},{key:"pump",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.upstream.next();case 2:if(!(n=t.sent).done){t.next=7;break}return t.abrupt("return",!1);case 7:r=n.value;case 8:return i=Object(l.env)().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(e.from(r.buffer)),this.outputQueue.push(i),t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),f}(f.b)}).call(this,n(162).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(9),a=n(4),i=n.n(a),o=n(17),u=n(3),c=n(10),s=n(14),l=n(15),f=n(56),d=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"split",value:function(e){return new h(this,e)}}]),n}(f.a),h=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e,r){var a;return Object(u.a)(this,n),(a=t.call(this)).upstream=e,a.impl=new p(e,r),a}return Object(c.a)(n,[{key:"summary",value:function(){return this.impl.summary()}},{key:"next",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.impl.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(d),p=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e,r){var a;return Object(u.a)(this,n),(a=t.call(this)).upstream=e,a.separator=r,a.carryover="",a}return Object(c.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")}},{key:"pump",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,n,a,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=9;break}if(""!==this.carryover){e.next=6;break}return e.abrupt("return",!1);case 6:return this.outputQueue.push(this.carryover),this.carryover="",e.abrupt("return",!0);case 9:(n=t.value.split(this.separator))[0]=this.carryover+n[0],a=Object(r.a)(n.slice(0,-1));try{for(a.s();!(o=a.n()).done;)u=o.value,this.outputQueue.push(u)}catch(i){a.e(i)}finally{a.f()}return this.carryover=n[n.length-1],e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(f.b)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(1),n(247);var r=n(352),a=n(421),i=n(422),o=n(246),u=n(298),c=n(423),s=n(181),l=n(424),f=n(426),d=n(427),h=n(428),p=n(180),v=n(429);t.version_vis=v.version;var m={barchart:r.barchart,table:s.table,histogram:o.histogram,linechart:u.linechart,scatterplot:c.scatterplot,confusionMatrix:a.confusionMatrix,heatmap:i.heatmap};t.render=m;var b={accuracy:p.accuracy,perClassAccuracy:p.perClassAccuracy,confusionMatrix:p.confusionMatrix};t.metrics=b;var g={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:d.perClassAccuracy,valuesDistribution:h.valuesDistribution,layer:f.layer,modelSummary:f.modelSummary};t.show=g;var y=n(296);t.visor=y.visor,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(295))},function(e){e.exports=JSON.parse('{"name":"vega-lite","author":"Dominik Moritz, Kanit \\"Ham\\" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer","version":"4.13.1","collaborators":["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],"homepage":"https://vega.github.io/vega-lite/","description":"Vega-Lite is a concise high-level language for interactive visualization.","main":"build/vega-lite.js","unpkg":"build/vega-lite.min.js","jsdelivr":"build/vega-lite.min.js","module":"build/src/index","types":"build/src/index.d.ts","bin":{"vl2png":"./bin/vl2png","vl2svg":"./bin/vl2svg","vl2pdf":"./bin/vl2pdf","vl2vg":"./bin/vl2vg"},"directories":{"test":"test"},"scripts":{"changelog":"conventional-changelog -p angular -r 2","build":"yarn build:only","build:only":"yarn tsc:src && rollup -c","postbuild":"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh","clean":"find build ! -name \'vega-lite-schema.json\' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name \'index.md\' ! -name \'data\' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site","data":"rsync -r node_modules/vega-datasets/data/* site/data","schema":"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/","renameschema":"scripts/rename-schema.sh","presite":"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh","site":"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json","prettierbase":"prettier \'**/*.{md,css,yml}\'","eslintbase":"eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","test":"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup \'yarn tsc:src -w\' \'rollup -c -w\'","watch:site":"concurrently --kill-others -n Typescript,Rollup \'yarn tsc:site -w\' \'rollup -c site/rollup.config.js -w\'","watch:test":"jest --watch"},"repository":{"type":"git","url":"https://github.com/vega/vega-lite.git"},"license":"BSD-3-Clause","bugs":{"url":"https://github.com/vega/vega-lite/issues"},"devDependencies":{"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2","ajv":"^6.12.2","chai":"^4.2.0","cheerio":"^1.0.0-rc.3","codecov":"^3.7.0","concurrently":"^5.2.0","conventional-changelog-cli":"^2.0.34","d3":"^5.16.0","eslint":"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3","jest":"^26.0.1","jest-puppeteer":"^4.4.0","mkdirp":"^1.0.4","prettier":"^2.0.5","puppeteer":"^3.1.0","rollup":"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7","terser":"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1","typescript":"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},"dependencies":{"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1","clone":"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0","tslib":"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0","yargs":"~15.3.1"},"peerDependencies":{"vega":"^5.12.1"},"jest":{"preset":"jest-puppeteer","transform":{"^.+\\\\.tsx?$":"ts-jest"},"testRegex":"(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$","moduleFileExtensions":["ts","tsx","js","jsx","json","node"],"testPathIgnorePatterns":["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],"coverageDirectory":"./coverage/","collectCoverage":false}}')},function(e,t,n){(function(t){var n=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var n,r,a;try{n=Map}catch(c){n=function(){}}try{r=Set}catch(c){r=function(){}}try{a=Promise}catch(c){a=function(){}}function i(o,c,s,l,f){"object"===typeof c&&(s=c.depth,l=c.prototype,f=c.includeNonEnumerable,c=c.circular);var d=[],h=[],p="undefined"!=typeof t;return"undefined"==typeof c&&(c=!0),"undefined"==typeof s&&(s=1/0),function o(s,v){if(null===s)return null;if(0===v)return s;var m,b;if("object"!=typeof s)return s;if(e(s,n))m=new n;else if(e(s,r))m=new r;else if(e(s,a))m=new a((function(e,t){s.then((function(t){e(o(t,v-1))}),(function(e){t(o(e,v-1))}))}));else if(i.__isArray(s))m=[];else if(i.__isRegExp(s))m=new RegExp(s.source,u(s)),s.lastIndex&&(m.lastIndex=s.lastIndex);else if(i.__isDate(s))m=new Date(s.getTime());else{if(p&&t.isBuffer(s))return m=t.allocUnsafe?t.allocUnsafe(s.length):new t(s.length),s.copy(m),m;e(s,Error)?m=Object.create(s):"undefined"==typeof l?(b=Object.getPrototypeOf(s),m=Object.create(b)):(m=Object.create(l),b=l)}if(c){var g=d.indexOf(s);if(-1!=g)return h[g];d.push(s),h.push(m)}for(var y in e(s,n)&&s.forEach((function(e,t){var n=o(t,v-1),r=o(e,v-1);m.set(n,r)})),e(s,r)&&s.forEach((function(e){var t=o(e,v-1);m.add(t)})),s){var x;b&&(x=Object.getOwnPropertyDescriptor(b,y)),x&&null==x.set||(m[y]=o(s[y],v-1))}if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(s);for(y=0;y<O.length;y++){var k=O[y];(!(j=Object.getOwnPropertyDescriptor(s,k))||j.enumerable||f)&&(m[k]=o(s[k],v-1),j.enumerable||Object.defineProperty(m,k,{enumerable:!1}))}}if(f){var w=Object.getOwnPropertyNames(s);for(y=0;y<w.length;y++){var j,_=w[y];(j=Object.getOwnPropertyDescriptor(s,_))&&j.enumerable||(m[_]=o(s[_],v-1),Object.defineProperty(m,_,{enumerable:!1}))}}return m}(o,s)}function o(e){return Object.prototype.toString.call(e)}function u(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=o,i.__isDate=function(e){return"object"===typeof e&&"[object Date]"===o(e)},i.__isArray=function(e){return"object"===typeof e&&"[object Array]"===o(e)},i.__isRegExp=function(e){return"object"===typeof e&&"[object RegExp]"===o(e)},i.__getRegExpFlags=u,i}();e.exports&&(e.exports=n)}).call(this,n(162).Buffer)},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(a=r;0!==a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=r;0!==a--;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;0!==a--;){var o=i[a];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(8),a=n(4),i=n.n(a),o=n(17),u=n(10),c=n(3),s=n(9),l=n(1),f=n(121),d=function(e){var t,n=[],r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n},h=function e(){Object(c.a)(this,e),this.parent=null,this.children={},this.end=!1,this.word=[[],0,0]},p=function(){function e(){Object(c.a)(this,e),this.root=new h}return Object(u.a)(e,[{key:"insert",value:function(e,t,n){for(var r=this.root,a=d(e),i=0;i<a.length;i++)r.children[a[i]]||(r.children[a[i]]=new h,r.children[a[i]].parent=r,r.children[a[i]].word[0]=r.word[0].concat(a[i])),r=r.children[a[i]],i===a.length-1&&(r.end=!0,r.word[1]=t,r.word[2]=n)}},{key:"commonPrefixSearch",value:function(e){for(var t=[],n=this.root.children[e[0]],r=0;r<e.length&&n;r++)n.end&&t.push(n.word),n=n.children[e[r+1]];return t.length||t.push([[e[0]],0,0]),t}}]),e}();var v=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;Object(c.a)(this,e),this.vocabulary=t,this.reservedSymbolsCount=n,this.trie=new p;for(var r=this.reservedSymbolsCount;r<this.vocabulary.length;r++)this.trie.insert(this.vocabulary[r][0],this.vocabulary[r][1],r)}return Object(u.a)(e,[{key:"encode",value:function(e){var t=[],n=[],r=[];e=function(e){var t=e.normalize("NFKC");return t.length>0?"\u2581"+t.replace(/ /g,"\u2581"):t}(e);for(var a=d(e),i=0;i<=a.length;i++)t.push({}),n.push(0),r.push(0);for(var o=0;o<a.length;o++)for(var u=this.trie.commonPrefixSearch(a.slice(o)),c=0;c<u.length;c++){var s=u[c],l={key:s[0],score:s[1],index:s[2]},f=s[0].length;null==t[o+f][o]&&(t[o+f][o]=[]),t[o+f][o].push(l)}for(var h=0;h<=a.length;h++)for(var p in t[h])for(var v=t[h][p],m=0;m<v.length;m++){var b=v[m],g=b.score+r[h-b.key.length];(0===r[h]||g>=r[h])&&(r[h]=g,n[h]=v[m].index)}for(var y=[],x=n.length-1;x>0;)y.push(n[x]),x-=this.vocabulary[n[x]][0].length;for(var O=[],k=!1,w=0;w<y.length;w++){var j=y[w];k&&0===j||O.push(j),k=0===j}return O.reverse()}}]),e}();function m(e){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.util.fetch(t);case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new x,e.next=3,t.load();case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,[{key:"loadModel",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(f.a)("https://tfhub.dev/tensorflow/tfjs-model/universal-sentence-encoder-lite/1/default/1",{fromTFHub:!0}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,n,a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.loadModel(),m("".concat("https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder","/vocab.json"))]);case 2:t=e.sent,n=Object(r.a)(t,2),a=n[0],o=n[1],this.model=a,this.tokenizer=new v(o);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"embed",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r,a,o,u,c,s,f,d=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for("string"==typeof t&&(t=[t]),n=t.map((function(e){return d.tokenizer.encode(e)})),r=n.map((function(e,t){return e.map((function(e,n){return[t,n]}))})),a=[],o=0;o<r.length;o++)a=a.concat(r[o]);return u=Object(l.tensor2d)(a,[a.length,2],"int32"),c=Object(l.tensor1d)(l.util.flatten(n),"int32"),s={indices:u,values:c},e.next=9,this.model.executeAsync(s);case 9:return f=e.sent,e.abrupt("return",(u.dispose(),c.dispose(),f));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},,,,function(e,t,n){"use strict";var r=n(124),a=60103,i=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var o=60109,u=60110,c=60112;t.Suspense=60113;var s=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var f=Symbol.for;a=f("react.element"),i=f("react.portal"),t.Fragment=f("react.fragment"),t.StrictMode=f("react.strict_mode"),t.Profiler=f("react.profiler"),o=f("react.provider"),u=f("react.context"),c=f("react.forward_ref"),t.Suspense=f("react.suspense"),s=f("react.memo"),l=f("react.lazy")}var d="function"===typeof Symbol&&Symbol.iterator;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function m(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}function b(){}function g(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=m.prototype;var y=g.prototype=new b;y.constructor=g,r(y,m.prototype),y.isPureReactComponent=!0;var x={current:null},O=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,n){var r,i={},o=null,u=null;if(null!=t)for(r in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(o=""+t.key),t)O.call(t,r)&&!k.hasOwnProperty(r)&&(i[r]=t[r]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var s=Array(c),l=0;l<c;l++)s[l]=arguments[l+2];i.children=s}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===i[r]&&(i[r]=c[r]);return{$$typeof:a,type:e,key:o,ref:u,props:i,_owner:x.current}}function j(e){return"object"===typeof e&&null!==e&&e.$$typeof===a}var _=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function E(e,t,n,r,o){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var c=!1;if(null===e)c=!0;else switch(u){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case a:case i:c=!0}}if(c)return o=o(c=e),e=""===r?"."+S(c,0):r,Array.isArray(o)?(n="",null!=e&&(n=e.replace(_,"$&/")+"/"),E(o,t,n,"",(function(e){return e}))):null!=o&&(j(o)&&(o=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,n+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+e)),t.push(o)),1;if(c=0,r=""===r?".":r+":",Array.isArray(e))for(var s=0;s<e.length;s++){var l=r+S(u=e[s],s);c+=E(u,t,n,l,o)}else if("function"===typeof(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e)))for(e=l.call(e),s=0;!(u=e.next()).done;)c+=E(u=u.value,t,n,l=r+S(u,s++),o);else if("object"===u)throw t=""+e,Error(h(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function C(e,t,n){if(null==e)return e;var r=[],a=0;return E(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function A(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var N={current:null};function T(){var e=N.current;if(null===e)throw Error(h(321));return e}var I={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:x,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:C,forEach:function(e,t,n){C(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return C(e,(function(){t++})),t},toArray:function(e){return C(e,(function(e){return e}))||[]},only:function(e){if(!j(e))throw Error(h(143));return e}},t.Component=m,t.PureComponent=g,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(h(267,e));var i=r({},e.props),o=e.key,u=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(u=t.ref,c=x.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)O.call(t,l)&&!k.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==s?s[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){s=Array(l);for(var f=0;f<l;f++)s[f]=arguments[f+2];i.children=s}return{$$typeof:a,type:e.type,key:o,ref:u,props:i,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:u,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=w,t.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=j,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:s,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return T().useCallback(e,t)},t.useContext=function(e,t){return T().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return T().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return T().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return T().useLayoutEffect(e,t)},t.useMemo=function(e,t){return T().useMemo(e,t)},t.useReducer=function(e,t,n){return T().useReducer(e,t,n)},t.useRef=function(e){return T().useRef(e)},t.useState=function(e){return T().useState(e)},t.version="17.0.2"},function(e,t,n){"use strict";var r=n(44),a=n(124),i=n(330);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(o(227));var u=new Set,c={};function s(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(c[e]=t,e=0;e<t.length;e++)u.add(t[e])}var f=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h=Object.prototype.hasOwnProperty,p={},v={};function m(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){b[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];b[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){b[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){b[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){b[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){b[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){b[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){b[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){b[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function x(e,t,n,r){var a=b.hasOwnProperty(t)?b[t]:null;(null!==a?0===a.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!h.call(v,e)||!h.call(p,e)&&(d.test(e)?v[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);b[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);b[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);b[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){b[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),b.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){b[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var O=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=60103,w=60106,j=60107,_=60108,S=60114,E=60109,C=60110,A=60112,N=60113,T=60120,I=60115,D=60116,F=60121,M=60128,R=60129,z=60130,L=60131;if("function"===typeof Symbol&&Symbol.for){var P=Symbol.for;k=P("react.element"),w=P("react.portal"),j=P("react.fragment"),_=P("react.strict_mode"),S=P("react.profiler"),E=P("react.provider"),C=P("react.context"),A=P("react.forward_ref"),N=P("react.suspense"),T=P("react.suspense_list"),I=P("react.memo"),D=P("react.lazy"),F=P("react.block"),P("react.scope"),M=P("react.opaque.id"),R=P("react.debug_trace_mode"),z=P("react.offscreen"),L=P("react.legacy_hidden")}var B,W="function"===typeof Symbol&&Symbol.iterator;function U(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=W&&e[W]||e["@@iterator"])?e:null}function V(e){if(void 0===B)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||""}return"\n"+B+e}var q=!1;function H(e,t){if(!e||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,u=i.length-1;1<=o&&0<=u&&a[o]!==i[u];)u--;for(;1<=o&&0<=u;o--,u--)if(a[o]!==i[u]){if(1!==o||1!==u)do{if(o--,0>--u||a[o]!==i[u])return"\n"+a[o].replace(" at new "," at ")}while(1<=o&&0<=u);break}}}finally{q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?V(e):""}function G(e){switch(e.tag){case 5:return V(e.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 22:return e=H(e.type._render,!1);case 1:return e=H(e.type,!0);default:return""}}function K(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case j:return"Fragment";case w:return"Portal";case S:return"Profiler";case _:return"StrictMode";case N:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case I:return K(e.type);case F:return K(e._render);case D:t=e._payload,e=e._init;try{return K(e(t))}catch(n){}}return null}function X(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Y(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function $(e){e._valueTracker||(e._valueTracker=function(e){var t=Y(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Y(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return a({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=X(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=X(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ae(e,t.type,n):t.hasOwnProperty("defaultValue")&&ae(e,t.type,X(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ae(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ie(e,t){return e=a({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function oe(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+X(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ue(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return a({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ce(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:X(n)}}function se(e,t){var n=X(t.value),r=X(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var fe="http://www.w3.org/1999/xhtml",de="http://www.w3.org/2000/svg";function he(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?he(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ve,me,be=(me=function(e,t){if(e.namespaceURI!==de||"innerHTML"in e)e.innerHTML=t;else{for((ve=ve||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ve.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return me(e,t)}))}:me);function ge(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ye={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xe=["Webkit","ms","Moz","O"];function Oe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||ye.hasOwnProperty(e)&&ye[e]?(""+t).trim():t+"px"}function ke(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=Oe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(ye).forEach((function(e){xe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ye[t]=ye[e]}))}));var we=a({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function je(e,t){if(t){if(we[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Ce=null,Ae=null;function Ne(e){if(e=ea(e)){if("function"!==typeof Ee)throw Error(o(280));var t=e.stateNode;t&&(t=na(t),Ee(e.stateNode,e.type,t))}}function Te(e){Ce?Ae?Ae.push(e):Ae=[e]:Ce=e}function Ie(){if(Ce){var e=Ce,t=Ae;if(Ae=Ce=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function De(e,t){return e(t)}function Fe(e,t,n,r,a){return e(t,n,r,a)}function Me(){}var Re=De,ze=!1,Le=!1;function Pe(){null===Ce&&null===Ae||(Me(),Ie())}function Be(e,t){var n=e.stateNode;if(null===n)return null;var r=na(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var We=!1;if(f)try{var Ue={};Object.defineProperty(Ue,"passive",{get:function(){We=!0}}),window.addEventListener("test",Ue,Ue),window.removeEventListener("test",Ue,Ue)}catch(me){We=!1}function Ve(e,t,n,r,a,i,o,u,c){var s=Array.prototype.slice.call(arguments,3);try{t.apply(n,s)}catch(l){this.onError(l)}}var qe=!1,He=null,Ge=!1,Ke=null,Xe={onError:function(e){qe=!0,He=e}};function Ye(e,t,n,r,a,i,o,u,c){qe=!1,He=null,Ve.apply(Xe,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Qe(e){if($e(e)!==e)throw Error(o(188))}function Ze(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return Qe(a),e;if(i===r)return Qe(a),t;i=i.sibling}throw Error(o(188))}if(n.return!==r.return)n=a,r=i;else{for(var u=!1,c=a.child;c;){if(c===n){u=!0,n=a,r=i;break}if(c===r){u=!0,r=a,n=i;break}c=c.sibling}if(!u){for(c=i.child;c;){if(c===n){u=!0,n=i,r=a;break}if(c===r){u=!0,r=i,n=a;break}c=c.sibling}if(!u)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,at,it=!1,ot=[],ut=null,ct=null,st=null,lt=new Map,ft=new Map,dt=[],ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(e,t,n,r,a){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:a,targetContainers:[r]}}function vt(e,t){switch(e){case"focusin":case"focusout":ut=null;break;case"dragenter":case"dragleave":ct=null;break;case"mouseover":case"mouseout":st=null;break;case"pointerover":case"pointerout":lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ft.delete(t.pointerId)}}function mt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e=pt(t,n,r,a,i),null!==t&&(null!==(t=ea(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function bt(e){var t=Zr(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Je(n)))return e.blockedOn=t,void at(e.lanePriority,(function(){i.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function gt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ea(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function yt(e,t,n){gt(e)&&n.delete(t)}function xt(){for(it=!1;0<ot.length;){var e=ot[0];if(null!==e.blockedOn){null!==(e=ea(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&ot.shift()}null!==ut&&gt(ut)&&(ut=null),null!==ct&&gt(ct)&&(ct=null),null!==st&&gt(st)&&(st=null),lt.forEach(yt),ft.forEach(yt)}function Ot(e,t){e.blockedOn===t&&(e.blockedOn=null,it||(it=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,xt)))}function kt(e){function t(t){return Ot(t,e)}if(0<ot.length){Ot(ot[0],e);for(var n=1;n<ot.length;n++){var r=ot[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==ut&&Ot(ut,e),null!==ct&&Ot(ct,e),null!==st&&Ot(st,e),lt.forEach(t),ft.forEach(t),n=0;n<dt.length;n++)(r=dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<dt.length&&null===(n=dt[0]).blockedOn;)bt(n),null===n.blockedOn&&dt.shift()}function wt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var jt={animationend:wt("Animation","AnimationEnd"),animationiteration:wt("Animation","AnimationIteration"),animationstart:wt("Animation","AnimationStart"),transitionend:wt("Transition","TransitionEnd")},_t={},St={};function Et(e){if(_t[e])return _t[e];if(!jt[e])return e;var t,n=jt[e];for(t in n)if(n.hasOwnProperty(t)&&t in St)return _t[e]=n[t];return e}f&&(St=document.createElement("div").style,"AnimationEvent"in window||(delete jt.animationend.animation,delete jt.animationiteration.animation,delete jt.animationstart.animation),"TransitionEvent"in window||delete jt.transitionend.transition);var Ct=Et("animationend"),At=Et("animationiteration"),Nt=Et("animationstart"),Tt=Et("transitionend"),It=new Map,Dt=new Map,Ft=["abort","abort",Ct,"animationEnd",At,"animationIteration",Nt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Tt,"transitionEnd","waiting","waiting"];function Mt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],a=e[n+1];a="on"+(a[0].toUpperCase()+a.slice(1)),Dt.set(r,t),It.set(r,a),s(a,[r])}}(0,i.unstable_now)();var Rt=8;function zt(e){if(0!==(1&e))return Rt=15,1;if(0!==(2&e))return Rt=14,2;if(0!==(4&e))return Rt=13,4;var t=24&e;return 0!==t?(Rt=12,t):0!==(32&e)?(Rt=11,32):0!==(t=192&e)?(Rt=10,t):0!==(256&e)?(Rt=9,256):0!==(t=3584&e)?(Rt=8,t):0!==(4096&e)?(Rt=7,4096):0!==(t=4186112&e)?(Rt=6,t):0!==(t=62914560&e)?(Rt=5,t):67108864&e?(Rt=4,67108864):0!==(134217728&e)?(Rt=3,134217728):0!==(t=805306368&e)?(Rt=2,t):0!==(1073741824&e)?(Rt=1,1073741824):(Rt=8,e)}function Lt(e,t){var n=e.pendingLanes;if(0===n)return Rt=0;var r=0,a=0,i=e.expiredLanes,o=e.suspendedLanes,u=e.pingedLanes;if(0!==i)r=i,a=Rt=15;else if(0!==(i=134217727&n)){var c=i&~o;0!==c?(r=zt(c),a=Rt):0!==(u&=i)&&(r=zt(u),a=Rt)}else 0!==(i=n&~o)?(r=zt(i),a=Rt):0!==u&&(r=zt(u),a=Rt);if(0===r)return 0;if(r=n&((0>(r=31-qt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&o)){if(zt(t),a<=Rt)return t;Rt=a}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-qt(t)),r|=e[n],t&=~a;return r}function Pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Bt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Wt(24&~t))?Bt(10,t):e;case 10:return 0===(e=Wt(192&~t))?Bt(8,t):e;case 8:return 0===(e=Wt(3584&~t))&&(0===(e=Wt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Wt(805306368&~t))&&(t=268435456),t}throw Error(o(358,e))}function Wt(e){return e&-e}function Ut(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Vt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-qt(t)]=n}var qt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Ht(e)/Gt|0)|0},Ht=Math.log,Gt=Math.LN2;var Kt=i.unstable_UserBlockingPriority,Xt=i.unstable_runWithPriority,Yt=!0;function $t(e,t,n,r){ze||Me();var a=Qt,i=ze;ze=!0;try{Fe(a,e,t,n,r)}finally{(ze=i)||Pe()}}function Jt(e,t,n,r){Xt(Kt,Qt.bind(null,e,t,n,r))}function Qt(e,t,n,r){var a;if(Yt)if((a=0===(4&t))&&0<ot.length&&-1<ht.indexOf(e))e=pt(null,e,t,n,r),ot.push(e);else{var i=Zt(e,t,n,r);if(null===i)a&&vt(e,r);else{if(a){if(-1<ht.indexOf(e))return e=pt(i,e,t,n,r),void ot.push(e);if(function(e,t,n,r,a){switch(t){case"focusin":return ut=mt(ut,e,t,n,r,a),!0;case"dragenter":return ct=mt(ct,e,t,n,r,a),!0;case"mouseover":return st=mt(st,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return lt.set(i,mt(lt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,ft.set(i,mt(ft.get(i)||null,e,t,n,r,a)),!0}return!1}(i,e,t,n,r))return;vt(e,r)}Ir(e,t,r,null,n)}}}function Zt(e,t,n,r){var a=Se(r);if(null!==(a=Zr(a))){var i=$e(a);if(null===i)a=null;else{var o=i.tag;if(13===o){if(null!==(a=Je(i)))return a;a=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null)}}return Ir(e,t,r,a,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,a="value"in en?en.value:en.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return nn=a.slice(e,1<t?1-t:void 0)}function an(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function un(){return!1}function cn(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?on:un,this.isPropagationStopped=un,this}return a(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var sn,ln,fn,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=cn(dn),pn=a({},dn,{view:0,detail:0}),vn=cn(pn),mn=a({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fn&&(fn&&"mousemove"===e.type?(sn=e.screenX-fn.screenX,ln=e.screenY-fn.screenY):ln=sn=0,fn=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),bn=cn(mn),gn=cn(a({},mn,{dataTransfer:0})),yn=cn(a({},pn,{relatedTarget:0})),xn=cn(a({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),On=cn(a({},dn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),kn=cn(a({},dn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function En(){return Sn}var Cn=cn(a({},pn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=an(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?jn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?an(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?an(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),An=cn(a({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=cn(a({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Tn=cn(a({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=cn(a({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Dn=[9,13,27,32],Fn=f&&"CompositionEvent"in window,Mn=null;f&&"documentMode"in document&&(Mn=document.documentMode);var Rn=f&&"TextEvent"in window&&!Mn,zn=f&&(!Fn||Mn&&8<Mn&&11>=Mn),Ln=String.fromCharCode(32),Pn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Hn(e,t,n,r){Te(r),0<(t=Fr(t,"onChange")).length&&(n=new hn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Xn(e){Sr(e,0)}function Yn(e){if(J(ta(e)))return e}function $n(e,t){if("change"===e)return t}var Jn=!1;if(f){var Qn;if(f){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Qn=Zn}else Qn=!1;Jn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Kn=Gn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];if(Hn(t,Kn,e,Se(e)),e=Xn,ze)e(t);else{ze=!0;try{De(e,t)}finally{ze=!1,Pe()}}}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function ir(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},cr=Object.prototype.hasOwnProperty;function sr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!cr.call(t,n[r])||!ur(e[n[r]],t[n[r]]))return!1;return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var vr=f&&"documentMode"in document&&11>=document.documentMode,mr=null,br=null,gr=null,yr=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==mr||mr!==Q(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&sr(gr,r)||(gr=r,0<(r=Fr(br,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}Mt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Mt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Mt(Ft,2);for(var Or="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),kr=0;kr<Or.length;kr++)Dt.set(Or[kr],0);l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(wr));function _r(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,i,u,c,s){if(Ye.apply(this,arguments),qe){if(!qe)throw Error(o(198));var l=He;qe=!1,He=null,Ge||(Ge=!0,Ke=l)}}(r,t,void 0,e),e.currentTarget=null}function Sr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],c=u.instance,s=u.currentTarget;if(u=u.listener,c!==i&&a.isPropagationStopped())break e;_r(a,u,s),i=c}else for(o=0;o<r.length;o++){if(c=(u=r[o]).instance,s=u.currentTarget,u=u.listener,c!==i&&a.isPropagationStopped())break e;_r(a,u,s),i=c}}}if(Ge)throw e=Ke,Ge=!1,Ke=null,e}function Er(e,t){var n=ra(t),r=e+"__bubble";n.has(r)||(Tr(t,e,2,!1),n.add(r))}var Cr="_reactListening"+Math.random().toString(36).slice(2);function Ar(e){e[Cr]||(e[Cr]=!0,u.forEach((function(t){jr.has(t)||Nr(t,!1,e,null),Nr(t,!0,e,null)})))}function Nr(e,t,n,r){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=n;if("selectionchange"===e&&9!==n.nodeType&&(i=n.ownerDocument),null!==r&&!t&&jr.has(e)){if("scroll"!==e)return;a|=2,i=r}var o=ra(i),u=e+"__"+(t?"capture":"bubble");o.has(u)||(t&&(a|=4),Tr(i,e,a,t),o.add(u))}function Tr(e,t,n,r){var a=Dt.get(t);switch(void 0===a?2:a){case 0:a=$t;break;case 1:a=Jt;break;default:a=Qt}n=a.bind(null,t,n,e),a=void 0,!We||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Ir(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var u=r.stateNode.containerInfo;if(u===a||8===u.nodeType&&u.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;o=o.return}for(;null!==u;){if(null===(o=Zr(u)))return;if(5===(c=o.tag)||6===c){r=i=o;continue e}u=u.parentNode}}r=r.return}!function(e,t,n){if(Le)return e(t,n);Le=!0;try{Re(e,t,n)}finally{Le=!1,Pe()}}((function(){var r=i,a=Se(n),o=[];e:{var u=It.get(e);if(void 0!==u){var c=hn,s=e;switch(e){case"keypress":if(0===an(n))break e;case"keydown":case"keyup":c=Cn;break;case"focusin":s="focus",c=yn;break;case"focusout":s="blur",c=yn;break;case"beforeblur":case"afterblur":c=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=bn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Nn;break;case Ct:case At:case Nt:c=xn;break;case Tt:c=Tn;break;case"scroll":c=vn;break;case"wheel":c=In;break;case"copy":case"cut":case"paste":c=On;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=An}var l=0!==(4&t),f=!l&&"scroll"===e,d=l?null!==u?u+"Capture":null:u;l=[];for(var h,p=r;null!==p;){var v=(h=p).stateNode;if(5===h.tag&&null!==v&&(h=v,null!==d&&(null!=(v=Be(p,d))&&l.push(Dr(p,v,h)))),f)break;p=p.return}0<l.length&&(u=new c(u,s,null,n,a),o.push({event:u,listeners:l}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(u="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(s=n.relatedTarget||n.fromElement)||!Zr(s)&&!s[Jr])&&(c||u)&&(u=a.window===a?a:(u=a.ownerDocument)?u.defaultView||u.parentWindow:window,c?(c=r,null!==(s=(s=n.relatedTarget||n.toElement)?Zr(s):null)&&(s!==(f=$e(s))||5!==s.tag&&6!==s.tag)&&(s=null)):(c=null,s=r),c!==s)){if(l=bn,v="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=An,v="onPointerLeave",d="onPointerEnter",p="pointer"),f=null==c?u:ta(c),h=null==s?u:ta(s),(u=new l(v,p+"leave",c,n,a)).target=f,u.relatedTarget=h,v=null,Zr(a)===r&&((l=new l(d,p+"enter",s,n,a)).target=h,l.relatedTarget=f,v=l),f=v,c&&s)e:{for(d=s,p=0,h=l=c;h;h=Mr(h))p++;for(h=0,v=d;v;v=Mr(v))h++;for(;0<p-h;)l=Mr(l),p--;for(;0<h-p;)d=Mr(d),h--;for(;p--;){if(l===d||null!==d&&l===d.alternate)break e;l=Mr(l),d=Mr(d)}l=null}else l=null;null!==c&&Rr(o,u,c,l,!1),null!==s&&null!==f&&Rr(o,f,s,l,!0)}if("select"===(c=(u=r?ta(r):window).nodeName&&u.nodeName.toLowerCase())||"input"===c&&"file"===u.type)var m=$n;else if(qn(u))if(Jn)m=or;else{m=ar;var b=rr}else(c=u.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===u.type||"radio"===u.type)&&(m=ir);switch(m&&(m=m(e,r))?Hn(o,m,n,a):(b&&b(e,u,r),"focusout"===e&&(b=u._wrapperState)&&b.controlled&&"number"===u.type&&ae(u,"number",u.value)),b=r?ta(r):window,e){case"focusin":(qn(b)||"true"===b.contentEditable)&&(mr=b,br=r,gr=null);break;case"focusout":gr=br=mr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,xr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(o,n,a)}var g;if(Fn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Un?Bn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(zn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==y?"onCompositionEnd"===y&&Un&&(g=rn()):(tn="value"in(en=a)?en.value:en.textContent,Un=!0)),0<(b=Fr(r,y)).length&&(y=new kn(y,e,null,n,a),o.push({event:y,listeners:b}),g?y.data=g:null!==(g=Wn(n))&&(y.data=g))),(g=Rn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Pn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Pn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Fn&&Bn(e,t)?(e=rn(),nn=tn=en=null,Un=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zn&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(r=Fr(r,"onBeforeInput")).length&&(a=new kn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=g))}Sr(o,t)}))}function Dr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Be(e,n))&&r.unshift(Dr(e,i,a)),null!=(i=Be(e,t))&&r.push(Dr(e,i,a))),e=e.return}return r}function Mr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Rr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var u=n,c=u.alternate,s=u.stateNode;if(null!==c&&c===r)break;5===u.tag&&null!==s&&(u=s,a?null!=(c=Be(n,i))&&o.unshift(Dr(n,c,u)):a||null!=(c=Be(n,i))&&o.push(Dr(n,c,u))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}function zr(){}var Lr=null,Pr=null;function Br(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Wr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Ur="function"===typeof setTimeout?setTimeout:void 0,Vr="function"===typeof clearTimeout?clearTimeout:void 0;function qr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Hr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Gr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Kr=0;var Xr=Math.random().toString(36).slice(2),Yr="__reactFiber$"+Xr,$r="__reactProps$"+Xr,Jr="__reactContainer$"+Xr,Qr="__reactEvents$"+Xr;function Zr(e){var t=e[Yr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jr]||n[Yr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Gr(e);null!==e;){if(n=e[Yr])return n;e=Gr(e)}return t}n=(e=n).parentNode}return null}function ea(e){return!(e=e[Yr]||e[Jr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ta(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function na(e){return e[$r]||null}function ra(e){var t=e[Qr];return void 0===t&&(t=e[Qr]=new Set),t}var aa=[],ia=-1;function oa(e){return{current:e}}function ua(e){0>ia||(e.current=aa[ia],aa[ia]=null,ia--)}function ca(e,t){ia++,aa[ia]=e.current,e.current=t}var sa={},la=oa(sa),fa=oa(!1),da=sa;function ha(e,t){var n=e.type.contextTypes;if(!n)return sa;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function pa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function va(){ua(fa),ua(la)}function ma(e,t,n){if(la.current!==sa)throw Error(o(168));ca(la,t),ca(fa,n)}function ba(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(o(108,K(t)||"Unknown",i));return a({},n,r)}function ga(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||sa,da=la.current,ca(la,e),ca(fa,fa.current),!0}function ya(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=ba(e,t,da),r.__reactInternalMemoizedMergedChildContext=e,ua(fa),ua(la),ca(la,e)):ua(fa),ca(fa,n)}var xa=null,Oa=null,ka=i.unstable_runWithPriority,wa=i.unstable_scheduleCallback,ja=i.unstable_cancelCallback,_a=i.unstable_shouldYield,Sa=i.unstable_requestPaint,Ea=i.unstable_now,Ca=i.unstable_getCurrentPriorityLevel,Aa=i.unstable_ImmediatePriority,Na=i.unstable_UserBlockingPriority,Ta=i.unstable_NormalPriority,Ia=i.unstable_LowPriority,Da=i.unstable_IdlePriority,Fa={},Ma=void 0!==Sa?Sa:function(){},Ra=null,za=null,La=!1,Pa=Ea(),Ba=1e4>Pa?Ea:function(){return Ea()-Pa};function Wa(){switch(Ca()){case Aa:return 99;case Na:return 98;case Ta:return 97;case Ia:return 96;case Da:return 95;default:throw Error(o(332))}}function Ua(e){switch(e){case 99:return Aa;case 98:return Na;case 97:return Ta;case 96:return Ia;case 95:return Da;default:throw Error(o(332))}}function Va(e,t){return e=Ua(e),ka(e,t)}function qa(e,t,n){return e=Ua(e),wa(e,t,n)}function Ha(){if(null!==za){var e=za;za=null,ja(e)}Ga()}function Ga(){if(!La&&null!==Ra){La=!0;var e=0;try{var t=Ra;Va(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Ra=null}catch(n){throw null!==Ra&&(Ra=Ra.slice(e+1)),wa(Aa,Ha),n}finally{La=!1}}}var Ka=O.ReactCurrentBatchConfig;function Xa(e,t){if(e&&e.defaultProps){for(var n in t=a({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Ya=oa(null),$a=null,Ja=null,Qa=null;function Za(){Qa=Ja=$a=null}function ei(e){var t=Ya.current;ua(Ya),e.type._context._currentValue=t}function ti(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function ni(e,t){$a=e,Qa=Ja=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Fo=!0),e.firstContext=null)}function ri(e,t){if(Qa!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(Qa=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Ja){if(null===$a)throw Error(o(308));Ja=t,$a.dependencies={lanes:0,firstContext:t,responders:null}}else Ja=Ja.next=t;return e._currentValue}var ai=!1;function ii(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ui(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ci(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function si(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function li(e,t,n,r){var i=e.updateQueue;ai=!1;var o=i.firstBaseUpdate,u=i.lastBaseUpdate,c=i.shared.pending;if(null!==c){i.shared.pending=null;var s=c,l=s.next;s.next=null,null===u?o=l:u.next=l,u=s;var f=e.alternate;if(null!==f){var d=(f=f.updateQueue).lastBaseUpdate;d!==u&&(null===d?f.firstBaseUpdate=l:d.next=l,f.lastBaseUpdate=s)}}if(null!==o){for(d=i.baseState,u=0,f=l=s=null;;){c=o.lane;var h=o.eventTime;if((r&c)===c){null!==f&&(f=f.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,v=o;switch(c=t,h=n,v.tag){case 1:if("function"===typeof(p=v.payload)){d=p.call(h,d,c);break e}d=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(c="function"===typeof(p=v.payload)?p.call(h,d,c):p)||void 0===c)break e;d=a({},d,c);break e;case 2:ai=!0}}null!==o.callback&&(e.flags|=32,null===(c=i.effects)?i.effects=[o]:c.push(o))}else h={eventTime:h,lane:c,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===f?(l=f=h,s=d):f=f.next=h,u|=c;if(null===(o=o.next)){if(null===(c=i.shared.pending))break;o=c.next,c.next=null,i.lastBaseUpdate=c,i.shared.pending=null}}null===f&&(s=d),i.baseState=s,i.firstBaseUpdate=l,i.lastBaseUpdate=f,Lu|=u,e.lanes=u,e.memoizedState=d}}function fi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(o(191,a));a.call(r)}}}var di=(new r.Component).refs;function hi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:a({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var pi={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=sc(),a=lc(e),i=ui(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ci(e,i),fc(e,a,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=sc(),a=lc(e),i=ui(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ci(e,i),fc(e,a,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=sc(),r=lc(e),a=ui(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),ci(e,a),fc(e,r,n)}};function vi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(a,i))}function mi(e,t,n){var r=!1,a=sa,i=t.contextType;return"object"===typeof i&&null!==i?i=ri(i):(a=pa(t)?da:la.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?ha(e,a):sa),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=pi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function bi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pi.enqueueReplaceState(t,t.state,null)}function gi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=di,ii(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=ri(i):(i=pa(t)?da:la.current,a.context=ha(e,i)),li(e,n,a,r),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(hi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&pi.enqueueReplaceState(a,a.state,null),li(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4)}var yi=Array.isArray;function xi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=r.refs;t===di&&(t=r.refs={}),null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Oi(e,t){if("textarea"!==e.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function ki(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Vc(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function u(t){return e&&null===t.alternate&&(t.flags=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Kc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function s(e,t,n,r){return null!==t&&t.elementType===n.type?((r=a(t,n.props)).ref=xi(e,t,n),r.return=e,r):((r=qc(n.type,n.key,n.props,null,e.mode,r)).ref=xi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Xc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Hc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Kc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=qc(t.type,t.key,t.props,null,e.mode,n)).ref=xi(e,null,t),n.return=e,n;case w:return(t=Xc(t,e.mode,n)).return=e,t}if(yi(t)||U(t))return(t=Hc(t,e.mode,n,null)).return=e,t;Oi(e,t)}return null}function h(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==a?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===a?n.type===j?f(e,t,n.props.children,r,a):s(e,t,n,r):null;case w:return n.key===a?l(e,t,n,r):null}if(yi(n)||U(n))return null!==a?null:f(e,t,n,r,null);Oi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return e=e.get(null===r.key?n:r.key)||null,r.type===j?f(t,e,r.props.children,a,r.key):s(t,e,r,a);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a)}if(yi(r)||U(r))return f(t,e=e.get(n)||null,r,a,null);Oi(t,r)}return null}function v(a,o,u,c){for(var s=null,l=null,f=o,v=o=0,m=null;null!==f&&v<u.length;v++){f.index>v?(m=f,f=null):m=f.sibling;var b=h(a,f,u[v],c);if(null===b){null===f&&(f=m);break}e&&f&&null===b.alternate&&t(a,f),o=i(b,o,v),null===l?s=b:l.sibling=b,l=b,f=m}if(v===u.length)return n(a,f),s;if(null===f){for(;v<u.length;v++)null!==(f=d(a,u[v],c))&&(o=i(f,o,v),null===l?s=f:l.sibling=f,l=f);return s}for(f=r(a,f);v<u.length;v++)null!==(m=p(f,a,v,u[v],c))&&(e&&null!==m.alternate&&f.delete(null===m.key?v:m.key),o=i(m,o,v),null===l?s=m:l.sibling=m,l=m);return e&&f.forEach((function(e){return t(a,e)})),s}function m(a,u,c,s){var l=U(c);if("function"!==typeof l)throw Error(o(150));if(null==(c=l.call(c)))throw Error(o(151));for(var f=l=null,v=u,m=u=0,b=null,g=c.next();null!==v&&!g.done;m++,g=c.next()){v.index>m?(b=v,v=null):b=v.sibling;var y=h(a,v,g.value,s);if(null===y){null===v&&(v=b);break}e&&v&&null===y.alternate&&t(a,v),u=i(y,u,m),null===f?l=y:f.sibling=y,f=y,v=b}if(g.done)return n(a,v),l;if(null===v){for(;!g.done;m++,g=c.next())null!==(g=d(a,g.value,s))&&(u=i(g,u,m),null===f?l=g:f.sibling=g,f=g);return l}for(v=r(a,v);!g.done;m++,g=c.next())null!==(g=p(v,a,m,g.value,s))&&(e&&null!==g.alternate&&v.delete(null===g.key?m:g.key),u=i(g,u,m),null===f?l=g:f.sibling=g,f=g);return e&&v.forEach((function(e){return t(a,e)})),l}return function(e,r,i,c){var s="object"===typeof i&&null!==i&&i.type===j&&null===i.key;s&&(i=i.props.children);var l="object"===typeof i&&null!==i;if(l)switch(i.$$typeof){case k:e:{for(l=i.key,s=r;null!==s;){if(s.key===l){switch(s.tag){case 7:if(i.type===j){n(e,s.sibling),(r=a(s,i.props.children)).return=e,e=r;break e}break;default:if(s.elementType===i.type){n(e,s.sibling),(r=a(s,i.props)).ref=xi(e,s,i),r.return=e,e=r;break e}}n(e,s);break}t(e,s),s=s.sibling}i.type===j?((r=Hc(i.props.children,e.mode,c,i.key)).return=e,e=r):((c=qc(i.type,i.key,i.props,null,e.mode,c)).ref=xi(e,r,i),c.return=e,e=c)}return u(e);case w:e:{for(s=i.key;null!==r;){if(r.key===s){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(e,r.sibling),(r=a(r,i.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Xc(i,e.mode,c)).return=e,e=r}return u(e)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==r&&6===r.tag?(n(e,r.sibling),(r=a(r,i)).return=e,e=r):(n(e,r),(r=Kc(i,e.mode,c)).return=e,e=r),u(e);if(yi(i))return v(e,r,i,c);if(U(i))return m(e,r,i,c);if(l&&Oi(e,i),"undefined"===typeof i&&!s)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(o(152,K(e.type)||"Component"))}return n(e,r)}}var wi=ki(!0),ji=ki(!1),_i={},Si=oa(_i),Ei=oa(_i),Ci=oa(_i);function Ai(e){if(e===_i)throw Error(o(174));return e}function Ni(e,t){switch(ca(Ci,t),ca(Ei,e),ca(Si,_i),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:t=pe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ua(Si),ca(Si,t)}function Ti(){ua(Si),ua(Ei),ua(Ci)}function Ii(e){Ai(Ci.current);var t=Ai(Si.current),n=pe(t,e.type);t!==n&&(ca(Ei,e),ca(Si,n))}function Di(e){Ei.current===e&&(ua(Si),ua(Ei))}var Fi=oa(0);function Mi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ri=null,zi=null,Li=!1;function Pi(e,t){var n=Wc(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Bi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Wi(e){if(Li){var t=zi;if(t){var n=t;if(!Bi(e,t)){if(!(t=Hr(n.nextSibling))||!Bi(e,t))return e.flags=-1025&e.flags|2,Li=!1,void(Ri=e);Pi(Ri,n)}Ri=e,zi=Hr(t.firstChild)}else e.flags=-1025&e.flags|2,Li=!1,Ri=e}}function Ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ri=e}function Vi(e){if(e!==Ri)return!1;if(!Li)return Ui(e),Li=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Wr(t,e.memoizedProps))for(t=zi;t;)Pi(e,t),t=Hr(t.nextSibling);if(Ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){zi=Hr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}zi=null}}else zi=Ri?Hr(e.stateNode.nextSibling):null;return!0}function qi(){zi=Ri=null,Li=!1}var Hi=[];function Gi(){for(var e=0;e<Hi.length;e++)Hi[e]._workInProgressVersionPrimary=null;Hi.length=0}var Ki=O.ReactCurrentDispatcher,Xi=O.ReactCurrentBatchConfig,Yi=0,$i=null,Ji=null,Qi=null,Zi=!1,eo=!1;function to(){throw Error(o(321))}function no(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function ro(e,t,n,r,a,i){if(Yi=i,$i=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ki.current=null===e||null===e.memoizedState?No:To,e=n(r,a),eo){i=0;do{if(eo=!1,!(25>i))throw Error(o(301));i+=1,Qi=Ji=null,t.updateQueue=null,Ki.current=Io,e=n(r,a)}while(eo)}if(Ki.current=Ao,t=null!==Ji&&null!==Ji.next,Yi=0,Qi=Ji=$i=null,Zi=!1,t)throw Error(o(300));return e}function ao(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Qi?$i.memoizedState=Qi=e:Qi=Qi.next=e,Qi}function io(){if(null===Ji){var e=$i.alternate;e=null!==e?e.memoizedState:null}else e=Ji.next;var t=null===Qi?$i.memoizedState:Qi.next;if(null!==t)Qi=t,Ji=e;else{if(null===e)throw Error(o(310));e={memoizedState:(Ji=e).memoizedState,baseState:Ji.baseState,baseQueue:Ji.baseQueue,queue:Ji.queue,next:null},null===Qi?$i.memoizedState=Qi=e:Qi=Qi.next=e}return Qi}function oo(e,t){return"function"===typeof t?t(e):t}function uo(e){var t=io(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=Ji,a=r.baseQueue,i=n.pending;if(null!==i){if(null!==a){var u=a.next;a.next=i.next,i.next=u}r.baseQueue=a=i,n.pending=null}if(null!==a){a=a.next,r=r.baseState;var c=u=i=null,s=a;do{var l=s.lane;if((Yi&l)===l)null!==c&&(c=c.next={lane:0,action:s.action,eagerReducer:s.eagerReducer,eagerState:s.eagerState,next:null}),r=s.eagerReducer===e?s.eagerState:e(r,s.action);else{var f={lane:l,action:s.action,eagerReducer:s.eagerReducer,eagerState:s.eagerState,next:null};null===c?(u=c=f,i=r):c=c.next=f,$i.lanes|=l,Lu|=l}s=s.next}while(null!==s&&s!==a);null===c?i=r:c.next=u,ur(r,t.memoizedState)||(Fo=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function co(e){var t=io(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var u=a=a.next;do{i=e(i,u.action),u=u.next}while(u!==a);ur(i,t.memoizedState)||(Fo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function so(e,t,n){var r=t._getVersion;r=r(t._source);var a=t._workInProgressVersionPrimary;if(null!==a?e=a===r:(e=e.mutableReadLanes,(e=(Yi&e)===e)&&(t._workInProgressVersionPrimary=r,Hi.push(t))),e)return n(t._source);throw Hi.push(t),Error(o(350))}function lo(e,t,n,r){var a=Nu;if(null===a)throw Error(o(349));var i=t._getVersion,u=i(t._source),c=Ki.current,s=c.useState((function(){return so(a,t,n)})),l=s[1],f=s[0];s=Qi;var d=e.memoizedState,h=d.refs,p=h.getSnapshot,v=d.source;d=d.subscribe;var m=$i;return e.memoizedState={refs:h,source:t,subscribe:r},c.useEffect((function(){h.getSnapshot=n,h.setSnapshot=l;var e=i(t._source);if(!ur(u,e)){e=n(t._source),ur(f,e)||(l(e),e=lc(m),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var r=a.entanglements,o=e;0<o;){var c=31-qt(o),s=1<<c;r[c]|=e,o&=~s}}}),[n,t,r]),c.useEffect((function(){return r(t._source,(function(){var e=h.getSnapshot,n=h.setSnapshot;try{n(e(t._source));var r=lc(m);a.mutableReadLanes|=r&a.pendingLanes}catch(i){n((function(){throw i}))}}))}),[t,r]),ur(p,n)&&ur(v,t)&&ur(d,r)||((e={pending:null,dispatch:null,lastRenderedReducer:oo,lastRenderedState:f}).dispatch=l=Co.bind(null,$i,e),s.queue=e,s.baseQueue=null,f=so(a,t,n),s.memoizedState=s.baseState=f),f}function fo(e,t,n){return lo(io(),e,t,n)}function ho(e){var t=ao();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:oo,lastRenderedState:e}).dispatch=Co.bind(null,$i,e),[t.memoizedState,e]}function po(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=$i.updateQueue)?(t={lastEffect:null},$i.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function vo(e){return e={current:e},ao().memoizedState=e}function mo(){return io().memoizedState}function bo(e,t,n,r){var a=ao();$i.flags|=e,a.memoizedState=po(1|t,n,void 0,void 0===r?null:r)}function go(e,t,n,r){var a=io();r=void 0===r?null:r;var i=void 0;if(null!==Ji){var o=Ji.memoizedState;if(i=o.destroy,null!==r&&no(r,o.deps))return void po(t,n,i,r)}$i.flags|=e,a.memoizedState=po(1|t,n,i,r)}function yo(e,t){return bo(516,4,e,t)}function xo(e,t){return go(516,4,e,t)}function Oo(e,t){return go(4,2,e,t)}function ko(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function wo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,go(4,2,ko.bind(null,t,e),n)}function jo(){}function _o(e,t){var n=io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&no(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function So(e,t){var n=io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&no(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Eo(e,t){var n=Wa();Va(98>n?98:n,(function(){e(!0)})),Va(97<n?97:n,(function(){var n=Xi.transition;Xi.transition=1;try{e(!1),t()}finally{Xi.transition=n}}))}function Co(e,t,n){var r=sc(),a=lc(e),i={lane:a,action:n,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===$i||null!==o&&o===$i)eo=Zi=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var u=t.lastRenderedState,c=o(u,n);if(i.eagerReducer=o,i.eagerState=c,ur(c,u))return}catch(s){}fc(e,a,r)}}var Ao={readContext:ri,useCallback:to,useContext:to,useEffect:to,useImperativeHandle:to,useLayoutEffect:to,useMemo:to,useReducer:to,useRef:to,useState:to,useDebugValue:to,useDeferredValue:to,useTransition:to,useMutableSource:to,useOpaqueIdentifier:to,unstable_isNewReconciler:!1},No={readContext:ri,useCallback:function(e,t){return ao().memoizedState=[e,void 0===t?null:t],e},useContext:ri,useEffect:yo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,bo(4,2,ko.bind(null,t,e),n)},useLayoutEffect:function(e,t){return bo(4,2,e,t)},useMemo:function(e,t){var n=ao();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ao();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Co.bind(null,$i,e),[r.memoizedState,e]},useRef:vo,useState:ho,useDebugValue:jo,useDeferredValue:function(e){var t=ho(e),n=t[0],r=t[1];return yo((function(){var t=Xi.transition;Xi.transition=1;try{r(e)}finally{Xi.transition=t}}),[e]),n},useTransition:function(){var e=ho(!1),t=e[0];return vo(e=Eo.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=ao();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},lo(r,e,t,n)},useOpaqueIdentifier:function(){if(Li){var e=!1,t=function(e){return{$$typeof:M,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Kr++).toString(36))),Error(o(355))})),n=ho(t)[1];return 0===(2&$i.mode)&&($i.flags|=516,po(5,(function(){n("r:"+(Kr++).toString(36))}),void 0,null)),t}return ho(t="r:"+(Kr++).toString(36)),t},unstable_isNewReconciler:!1},To={readContext:ri,useCallback:_o,useContext:ri,useEffect:xo,useImperativeHandle:wo,useLayoutEffect:Oo,useMemo:So,useReducer:uo,useRef:mo,useState:function(){return uo(oo)},useDebugValue:jo,useDeferredValue:function(e){var t=uo(oo),n=t[0],r=t[1];return xo((function(){var t=Xi.transition;Xi.transition=1;try{r(e)}finally{Xi.transition=t}}),[e]),n},useTransition:function(){var e=uo(oo)[0];return[mo().current,e]},useMutableSource:fo,useOpaqueIdentifier:function(){return uo(oo)[0]},unstable_isNewReconciler:!1},Io={readContext:ri,useCallback:_o,useContext:ri,useEffect:xo,useImperativeHandle:wo,useLayoutEffect:Oo,useMemo:So,useReducer:co,useRef:mo,useState:function(){return co(oo)},useDebugValue:jo,useDeferredValue:function(e){var t=co(oo),n=t[0],r=t[1];return xo((function(){var t=Xi.transition;Xi.transition=1;try{r(e)}finally{Xi.transition=t}}),[e]),n},useTransition:function(){var e=co(oo)[0];return[mo().current,e]},useMutableSource:fo,useOpaqueIdentifier:function(){return co(oo)[0]},unstable_isNewReconciler:!1},Do=O.ReactCurrentOwner,Fo=!1;function Mo(e,t,n,r){t.child=null===e?ji(t,null,n,r):wi(t,e.child,n,r)}function Ro(e,t,n,r,a){n=n.render;var i=t.ref;return ni(t,a),r=ro(e,t,n,r,i,a),null===e||Fo?(t.flags|=1,Mo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,nu(e,t,a))}function zo(e,t,n,r,a,i){if(null===e){var o=n.type;return"function"!==typeof o||Uc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=qc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Lo(e,t,o,r,a,i))}return o=e.child,0===(a&i)&&(a=o.memoizedProps,(n=null!==(n=n.compare)?n:sr)(a,r)&&e.ref===t.ref)?nu(e,t,i):(t.flags|=1,(e=Vc(o,r)).ref=t.ref,e.return=t,t.child=e)}function Lo(e,t,n,r,a,i){if(null!==e&&sr(e.memoizedProps,r)&&e.ref===t.ref){if(Fo=!1,0===(i&a))return t.lanes=e.lanes,nu(e,t,i);0!==(16384&e.flags)&&(Fo=!0)}return Wo(e,t,n,r,i)}function Po(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},yc(t,n);else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},yc(t,e),null;t.memoizedState={baseLanes:0},yc(t,null!==i?i.baseLanes:n)}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,yc(t,r);return Mo(e,t,a,n),t.child}function Bo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Wo(e,t,n,r,a){var i=pa(n)?da:la.current;return i=ha(t,i),ni(t,a),n=ro(e,t,n,r,i,a),null===e||Fo?(t.flags|=1,Mo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,nu(e,t,a))}function Uo(e,t,n,r,a){if(pa(n)){var i=!0;ga(t)}else i=!1;if(ni(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),mi(t,n,r),gi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,u=t.memoizedProps;o.props=u;var c=o.context,s=n.contextType;"object"===typeof s&&null!==s?s=ri(s):s=ha(t,s=pa(n)?da:la.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==r||c!==s)&&bi(t,o,r,s),ai=!1;var d=t.memoizedState;o.state=d,li(t,r,o,a),c=t.memoizedState,u!==r||d!==c||fa.current||ai?("function"===typeof l&&(hi(t,n,l,r),c=t.memoizedState),(u=ai||vi(t,n,u,r,d,c,s))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4)):("function"===typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=s,r=u):("function"===typeof o.componentDidMount&&(t.flags|=4),r=!1)}else{o=t.stateNode,oi(e,t),u=t.memoizedProps,s=t.type===t.elementType?u:Xa(t.type,u),o.props=s,f=t.pendingProps,d=o.context,"object"===typeof(c=n.contextType)&&null!==c?c=ri(c):c=ha(t,c=pa(n)?da:la.current);var h=n.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==f||d!==c)&&bi(t,o,r,c),ai=!1,d=t.memoizedState,o.state=d,li(t,r,o,a);var p=t.memoizedState;u!==f||d!==p||fa.current||ai?("function"===typeof h&&(hi(t,n,h,r),p=t.memoizedState),(s=ai||vi(t,n,s,r,d,p,c))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=c,r=s):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return Vo(e,t,n,r,i,a)}function Vo(e,t,n,r,a,i){Bo(e,t);var o=0!==(64&t.flags);if(!r&&!o)return a&&ya(t,n,!1),nu(e,t,i);r=t.stateNode,Do.current=t;var u=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,u,i)):Mo(e,t,u,i),t.memoizedState=r.state,a&&ya(t,n,!0),t.child}function qo(e){var t=e.stateNode;t.pendingContext?ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ma(0,t.context,!1),Ni(e,t.containerInfo)}var Ho,Go,Ko,Xo={dehydrated:null,retryLane:0};function Yo(e,t,n){var r,a=t.pendingProps,i=Fi.current,o=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(i|=1),ca(Fi,1&i),null===e?(void 0!==a.fallback&&Wi(t),e=a.children,i=a.fallback,o?(e=$o(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Xo,e):"number"===typeof a.unstable_expectedLoadTime?(e=$o(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Xo,t.lanes=33554432,e):((n=Gc({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,o?(a=Qo(e,t,a.children,a.fallback,n),o=t.child,i=e.child.memoizedState,o.memoizedState=null===i?{baseLanes:n}:{baseLanes:i.baseLanes|n},o.childLanes=e.childLanes&~n,t.memoizedState=Xo,a):(n=Jo(e,t,a.children,n),t.memoizedState=null,n))}function $o(e,t,n,r){var a=e.mode,i=e.child;return t={mode:"hidden",children:t},0===(2&a)&&null!==i?(i.childLanes=0,i.pendingProps=t):i=Gc(t,a,0,null),n=Hc(n,a,r,null),i.return=e,n.return=e,i.sibling=n,e.child=i,n}function Jo(e,t,n,r){var a=e.child;return e=a.sibling,n=Vc(a,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function Qo(e,t,n,r,a){var i=t.mode,o=e.child;e=o.sibling;var u={mode:"hidden",children:n};return 0===(2&i)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=u,null!==(o=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Vc(o,u),null!==e?r=Vc(e,r):(r=Hc(r,i,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Zo(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ti(e.return,t)}function eu(e,t,n,r,a,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,lastEffect:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a,o.lastEffect=i)}function tu(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Mo(e,t,r.children,n),0!==(2&(r=Fi.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Zo(e,n);else if(19===e.tag)Zo(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ca(Fi,r),0===(2&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Mi(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),eu(t,!1,a,n,i,t.lastEffect);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Mi(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}eu(t,!0,n,null,i,t.lastEffect);break;case"together":eu(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function nu(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lu|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Vc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Vc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function ru(e,t){if(!Li)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function au(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return pa(t.type)&&va(),null;case 3:return Ti(),ua(fa),ua(la),Gi(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Vi(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Di(t);var i=Ai(Ci.current);if(n=t.type,null!==e&&null!=t.stateNode)Go(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(o(166));return null}if(e=Ai(Si.current),Vi(t)){r=t.stateNode,n=t.type;var u=t.memoizedProps;switch(r[Yr]=t,r[$r]=u,n){case"dialog":Er("cancel",r),Er("close",r);break;case"iframe":case"object":case"embed":Er("load",r);break;case"video":case"audio":for(e=0;e<wr.length;e++)Er(wr[e],r);break;case"source":Er("error",r);break;case"img":case"image":case"link":Er("error",r),Er("load",r);break;case"details":Er("toggle",r);break;case"input":ee(r,u),Er("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!u.multiple},Er("invalid",r);break;case"textarea":ce(r,u),Er("invalid",r)}for(var s in je(n,u),e=null,u)u.hasOwnProperty(s)&&(i=u[s],"children"===s?"string"===typeof i?r.textContent!==i&&(e=["children",i]):"number"===typeof i&&r.textContent!==""+i&&(e=["children",""+i]):c.hasOwnProperty(s)&&null!=i&&"onScroll"===s&&Er("scroll",r));switch(n){case"input":$(r),re(r,u,!0);break;case"textarea":$(r),le(r);break;case"select":case"option":break;default:"function"===typeof u.onClick&&(r.onclick=zr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(s=9===i.nodeType?i:i.ownerDocument,e===fe&&(e=he(n)),e===fe?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),"select"===n&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Yr]=t,e[$r]=r,Ho(e,t),t.stateNode=e,s=_e(n,r),n){case"dialog":Er("cancel",e),Er("close",e),i=r;break;case"iframe":case"object":case"embed":Er("load",e),i=r;break;case"video":case"audio":for(i=0;i<wr.length;i++)Er(wr[i],e);i=r;break;case"source":Er("error",e),i=r;break;case"img":case"image":case"link":Er("error",e),Er("load",e),i=r;break;case"details":Er("toggle",e),i=r;break;case"input":ee(e,r),i=Z(e,r),Er("invalid",e);break;case"option":i=ie(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=a({},r,{value:void 0}),Er("invalid",e);break;case"textarea":ce(e,r),i=ue(e,r),Er("invalid",e);break;default:i=r}je(n,i);var l=i;for(u in l)if(l.hasOwnProperty(u)){var f=l[u];"style"===u?ke(e,f):"dangerouslySetInnerHTML"===u?null!=(f=f?f.__html:void 0)&&be(e,f):"children"===u?"string"===typeof f?("textarea"!==n||""!==f)&&ge(e,f):"number"===typeof f&&ge(e,""+f):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(c.hasOwnProperty(u)?null!=f&&"onScroll"===u&&Er("scroll",e):null!=f&&x(e,u,f,s))}switch(n){case"input":$(e),re(e,r,!1);break;case"textarea":$(e),le(e);break;case"option":null!=r.value&&e.setAttribute("value",""+X(r.value));break;case"select":e.multiple=!!r.multiple,null!=(u=r.value)?oe(e,!!r.multiple,u,!1):null!=r.defaultValue&&oe(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=zr)}Br(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Ko(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));n=Ai(Ci.current),Ai(Si.current),Vi(t)?(r=t.stateNode,n=t.memoizedProps,r[Yr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Yr]=t,t.stateNode=r)}return null;case 13:return ua(Fi),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Vi(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Fi.current)?0===Mu&&(Mu=3):(0!==Mu&&3!==Mu||(Mu=4),null===Nu||0===(134217727&Lu)&&0===(134217727&Pu)||vc(Nu,Iu))),(r||n)&&(t.flags|=4),null);case 4:return Ti(),null===e&&Ar(t.stateNode.containerInfo),null;case 10:return ei(t),null;case 17:return pa(t.type)&&va(),null;case 19:if(ua(Fi),null===(r=t.memoizedState))return null;if(u=0!==(64&t.flags),null===(s=r.rendering))if(u)ru(r,!1);else{if(0!==Mu||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(s=Mi(e))){for(t.flags|=64,ru(r,!1),null!==(u=s.updateQueue)&&(t.updateQueue=u,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(u=n).flags&=2,u.nextEffect=null,u.firstEffect=null,u.lastEffect=null,null===(s=u.alternate)?(u.childLanes=0,u.lanes=e,u.child=null,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,u.type=s.type,e=s.dependencies,u.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ca(Fi,1&Fi.current|2),t.child}e=e.sibling}null!==r.tail&&Ba()>Vu&&(t.flags|=64,u=!0,ru(r,!1),t.lanes=33554432)}else{if(!u)if(null!==(e=Mi(s))){if(t.flags|=64,u=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),ru(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!Li)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ba()-r.renderingStartTime>Vu&&1073741824!==n&&(t.flags|=64,u=!0,ru(r,!1),t.lanes=33554432);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=r.last)?n.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ba(),n.sibling=null,t=Fi.current,ca(Fi,u?1&t|2:1&t),n):null;case 23:case 24:return xc(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(o(156,t.tag))}function iu(e){switch(e.tag){case 1:pa(e.type)&&va();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Ti(),ua(fa),ua(la),Gi(),0!==(64&(t=e.flags)))throw Error(o(285));return e.flags=-4097&t|64,e;case 5:return Di(e),null;case 13:return ua(Fi),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return ua(Fi),null;case 4:return Ti(),null;case 10:return ei(e),null;case 23:case 24:return xc(),null;default:return null}}function ou(e,t){try{var n="",r=t;do{n+=G(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a}}function uu(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Ho=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Go=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ai(Si.current);var o,u=null;switch(n){case"input":i=Z(e,i),r=Z(e,r),u=[];break;case"option":i=ie(e,i),r=ie(e,r),u=[];break;case"select":i=a({},i,{value:void 0}),r=a({},r,{value:void 0}),u=[];break;case"textarea":i=ue(e,i),r=ue(e,r),u=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=zr)}for(f in je(n,r),n=null,i)if(!r.hasOwnProperty(f)&&i.hasOwnProperty(f)&&null!=i[f])if("style"===f){var s=i[f];for(o in s)s.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==f&&"children"!==f&&"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(c.hasOwnProperty(f)?u||(u=[]):(u=u||[]).push(f,null));for(f in r){var l=r[f];if(s=null!=i?i[f]:void 0,r.hasOwnProperty(f)&&l!==s&&(null!=l||null!=s))if("style"===f)if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(u||(u=[]),u.push(f,n)),n=l;else"dangerouslySetInnerHTML"===f?(l=l?l.__html:void 0,s=s?s.__html:void 0,null!=l&&s!==l&&(u=u||[]).push(f,l)):"children"===f?"string"!==typeof l&&"number"!==typeof l||(u=u||[]).push(f,""+l):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&(c.hasOwnProperty(f)?(null!=l&&"onScroll"===f&&Er("scroll",e),u||s===l||(u=[])):"object"===typeof l&&null!==l&&l.$$typeof===M?l.toString():(u=u||[]).push(f,l))}n&&(u=u||[]).push("style",n);var f=u;(t.updateQueue=f)&&(t.flags|=4)}},Ko=function(e,t,n,r){n!==r&&(t.flags|=4)};var cu="function"===typeof WeakMap?WeakMap:Map;function su(e,t,n){(n=ui(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ku||(Ku=!0,Xu=r),uu(0,t)},n}function lu(e,t,n){(n=ui(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return uu(0,t),r(a)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Yu?Yu=new Set([this]):Yu.add(this),uu(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var fu="function"===typeof WeakSet?WeakSet:Set;function du(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){zc(e,n)}else t.current=null}function hu(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Xa(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&qr(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(o(163))}function pu(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var a=e;r=a.next,0!==(4&(a=a.tag))&&0!==(1&a)&&(Fc(n,e),Dc(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Xa(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&fi(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}fi(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Br(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&kt(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(o(163))}function vu(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var a=n.memoizedProps.style;a=void 0!==a&&null!==a&&a.hasOwnProperty("display")?a.display:null,r.style.display=Oe("display",a)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function mu(e,t){if(Oa&&"function"===typeof Oa.onCommitFiberUnmount)try{Oa.onCommitFiberUnmount(xa,t)}catch(i){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,a=r.destroy;if(r=r.tag,void 0!==a)if(0!==(4&r))Fc(t,n);else{r=t;try{a()}catch(i){zc(r,i)}}n=n.next}while(n!==e)}break;case 1:if(du(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(i){zc(t,i)}break;case 5:du(t);break;case 4:ku(e,t)}}function bu(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function gu(e){return 5===e.tag||3===e.tag||4===e.tag}function yu(e){e:{for(var t=e.return;null!==t;){if(gu(t))break e;t=t.return}throw Error(o(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(o(161))}16&n.flags&&(ge(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||gu(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?xu(e,n,t):Ou(e,n,t)}function xu(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=zr));else if(4!==r&&null!==(e=e.child))for(xu(e,t,n),e=e.sibling;null!==e;)xu(e,t,n),e=e.sibling}function Ou(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Ou(e,t,n),e=e.sibling;null!==e;)Ou(e,t,n),e=e.sibling}function ku(e,t){for(var n,r,a=t,i=!1;;){if(!i){i=a.return;e:for(;;){if(null===i)throw Error(o(160));switch(n=i.stateNode,i.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}i=i.return}i=!0}if(5===a.tag||6===a.tag){e:for(var u=e,c=a,s=c;;)if(mu(u,s),null!==s.child&&4!==s.tag)s.child.return=s,s=s.child;else{if(s===c)break e;for(;null===s.sibling;){if(null===s.return||s.return===c)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}r?(u=n,c=a.stateNode,8===u.nodeType?u.parentNode.removeChild(c):u.removeChild(c)):n.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(mu(e,a),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(i=!1)}a.sibling.return=a.return,a=a.sibling}}function wu(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var a=null!==e?e.memoizedProps:r;e=t.type;var i=t.updateQueue;if(t.updateQueue=null,null!==i){for(n[$r]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),_e(e,a),t=_e(e,r),a=0;a<i.length;a+=2){var u=i[a],c=i[a+1];"style"===u?ke(n,c):"dangerouslySetInnerHTML"===u?be(n,c):"children"===u?ge(n,c):x(n,u,c,t)}switch(e){case"input":ne(n,r);break;case"textarea":se(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(i=r.value)?oe(n,!!r.multiple,i,!1):e!==!!r.multiple&&(null!=r.defaultValue?oe(n,!!r.multiple,r.defaultValue,!0):oe(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(o(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,kt(n.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(Uu=Ba(),vu(t.child,!0)),void ju(t);case 19:return void ju(t);case 17:return;case 23:case 24:return void vu(t,null!==t.memoizedState)}throw Error(o(163))}function ju(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new fu),t.forEach((function(t){var r=Pc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function _u(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Su=Math.ceil,Eu=O.ReactCurrentDispatcher,Cu=O.ReactCurrentOwner,Au=0,Nu=null,Tu=null,Iu=0,Du=0,Fu=oa(0),Mu=0,Ru=null,zu=0,Lu=0,Pu=0,Bu=0,Wu=null,Uu=0,Vu=1/0;function qu(){Vu=Ba()+500}var Hu,Gu=null,Ku=!1,Xu=null,Yu=null,$u=!1,Ju=null,Qu=90,Zu=[],ec=[],tc=null,nc=0,rc=null,ac=-1,ic=0,oc=0,uc=null,cc=!1;function sc(){return 0!==(48&Au)?Ba():-1!==ac?ac:ac=Ba()}function lc(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Wa()?1:2;if(0===ic&&(ic=zu),0!==Ka.transition){0!==oc&&(oc=null!==Wu?Wu.pendingLanes:0),e=ic;var t=4186112&~oc;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Wa(),0!==(4&Au)&&98===e?e=Bt(12,ic):e=Bt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ic),e}function fc(e,t,n){if(50<nc)throw nc=0,rc=null,Error(o(185));if(null===(e=dc(e,t)))return null;Vt(e,t,n),e===Nu&&(Pu|=t,4===Mu&&vc(e,Iu));var r=Wa();1===t?0!==(8&Au)&&0===(48&Au)?mc(e):(hc(e,n),0===Au&&(qu(),Ha())):(0===(4&Au)||98!==r&&99!==r||(null===tc?tc=new Set([e]):tc.add(e)),hc(e,n)),Wu=e}function dc(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function hc(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,a=e.pingedLanes,i=e.expirationTimes,u=e.pendingLanes;0<u;){var c=31-qt(u),s=1<<c,l=i[c];if(-1===l){if(0===(s&r)||0!==(s&a)){l=t,zt(s);var f=Rt;i[c]=10<=f?l+250:6<=f?l+5e3:-1}}else l<=t&&(e.expiredLanes|=s);u&=~s}if(r=Lt(e,e===Nu?Iu:0),t=Rt,0===r)null!==n&&(n!==Fa&&ja(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Fa&&ja(n)}15===t?(n=mc.bind(null,e),null===Ra?(Ra=[n],za=wa(Aa,Ga)):Ra.push(n),n=Fa):14===t?n=qa(99,mc.bind(null,e)):n=qa(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(o(358,e))}}(t),pc.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function pc(e){if(ac=-1,oc=ic=0,0!==(48&Au))throw Error(o(327));var t=e.callbackNode;if(Ic()&&e.callbackNode!==t)return null;var n=Lt(e,e===Nu?Iu:0);if(0===n)return null;var r=n,a=Au;Au|=16;var i=wc();for(Nu===e&&Iu===r||(qu(),Oc(e,r));;)try{Sc();break}catch(c){kc(e,c)}if(Za(),Eu.current=i,Au=a,null!==Tu?r=0:(Nu=null,Iu=0,r=Mu),0!==(zu&Pu))Oc(e,0);else if(0!==r){if(2===r&&(Au|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(n=Pt(e))&&(r=jc(e,n))),1===r)throw t=Ru,Oc(e,0),vc(e,n),hc(e,Ba()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(o(345));case 2:Ac(e);break;case 3:if(vc(e,n),(62914560&n)===n&&10<(r=Uu+500-Ba())){if(0!==Lt(e,0))break;if(((a=e.suspendedLanes)&n)!==n){sc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Ur(Ac.bind(null,e),r);break}Ac(e);break;case 4:if(vc(e,n),(4186112&n)===n)break;for(r=e.eventTimes,a=-1;0<n;){var u=31-qt(n);i=1<<u,(u=r[u])>a&&(a=u),n&=~i}if(n=a,10<(n=(120>(n=Ba()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Su(n/1960))-n)){e.timeoutHandle=Ur(Ac.bind(null,e),n);break}Ac(e);break;case 5:Ac(e);break;default:throw Error(o(329))}}return hc(e,Ba()),e.callbackNode===t?pc.bind(null,e):null}function vc(e,t){for(t&=~Bu,t&=~Pu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-qt(t),r=1<<n;e[n]=-1,t&=~r}}function mc(e){if(0!==(48&Au))throw Error(o(327));if(Ic(),e===Nu&&0!==(e.expiredLanes&Iu)){var t=Iu,n=jc(e,t);0!==(zu&Pu)&&(n=jc(e,t=Lt(e,t)))}else n=jc(e,t=Lt(e,0));if(0!==e.tag&&2===n&&(Au|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(t=Pt(e))&&(n=jc(e,t))),1===n)throw n=Ru,Oc(e,0),vc(e,t),hc(e,Ba()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ac(e),hc(e,Ba()),null}function bc(e,t){var n=Au;Au|=1;try{return e(t)}finally{0===(Au=n)&&(qu(),Ha())}}function gc(e,t){var n=Au;Au&=-2,Au|=8;try{return e(t)}finally{0===(Au=n)&&(qu(),Ha())}}function yc(e,t){ca(Fu,Du),Du|=t,zu|=t}function xc(){Du=Fu.current,ua(Fu)}function Oc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Vr(n)),null!==Tu)for(n=Tu.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&va();break;case 3:Ti(),ua(fa),ua(la),Gi();break;case 5:Di(r);break;case 4:Ti();break;case 13:case 19:ua(Fi);break;case 10:ei(r);break;case 23:case 24:xc()}n=n.return}Nu=e,Tu=Vc(e.current,null),Iu=Du=zu=t,Mu=0,Ru=null,Bu=Pu=Lu=0}function kc(e,t){for(;;){var n=Tu;try{if(Za(),Ki.current=Ao,Zi){for(var r=$i.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}Zi=!1}if(Yi=0,Qi=Ji=$i=null,eo=!1,Cu.current=null,null===n||null===n.return){Mu=1,Ru=t,Tu=null;break}e:{var i=e,o=n.return,u=n,c=t;if(t=Iu,u.flags|=2048,u.firstEffect=u.lastEffect=null,null!==c&&"object"===typeof c&&"function"===typeof c.then){var s=c;if(0===(2&u.mode)){var l=u.alternate;l?(u.updateQueue=l.updateQueue,u.memoizedState=l.memoizedState,u.lanes=l.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=0!==(1&Fi.current),d=o;do{var h;if(h=13===d.tag){var p=d.memoizedState;if(null!==p)h=null!==p.dehydrated;else{var v=d.memoizedProps;h=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!f)}}if(h){var m=d.updateQueue;if(null===m){var b=new Set;b.add(s),d.updateQueue=b}else m.add(s);if(0===(2&d.mode)){if(d.flags|=64,u.flags|=16384,u.flags&=-2981,1===u.tag)if(null===u.alternate)u.tag=17;else{var g=ui(-1,1);g.tag=2,ci(u,g)}u.lanes|=1;break e}c=void 0,u=t;var y=i.pingCache;if(null===y?(y=i.pingCache=new cu,c=new Set,y.set(s,c)):void 0===(c=y.get(s))&&(c=new Set,y.set(s,c)),!c.has(u)){c.add(u);var x=Lc.bind(null,i,s,u);s.then(x,x)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);c=Error((K(u.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Mu&&(Mu=2),c=ou(c,u),d=o;do{switch(d.tag){case 3:i=c,d.flags|=4096,t&=-t,d.lanes|=t,si(d,su(0,i,t));break e;case 1:i=c;var O=d.type,k=d.stateNode;if(0===(64&d.flags)&&("function"===typeof O.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===Yu||!Yu.has(k)))){d.flags|=4096,t&=-t,d.lanes|=t,si(d,lu(d,i,t));break e}}d=d.return}while(null!==d)}Cc(n)}catch(w){t=w,Tu===n&&null!==n&&(Tu=n=n.return);continue}break}}function wc(){var e=Eu.current;return Eu.current=Ao,null===e?Ao:e}function jc(e,t){var n=Au;Au|=16;var r=wc();for(Nu===e&&Iu===t||Oc(e,t);;)try{_c();break}catch(a){kc(e,a)}if(Za(),Au=n,Eu.current=r,null!==Tu)throw Error(o(261));return Nu=null,Iu=0,Mu}function _c(){for(;null!==Tu;)Ec(Tu)}function Sc(){for(;null!==Tu&&!_a();)Ec(Tu)}function Ec(e){var t=Hu(e.alternate,e,Du);e.memoizedProps=e.pendingProps,null===t?Cc(e):Tu=t,Cu.current=null}function Cc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=au(n,t,Du)))return void(Tu=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Du)||0===(4&n.mode)){for(var r=0,a=n.child;null!==a;)r|=a.lanes|a.childLanes,a=a.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=iu(t)))return n.flags&=2047,void(Tu=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Tu=t);Tu=t=e}while(null!==t);0===Mu&&(Mu=5)}function Ac(e){var t=Wa();return Va(99,Nc.bind(null,e,t)),null}function Nc(e,t){do{Ic()}while(null!==Ju);if(0!==(48&Au))throw Error(o(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null;var r=n.lanes|n.childLanes,a=r,i=e.pendingLanes&~a;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=a,e.mutableReadLanes&=a,e.entangledLanes&=a,a=e.entanglements;for(var u=e.eventTimes,c=e.expirationTimes;0<i;){var s=31-qt(i),l=1<<s;a[s]=0,u[s]=-1,c[s]=-1,i&=~l}if(null!==tc&&0===(24&r)&&tc.has(e)&&tc.delete(e),e===Nu&&(Tu=Nu=null,Iu=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(a=Au,Au|=32,Cu.current=null,Lr=Yt,pr(u=hr())){if("selectionStart"in u)c={start:u.selectionStart,end:u.selectionEnd};else e:if(c=(c=u.ownerDocument)&&c.defaultView||window,(l=c.getSelection&&c.getSelection())&&0!==l.rangeCount){c=l.anchorNode,i=l.anchorOffset,s=l.focusNode,l=l.focusOffset;try{c.nodeType,s.nodeType}catch(S){c=null;break e}var f=0,d=-1,h=-1,p=0,v=0,m=u,b=null;t:for(;;){for(var g;m!==c||0!==i&&3!==m.nodeType||(d=f+i),m!==s||0!==l&&3!==m.nodeType||(h=f+l),3===m.nodeType&&(f+=m.nodeValue.length),null!==(g=m.firstChild);)b=m,m=g;for(;;){if(m===u)break t;if(b===c&&++p===i&&(d=f),b===s&&++v===l&&(h=f),null!==(g=m.nextSibling))break;b=(m=b).parentNode}m=g}c=-1===d||-1===h?null:{start:d,end:h}}else c=null;c=c||{start:0,end:0}}else c=null;Pr={focusedElem:u,selectionRange:c},Yt=!1,uc=null,cc=!1,Gu=r;do{try{Tc()}catch(S){if(null===Gu)throw Error(o(330));zc(Gu,S),Gu=Gu.nextEffect}}while(null!==Gu);uc=null,Gu=r;do{try{for(u=e;null!==Gu;){var y=Gu.flags;if(16&y&&ge(Gu.stateNode,""),128&y){var x=Gu.alternate;if(null!==x){var O=x.ref;null!==O&&("function"===typeof O?O(null):O.current=null)}}switch(1038&y){case 2:yu(Gu),Gu.flags&=-3;break;case 6:yu(Gu),Gu.flags&=-3,wu(Gu.alternate,Gu);break;case 1024:Gu.flags&=-1025;break;case 1028:Gu.flags&=-1025,wu(Gu.alternate,Gu);break;case 4:wu(Gu.alternate,Gu);break;case 8:ku(u,c=Gu);var k=c.alternate;bu(c),null!==k&&bu(k)}Gu=Gu.nextEffect}}catch(S){if(null===Gu)throw Error(o(330));zc(Gu,S),Gu=Gu.nextEffect}}while(null!==Gu);if(O=Pr,x=hr(),y=O.focusedElem,u=O.selectionRange,x!==y&&y&&y.ownerDocument&&dr(y.ownerDocument.documentElement,y)){null!==u&&pr(y)&&(x=u.start,void 0===(O=u.end)&&(O=x),"selectionStart"in y?(y.selectionStart=x,y.selectionEnd=Math.min(O,y.value.length)):(O=(x=y.ownerDocument||document)&&x.defaultView||window).getSelection&&(O=O.getSelection(),c=y.textContent.length,k=Math.min(u.start,c),u=void 0===u.end?k:Math.min(u.end,c),!O.extend&&k>u&&(c=u,u=k,k=c),c=fr(y,k),i=fr(y,u),c&&i&&(1!==O.rangeCount||O.anchorNode!==c.node||O.anchorOffset!==c.offset||O.focusNode!==i.node||O.focusOffset!==i.offset)&&((x=x.createRange()).setStart(c.node,c.offset),O.removeAllRanges(),k>u?(O.addRange(x),O.extend(i.node,i.offset)):(x.setEnd(i.node,i.offset),O.addRange(x))))),x=[];for(O=y;O=O.parentNode;)1===O.nodeType&&x.push({element:O,left:O.scrollLeft,top:O.scrollTop});for("function"===typeof y.focus&&y.focus(),y=0;y<x.length;y++)(O=x[y]).element.scrollLeft=O.left,O.element.scrollTop=O.top}Yt=!!Lr,Pr=Lr=null,e.current=n,Gu=r;do{try{for(y=e;null!==Gu;){var w=Gu.flags;if(36&w&&pu(y,Gu.alternate,Gu),128&w){x=void 0;var j=Gu.ref;if(null!==j){var _=Gu.stateNode;switch(Gu.tag){case 5:x=_;break;default:x=_}"function"===typeof j?j(x):j.current=x}}Gu=Gu.nextEffect}}catch(S){if(null===Gu)throw Error(o(330));zc(Gu,S),Gu=Gu.nextEffect}}while(null!==Gu);Gu=null,Ma(),Au=a}else e.current=n;if($u)$u=!1,Ju=e,Qu=t;else for(Gu=r;null!==Gu;)t=Gu.nextEffect,Gu.nextEffect=null,8&Gu.flags&&((w=Gu).sibling=null,w.stateNode=null),Gu=t;if(0===(r=e.pendingLanes)&&(Yu=null),1===r?e===rc?nc++:(nc=0,rc=e):nc=0,n=n.stateNode,Oa&&"function"===typeof Oa.onCommitFiberRoot)try{Oa.onCommitFiberRoot(xa,n,void 0,64===(64&n.current.flags))}catch(S){}if(hc(e,Ba()),Ku)throw Ku=!1,e=Xu,Xu=null,e;return 0!==(8&Au)||Ha(),null}function Tc(){for(;null!==Gu;){var e=Gu.alternate;cc||null===uc||(0!==(8&Gu.flags)?et(Gu,uc)&&(cc=!0):13===Gu.tag&&_u(e,Gu)&&et(Gu,uc)&&(cc=!0));var t=Gu.flags;0!==(256&t)&&hu(e,Gu),0===(512&t)||$u||($u=!0,qa(97,(function(){return Ic(),null}))),Gu=Gu.nextEffect}}function Ic(){if(90!==Qu){var e=97<Qu?97:Qu;return Qu=90,Va(e,Mc)}return!1}function Dc(e,t){Zu.push(t,e),$u||($u=!0,qa(97,(function(){return Ic(),null})))}function Fc(e,t){ec.push(t,e),$u||($u=!0,qa(97,(function(){return Ic(),null})))}function Mc(){if(null===Ju)return!1;var e=Ju;if(Ju=null,0!==(48&Au))throw Error(o(331));var t=Au;Au|=32;var n=ec;ec=[];for(var r=0;r<n.length;r+=2){var a=n[r],i=n[r+1],u=a.destroy;if(a.destroy=void 0,"function"===typeof u)try{u()}catch(s){if(null===i)throw Error(o(330));zc(i,s)}}for(n=Zu,Zu=[],r=0;r<n.length;r+=2){a=n[r],i=n[r+1];try{var c=a.create;a.destroy=c()}catch(s){if(null===i)throw Error(o(330));zc(i,s)}}for(c=e.current.firstEffect;null!==c;)e=c.nextEffect,c.nextEffect=null,8&c.flags&&(c.sibling=null,c.stateNode=null),c=e;return Au=t,Ha(),!0}function Rc(e,t,n){ci(e,t=su(0,t=ou(n,t),1)),t=sc(),null!==(e=dc(e,1))&&(Vt(e,1,t),hc(e,t))}function zc(e,t){if(3===e.tag)Rc(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Rc(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Yu||!Yu.has(r))){var a=lu(n,e=ou(t,e),1);if(ci(n,a),a=sc(),null!==(n=dc(n,1)))Vt(n,1,a),hc(n,a);else if("function"===typeof r.componentDidCatch&&(null===Yu||!Yu.has(r)))try{r.componentDidCatch(t,e)}catch(i){}break}}n=n.return}}function Lc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=sc(),e.pingedLanes|=e.suspendedLanes&n,Nu===e&&(Iu&n)===n&&(4===Mu||3===Mu&&(62914560&Iu)===Iu&&500>Ba()-Uu?Oc(e,0):Bu|=n),hc(e,t)}function Pc(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Wa()?1:2:(0===ic&&(ic=zu),0===(t=Wt(62914560&~ic))&&(t=4194304))),n=sc(),null!==(e=dc(e,t))&&(Vt(e,t,n),hc(e,n))}function Bc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Wc(e,t,n,r){return new Bc(e,t,n,r)}function Uc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Vc(e,t){var n=e.alternate;return null===n?((n=Wc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function qc(e,t,n,r,a,i){var u=2;if(r=e,"function"===typeof e)Uc(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case j:return Hc(n.children,a,i,t);case R:u=8,a|=16;break;case _:u=8,a|=1;break;case S:return(e=Wc(12,n,t,8|a)).elementType=S,e.type=S,e.lanes=i,e;case N:return(e=Wc(13,n,t,a)).type=N,e.elementType=N,e.lanes=i,e;case T:return(e=Wc(19,n,t,a)).elementType=T,e.lanes=i,e;case z:return Gc(n,a,i,t);case L:return(e=Wc(24,n,t,a)).elementType=L,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:u=10;break e;case C:u=9;break e;case A:u=11;break e;case I:u=14;break e;case D:u=16,r=null;break e;case F:u=22;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Wc(u,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function Hc(e,t,n,r){return(e=Wc(7,e,r,t)).lanes=n,e}function Gc(e,t,n,r){return(e=Wc(23,e,r,t)).elementType=z,e.lanes=n,e}function Kc(e,t,n){return(e=Wc(6,e,null,t)).lanes=n,e}function Xc(e,t,n){return(t=Wc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Yc(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ut(0),this.expirationTimes=Ut(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ut(0),this.mutableSourceEagerHydrationData=null}function $c(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Jc(e,t,n,r){var a=t.current,i=sc(),u=lc(a);e:if(n){t:{if($e(n=n._reactInternals)!==n||1!==n.tag)throw Error(o(170));var c=n;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(pa(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(null!==c);throw Error(o(171))}if(1===n.tag){var s=n.type;if(pa(s)){n=ba(n,s,c);break e}}n=c}else n=sa;return null===t.context?t.context=n:t.pendingContext=n,(t=ui(i,u)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ci(a,t),fc(a,u,i),u}function Qc(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Zc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function es(e,t){Zc(e,t),(e=e.alternate)&&Zc(e,t)}function ts(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Yc(e,t,null!=n&&!0===n.hydrate),t=Wc(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,ii(t),e[Jr]=n.current,Ar(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var a=(t=r[e])._getVersion;a=a(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,a]:n.mutableSourceEagerHydrationData.push(t,a)}this._internalRoot=n}function ns(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function rs(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i._internalRoot;if("function"===typeof a){var u=a;a=function(){var e=Qc(o);u.call(e)}}Jc(t,o,e,a)}else{if(i=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new ts(e,0,t?{hydrate:!0}:void 0)}(n,r),o=i._internalRoot,"function"===typeof a){var c=a;a=function(){var e=Qc(o);c.call(e)}}gc((function(){Jc(t,o,e,a)}))}return Qc(o)}function as(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ns(t))throw Error(o(200));return $c(e,t,null,n)}Hu=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||fa.current)Fo=!0;else{if(0===(n&r)){switch(Fo=!1,t.tag){case 3:qo(t),qi();break;case 5:Ii(t);break;case 1:pa(t.type)&&ga(t);break;case 4:Ni(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var a=t.type._context;ca(Ya,a._currentValue),a._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Yo(e,t,n):(ca(Fi,1&Fi.current),null!==(t=nu(e,t,n))?t.sibling:null);ca(Fi,1&Fi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return tu(e,t,n);t.flags|=64}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),ca(Fi,Fi.current),r)break;return null;case 23:case 24:return t.lanes=0,Po(e,t,n)}return nu(e,t,n)}Fo=0!==(16384&e.flags)}else Fo=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=ha(t,la.current),ni(t,n),a=ro(null,t,r,e,a,n),t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,pa(r)){var i=!0;ga(t)}else i=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,ii(t);var u=r.getDerivedStateFromProps;"function"===typeof u&&hi(t,r,u,e),a.updater=pi,t.stateNode=a,a._reactInternals=t,gi(t,r,e,n),t=Vo(null,t,r,!0,i,n)}else t.tag=0,Mo(null,t,a,n),t=t.child;return t;case 16:a=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=(i=a._init)(a._payload),t.type=a,i=t.tag=function(e){if("function"===typeof e)return Uc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===I)return 14}return 2}(a),e=Xa(a,e),i){case 0:t=Wo(null,t,a,e,n);break e;case 1:t=Uo(null,t,a,e,n);break e;case 11:t=Ro(null,t,a,e,n);break e;case 14:t=zo(null,t,a,Xa(a.type,e),r,n);break e}throw Error(o(306,a,""))}return t;case 0:return r=t.type,a=t.pendingProps,Wo(e,t,r,a=t.elementType===r?a:Xa(r,a),n);case 1:return r=t.type,a=t.pendingProps,Uo(e,t,r,a=t.elementType===r?a:Xa(r,a),n);case 3:if(qo(t),r=t.updateQueue,null===e||null===r)throw Error(o(282));if(r=t.pendingProps,a=null!==(a=t.memoizedState)?a.element:null,oi(e,t),li(t,r,null,n),(r=t.memoizedState.element)===a)qi(),t=nu(e,t,n);else{if((i=(a=t.stateNode).hydrate)&&(zi=Hr(t.stateNode.containerInfo.firstChild),Ri=t,i=Li=!0),i){if(null!=(e=a.mutableSourceEagerHydrationData))for(a=0;a<e.length;a+=2)(i=e[a])._workInProgressVersionPrimary=e[a+1],Hi.push(i);for(n=ji(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Mo(e,t,r,n),qi();t=t.child}return t;case 5:return Ii(t),null===e&&Wi(t),r=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,u=a.children,Wr(r,a)?u=null:null!==i&&Wr(r,i)&&(t.flags|=16),Bo(e,t),Mo(e,t,u,n),t.child;case 6:return null===e&&Wi(t),null;case 13:return Yo(e,t,n);case 4:return Ni(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wi(t,null,r,n):Mo(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,Ro(e,t,r,a=t.elementType===r?a:Xa(r,a),n);case 7:return Mo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Mo(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,a=t.pendingProps,u=t.memoizedProps,i=a.value;var c=t.type._context;if(ca(Ya,c._currentValue),c._currentValue=i,null!==u)if(c=u.value,0===(i=ur(c,i)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(c,i):1073741823))){if(u.children===a.children&&!fa.current){t=nu(e,t,n);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var s=c.dependencies;if(null!==s){u=c.child;for(var l=s.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&i)){1===c.tag&&((l=ui(-1,n&-n)).tag=2,ci(c,l)),c.lanes|=n,null!==(l=c.alternate)&&(l.lanes|=n),ti(c.return,n),s.lanes|=n;break}l=l.next}}else u=10===c.tag&&c.type===t.type?null:c.child;if(null!==u)u.return=c;else for(u=c;null!==u;){if(u===t){u=null;break}if(null!==(c=u.sibling)){c.return=u.return,u=c;break}u=u.return}c=u}Mo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=(i=t.pendingProps).children,ni(t,n),r=r(a=ri(a,i.unstable_observedBits)),t.flags|=1,Mo(e,t,r,n),t.child;case 14:return i=Xa(a=t.type,t.pendingProps),zo(e,t,a,i=Xa(a.type,i),r,n);case 15:return Lo(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Xa(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,pa(r)?(e=!0,ga(t)):e=!1,ni(t,n),mi(t,r,a),gi(t,r,a,n),Vo(null,t,r,!0,e,n);case 19:return tu(e,t,n);case 23:case 24:return Po(e,t,n)}throw Error(o(156,t.tag))},ts.prototype.render=function(e){Jc(e,this._internalRoot,null,null)},ts.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Jc(null,e,null,(function(){t[Jr]=null}))},tt=function(e){13===e.tag&&(fc(e,4,sc()),es(e,4))},nt=function(e){13===e.tag&&(fc(e,67108864,sc()),es(e,67108864))},rt=function(e){if(13===e.tag){var t=sc(),n=lc(e);fc(e,n,t),es(e,n)}},at=function(e,t){return t()},Ee=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=na(r);if(!a)throw Error(o(90));J(r),ne(r,a)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&oe(e,!!n.multiple,t,!1)}},De=bc,Fe=function(e,t,n,r,a){var i=Au;Au|=4;try{return Va(98,e.bind(null,t,n,r,a))}finally{0===(Au=i)&&(qu(),Ha())}},Me=function(){0===(49&Au)&&(function(){if(null!==tc){var e=tc;tc=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,hc(e,Ba())}))}Ha()}(),Ic())},Re=function(e,t){var n=Au;Au|=2;try{return e(t)}finally{0===(Au=n)&&(qu(),Ha())}};var is={Events:[ea,ta,na,Te,Ie,Ic,{current:!1}]},os={findFiberByHostInstance:Zr,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},us={bundleType:os.bundleType,version:os.version,rendererPackageName:os.rendererPackageName,rendererConfig:os.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:O.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:os.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var cs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cs.isDisabled&&cs.supportsFiber)try{xa=cs.inject(us),Oa=cs}catch(me){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=is,t.createPortal=as,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw Error(o(268,Object.keys(e)))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Au;if(0!==(48&n))return e(t);Au|=1;try{if(e)return Va(99,e.bind(null,t))}finally{Au=n,Ha()}},t.hydrate=function(e,t,n){if(!ns(t))throw Error(o(200));return rs(null,e,t,!0,n)},t.render=function(e,t,n){if(!ns(t))throw Error(o(200));return rs(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!ns(e))throw Error(o(40));return!!e._reactRootContainer&&(gc((function(){rs(null,null,e,!1,(function(){e._reactRootContainer=null,e[Jr]=null}))})),!0)},t.unstable_batchedUpdates=bc,t.unstable_createPortal=function(e,t){return as(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ns(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return rs(e,t,n,!1,r)},t.version="17.0.2"},function(e,t,n){"use strict";e.exports=n(331)},function(e,t,n){"use strict";var r,a,i,o;if("object"===typeof performance&&"function"===typeof performance.now){var u=performance;t.unstable_now=function(){return u.now()}}else{var c=Date,s=c.now();t.unstable_now=function(){return c.now()-s}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,f=null,d=function e(){if(null!==l)try{var n=t.unstable_now();l(!0,n),l=null}catch(r){throw setTimeout(e,0),r}};r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(d,0))},a=function(e,t){f=setTimeout(e,t)},i=function(){clearTimeout(f)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var v=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,b=null,g=-1,y=5,x=0;t.unstable_shouldYield=function(){return t.unstable_now()>=x},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<e?Math.floor(1e3/e):5};var O=new MessageChannel,k=O.port2;O.port1.onmessage=function(){if(null!==b){var e=t.unstable_now();x=e+y;try{b(!0,e)?k.postMessage(null):(m=!1,b=null)}catch(n){throw k.postMessage(null),n}}else m=!1},r=function(e){b=e,m||(m=!0,k.postMessage(null))},a=function(e,n){g=h((function(){e(t.unstable_now())}),n)},i=function(){p(g),g=-1}}function w(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<S(a,t)))break e;e[r]=t,e[n]=a,n=r}}function j(e){return void 0===(e=e[0])?null:e}function _(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var i=2*(r+1)-1,o=e[i],u=i+1,c=e[u];if(void 0!==o&&0>S(o,n))void 0!==c&&0>S(c,o)?(e[r]=c,e[u]=n,r=u):(e[r]=o,e[i]=n,r=i);else{if(!(void 0!==c&&0>S(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}return null}function S(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var E=[],C=[],A=1,N=null,T=3,I=!1,D=!1,F=!1;function M(e){for(var t=j(C);null!==t;){if(null===t.callback)_(C);else{if(!(t.startTime<=e))break;_(C),t.sortIndex=t.expirationTime,w(E,t)}t=j(C)}}function R(e){if(F=!1,M(e),!D)if(null!==j(E))D=!0,r(z);else{var t=j(C);null!==t&&a(R,t.startTime-e)}}function z(e,n){D=!1,F&&(F=!1,i()),I=!0;var r=T;try{for(M(n),N=j(E);null!==N&&(!(N.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=N.callback;if("function"===typeof o){N.callback=null,T=N.priorityLevel;var u=o(N.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?N.callback=u:N===j(E)&&_(E),M(n)}else _(E);N=j(E)}if(null!==N)var c=!0;else{var s=j(C);null!==s&&a(R,s.startTime-n),c=!1}return c}finally{N=null,T=r,I=!1}}var L=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){D||I||(D=!0,r(z))},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return j(E)},t.unstable_next=function(e){switch(T){case 1:case 2:case 3:var t=3;break;default:t=T}var n=T;T=t;try{return e()}finally{T=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=L,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=T;T=e;try{return t()}finally{T=n}},t.unstable_scheduleCallback=function(e,n,o){var u=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?u+o:u:o=u,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:A++,callback:n,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>u?(e.sortIndex=o,w(C,e),null===j(E)&&e===j(C)&&(F?i():F=!0,a(R,o-u))):(e.sortIndex=c,w(E,e),D||I||(D=!0,r(z))),e},t.unstable_wrapCallback=function(e){var t=T;return function(){var n=T;T=t;try{return e.apply(this,arguments)}finally{T=n}}}},,function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,a="function"===typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(T){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a=t&&t.prototype instanceof m?t:m,i=Object.create(a.prototype),o=new C(r||[]);return i._invoke=function(e,t,n){var r=f;return function(a,i){if(r===h)throw new Error("Generator is already running");if(r===p){if("throw"===a)throw i;return N()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var u=_(o,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?p:d,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}(e,n,o),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(T){return{type:"throw",arg:T}}}e.wrap=s;var f="suspendedStart",d="suspendedYield",h="executing",p="completed",v={};function m(){}function b(){}function g(){}var y={};y[i]=function(){return this};var x=Object.getPrototypeOf,O=x&&x(x(A([])));O&&O!==n&&r.call(O,i)&&(y=O);var k=g.prototype=m.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function n(a,i,o,u){var c=l(e[a],e,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"===typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,o,u)}),(function(e){n("throw",e,o,u)})):t.resolve(f).then((function(e){s.value=e,o(s)}),(function(e){return n("throw",e,o,u)}))}u(c.arg)}var a;this._invoke=function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}}function _(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,_(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var a=l(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function A(e){if(e){var n=e[i];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:N}}function N(){return{value:t,done:!0}}return b.prototype=k.constructor=g,g.constructor=b,b.displayName=c(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},w(j.prototype),j.prototype[o]=function(){return this},e.AsyncIterator=j,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new j(s(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(k),c(k,u,"Generator"),k[i]=function(){return this},k.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return u.type="throw",u.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],u=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),s=r.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;E(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=r}catch(a){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=s(e),o=r[0],u=r[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,o,u)),l=0,f=u>0?o-4:o;for(n=0;n<f;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===u&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===u&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,i=[],o=16383,u=0,c=n-a;u<c;u+=o)i.push(l(e,u,u+o>c?c:u+o));1===a?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],a=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,c=o.length;u<c;++u)r[u]=o[u],a[o.charCodeAt(u)]=u;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var a,i,o=[],u=t;u<n;u+=3)a=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(255&e[u+2]),o.push(r[(i=a)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,a){var i,o,u=8*a-r-1,c=(1<<u)-1,s=c>>1,l=-7,f=n?a-1:0,d=n?-1:1,h=e[t+f];for(f+=d,i=h&(1<<-l)-1,h>>=-l,l+=u;l>0;i=256*i+e[t+f],f+=d,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=r;l>0;o=256*o+e[t+f],f+=d,l-=8);if(0===i)i=1-s;else{if(i===c)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),i-=s}return(h?-1:1)*o*Math.pow(2,i-r)},t.write=function(e,t,n,r,a,i){var o,u,c,s=8*i-a-1,l=(1<<s)-1,f=l>>1,d=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(o++,c/=2),o+f>=l?(u=0,o=l):o+f>=1?(u=(t*c-1)*Math.pow(2,a),o+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,a),o=0));a>=8;e[n+h]=255&u,h+=p,u/=256,a-=8);for(o=o<<a|u,s+=a;s>0;e[n+h]=255&o,h+=p,o/=256,s-=8);e[n+h-p]|=128*v}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";(function(e){var t,r=n(3),a=n(10),i=n(34),o=function(){return n(338)};var u=function(){function u(){Object(r.a)(this,u),this.util=n(339),this.textEncoder=new this.util.TextEncoder}return Object(a.a)(u,[{key:"fetch",value:function(e,n){return null!=Object(i.c)().global.fetch?Object(i.c)().global.fetch(e,n):(null==t&&(t=o()),t(e,n))}},{key:"now",value:function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),u}();Object(i.c)().get("IS_NODE")&&Object(i.c)().setPlatform("node",new u)}).call(this,n(160))},,,function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function u(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function c(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=c:n(72)&&n(126)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.alea=c}(0,e,n(72))}).call(this,n(125)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function u(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function c(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=c:n(72)&&n(126)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.xor128=c}(0,e,n(72))}).call(this,n(125)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function u(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function c(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=c:n(72)&&n(126)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.xorwow=c}(0,e,n(72))}).call(this,n(125)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function u(e,t){return t.x=e.x.slice(),t.i=e.i,t}function c(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=c:n(72)&&n(126)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.xorshift7=c}(0,e,n(72))}).call(this,n(125)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,u=[],c=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,c=Math.max(c,t.length)),a=0,i=-32;i<c;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=u[127&i]^=r+o)?a+1:0);for(a>=128&&(u[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=u[a+34&127],n=u[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,u[a]=r^n;e.w=o,e.X=u,e.i=a}(t,e)}function u(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function c(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=c:n(72)&&n(126)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.xor4096=c}(0,e,n(72))}).call(this,n(125)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function u(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function c(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=c:n(72)&&n(126)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.tychei=c}(0,e,n(72))}).call(this,n(125)(e))},function(e,t,n){var r;!function(a,i){var o,u=this,c=256,s=i.pow(c,6),l=i.pow(2,52),f=2*l,d=255;function h(e,t,n){var r=[],d=b(m((t=1==t?{entropy:!0}:t||{}).entropy?[e,g(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(c):(e=new Uint8Array(c),(u.crypto||u.msCrypto).getRandomValues(e)),g(e)}catch(r){var t=u.navigator,n=t&&t.plugins;return[+new Date,u,n,u.screen,g(a)]}}():e,3),r),h=new p(r),y=function(){for(var e=h.g(6),t=s,n=0;e<l;)e=(e+n)*c,t*=c,n=h.g(1);for(;e>=f;)e/=2,t/=2,n>>>=1;return(e+n)/t};return y.int32=function(){return 0|h.g(4)},y.quick=function(){return h.g(4)/4294967296},y.double=y,b(g(h.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&v(r,h),e.state=function(){return v(h,{})}),n?(i.random=e,t):e})(y,d,"global"in t?t.global:this==i,t.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<c;)o[a]=a++;for(a=0;a<c;a++)o[a]=o[i=d&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=d&a+1],n=n*c+o[d&(o[a]=o[i=d&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(c)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(m(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function b(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=h,b(i.random(),a),e.exports){e.exports=h;try{o=n(347)}catch(y){}}else void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}([],Math)},,function(e,t,n){(function(e){var r="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,a=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(a.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(a.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(349),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(172))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,a=1,i={},o=!1,u=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){l(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"===typeof n.data&&0===n.data.indexOf(t)&&l(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},r=function(t){e.port2.postMessage(t)}}():u&&"onreadystatechange"in u.createElement("script")?function(){var e=u.documentElement;r=function(t){var n=u.createElement("script");n.onreadystatechange=function(){l(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():r=function(e){setTimeout(l,0,e)},c.setImmediate=function(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return i[a]=o,r(a),a++},c.clearImmediate=s}function s(e){delete i[e]}function l(e){if(o)setTimeout(l,0,e);else{var t=i[e];if(t){o=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{s(e),o=!1}}}}}("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,n(172),n(160))},,,function(e,t,n){"use strict";var r=n(4),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(130)),u=n(100),c=n(82);t.barchart=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,void 0,void 0,r.mark((function a(){var i,f,d,h,p,v,m,b,g,y,x,O,k,w,j,_;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=c.getDrawArea(e),f=t,d=Object.assign({},s,n),!l.has(i)){r.next=13;break}if(h=l.get(i),!c.shallowEquals(d,h.lastOptions)){r.next=13;break}return r.next=8,c.nextFrame();case 8:return p=h.view,v=p.changeset().remove((function(){return!0})).insert(f),r.next=12,p.change("values",v).runAsync();case 12:return r.abrupt("return");case 13:return m=d.xLabel,b=d.yLabel,g=d.xType,y=d.yType,x=null,null!=m&&(x={title:m}),O=null,null!=b&&(O={title:b}),k={actions:!1,mode:"vega-lite",defaultStyle:!1},w=null!=d.color?Array.isArray(d.color)?{field:"index",type:"nominal",scale:{range:d.color}}:{value:d.color}:{value:"#4C78A0"},j={width:d.width||u.getDefaultWidth(i),height:d.height||u.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:f,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:g,axis:x},y:{field:"value",type:y,axis:O},color:w}},r.next=23,c.nextFrame();case 23:return r.next=25,o.default(i,j,k);case 25:_=r.sent,l.set(i,{view:_.view,lastOptions:d});case 27:case"end":return r.stop()}}),a)})))};var s={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},l=new Map},function(e,t,n){var r=n(128);e.exports=function(e,t){var n=r(e,t);return n?n.version:null}},function(e,t,n){var r=n(128);e.exports=function(e,t){var n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},function(e,t,n){var r=n(62);e.exports=function(e,t,n,a){"string"===typeof n&&(a=n,n=void 0);try{return new r(e,n).inc(t,a).version}catch(i){return null}}},function(e,t,n){var r=n(128),a=n(234);e.exports=function(e,t){if(a(e,t))return null;var n=r(e),i=r(t),o=n.prerelease.length||i.prerelease.length,u=o?"pre":"",c=o?"prerelease":"";for(var s in n)if(("major"===s||"minor"===s||"patch"===s)&&n[s]!==i[s])return u+s;return c}},function(e,t,n){var r=n(62);e.exports=function(e,t){return new r(e,t).major}},function(e,t,n){var r=n(62);e.exports=function(e,t){return new r(e,t).minor}},function(e,t,n){var r=n(62);e.exports=function(e,t){return new r(e,t).patch}},function(e,t,n){var r=n(128);e.exports=function(e,t){var n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},function(e,t,n){var r=n(80);e.exports=function(e,t,n){return r(t,e,n)}},function(e,t,n){var r=n(80);e.exports=function(e,t){return r(e,t,!0)}},function(e,t,n){var r=n(235);e.exports=function(e,t){return e.sort((function(e,n){return r(e,n,t)}))}},function(e,t,n){var r=n(235);e.exports=function(e,t){return e.sort((function(e,n){return r(n,e,t)}))}},function(e,t,n){var r=n(62),a=n(128),i=n(127),o=i.re,u=i.t;e.exports=function(e,t){if(e instanceof r)return e;if("number"===typeof e&&(e=String(e)),"string"!==typeof e)return null;var n=null;if((t=t||{}).rtl){for(var i;(i=o[u.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),o[u.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;o[u.COERCERTL].lastIndex=-1}else n=e.match(o[u.COERCE]);return null===n?null:a("".concat(n[2],".").concat(n[3]||"0",".").concat(n[4]||"0"),t)}},function(e,t,n){var r=n(291);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";var r=n(98),a=n(99),i=n(370),o=Symbol("max"),u=Symbol("length"),c=Symbol("lengthCalculator"),s=Symbol("allowStale"),l=Symbol("maxAge"),f=Symbol("dispose"),d=Symbol("noDisposeOnSet"),h=Symbol("lruList"),p=Symbol("cache"),v=Symbol("updateAgeOnGet"),m=function(){return 1},b=function(){function e(t){if(r(this,e),"number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[o]=t.max||1/0;var n=t.length||m;if(this[c]="function"!==typeof n?m:n,this[s]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[l]=t.maxAge||0,this[f]=t.dispose,this[d]=t.noDisposeOnSet||!1,this[v]=t.updateAgeOnGet||!1,this.reset()}return a(e,[{key:"max",get:function(){return this[o]},set:function(e){if("number"!==typeof e||e<0)throw new TypeError("max must be a non-negative number");this[o]=e||1/0,x(this)}},{key:"allowStale",get:function(){return this[s]},set:function(e){this[s]=!!e}},{key:"maxAge",get:function(){return this[l]},set:function(e){if("number"!==typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,x(this)}},{key:"lengthCalculator",get:function(){return this[c]},set:function(e){var t=this;"function"!==typeof e&&(e=m),e!==this[c]&&(this[c]=e,this[u]=0,this[h].forEach((function(e){e.length=t[c](e.value,e.key),t[u]+=e.length}))),x(this)}},{key:"length",get:function(){return this[u]}},{key:"itemCount",get:function(){return this[h].length}},{key:"rforEach",value:function(e,t){t=t||this;for(var n=this[h].tail;null!==n;){var r=n.prev;w(this,e,n,t),n=r}}},{key:"forEach",value:function(e,t){t=t||this;for(var n=this[h].head;null!==n;){var r=n.next;w(this,e,n,t),n=r}}},{key:"keys",value:function(){return this[h].toArray().map((function(e){return e.key}))}},{key:"values",value:function(){return this[h].toArray().map((function(e){return e.value}))}},{key:"reset",value:function(){var e=this;this[f]&&this[h]&&this[h].length&&this[h].forEach((function(t){return e[f](t.key,t.value)})),this[p]=new Map,this[h]=new i,this[u]=0}},{key:"dump",value:function(){var e=this;return this[h].map((function(t){return!y(e,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}})).toArray().filter((function(e){return e}))}},{key:"dumpLru",value:function(){return this[h]}},{key:"set",value:function(e,t,n){if((n=n||this[l])&&"number"!==typeof n)throw new TypeError("maxAge must be a number");var r=n?Date.now():0,a=this[c](t,e);if(this[p].has(e)){if(a>this[o])return O(this,this[p].get(e)),!1;var i=this[p].get(e).value;return this[f]&&(this[d]||this[f](e,i.value)),i.now=r,i.maxAge=n,i.value=t,this[u]+=a-i.length,i.length=a,this.get(e),x(this),!0}var s=new k(e,t,a,r,n);return s.length>this[o]?(this[f]&&this[f](e,t),!1):(this[u]+=s.length,this[h].unshift(s),this[p].set(e,this[h].head),x(this),!0)}},{key:"has",value:function(e){if(!this[p].has(e))return!1;var t=this[p].get(e).value;return!y(this,t)}},{key:"get",value:function(e){return g(this,e,!0)}},{key:"peek",value:function(e){return g(this,e,!1)}},{key:"pop",value:function(){var e=this[h].tail;return e?(O(this,e),e.value):null}},{key:"del",value:function(e){O(this,this[p].get(e))}},{key:"load",value:function(e){this.reset();for(var t=Date.now(),n=e.length-1;n>=0;n--){var r=e[n],a=r.e||0;if(0===a)this.set(r.k,r.v);else{var i=a-t;i>0&&this.set(r.k,r.v,i)}}}},{key:"prune",value:function(){var e=this;this[p].forEach((function(t,n){return g(e,n,!1)}))}}]),e}(),g=function(e,t,n){var r=e[p].get(t);if(r){var a=r.value;if(y(e,a)){if(O(e,r),!e[s])return}else n&&(e[v]&&(r.value.now=Date.now()),e[h].unshiftNode(r));return a.value}},y=function(e,t){if(!t||!t.maxAge&&!e[l])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},x=function(e){if(e[u]>e[o])for(var t=e[h].tail;e[u]>e[o]&&null!==t;){var n=t.prev;O(e,t),t=n}},O=function(e,t){if(t){var n=t.value;e[f]&&e[f](n.key,n.value),e[u]-=n.length,e[p].delete(n.key),e[h].removeNode(t)}},k=function e(t,n,a,i,o){r(this,e),this.key=t,this.value=n,this.length=a,this.now=i,this.maxAge=o||0},w=function(e,t,n,r){var a=n.value;y(e,a)&&(O(e,n),e[s]||(a=void 0)),a&&t.call(r,a.value,a.key,e)};e.exports=b},function(e,t,n){"use strict";function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"===typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,a=arguments.length;n<a;n++)t.push(arguments[n]);return t}function a(e,t,n){var r=t===e.head?new u(n,null,t,e):new u(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function i(e,t){e.tail=new u(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new u(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function u(e,t,n,r){if(!(this instanceof u))return new u(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=u,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},r.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},r.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,a=this.head;null!==a;)n.push(e.call(t,a.value,this)),a=a.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,a=this.tail;null!==a;)n.push(e.call(t,a.value,this)),a=a.prev;return n},r.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var a=0;null!==r;a++)n=e(n,r.value,a),r=r.next;return n},r.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var a=this.length-1;null!==r;a--)n=e(n,r.value,a),r=r.prev;return n},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=0,i=this.head;null!==i&&a<e;a++)i=i.next;for(;null!==i&&a<t;a++,i=i.next)n.push(i.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=this.length,i=this.tail;null!==i&&a>t;a--)i=i.prev;for(;null!==i&&a>e;a--,i=i.prev)n.push(i.value);return n},r.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var i=[];for(n=0;r&&n<t;n++)i.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=a(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return i},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{n(371)(r)}catch(c){}},function(e,t,n){"use strict";var r=n(4);e.exports=function(e){e.prototype[Symbol.iterator]=r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}},function(e,t,n){var r=n(81);e.exports=function(e,t){return new r(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))}},function(e,t,n){var r=n(62),a=n(81);e.exports=function(e,t,n){var i=null,o=null,u=null;try{u=new a(t,n)}catch(c){return null}return e.forEach((function(e){u.test(e)&&(i&&-1!==o.compare(e)||(o=new r(i=e,n)))})),i}},function(e,t,n){var r=n(62),a=n(81);e.exports=function(e,t,n){var i=null,o=null,u=null;try{u=new a(t,n)}catch(c){return null}return e.forEach((function(e){u.test(e)&&(i&&1!==o.compare(e)||(o=new r(i=e,n)))})),i}},function(e,t,n){var r=n(62),a=n(81),i=n(176);e.exports=function(e,t){e=new a(e,t);var n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(var o=function(t){var a=e.set[t],o=null;a.forEach((function(e){var t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!i(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(e.operator))}})),!o||n&&!i(n,o)||(n=o)},u=0;u<e.set.length;++u)o(u);return n&&e.test(n)?n:null}},function(e,t,n){var r=n(81);e.exports=function(e,t){try{return new r(e,t).range||"*"}catch(n){return null}}},function(e,t,n){var r=n(241);e.exports=function(e,t,n){return r(e,t,">",n)}},function(e,t,n){var r=n(241);e.exports=function(e,t,n){return r(e,t,"<",n)}},function(e,t,n){var r=n(81);e.exports=function(e,t,n){return e=new r(e,n),t=new r(t,n),e.intersects(t)}},function(e,t,n){var r=n(242),a=n(129),i=n(178),o=n(80);e.exports=function(e,t,n){var u,c=[],s=null,l=null,f=e.sort((function(e,t){return o(e,t,n)})),d=a(f);try{for(d.s();!(u=d.n()).done;){var h=u.value;i(h,t,n)?(l=h,s||(s=h)):(l&&c.push([s,l]),l=null,s=null)}}catch(k){d.e(k)}finally{d.f()}s&&c.push([s,null]);for(var p=[],v=0,m=c;v<m.length;v++){var b=r(m[v],2),g=b[0],y=b[1];g===y?p.push(g):y||g!==f[0]?y?g===f[0]?p.push("<=".concat(y)):p.push("".concat(g," - ").concat(y)):p.push(">=".concat(g)):p.push("*")}var x=p.join(" || "),O="string"===typeof t.raw?t.raw:String(t);return x.length<O.length?x:t}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(c){a=!0,i=c}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){var r=n(129),a=n(81),i=n(177),o=i.ANY,u=n(178),c=n(80),s=function(e,t,n){if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=[new i(">=0.0.0")]}var a,s,d,h,p=new Set,v=r(e);try{for(v.s();!(d=v.n()).done;){var m=d.value;">"===m.operator||">="===m.operator?a=l(a,m,n):"<"===m.operator||"<="===m.operator?s=f(s,m,n):p.add(m.semver)}}catch(I){v.e(I)}finally{v.f()}if(p.size>1)return null;if(a&&s){if((h=c(a.semver,s.semver,n))>0)return null;if(0===h&&(">="!==a.operator||"<="!==s.operator))return null}var b,g,y,x,O,k=r(p);try{for(k.s();!(b=k.n()).done;){var w=b.value;if(a&&!u(w,String(a),n))return null;if(s&&!u(w,String(s),n))return null;var j,_=r(t);try{for(_.s();!(j=_.n()).done;){var S=j.value;if(!u(w,String(S),n))return!1}}catch(I){_.e(I)}finally{_.f()}return!0}}catch(I){k.e(I)}finally{k.f()}var E=!(!s||n.includePrerelease||!s.semver.prerelease.length)&&s.semver,C=!(!a||n.includePrerelease||!a.semver.prerelease.length)&&a.semver;E&&1===E.prerelease.length&&"<"===s.operator&&0===E.prerelease[0]&&(E=!1);var A,N=r(t);try{for(N.s();!(A=N.n()).done;){var T=A.value;if(O=O||">"===T.operator||">="===T.operator,x=x||"<"===T.operator||"<="===T.operator,a)if(C&&T.semver.prerelease&&T.semver.prerelease.length&&T.semver.major===C.major&&T.semver.minor===C.minor&&T.semver.patch===C.patch&&(C=!1),">"===T.operator||">="===T.operator){if((g=l(a,T,n))===T&&g!==a)return!1}else if(">="===a.operator&&!u(a.semver,String(T),n))return!1;if(s)if(E&&T.semver.prerelease&&T.semver.prerelease.length&&T.semver.major===E.major&&T.semver.minor===E.minor&&T.semver.patch===E.patch&&(E=!1),"<"===T.operator||"<="===T.operator){if((y=f(s,T,n))===T&&y!==s)return!1}else if("<="===s.operator&&!u(s.semver,String(T),n))return!1;if(!T.operator&&(s||a)&&0!==h)return!1}}catch(I){N.e(I)}finally{N.f()}return!(a&&x&&!s&&0!==h)&&(!(s&&O&&!a&&0!==h)&&(!C&&!E))},l=function(e,t,n){if(!e)return t;var r=c(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},f=function(e,t,n){if(!e)return t;var r=c(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;e=new a(e,n),t=new a(t,n);var i,o=!1,u=r(e.set);try{e:for(u.s();!(i=u.n()).done;){var c,l=i.value,f=r(t.set);try{for(f.s();!(c=f.n()).done;){var d=c.value,h=s(l,d,n);if(o=o||null!==h,h)continue e}}catch(p){f.e(p)}finally{f.f()}if(o)return!1}}catch(p){u.e(p)}finally{u.f()}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleSheet=d;var r,a=n(124),i=(r=a)&&r.__esModule?r:{default:r};function o(e){return e[e.length-1]}function u(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var c="undefined"!==typeof window,s=!1,l=function(){if(c){var e=document.createElement("div");return e.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===e.getElementsByTagName("i").length}}();function f(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.speedy,n=void 0===t||t,r=e.maxLength,a=void 0===r?c&&l?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=a,this.ctr=0}(0,i.default)(d.prototype,{getSheet:function(){return u(o(this.tags))},inject:function(){var e=this;if(this.injected)throw new Error("already injected stylesheet!");c?this.tags[0]=f():this.sheet={cssRules:[],insertRule:function(t){e.sheet.cssRules.push({cssText:t})}},this.injected=!0},speedy:function(e){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+e+") earlier in your app, or call flush() before speedy("+e+")");this.isSpeedy=!!e},_insert:function(e){try{var t=this.getSheet();t.insertRule(e,-1!==e.indexOf("@import")?0:t.cssRules.length)}catch(n){s}},insert:function(e){if(c)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(e);else if(-1!==e.indexOf("@import")){var t=o(this.tags);t.insertBefore(document.createTextNode(e),t.firstChild)}else o(this.tags).appendChild(document.createTextNode(e));else this.sheet.insertRule(e,-1!==e.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,c&&this.ctr%this.maxLength===0&&this.tags.push(f()),this.ctr-1},delete:function(e){return this.replace(e,"")},flush:function(){c?(this.tags.forEach((function(e){return e.parentNode.removeChild(e)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!c)return this.sheet.cssRules;var e=[];return this.tags.forEach((function(t){return e.splice.apply(e,[e.length,0].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array.from(u(t).cssRules))))})),e}})},function(e,t,n){"use strict";var r=n(387),a=/^-ms-/;e.exports=function(e){return r(e.replace(a,"ms-"))}},function(e,t,n){"use strict";var r=/-(.)/g;e.exports=function(e){return e.replace(r,(function(e,t){return t.toUpperCase()}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(389));a(n(293));function a(e){return e&&e.__esModule?e:{default:e}}var i=r.default.isUnitlessNumber;t.default=function(e,t,n){return null==t||"boolean"===typeof t||""===t?"":isNaN(t)||0===t||i.hasOwnProperty(e)&&i[e]?""+t:("string"===typeof t&&(t=t.trim()),t+"px")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var a=["Webkit","ms","Moz","O"];Object.keys(r).forEach((function(e){a.forEach((function(t){r[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(t,e)]=r[e]}))}));var i={isUnitlessNumber:r,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};t.default=i},function(e,t,n){"use strict";function r(e){return function(){return e}}var a=function(){};a.thatReturns=r,a.thatReturnsFalse=r(!1),a.thatReturnsTrue=r(!0),a.thatReturnsNull=r(null),a.thatReturnsThis=function(){return this},a.thatReturnsArgument=function(e){return e},e.exports=a},function(e,t,n){"use strict";var r=n(392),a=/^ms-/;e.exports=function(e){return r(e).replace(a,"-ms-")}},function(e,t,n){"use strict";var r=/([A-Z])/g;e.exports=function(e){return e.replace(r,"-$1").toLowerCase()}},function(e,t,n){"use strict";e.exports=function(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e){if(function(e){return null===e||void 0===e||!1===e||"object"===("undefined"===typeof e?"undefined":r(e))&&0===Object.keys(e).length}(e))return null;if("object"!==("undefined"===typeof e?"undefined":r(e)))return e;for(var t={},n=Object.keys(e),a=!1,o=0;o<n.length;o++){var u=e[n[o]],c=i(u);null!==c&&c===u||(a=!0),null!==c&&(t[n[o]]=c)}return 0===Object.keys(t).length?null:a?t:e}function i(e){return Array.isArray(e)?function(e){var t=!1,n=[];return e.forEach((function(e){var r=i(e);null!==r&&r===e||(t=!0),null!==r&&n.push(r)})),0==n.length?null:t?n:e}(e):a(e)}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.PluginSet=c,t.fallbacks=function(e){if(Object.keys(e.style).map((function(t){return Array.isArray(e.style[t])})).indexOf(!0)>=0){var t=e.style,n=Object.keys(t).reduce((function(e,n){return e[n]=Array.isArray(t[n])?t[n].join("; "+(0,i.processStyleName)(n)+": "):t[n],e}),{});return(0,a.default)({},e,{style:n})}return e},t.contentWrap=function(e){if(e.style.content){var t=e.style.content;return s.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)?e:t.charAt(0)!==t.charAt(t.length-1)||'"'!==t.charAt(0)&&"'"!==t.charAt(0)?r({},e,{style:r({},e.style,{content:'"'+t+'"'})}):e}return e},t.prefixes=function(e){return(0,a.default)({},e,{style:(0,o.default)(r({},e.style))})};var a=u(n(124)),i=n(292),o=u(n(396));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){this.fns=e||[]}(0,a.default)(c.prototype,{add:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){e.fns.indexOf(t)>=0||(e.fns=[t].concat(e.fns))}))},remove:function(e){this.fns=this.fns.filter((function(t){return t!==e}))},clear:function(){this.fns=[]},transform:function(e){return this.fns.reduce((function(e,t){return t(e)}),e)}});var s=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t in e){var n=e[t],r=(0,i.default)(b,t,n,e,g);r&&(e[t]=r),(0,a.default)(g,t,e)}return e};var r=m(n(397)),a=m(n(398)),i=m(n(399)),o=m(n(400)),u=m(n(401)),c=m(n(402)),s=m(n(403)),l=m(n(404)),f=m(n(405)),d=m(n(406)),h=m(n(407)),p=m(n(408)),v=m(n(409));function m(e){return e&&e.__esModule?e:{default:e}}var b=[u.default,o.default,c.default,l.default,f.default,d.default,h.default,p.default,v.default,s.default],g=r.default.prefixMap},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["Webkit"],a=["Moz"],i=["ms"],o=["Webkit","Moz"],u=["Webkit","ms"],c=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:o,userSelect:c,textEmphasisPosition:r,textEmphasis:r,textEmphasisStyle:r,textEmphasisColor:r,boxDecorationBreak:r,clipPath:r,maskImage:r,maskMode:r,maskRepeat:r,maskPosition:r,maskClip:r,maskOrigin:r,maskSize:r,maskComposite:r,mask:r,maskBorderSource:r,maskBorderMode:r,maskBorderSlice:r,maskBorderWidth:r,maskBorderOutset:r,maskBorderRepeat:r,maskBorder:r,maskType:r,textDecorationStyle:r,textDecorationSkip:r,textDecorationLine:r,textDecorationColor:r,filter:r,fontFeatureSettings:r,breakAfter:c,breakBefore:c,breakInside:c,columnCount:o,columnFill:o,columnGap:o,columnRule:o,columnRuleColor:o,columnRuleStyle:o,columnRuleWidth:o,columns:o,columnSpan:o,columnWidth:o,writingMode:u,flex:r,flexBasis:r,flexDirection:r,flexGrow:r,flexFlow:r,flexShrink:r,flexWrap:r,alignContent:r,alignItems:r,alignSelf:r,justifyContent:r,order:r,transform:r,transformOrigin:r,transformOriginX:r,transformOriginY:r,backfaceVisibility:r,perspective:r,perspectiveOrigin:r,transformStyle:r,transformOriginZ:r,animation:r,animationDelay:r,animationDirection:r,animationFillMode:r,animationDuration:r,animationIterationCount:r,animationName:r,animationPlayState:r,animationTimingFunction:r,backdropFilter:r,fontKerning:r,scrollSnapType:u,scrollSnapPointsX:u,scrollSnapPointsY:u,scrollSnapDestination:u,scrollSnapCoordinate:u,shapeImageThreshold:r,shapeImageMargin:r,shapeImageOutside:r,hyphens:c,flowInto:u,flowFrom:u,regionFragment:u,textAlignLast:a,tabSize:a,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:u,borderImage:r,borderImageOutset:r,borderImageRepeat:r,borderImageSlice:r,borderImageSource:r,borderImageWidth:r,transitionDelay:r,transitionDuration:r,transitionProperty:r,transitionTimingFunction:r}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e.hasOwnProperty(t))for(var r=e[t],a=0,o=r.length;a<o;++a)n[r[a]+(0,i.default)(t)]=n[t]};var r,a=n(294),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,a){for(var i=0,o=e.length;i<o;++i){var u=e[i](t,n,r,a);if(u)return u}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("cursor"===e&&a.hasOwnProperty(t))return r.map((function(e){return e+t}))};var r=["-webkit-","-moz-",""],a={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("cross-fade(")>-1)return o.map((function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")}))};var r,a=n(164),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("filter(")>-1)return o.map((function(e){return t.replace(/filter\(/g,e+"filter(")}))};var r,a=n(164),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("display"===e&&r.hasOwnProperty(t))return r[t]};var r={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){"flexDirection"===e&&"string"===typeof t&&(t.indexOf("column")>-1?n.WebkitBoxOrient="vertical":n.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?n.WebkitBoxDirection="reverse":n.WebkitBoxDirection="normal");a.hasOwnProperty(e)&&(n[a[e]]=r[t]||t)};var r={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},a={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&u.test(t))return o.map((function(e){return e+t}))};var r,a=n(164),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-","-moz-",""],u=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("image-set(")>-1)return o.map((function(e){return t.replace(/image-set\(/g,e+"image-set(")}))};var r,a=n(164),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("position"===e&&"sticky"===t)return["-webkit-sticky","sticky"]},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(a.hasOwnProperty(e)&&i.hasOwnProperty(t))return r.map((function(e){return e+t}))};var r=["-webkit-","-moz-",""],a={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){if("string"===typeof t&&u.hasOwnProperty(e)){var s=function(e,t){if((0,a.default)(e))return e;for(var n=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),i=0,o=n.length;i<o;++i){var u=n[i],s=[u];for(var l in t){var f=(0,r.default)(l);if(u.indexOf(f)>-1&&"order"!==f)for(var d=t[l],h=0,p=d.length;h<p;++h)s.unshift(u.replace(f,c[d[h]]+f))}n[i]=s.join(",")}return n.join(",")}(t,o),l=s.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-moz-|-ms-/.test(e)})).join(",");if(e.indexOf("Webkit")>-1)return l;var f=s.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-webkit-|-ms-/.test(e)})).join(",");return e.indexOf("Moz")>-1?f:(n["Webkit"+(0,i.default)(e)]=l,n["Moz"+(0,i.default)(e)]=f,s)}};var r=o(n(410)),a=o(n(164)),i=o(n(294));function o(e){return e&&e.__esModule?e:{default:e}}var u={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var r,a=n(411),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},function(e,t,n){"use strict";n.r(t);var r=/[A-Z]/g,a=/^ms-/,i={};function o(e){return"-"+e.toLowerCase()}t.default=function(e){if(i.hasOwnProperty(e))return i[e];var t=e.replace(r,o);return i[e]=a.test(t)?"-"+t:t}},function(e,t,n){"use strict";function r(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function a(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function i(e,t){return(65535&(e|=0))*(t|=0)+(((e>>>16)*t&65535)<<16)|0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=1540483477,o=t^e.length,u=e.length,c=0;for(;u>=4;){var s=r(e,c);s=i(s,n),s=i(s^=s>>>24,n),o=i(o,n),o^=s,c+=4,u-=4}switch(u){case 3:o^=a(e,c),o=i(o^=e.charCodeAt(c+2)<<16,n);break;case 2:o=i(o^=a(e,c),n);break;case 1:o=i(o^=e.charCodeAt(c),n)}return o=i(o^=o>>>13,n),(o^=o>>>15)>>>0}},function(e,t,n){"use strict";var r=n(129),a=n(98),i=n(99),o=n(297),u=n(243),c=n(244);Object.defineProperty(t,"__esModule",{value:!0});var s=n(245),l=n(163),f=n(419),d=n(420),h=function(e){u(n,e);var t=c(n);function n(e){var r;a(this,n),(r=t.call(this,e)).surfaces=new Map;var i=null==e.startOpen||e.startOpen;return r.state={isOpen:i,isFullscreen:!1,activeTab:null,tabs:new Set},r.keyHandler=r.keyHandler.bind(o(r)),r}return i(n,[{key:"close",value:function(){this.setState({isOpen:!1})}},{key:"open",value:function(){this.setState({isOpen:!0})}},{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"toggleFullScreen",value:function(){this.setState({isFullscreen:!this.state.isFullscreen})}},{key:"isOpen",value:function(){return this.state.isOpen}},{key:"isFullscreen",value:function(){return this.state.isFullscreen}},{key:"getSurface",value:function(e,t){var n,r=this.surfaceId(e,t);if(!this.surfaces.has(r))throw Error("Surface not found with id: ".concat(r));return{container:(n=this.surfaces.get(r)).container,label:n.label,drawArea:n.drawArea}}},{key:"bindKeys",value:function(){document.addEventListener("keydown",this.keyHandler,!1)}},{key:"unbindKeys",value:function(){document.removeEventListener("keydown",this.keyHandler)}},{key:"surfaceId",value:function(e,t){return e+t}},{key:"setTabs",value:function(e){var t,n,a=e.map((function(e){return e.tab})),i=this.state.tabs,o=r(a);try{for(o.s();!(n=o.n()).done;){var u=n.value;i.has(u)||(i.add(u),t=u)}}catch(c){o.e(c)}finally{o.f()}null!=t&&this.setState({tabs:i,activeTab:t})}},{key:"getTabs",value:function(){return this.state.tabs}},{key:"registerSurface",value:function(e,t,n){var r=this.surfaceId(e,t);this.surfaces.set(r,n)}},{key:"keyHandler",value:function(e){192===e.keyCode&&(e.shiftKey?this.toggleFullScreen():this.toggle())}},{key:"setActiveTab",value:function(e){this.setState({activeTab:e})}},{key:"componentDidMount",value:function(){this.bindKeys()}},{key:"componentWillMount",value:function(){this.setTabs(this.props.surfaceList)}},{key:"componentWillReceiveProps",value:function(e){this.setTabs(e.surfaceList)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isOpen,r=t.isFullscreen,a=t.activeTab,i=this.props.surfaceList,o=Array.from(this.getTabs().values()),u=r?"90vw":"550px",c=l.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),h=l.css({right:"0"}),v=l.css({right:"calc(-".concat(u," - 10px)")}),m=n?h:v,b=l.css({});return s.h("div",{className:"".concat(c," ").concat(m," visor"),"data-isopen":n,"data-isfullscreen":r},s.h(p,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:r}),s.h(d.Tabs,{tabNames:o,activeTab:a,handleClick:this.setActiveTab.bind(this)}),s.h("div",{className:"".concat(b," visor-surfaces")},i.map((function(t){return s.h(f.SurfaceComponent,{key:t.name+t.tab,name:t.name,tab:t.tab,styles:t.styles,registerSurface:e.registerSurface.bind(e),visible:a===t.tab})}))))}}],[{key:"render",value:function(e,t,r){return s.render(s.h(n,Object.assign({},r)),e,t)}}]),n}(s.Component);function p(e){var t=e.isFullScreen,n=e.fullScreenHandler,r=e.closeHandler,a=l.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),i=l.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=l.css({marginLeft:"auto"});return s.h("div",{className:"".concat(a," visor-controls")},s.h("button",{className:"".concat(i),onClick:n},t?"Minimize":"Maximize"),s.h("button",{className:"".concat(i," ").concat(o),onClick:r},"Hide"))}t.VisorComponent=h},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t,n){var r=n(418),a=n(297);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?a(e):t}},function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){"use strict";var r=n(98),a=n(99),i=n(243),o=n(244);Object.defineProperty(t,"__esModule",{value:!0});var u=n(245),c=n(163),s=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.name,n=e.tab;this.props.registerSurface(t,n,this)}},{key:"componentDidUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this,t=this.props,r=t.name,a=t.visible,i=t.styles,o=Object.assign({},n.defaultStyles,i),s=o.width,l=o.height,f=o.maxHeight,d=o.maxWidth;f=l===n.defaultStyles.height?f:l,d=s===n.defaultStyles.width?d:s;var h=c.css({display:a?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:l,width:s,maxHeight:f,maxWidth:d,overflow:"auto"}),p=c.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),v=c.css({boxSizing:"border-box"});return u.h("div",{className:"".concat(h," tf-surface"),ref:function(t){return e.container=t},"data-visible":a},u.h("div",{className:"".concat(p," tf-label"),ref:function(t){return e.label=t}},r),u.h("div",{className:"".concat(v," tf-draw-area"),ref:function(t){return e.drawArea=t}}))}}]),n}(u.Component);s.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},t.SurfaceComponent=s},function(e,t,n){"use strict";var r=n(98),a=n(99),i=n(243),o=n(244);Object.defineProperty(t,"__esModule",{value:!0});var u=n(245),c=n(163),s=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"render",value:function(){var e=this.props,t=e.tabNames,n=e.activeTab,r=e.handleClick,a=t.length>0?t.map((function(e){return u.h(l,{key:e,id:e,handleClick:r,isActive:e===n},e)})):null,i=c.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return u.h("div",{className:"".concat(i," visor-tabs")},a)}}]),n}(u.Component);t.Tabs=s;var l=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.isActive,r=e.handleClick,a=e.id,i=c.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return u.h("a",{className:"".concat(i," tf-tab"),"data-isactive":n,onClick:function(){return r(a)}},t)}}]),n}(u.Component)},function(e,t,n){"use strict";var r=n(4),a=n(129),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(130)),c=n(100),s=n(82);t.confusionMatrix=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r.mark((function i(){var o,f,d,h,p,v,m,b,g,y,x,O,k,w,j,_,S,E;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(o=Object.assign({},l,n),f=s.getDrawArea(e),d=[],h=t.values,p=t.tickLabels||[],v=0===p.length,m=!0,b=0;b<h.length;b++)for(g=v?"Class ".concat(b):p[b],v&&p.push(g),y=0;y<h[b].length;y++)x=v?"Class ".concat(y):p[y],O=h[b][y],b!==y||o.shadeDiagonal?(d.push({label:g,prediction:x,count:O,scaleCount:O}),0!==O&&(m=!1)):d.push({label:g,prediction:x,count:O,noFill:!0});if(!o.shadeDiagonal&&m){k=a(d);try{for(k.s();!(w=k.n()).done;)!0===(j=w.value).noFill&&(j.noFill=!1,j.scaleCount=j.count)}catch(i){k.e(i)}finally{k.f()}}return _={actions:!1,mode:"vega-lite",defaultStyle:!1},S={width:o.width||c.getDefaultWidth(f),height:o.height||c.getDefaultHeight(f),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},data:{values:d},encoding:{x:{field:"prediction",type:"ordinal",title:o.xLabel||"prediction",scale:{domain:p}},y:{field:"label",type:"ordinal",title:o.yLabel||"label",scale:{domain:p}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:o.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]},!1===o.shadeDiagonal&&S.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),o.showTextOverlay&&S.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}}),E="string"===typeof o.colorMap?{scheme:o.colorMap}:o.colorMap,S.layer[0].encoding.color.scale.range=E,r.next=17,u.default(f,S,_);case 17:case"end":return r.stop()}}),i)})))};var l={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},function(e,t,n){"use strict";var r=n(4),a=n(242),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(1)),s=u(n(130)),l=n(100),f=n(179),d=n(82);function h(e){return i(this,void 0,void 0,r.mark((function t(){var n,a,i,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e instanceof c.Tensor?(n=e.shape,a=e.transpose()):(n=[e.length,e[0].length],a=c.tidy((function(){return c.tensor2d(e).transpose()}))),f.assert(2===a.rank,"Input to renderHeatmap must be a 2d array or Tensor2d"),t.next=4,a.array();case 4:return i=t.sent,a.dispose(),o=[i.length,i[0].length],f.assert(n[0]===o[1]&&n[1]===o[0],"Unexpected transposed shape. Original ".concat(n," : Transposed ").concat(o)),t.abrupt("return",i);case 9:case"end":return t.stop()}}),t)})))}function p(e,t,n){var r=e instanceof c.Tensor?e.shape:[e.length,e[0].length];0===n?f.assert(r[0]===t.length,"Length of xTickLabels (".concat(t.length,") must match number of rows")+" (".concat(r[0],")")):1===n&&f.assert(r[1]===t.length,"Length of yTickLabels (".concat(t.length,") must match number of columns (").concat(r[1],")"))}t.heatmap=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r.mark((function i(){var o,u,m,b,g,y,x,O,k,w,j,_,S,E,C,A,N,T,I,D,F,M,R,z,L,P,B,W;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=Object.assign({},v,n),u=d.getDrawArea(e),m=t.values,!o.rowMajor){r.next=7;break}return r.next=6,h(t.values);case 6:m=r.sent;case 7:if(b=t.xTickLabels,g=t.yTickLabels,null!=b&&(0,p(m,b,0)),null!=g&&(1,p(m,g,1)),y="@tfidx@",x=[],!(m instanceof c.Tensor)){r.next=21;break}return f.assert(2===m.rank,"Input to renderHeatmap must be a 2d array or Tensor2d"),r.next=16,m.data();case 16:for(O=r.sent,k=a(m.shape,2),w=k[0],j=k[1],_=0;_<w;_++)for(S=b?"".concat(b[_]).concat(y).concat(_):_,E=0;E<j;E++)C=g?"".concat(g[E]).concat(y).concat(E):E,A=O[_*j+E],x.push({x:S,y:C,value:A});r.next=23;break;case 21:for(N=m,T=0;T<N.length;T++)for(I=b?"".concat(b[T]).concat(y).concat(T):T,D=0;D<N[T].length;D++)F=g?"".concat(g[D]).concat(y).concat(D):D,M=N[T][D],x.push({x:I,y:F,value:M});case 23:R={actions:!1,mode:"vega-lite",defaultStyle:!1},z={width:o.width||l.getDefaultWidth(u),height:o.height||l.getDefaultHeight(u),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:x},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:o.xType,title:o.xLabel,sort:!1},y:{field:"y",type:o.yType,title:o.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},L="".concat(y,"\\d+$"),P=new RegExp(L),b&&(z.encoding.x.axis={labelExpr:"replace(datum.value, regexp(/".concat(L,"/), '')")}),g&&(z.encoding.y.axis={labelExpr:"replace(datum.value, regexp(/".concat(L,"/), '')")}),(b||g)&&(R.tooltip={sanitize:function(e){return String(e).replace(P,"")}}),r.t0=o.colorMap,r.next="blues"===r.t0?33:"greyscale"===r.t0?35:(r.t0,37);break;case 33:return B=["#f7fbff","#4292c6"],r.abrupt("break",39);case 35:return B=["#000000","#ffffff"],r.abrupt("break",39);case 37:return B="viridis",r.abrupt("break",39);case 39:return"viridis"!==B&&(z.encoding.fill.scale={range:B}),o.domain&&(null!=(W=z.encoding.fill).scale?W.scale=Object.assign({},W.scale,{domain:o.domain}):W.scale={domain:o.domain}),r.next=43,s.default(u,z,R);case 43:case"end":return r.stop()}}),i)})))};var v={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},function(e,t,n){"use strict";var r=n(4),a=n(239),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(130)),c=n(100),s=n(179),l=n(82);t.scatterplot=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r.mark((function i(){var o,d,h,p,v,m,b,g,y;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.values,d=null==t.series?[]:t.series,o=Array.isArray(o[0])?o:[o],h=[],o.forEach((function(e,t){var n=null!=d[t]?d[t]:"Series ".concat(t+1),r=e.map((function(e){return Object.assign({},e,{series:n})}));h.push.apply(h,a(r))})),null!=n.seriesColors&&s.assert(n.seriesColors.length===o.length,"Must have an equal number of series colors as there are data series"),p=l.getDrawArea(e),v=Object.assign({},f,n),m={actions:!1,mode:"vega-lite",defaultStyle:!1},b=function(){return v.zoomToFit?{zero:!1}:null!=v.xAxisDomain?{domain:v.xAxisDomain}:void 0},g=function(){return v.zoomToFit?{zero:!1}:null!=v.yAxisDomain?{domain:v.yAxisDomain}:void 0},y={width:v.width||c.getDefaultWidth(p),height:v.height||c.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:v.fontSize,titleFontSize:v.fontSize},text:{fontSize:v.fontSize},legend:{labelFontSize:v.fontSize,titleFontSize:v.fontSize}},data:{values:h},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:v.xType,title:v.xLabel,scale:b()},y:{field:"y",type:v.yType,title:v.yLabel,scale:g()},color:{field:"series",type:"nominal",scale:{range:v.seriesColors}},shape:{field:"series",type:"nominal"}}},r.next=14,u.default(p,y,m);case 14:return r.abrupt("return",Promise.resolve());case 15:case"end":return r.stop()}}),i)})))};var f={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},function(e,t,n){"use strict";var r=n(425),a=n(4),i=n(129),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var u=n(298),c=n(82),s=n(100);function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return o(this,void 0,void 0,a.mark((function o(){var l,h,p,v,m,b,g,y,x,O,k,w,j,_,S,E,C,A;return a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:l=c.getDrawArea(e),h={},p=i(n);try{for(p.s();!(v=p.n()).done;)m=v.value,/val_/.test(m)?(g=m.replace("val_",""),f(h,g),y=d(t,m,n.indexOf(m)),h[g].series.push(m),h[g].values.push(y)):(b=d(t,m,n.indexOf(m)),f(h,m),h[m].series.push(m),h[m].values.push(b))}catch(o){p.e(o)}finally{p.f()}for(x=Object.keys(h),O=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),k=[],w=0,j=x;w<j.length;w++)_=j[w],S=s.subSurface(l,_),E=h[_].series,C=h[_].values,E.every((function(e){return Boolean(e.match("acc"))}))&&(O.zoomToFitAccuracy?O.zoomToFit=!0:(O.yAxisDomain=[0,1],delete O.zoomToFit)),A=u.linechart(S,{values:C,series:E},O),k.push(A);return a.next=10,Promise.all(k);case 10:case"end":return a.stop()}}),o)})))}function f(e,t){null==e[t]&&(e[t]={series:[],values:[]})}function d(e,t,n){if(Array.isArray(e)){for(var r=Array.isArray(e[0])?e[n]:e,a=[],i=0;i<r.length;i++){var o=r[i];a.push({x:i,y:o[t]})}return a}return e.history[t].map((function(e,t){return{x:t,y:e}}))}function h(e,t,n){return null==e[t]&&(e[t]={}),null==e[t][n]&&(e[t][n]=[]),e[t][n]}t.history=l,t.fitCallbacks=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u={},f=n.callbacks||["onEpochEnd","onBatchEnd"],d=c.getDrawArea(e),p=Object.assign({},n);function v(e){var n=this;return function(f,v){return o(n,void 0,void 0,a.mark((function n(){var o,f,m,b,g,y;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:/batch/i.test(e)?p.xLabel="Batch":/epoch/i.test(e)&&(p.xLabel="Epoch"),o=[],f=[],m=i(t);try{for(m.s();!(b=m.n()).done;)g=b.value,null!=v[g]&&(f.push(g),(y=h(u,e,g)).push(r({},g,v[g])),o.push(y))}catch(a){m.e(a)}finally{m.f()}return l(s.subSurface(d,e,{title:e}),o,f,p),n.next=9,c.nextFrame();case 9:case"end":return n.stop()}}),n)})))}}delete p.callbacks;var m={};return f.forEach((function(e){m[e]=v(e)})),m}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";var r=n(4),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(246),o=n(82),u=n(181),c=n(100),s=n(180);function l(e){return{layers:e.layers.map(f)}}function f(e){var t;if(Array.isArray(e.outputShape[0])){var n=e.outputShape.map((function(e){return h(e)}));t="[".concat(n.join(", "),"]")}else t=h(e.outputShape);return{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function d(e){return a(this,void 0,void 0,r.mark((function t(){var n,a,i,o,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getWeights(),a=e.weights,i=n.map(s.tensorStats),t.next=5,Promise.all(i);case 5:return o=t.sent,u=n.map((function(e){return e.shape})),t.abrupt("return",n.map((function(e,t){return{name:a[t].name,stats:o[t],shape:h(u[t]),weight:e}})));case 8:case"end":return t.stop()}}),t)})))}function h(e){var t=e.slice();return 0===t.length?"Scalar":(null===t[0]&&(t[0]="batch"),"[".concat(t.join(","),"]"))}function p(e,t,n){var r="\n    <select>\n      ".concat(e.map((function(e){return"<option value=".concat(e,">").concat(e,"</option>")})),"\n    </select>\n  "),a="<div>".concat("<button>Show Values Distribution for:</button>").concat(r,"</div>");t.innerHTML=a;var i=t.querySelector("button"),o=t.querySelector("select");i.addEventListener("click",(function(){n(o.selectedOptions[0].label)}))}t.modelSummary=function(e,t){return a(this,void 0,void 0,r.mark((function n(){var a,i,c,s;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=o.getDrawArea(e),i=l(t),c=["Layer Name","Output Shape","# Of Params","Trainable"],s=i.layers.map((function(e){return[e.name,e.outputShape,e.parameters,e.trainable]})),u.table(a,{headers:c,values:s});case 5:case"end":return n.stop()}}),n)})))},t.layer=function(e,t){return a(this,void 0,void 0,r.mark((function n(){var s,l,f,h,v,m,b,g,y=this;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=o.getDrawArea(e),n.next=3,d(t);case 3:l=n.sent,f=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],h=c.subSurface(s,"layer-weights-info"),v=l.map((function(e){return[e.name,e.shape,e.stats.min,e.stats.max,e.weight.size,e.stats.numZeros,e.stats.numNans,e.stats.numInfs]})),u.table(h,{headers:f,values:v}),m=c.subSurface(s,"select-layer"),b=c.subSurface(s,"param-distribution"),g=function(e){return a(y,void 0,void 0,r.mark((function t(){var n,a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.filter((function(t){return t.name===e}))[0],t.next=3,n.weight.data();case 3:a=t.sent,i.histogram(b,a,{height:150,width:460,stats:!1});case 5:case"end":return t.stop()}}),t)})))},p(l.map((function(e){return e.name})),m,g);case 12:case"end":return n.stop()}}),n)})))}},function(e,t,n){"use strict";var r=n(4),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(82),o=n(181);t.perClassAccuracy=function(e,t,n){return a(this,void 0,void 0,r.mark((function a(){var u,c,s,l,f,d;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(u=i.getDrawArea(e),c=["Class","Accuracy","# Samples"],s=[],l=0;l<t.length;l++)f=n?n[l]:l.toString(),d=t[l],s.push([f,d.accuracy,d.count]);return r.abrupt("return",o.table(u,{headers:c,values:s}));case 5:case"end":return r.stop()}}),a)})))}},function(e,t,n){"use strict";var r=n(4),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(246),o=n(82),u=n(180);t.valuesDistribution=function(e,t){return a(this,void 0,void 0,r.mark((function n(){var a,c,s;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o.getDrawArea(e),n.next=3,u.tensorStats(t);case 3:return c=n.sent,n.next=6,t.data();case 6:s=n.sent,i.histogram(a,s,{height:150,stats:c});case 8:case"end":return n.stop()}}),n)})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.version="1.5.1"},,,function(e,t,n){"use strict";n(124);var r=n(44),a=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var i=Symbol.for;a=i("react.element"),t.Fragment=i("react.fragment")}var o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function s(e,t,n){var r,i={},s=null,l=null;for(r in void 0!==n&&(s=""+n),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(l=t.ref),t)u.call(t,r)&&!c.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:s,ref:l,props:i,_owner:o.current}}t.jsx=s,t.jsxs=s},function(e,t,n){"use strict";n.r(t),n.d(t,"create",(function(){return ge})),n.d(t,"creator",(function(){return c})),n.d(t,"local",(function(){return xe})),n.d(t,"matcher",(function(){return m})),n.d(t,"mouse",(function(){return je})),n.d(t,"namespace",(function(){return i})),n.d(t,"namespaces",(function(){return a})),n.d(t,"clientPoint",(function(){return we})),n.d(t,"select",(function(){return be})),n.d(t,"selectAll",(function(){return _e})),n.d(t,"selection",(function(){return me})),n.d(t,"selector",(function(){return l})),n.d(t,"selectorAll",(function(){return d})),n.d(t,"style",(function(){return I})),n.d(t,"touch",(function(){return Se})),n.d(t,"touches",(function(){return Ee})),n.d(t,"window",(function(){return C})),n.d(t,"event",(function(){return re})),n.d(t,"customEvent",(function(){return se}));var r="http://www.w3.org/1999/xhtml",a={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},i=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),a.hasOwnProperty(t)?{space:a[t],local:e}:e};function o(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===r&&t.documentElement.namespaceURI===r?t.createElement(e):t.createElementNS(n,e)}}function u(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var c=function(e){var t=i(e);return(t.local?u:o)(t)};function s(){}var l=function(e){return null==e?s:function(){return this.querySelector(e)}};function f(){return[]}var d=function(e){return null==e?f:function(){return this.querySelectorAll(e)}},h=function(e){return function(){return this.matches(e)}};if("undefined"!==typeof document){var p=document.documentElement;if(!p.matches){var v=p.webkitMatchesSelector||p.msMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector;h=function(e){return function(){return v.call(this,e)}}}}var m=h,b=function(e){return new Array(e.length)};function g(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}g.prototype={constructor:g,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function y(e,t,n,r,a,i){for(var o,u=0,c=t.length,s=i.length;u<s;++u)(o=t[u])?(o.__data__=i[u],r[u]=o):n[u]=new g(e,i[u]);for(;u<c;++u)(o=t[u])&&(a[u]=o)}function x(e,t,n,r,a,i,o){var u,c,s,l={},f=t.length,d=i.length,h=new Array(f);for(u=0;u<f;++u)(c=t[u])&&(h[u]=s="$"+o.call(c,c.__data__,u,t),s in l?a[u]=c:l[s]=c);for(u=0;u<d;++u)(c=l[s="$"+o.call(e,i[u],u,i)])?(r[u]=c,c.__data__=i[u],l[s]=null):n[u]=new g(e,i[u]);for(u=0;u<f;++u)(c=t[u])&&l[h[u]]===c&&(a[u]=c)}function O(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function k(e){return function(){this.removeAttribute(e)}}function w(e){return function(){this.removeAttributeNS(e.space,e.local)}}function j(e,t){return function(){this.setAttribute(e,t)}}function _(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function S(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function E(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}var C=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function A(e){return function(){this.style.removeProperty(e)}}function N(e,t,n){return function(){this.style.setProperty(e,t,n)}}function T(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function I(e,t){return e.style.getPropertyValue(t)||C(e).getComputedStyle(e,null).getPropertyValue(t)}function D(e){return function(){delete this[e]}}function F(e,t){return function(){this[e]=t}}function M(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function R(e){return e.trim().split(/^|\s+/)}function z(e){return e.classList||new L(e)}function L(e){this._node=e,this._names=R(e.getAttribute("class")||"")}function P(e,t){for(var n=z(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function B(e,t){for(var n=z(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function W(e){return function(){P(this,e)}}function U(e){return function(){B(this,e)}}function V(e,t){return function(){(t.apply(this,arguments)?P:B)(this,e)}}L.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function q(){this.textContent=""}function H(e){return function(){this.textContent=e}}function G(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function K(){this.innerHTML=""}function X(e){return function(){this.innerHTML=e}}function Y(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function $(){this.nextSibling&&this.parentNode.appendChild(this)}function J(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Q(){return null}function Z(){var e=this.parentNode;e&&e.removeChild(this)}function ee(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function te(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var ne={},re=null;"undefined"!==typeof document&&("onmouseenter"in document.documentElement||(ne={mouseenter:"mouseover",mouseleave:"mouseout"}));function ae(e,t,n){return e=ie(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function ie(e,t,n){return function(r){var a=re;re=r;try{e.call(this,this.__data__,t,n)}finally{re=a}}}function oe(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function ue(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.capture);++a?t.length=a:delete this.__on}}}function ce(e,t,n){var r=ne.hasOwnProperty(e.type)?ae:ie;return function(a,i,o){var u,c=this.__on,s=r(t,i,o);if(c)for(var l=0,f=c.length;l<f;++l)if((u=c[l]).type===e.type&&u.name===e.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=s,u.capture=n),void(u.value=t);this.addEventListener(e.type,s,n),u={type:e.type,name:e.name,value:t,listener:s,capture:n},c?c.push(u):this.__on=[u]}}function se(e,t,n,r){var a=re;e.sourceEvent=re,re=e;try{return t.apply(n,r)}finally{re=a}}function le(e,t,n){var r=C(e),a=r.CustomEvent;"function"===typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function fe(e,t){return function(){return le(this,e,t)}}function de(e,t){return function(){return le(this,e,t.apply(this,arguments))}}var he=[null];function pe(e,t){this._groups=e,this._parents=t}function ve(){return new pe([[document.documentElement]],he)}pe.prototype=ve.prototype={constructor:pe,select:function(e){"function"!==typeof e&&(e=l(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o,u=t[a],c=u.length,s=r[a]=new Array(c),f=0;f<c;++f)(i=u[f])&&(o=e.call(i,i.__data__,f,u))&&("__data__"in i&&(o.__data__=i.__data__),s[f]=o);return new pe(r,this._parents)},selectAll:function(e){"function"!==typeof e&&(e=d(e));for(var t=this._groups,n=t.length,r=[],a=[],i=0;i<n;++i)for(var o,u=t[i],c=u.length,s=0;s<c;++s)(o=u[s])&&(r.push(e.call(o,o.__data__,s,u)),a.push(o));return new pe(r,a)},filter:function(e){"function"!==typeof e&&(e=m(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],u=o.length,c=r[a]=[],s=0;s<u;++s)(i=o[s])&&e.call(i,i.__data__,s,o)&&c.push(i);return new pe(r,this._parents)},data:function(e,t){if(!e)return p=new Array(this.size()),l=-1,this.each((function(e){p[++l]=e})),p;var n,r=t?x:y,a=this._parents,i=this._groups;"function"!==typeof e&&(n=e,e=function(){return n});for(var o=i.length,u=new Array(o),c=new Array(o),s=new Array(o),l=0;l<o;++l){var f=a[l],d=i[l],h=d.length,p=e.call(f,f&&f.__data__,l,a),v=p.length,m=c[l]=new Array(v),b=u[l]=new Array(v);r(f,d,m,b,s[l]=new Array(h),p,t);for(var g,O,k=0,w=0;k<v;++k)if(g=m[k]){for(k>=w&&(w=k+1);!(O=b[w])&&++w<v;);g._next=O||null}}return(u=new pe(u,a))._enter=c,u._exit=s,u},enter:function(){return new pe(this._enter||this._groups.map(b),this._parents)},exit:function(){return new pe(this._exit||this._groups.map(b),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),u=0;u<i;++u)for(var c,s=t[u],l=n[u],f=s.length,d=o[u]=new Array(f),h=0;h<f;++h)(c=s[h]||l[h])&&(d[h]=c);for(;u<r;++u)o[u]=t[u];return new pe(o,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=O);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,u=n[i],c=u.length,s=a[i]=new Array(c),l=0;l<c;++l)(o=u[l])&&(s[l]=o);s.sort(t)}return new pe(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,i=t[n],o=0,u=i.length;o<u;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this},attr:function(e,t){var n=i(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?w:k:"function"===typeof t?n.local?E:S:n.local?_:j)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?A:"function"===typeof t?T:N)(e,t,null==n?"":n)):I(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?D:"function"===typeof t?M:F)(e,t)):this.node()[e]},classed:function(e,t){var n=R(e+"");if(arguments.length<2){for(var r=z(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"===typeof t?V:t?W:U)(n,t))},text:function(e){return arguments.length?this.each(null==e?q:("function"===typeof e?G:H)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?K:("function"===typeof e?Y:X)(e)):this.node().innerHTML},raise:function(){return this.each($)},lower:function(){return this.each(J)},append:function(e){var t="function"===typeof e?e:c(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:c(e),r=null==t?Q:"function"===typeof t?t:l(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Z)},clone:function(e){return this.select(e?te:ee)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,i=oe(e+""),o=i.length;if(!(arguments.length<2)){for(u=t?ce:ue,null==n&&(n=!1),r=0;r<o;++r)this.each(u(i[r],t,n));return this}var u=this.node().__on;if(u)for(var c,s=0,l=u.length;s<l;++s)for(r=0,c=u[s];r<o;++r)if((a=i[r]).type===c.type&&a.name===c.name)return c.value},dispatch:function(e,t){return this.each(("function"===typeof t?de:fe)(e,t))}};var me=ve,be=function(e){return"string"===typeof e?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],he)},ge=function(e){return be(c(e).call(document.documentElement))},ye=0;function xe(){return new Oe}function Oe(){this._="@"+(++ye).toString(36)}Oe.prototype=xe.prototype={constructor:Oe,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var ke=function(){for(var e,t=re;e=t.sourceEvent;)t=e;return t},we=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]},je=function(e){var t=ke();return t.changedTouches&&(t=t.changedTouches[0]),we(e,t)},_e=function(e){return"string"===typeof e?new pe([document.querySelectorAll(e)],[document.documentElement]):new pe([null==e?[]:e],he)},Se=function(e,t,n){arguments.length<3&&(n=t,t=ke().changedTouches);for(var r,a=0,i=t?t.length:0;a<i;++a)if((r=t[a]).identifier===n)return we(e,r);return null},Ee=function(e,t){null==t&&(t=ke().touches);for(var n=0,r=t?t.length:0,a=new Array(r);n<r;++n)a[n]=we(e,t[n]);return a}}]]);
//# sourceMappingURL=2.9dab980f.chunk.js.map